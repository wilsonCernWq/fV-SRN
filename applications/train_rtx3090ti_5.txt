16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/mechhand_640x220x229_float32_raw_640x220x229_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json
Initialize network
Latent space memory: 13.2MiB
# of network parameters: 3473665
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.24it/s]1it [00:00,  3.24it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=0.999988317489624, mean=0.39814621210098267
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.55it/s]Render: : 1it [00:00,  2.55it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 60, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [640, 220, 229], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<05:21,  1.61s/it]Loss: 0.18820:   0%|          | 1/201 [00:01<05:21,  1.61s/it]Loss: 0.18820:   1%|          | 2/201 [00:02<03:52,  1.17s/it]Loss: 0.08480:   1%|          | 2/201 [00:02<03:52,  1.17s/it]Loss: 0.08480:   1%|▏         | 3/201 [00:03<03:24,  1.03s/it]Loss: 0.07123:   1%|▏         | 3/201 [00:03<03:24,  1.03s/it]Loss: 0.07123:   2%|▏         | 4/201 [00:04<03:10,  1.03it/s]Loss: 0.06157:   2%|▏         | 4/201 [00:04<03:10,  1.03it/s]Loss: 0.06157:   2%|▏         | 5/201 [00:05<03:02,  1.07it/s]Loss: 0.05612:   2%|▏         | 5/201 [00:05<03:02,  1.07it/s]Loss: 0.05612:   3%|▎         | 6/201 [00:05<02:57,  1.10it/s]Loss: 0.05266:   3%|▎         | 6/201 [00:05<02:57,  1.10it/s]Loss: 0.05266:   3%|▎         | 7/201 [00:06<02:53,  1.12it/s]Loss: 0.04781:   3%|▎         | 7/201 [00:06<02:53,  1.12it/s]Loss: 0.04781:   4%|▍         | 8/201 [00:07<02:51,  1.13it/s]Loss: 0.04459:   4%|▍         | 8/201 [00:07<02:51,  1.13it/s]Loss: 0.04459:   4%|▍         | 9/201 [00:08<02:49,  1.13it/s]Loss: 0.04129:   4%|▍         | 9/201 [00:08<02:49,  1.13it/s]Loss: 0.04129:   5%|▍         | 10/201 [00:09<02:47,  1.14it/s]Loss: 0.03776:   5%|▍         | 10/201 [00:09<02:47,  1.14it/s]Loss: 0.03776:   5%|▌         | 11/201 [00:10<02:46,  1.14it/s]Loss: 0.03581:   5%|▌         | 11/201 [00:10<02:46,  1.14it/s]Loss: 0.03581:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.03431:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.03431:   6%|▋         | 13/201 [00:12<02:43,  1.15it/s]Loss: 0.03288:   6%|▋         | 13/201 [00:12<02:43,  1.15it/s]Loss: 0.03288:   7%|▋         | 14/201 [00:12<02:42,  1.15it/s]Loss: 0.02939:   7%|▋         | 14/201 [00:12<02:42,  1.15it/s]Loss: 0.02939:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.02718:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.02718:   8%|▊         | 16/201 [00:14<02:40,  1.15it/s]Loss: 0.02619:   8%|▊         | 16/201 [00:14<02:40,  1.15it/s]Loss: 0.02619:   8%|▊         | 17/201 [00:15<02:39,  1.15it/s]Loss: 0.02507:   8%|▊         | 17/201 [00:15<02:39,  1.15it/s]Loss: 0.02507:   9%|▉         | 18/201 [00:16<02:38,  1.15it/s]Loss: 0.02445:   9%|▉         | 18/201 [00:16<02:38,  1.15it/s]Loss: 0.02445:   9%|▉         | 19/201 [00:17<02:38,  1.15it/s]Loss: 0.02390:   9%|▉         | 19/201 [00:17<02:38,  1.15it/s]Loss: 0.02390:  10%|▉         | 20/201 [00:18<02:37,  1.15it/s]Loss: 0.02272:  10%|▉         | 20/201 [00:18<02:37,  1.15it/s]Loss: 0.02272:  10%|█         | 21/201 [00:18<02:37,  1.14it/s]Loss: 0.02217:  10%|█         | 21/201 [00:18<02:37,  1.14it/s]Loss: 0.02217:  11%|█         | 22/201 [00:19<02:36,  1.15it/s]Loss: 0.02119:  11%|█         | 22/201 [00:19<02:36,  1.15it/s]Loss: 0.02119:  11%|█▏        | 23/201 [00:20<02:35,  1.15it/s]Loss: 0.02089:  11%|█▏        | 23/201 [00:20<02:35,  1.15it/s]Loss: 0.02089:  12%|█▏        | 24/201 [00:21<02:33,  1.15it/s]Loss: 0.02046:  12%|█▏        | 24/201 [00:21<02:33,  1.15it/s]Loss: 0.02046:  12%|█▏        | 25/201 [00:22<02:33,  1.15it/s]Loss: 0.01965:  12%|█▏        | 25/201 [00:22<02:33,  1.15it/s]Loss: 0.01965:  13%|█▎        | 26/201 [00:23<02:32,  1.15it/s]Loss: 0.01978:  13%|█▎        | 26/201 [00:23<02:32,  1.15it/s]Loss: 0.01978:  13%|█▎        | 27/201 [00:24<02:31,  1.15it/s]Loss: 0.01892:  13%|█▎        | 27/201 [00:24<02:31,  1.15it/s]Loss: 0.01892:  14%|█▍        | 28/201 [00:25<02:30,  1.15it/s]Loss: 0.01872:  14%|█▍        | 28/201 [00:25<02:30,  1.15it/s]Loss: 0.01872:  14%|█▍        | 29/201 [00:25<02:29,  1.15it/s]Loss: 0.01799:  14%|█▍        | 29/201 [00:25<02:29,  1.15it/s]Loss: 0.01799:  15%|█▍        | 30/201 [00:26<02:28,  1.15it/s]Loss: 0.01867:  15%|█▍        | 30/201 [00:26<02:28,  1.15it/s]Loss: 0.01867:  15%|█▌        | 31/201 [00:27<02:27,  1.15it/s]Loss: 0.01841:  15%|█▌        | 31/201 [00:27<02:27,  1.15it/s]Loss: 0.01841:  16%|█▌        | 32/201 [00:28<02:26,  1.15it/s]Loss: 0.01788:  16%|█▌        | 32/201 [00:28<02:26,  1.15it/s]Loss: 0.01788:  16%|█▋        | 33/201 [00:29<02:25,  1.15it/s]Loss: 0.01750:  16%|█▋        | 33/201 [00:29<02:25,  1.15it/s]Loss: 0.01750:  17%|█▋        | 34/201 [00:30<02:24,  1.15it/s]Loss: 0.01731:  17%|█▋        | 34/201 [00:30<02:24,  1.15it/s]Loss: 0.01731:  17%|█▋        | 35/201 [00:31<02:24,  1.15it/s]Loss: 0.01687:  17%|█▋        | 35/201 [00:31<02:24,  1.15it/s]Loss: 0.01687:  18%|█▊        | 36/201 [00:32<02:23,  1.15it/s]Loss: 0.01721:  18%|█▊        | 36/201 [00:32<02:23,  1.15it/s]Loss: 0.01721:  18%|█▊        | 37/201 [00:32<02:22,  1.15it/s]Loss: 0.01751:  18%|█▊        | 37/201 [00:32<02:22,  1.15it/s]Loss: 0.01751:  19%|█▉        | 38/201 [00:33<02:21,  1.15it/s]Loss: 0.01718:  19%|█▉        | 38/201 [00:33<02:21,  1.15it/s]Loss: 0.01718:  19%|█▉        | 39/201 [00:34<02:20,  1.15it/s]Loss: 0.01658:  19%|█▉        | 39/201 [00:34<02:20,  1.15it/s]Loss: 0.01658:  20%|█▉        | 40/201 [00:35<02:19,  1.15it/s]Loss: 0.01628:  20%|█▉        | 40/201 [00:35<02:19,  1.15it/s]Loss: 0.01628:  20%|██        | 41/201 [00:36<02:20,  1.14it/s]Loss: 0.01657:  20%|██        | 41/201 [00:36<02:20,  1.14it/s]Loss: 0.01657:  21%|██        | 42/201 [00:37<02:18,  1.15it/s]Loss: 0.01617:  21%|██        | 42/201 [00:37<02:18,  1.15it/s]Loss: 0.01617:  21%|██▏       | 43/201 [00:38<02:17,  1.15it/s]Loss: 0.01608:  21%|██▏       | 43/201 [00:38<02:17,  1.15it/s]Loss: 0.01608:  22%|██▏       | 44/201 [00:38<02:16,  1.15it/s]Loss: 0.01562:  22%|██▏       | 44/201 [00:38<02:16,  1.15it/s]Loss: 0.01562:  22%|██▏       | 45/201 [00:39<02:15,  1.15it/s]Loss: 0.01573:  22%|██▏       | 45/201 [00:39<02:15,  1.15it/s]Loss: 0.01573:  23%|██▎       | 46/201 [00:40<02:14,  1.15it/s]Loss: 0.01570:  23%|██▎       | 46/201 [00:40<02:14,  1.15it/s]Loss: 0.01570:  23%|██▎       | 47/201 [00:41<02:13,  1.15it/s]Loss: 0.01559:  23%|██▎       | 47/201 [00:41<02:13,  1.15it/s]Loss: 0.01559:  24%|██▍       | 48/201 [00:42<02:12,  1.15it/s]Loss: 0.01510:  24%|██▍       | 48/201 [00:42<02:12,  1.15it/s]Loss: 0.01510:  24%|██▍       | 49/201 [00:43<02:12,  1.15it/s]Loss: 0.01615:  24%|██▍       | 49/201 [00:43<02:12,  1.15it/s]Loss: 0.01615:  25%|██▍       | 50/201 [00:44<02:11,  1.15it/s]Loss: 0.01586:  25%|██▍       | 50/201 [00:44<02:11,  1.15it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.55s/it][A1it [00:01,  1.55s/it]
Loss: 0.01586:  25%|██▌       | 51/201 [00:46<03:20,  1.34s/it]Loss: 0.09033:  25%|██▌       | 51/201 [00:46<03:20,  1.34s/it]Loss: 0.09033:  26%|██▌       | 52/201 [00:47<02:58,  1.20s/it]Loss: 0.03832:  26%|██▌       | 52/201 [00:47<02:58,  1.20s/it]Loss: 0.03832:  26%|██▋       | 53/201 [00:48<02:42,  1.10s/it]Loss: 0.01925:  26%|██▋       | 53/201 [00:48<02:42,  1.10s/it]Loss: 0.01925:  27%|██▋       | 54/201 [00:49<02:31,  1.03s/it]Loss: 0.01334:  27%|██▋       | 54/201 [00:49<02:31,  1.03s/it]Loss: 0.01334:  27%|██▋       | 55/201 [00:50<02:23,  1.02it/s]Loss: 0.01180:  27%|██▋       | 55/201 [00:50<02:23,  1.02it/s]Loss: 0.01180:  28%|██▊       | 56/201 [00:50<02:17,  1.05it/s]Loss: 0.01075:  28%|██▊       | 56/201 [00:50<02:17,  1.05it/s]Loss: 0.01075:  28%|██▊       | 57/201 [00:51<02:13,  1.08it/s]Loss: 0.01012:  28%|██▊       | 57/201 [00:51<02:13,  1.08it/s]Loss: 0.01012:  29%|██▉       | 58/201 [00:52<02:10,  1.10it/s]Loss: 0.00970:  29%|██▉       | 58/201 [00:52<02:10,  1.10it/s]Loss: 0.00970:  29%|██▉       | 59/201 [00:53<02:07,  1.11it/s]Loss: 0.00932:  29%|██▉       | 59/201 [00:53<02:07,  1.11it/s]Loss: 0.00932:  30%|██▉       | 60/201 [00:54<02:05,  1.13it/s]Loss: 0.00900:  30%|██▉       | 60/201 [00:54<02:05,  1.13it/s]Loss: 0.00900:  30%|███       | 61/201 [00:55<02:04,  1.12it/s]Loss: 0.00895:  30%|███       | 61/201 [00:55<02:04,  1.12it/s]Loss: 0.00895:  31%|███       | 62/201 [00:56<02:02,  1.14it/s]Loss: 0.01036:  31%|███       | 62/201 [00:56<02:02,  1.14it/s]Loss: 0.01036:  31%|███▏      | 63/201 [00:57<02:00,  1.14it/s]Loss: 0.01008:  31%|███▏      | 63/201 [00:57<02:00,  1.14it/s]Loss: 0.01008:  32%|███▏      | 64/201 [00:57<01:59,  1.15it/s]Loss: 0.01024:  32%|███▏      | 64/201 [00:57<01:59,  1.15it/s]Loss: 0.01024:  32%|███▏      | 65/201 [00:58<01:58,  1.15it/s]Loss: 0.00939:  32%|███▏      | 65/201 [00:58<01:58,  1.15it/s]Loss: 0.00939:  33%|███▎      | 66/201 [00:59<01:57,  1.15it/s]Loss: 0.00876:  33%|███▎      | 66/201 [00:59<01:57,  1.15it/s]Loss: 0.00876:  33%|███▎      | 67/201 [01:00<01:56,  1.15it/s]Loss: 0.00852:  33%|███▎      | 67/201 [01:00<01:56,  1.15it/s]Loss: 0.00852:  34%|███▍      | 68/201 [01:01<01:55,  1.15it/s]Loss: 0.00816:  34%|███▍      | 68/201 [01:01<01:55,  1.15it/s]Loss: 0.00816:  34%|███▍      | 69/201 [01:02<01:54,  1.15it/s]Loss: 0.00750:  34%|███▍      | 69/201 [01:02<01:54,  1.15it/s]Loss: 0.00750:  35%|███▍      | 70/201 [01:03<01:53,  1.15it/s]Loss: 0.00743:  35%|███▍      | 70/201 [01:03<01:53,  1.15it/s]Loss: 0.00743:  35%|███▌      | 71/201 [01:03<01:52,  1.15it/s]Loss: 0.00780:  35%|███▌      | 71/201 [01:03<01:52,  1.15it/s]Loss: 0.00780:  36%|███▌      | 72/201 [01:04<01:52,  1.15it/s]Loss: 0.00725:  36%|███▌      | 72/201 [01:04<01:52,  1.15it/s]Loss: 0.00725:  36%|███▋      | 73/201 [01:05<01:51,  1.15it/s]Loss: 0.00716:  36%|███▋      | 73/201 [01:05<01:51,  1.15it/s]Loss: 0.00716:  37%|███▋      | 74/201 [01:06<01:50,  1.15it/s]Loss: 0.00790:  37%|███▋      | 74/201 [01:06<01:50,  1.15it/s]Loss: 0.00790:  37%|███▋      | 75/201 [01:07<01:49,  1.15it/s]Loss: 0.00783:  37%|███▋      | 75/201 [01:07<01:49,  1.15it/s]Loss: 0.00783:  38%|███▊      | 76/201 [01:08<01:48,  1.15it/s]Loss: 0.00785:  38%|███▊      | 76/201 [01:08<01:48,  1.15it/s]Loss: 0.00785:  38%|███▊      | 77/201 [01:09<01:48,  1.15it/s]Loss: 0.00760:  38%|███▊      | 77/201 [01:09<01:48,  1.15it/s]Loss: 0.00760:  39%|███▉      | 78/201 [01:10<01:47,  1.15it/s]Loss: 0.00744:  39%|███▉      | 78/201 [01:10<01:47,  1.15it/s]Loss: 0.00744:  39%|███▉      | 79/201 [01:10<01:46,  1.15it/s]Loss: 0.00734:  39%|███▉      | 79/201 [01:10<01:46,  1.15it/s]Loss: 0.00734:  40%|███▉      | 80/201 [01:11<01:45,  1.15it/s]Loss: 0.00728:  40%|███▉      | 80/201 [01:11<01:45,  1.15it/s]Loss: 0.00728:  40%|████      | 81/201 [01:12<01:45,  1.14it/s]Loss: 0.00721:  40%|████      | 81/201 [01:12<01:45,  1.14it/s]Loss: 0.00721:  41%|████      | 82/201 [01:13<01:44,  1.14it/s]Loss: 0.00705:  41%|████      | 82/201 [01:13<01:44,  1.14it/s]Loss: 0.00705:  41%|████▏     | 83/201 [01:14<01:43,  1.14it/s]Loss: 0.00684:  41%|████▏     | 83/201 [01:14<01:43,  1.14it/s]Loss: 0.00684:  42%|████▏     | 84/201 [01:15<01:42,  1.15it/s]Loss: 0.00655:  42%|████▏     | 84/201 [01:15<01:42,  1.15it/s]Loss: 0.00655:  42%|████▏     | 85/201 [01:16<01:41,  1.15it/s]Loss: 0.00664:  42%|████▏     | 85/201 [01:16<01:41,  1.15it/s]Loss: 0.00664:  43%|████▎     | 86/201 [01:17<01:40,  1.15it/s]Loss: 0.00701:  43%|████▎     | 86/201 [01:17<01:40,  1.15it/s]Loss: 0.00701:  43%|████▎     | 87/201 [01:17<01:39,  1.15it/s]Loss: 0.00682:  43%|████▎     | 87/201 [01:17<01:39,  1.15it/s]Loss: 0.00682:  44%|████▍     | 88/201 [01:18<01:38,  1.15it/s]Loss: 0.00675:  44%|████▍     | 88/201 [01:18<01:38,  1.15it/s]Loss: 0.00675:  44%|████▍     | 89/201 [01:19<01:37,  1.15it/s]Loss: 0.00673:  44%|████▍     | 89/201 [01:19<01:37,  1.15it/s]Loss: 0.00673:  45%|████▍     | 90/201 [01:20<01:36,  1.15it/s]Loss: 0.00671:  45%|████▍     | 90/201 [01:20<01:36,  1.15it/s]Loss: 0.00671:  45%|████▌     | 91/201 [01:21<01:35,  1.15it/s]Loss: 0.00669:  45%|████▌     | 91/201 [01:21<01:35,  1.15it/s]Loss: 0.00669:  46%|████▌     | 92/201 [01:22<01:34,  1.15it/s]Loss: 0.00665:  46%|████▌     | 92/201 [01:22<01:34,  1.15it/s]Loss: 0.00665:  46%|████▋     | 93/201 [01:23<01:34,  1.15it/s]Loss: 0.00673:  46%|████▋     | 93/201 [01:23<01:34,  1.15it/s]Loss: 0.00673:  47%|████▋     | 94/201 [01:24<01:33,  1.15it/s]Loss: 0.00651:  47%|████▋     | 94/201 [01:24<01:33,  1.15it/s]Loss: 0.00651:  47%|████▋     | 95/201 [01:24<01:32,  1.15it/s]Loss: 0.00669:  47%|████▋     | 95/201 [01:24<01:32,  1.15it/s]Loss: 0.00669:  48%|████▊     | 96/201 [01:25<01:31,  1.15it/s]Loss: 0.00680:  48%|████▊     | 96/201 [01:25<01:31,  1.15it/s]Loss: 0.00680:  48%|████▊     | 97/201 [01:26<01:30,  1.15it/s]Loss: 0.00660:  48%|████▊     | 97/201 [01:26<01:30,  1.15it/s]Loss: 0.00660:  49%|████▉     | 98/201 [01:27<01:29,  1.15it/s]Loss: 0.00651:  49%|████▉     | 98/201 [01:27<01:29,  1.15it/s]Loss: 0.00651:  49%|████▉     | 99/201 [01:28<01:28,  1.15it/s]Loss: 0.00652:  49%|████▉     | 99/201 [01:28<01:28,  1.15it/s]Loss: 0.00652:  50%|████▉     | 100/201 [01:29<01:27,  1.15it/s]Loss: 0.00651:  50%|████▉     | 100/201 [01:29<01:27,  1.15it/s]Loss: 0.00651:  50%|█████     | 101/201 [01:30<01:27,  1.14it/s]Loss: 0.00584:  50%|█████     | 101/201 [01:30<01:27,  1.14it/s]max loss: 0.5332052707672119
Densities: min=0.0, max=0.9999546408653259, mean=0.08792021125555038
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.63s/it][A1it [00:01,  1.63s/it]
Loss: 0.00584:  51%|█████     | 102/201 [01:32<02:15,  1.37s/it]Loss: 0.00930:  51%|█████     | 102/201 [01:32<02:15,  1.37s/it]Loss: 0.00930:  51%|█████     | 103/201 [01:33<01:59,  1.22s/it]Loss: 0.00901:  51%|█████     | 103/201 [01:33<01:59,  1.22s/it]Loss: 0.00901:  52%|█████▏    | 104/201 [01:34<01:47,  1.11s/it]Loss: 0.00891:  52%|█████▏    | 104/201 [01:34<01:47,  1.11s/it]Loss: 0.00891:  52%|█████▏    | 105/201 [01:35<01:39,  1.04s/it]Loss: 0.00885:  52%|█████▏    | 105/201 [01:35<01:39,  1.04s/it]Loss: 0.00885:  53%|█████▎    | 106/201 [01:36<01:33,  1.01it/s]Loss: 0.00882:  53%|█████▎    | 106/201 [01:36<01:33,  1.01it/s]Loss: 0.00882:  53%|█████▎    | 107/201 [01:37<01:29,  1.05it/s]Loss: 0.00877:  53%|█████▎    | 107/201 [01:37<01:29,  1.05it/s]Loss: 0.00877:  54%|█████▎    | 108/201 [01:37<01:26,  1.08it/s]Loss: 0.00871:  54%|█████▎    | 108/201 [01:37<01:26,  1.08it/s]Loss: 0.00871:  54%|█████▍    | 109/201 [01:38<01:23,  1.10it/s]Loss: 0.00870:  54%|█████▍    | 109/201 [01:38<01:23,  1.10it/s]Loss: 0.00870:  55%|█████▍    | 110/201 [01:39<01:21,  1.11it/s]Loss: 0.00868:  55%|█████▍    | 110/201 [01:39<01:21,  1.11it/s]Loss: 0.00868:  55%|█████▌    | 111/201 [01:40<01:20,  1.12it/s]Loss: 0.00866:  55%|█████▌    | 111/201 [01:40<01:20,  1.12it/s]Loss: 0.00866:  56%|█████▌    | 112/201 [01:41<01:18,  1.13it/s]Loss: 0.00862:  56%|█████▌    | 112/201 [01:41<01:18,  1.13it/s]Loss: 0.00862:  56%|█████▌    | 113/201 [01:42<01:17,  1.14it/s]Loss: 0.00858:  56%|█████▌    | 113/201 [01:42<01:17,  1.14it/s]Loss: 0.00858:  57%|█████▋    | 114/201 [01:43<01:16,  1.14it/s]Loss: 0.00856:  57%|█████▋    | 114/201 [01:43<01:16,  1.14it/s]Loss: 0.00856:  57%|█████▋    | 115/201 [01:43<01:15,  1.14it/s]Loss: 0.00850:  57%|█████▋    | 115/201 [01:43<01:15,  1.14it/s]Loss: 0.00850:  58%|█████▊    | 116/201 [01:44<01:14,  1.15it/s]Loss: 0.00846:  58%|█████▊    | 116/201 [01:44<01:14,  1.15it/s]Loss: 0.00846:  58%|█████▊    | 117/201 [01:45<01:13,  1.15it/s]Loss: 0.00843:  58%|█████▊    | 117/201 [01:45<01:13,  1.15it/s]Loss: 0.00843:  59%|█████▊    | 118/201 [01:46<01:12,  1.15it/s]Loss: 0.00853:  59%|█████▊    | 118/201 [01:46<01:12,  1.15it/s]Loss: 0.00853:  59%|█████▉    | 119/201 [01:47<01:11,  1.15it/s]Loss: 0.00841:  59%|█████▉    | 119/201 [01:47<01:11,  1.15it/s]Loss: 0.00841:  60%|█████▉    | 120/201 [01:48<01:10,  1.15it/s]Loss: 0.00843:  60%|█████▉    | 120/201 [01:48<01:10,  1.15it/s]Loss: 0.00843:  60%|██████    | 121/201 [01:49<01:10,  1.14it/s]Loss: 0.00834:  60%|██████    | 121/201 [01:49<01:10,  1.14it/s]Loss: 0.00834:  61%|██████    | 122/201 [01:50<01:09,  1.14it/s]Loss: 0.00842:  61%|██████    | 122/201 [01:50<01:09,  1.14it/s]Loss: 0.00842:  61%|██████    | 123/201 [01:50<01:08,  1.15it/s]Loss: 0.00833:  61%|██████    | 123/201 [01:50<01:08,  1.15it/s]Loss: 0.00833:  62%|██████▏   | 124/201 [01:51<01:07,  1.15it/s]Loss: 0.00833:  62%|██████▏   | 124/201 [01:51<01:07,  1.15it/s]Loss: 0.00833:  62%|██████▏   | 125/201 [01:52<01:06,  1.15it/s]Loss: 0.00834:  62%|██████▏   | 125/201 [01:52<01:06,  1.15it/s]Loss: 0.00834:  63%|██████▎   | 126/201 [01:53<01:05,  1.15it/s]Loss: 0.00832:  63%|██████▎   | 126/201 [01:53<01:05,  1.15it/s]Loss: 0.00832:  63%|██████▎   | 127/201 [01:54<01:04,  1.15it/s]Loss: 0.00832:  63%|██████▎   | 127/201 [01:54<01:04,  1.15it/s]Loss: 0.00832:  64%|██████▎   | 128/201 [01:55<01:03,  1.15it/s]Loss: 0.00833:  64%|██████▎   | 128/201 [01:55<01:03,  1.15it/s]Loss: 0.00833:  64%|██████▍   | 129/201 [01:56<01:02,  1.15it/s]Loss: 0.00825:  64%|██████▍   | 129/201 [01:56<01:02,  1.15it/s]Loss: 0.00825:  65%|██████▍   | 130/201 [01:57<01:01,  1.15it/s]Loss: 0.00827:  65%|██████▍   | 130/201 [01:57<01:01,  1.15it/s]Loss: 0.00827:  65%|██████▌   | 131/201 [01:57<01:00,  1.15it/s]Loss: 0.00819:  65%|██████▌   | 131/201 [01:57<01:00,  1.15it/s]Loss: 0.00819:  66%|██████▌   | 132/201 [01:58<00:59,  1.15it/s]Loss: 0.00813:  66%|██████▌   | 132/201 [01:58<00:59,  1.15it/s]Loss: 0.00813:  66%|██████▌   | 133/201 [01:59<00:59,  1.15it/s]Loss: 0.00822:  66%|██████▌   | 133/201 [01:59<00:59,  1.15it/s]Loss: 0.00822:  67%|██████▋   | 134/201 [02:00<00:58,  1.15it/s]Loss: 0.00817:  67%|██████▋   | 134/201 [02:00<00:58,  1.15it/s]Loss: 0.00817:  67%|██████▋   | 135/201 [02:01<00:57,  1.15it/s]Loss: 0.00819:  67%|██████▋   | 135/201 [02:01<00:57,  1.15it/s]Loss: 0.00819:  68%|██████▊   | 136/201 [02:02<00:56,  1.15it/s]Loss: 0.00819:  68%|██████▊   | 136/201 [02:02<00:56,  1.15it/s]Loss: 0.00819:  68%|██████▊   | 137/201 [02:03<00:55,  1.15it/s]Loss: 0.00809:  68%|██████▊   | 137/201 [02:03<00:55,  1.15it/s]Loss: 0.00809:  69%|██████▊   | 138/201 [02:03<00:54,  1.15it/s]Loss: 0.00808:  69%|██████▊   | 138/201 [02:03<00:54,  1.15it/s]Loss: 0.00808:  69%|██████▉   | 139/201 [02:04<00:53,  1.15it/s]Loss: 0.00811:  69%|██████▉   | 139/201 [02:04<00:53,  1.15it/s]Loss: 0.00811:  70%|██████▉   | 140/201 [02:05<00:53,  1.15it/s]Loss: 0.00810:  70%|██████▉   | 140/201 [02:05<00:53,  1.15it/s]Loss: 0.00810:  70%|███████   | 141/201 [02:06<00:52,  1.14it/s]Loss: 0.00808:  70%|███████   | 141/201 [02:06<00:52,  1.14it/s]Loss: 0.00808:  71%|███████   | 142/201 [02:07<00:51,  1.14it/s]Loss: 0.00806:  71%|███████   | 142/201 [02:07<00:51,  1.14it/s]Loss: 0.00806:  71%|███████   | 143/201 [02:08<00:50,  1.15it/s]Loss: 0.00811:  71%|███████   | 143/201 [02:08<00:50,  1.15it/s]Loss: 0.00811:  72%|███████▏  | 144/201 [02:09<00:49,  1.15it/s]Loss: 0.00810:  72%|███████▏  | 144/201 [02:09<00:49,  1.15it/s]Loss: 0.00810:  72%|███████▏  | 145/201 [02:10<00:48,  1.15it/s]Loss: 0.00802:  72%|███████▏  | 145/201 [02:10<00:48,  1.15it/s]Loss: 0.00802:  73%|███████▎  | 146/201 [02:10<00:47,  1.15it/s]Loss: 0.00809:  73%|███████▎  | 146/201 [02:10<00:47,  1.15it/s]Loss: 0.00809:  73%|███████▎  | 147/201 [02:11<00:46,  1.15it/s]Loss: 0.00800:  73%|███████▎  | 147/201 [02:11<00:46,  1.15it/s]Loss: 0.00800:  74%|███████▎  | 148/201 [02:12<00:46,  1.15it/s]Loss: 0.00799:  74%|███████▎  | 148/201 [02:12<00:46,  1.15it/s]Loss: 0.00799:  74%|███████▍  | 149/201 [02:13<00:45,  1.15it/s]Loss: 0.00797:  74%|███████▍  | 149/201 [02:13<00:45,  1.15it/s]Loss: 0.00797:  75%|███████▍  | 150/201 [02:14<00:44,  1.15it/s]Loss: 0.00801:  75%|███████▍  | 150/201 [02:14<00:44,  1.15it/s]Loss: 0.00801:  75%|███████▌  | 151/201 [02:15<00:43,  1.15it/s]Loss: 0.00795:  75%|███████▌  | 151/201 [02:15<00:43,  1.15it/s]Loss: 0.00795:  76%|███████▌  | 152/201 [02:16<00:42,  1.15it/s]Loss: 0.00803:  76%|███████▌  | 152/201 [02:16<00:42,  1.15it/s]max loss: 0.21905964612960815
Densities: min=0.0, max=0.9999451041221619, mean=0.14794494211673737
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.62s/it][A1it [00:01,  1.62s/it]
Loss: 0.00803:  76%|███████▌  | 153/201 [02:18<01:05,  1.36s/it]Loss: 0.00953:  76%|███████▌  | 153/201 [02:18<01:05,  1.36s/it]Loss: 0.00953:  77%|███████▋  | 154/201 [02:19<00:56,  1.21s/it]Loss: 0.00938:  77%|███████▋  | 154/201 [02:19<00:56,  1.21s/it]Loss: 0.00938:  77%|███████▋  | 155/201 [02:20<00:50,  1.11s/it]Loss: 0.00917:  77%|███████▋  | 155/201 [02:20<00:50,  1.11s/it]Loss: 0.00917:  78%|███████▊  | 156/201 [02:21<00:46,  1.04s/it]Loss: 0.00924:  78%|███████▊  | 156/201 [02:21<00:46,  1.04s/it]Loss: 0.00924:  78%|███████▊  | 157/201 [02:22<00:43,  1.01it/s]Loss: 0.00904:  78%|███████▊  | 157/201 [02:22<00:43,  1.01it/s]Loss: 0.00904:  79%|███████▊  | 158/201 [02:23<00:40,  1.05it/s]Loss: 0.00901:  79%|███████▊  | 158/201 [02:23<00:40,  1.05it/s]Loss: 0.00901:  79%|███████▉  | 159/201 [02:23<00:38,  1.08it/s]Loss: 0.00907:  79%|███████▉  | 159/201 [02:23<00:38,  1.08it/s]Loss: 0.00907:  80%|███████▉  | 160/201 [02:24<00:37,  1.10it/s]Loss: 0.00906:  80%|███████▉  | 160/201 [02:24<00:37,  1.10it/s]Loss: 0.00906:  80%|████████  | 161/201 [02:25<00:36,  1.10it/s]Loss: 0.00898:  80%|████████  | 161/201 [02:25<00:36,  1.10it/s]Loss: 0.00898:  81%|████████  | 162/201 [02:26<00:34,  1.12it/s]Loss: 0.00896:  81%|████████  | 162/201 [02:26<00:34,  1.12it/s]Loss: 0.00896:  81%|████████  | 163/201 [02:27<00:33,  1.13it/s]Loss: 0.00893:  81%|████████  | 163/201 [02:27<00:33,  1.13it/s]Loss: 0.00893:  82%|████████▏ | 164/201 [02:28<00:32,  1.14it/s]Loss: 0.00887:  82%|████████▏ | 164/201 [02:28<00:32,  1.14it/s]Loss: 0.00887:  82%|████████▏ | 165/201 [02:29<00:31,  1.14it/s]Loss: 0.00885:  82%|████████▏ | 165/201 [02:29<00:31,  1.14it/s]Loss: 0.00885:  83%|████████▎ | 166/201 [02:29<00:30,  1.14it/s]Loss: 0.00876:  83%|████████▎ | 166/201 [02:29<00:30,  1.14it/s]Loss: 0.00876:  83%|████████▎ | 167/201 [02:30<00:29,  1.15it/s]Loss: 0.00880:  83%|████████▎ | 167/201 [02:30<00:29,  1.15it/s]Loss: 0.00880:  84%|████████▎ | 168/201 [02:31<00:28,  1.15it/s]Loss: 0.00873:  84%|████████▎ | 168/201 [02:31<00:28,  1.15it/s]Loss: 0.00873:  84%|████████▍ | 169/201 [02:32<00:27,  1.15it/s]Loss: 0.00880:  84%|████████▍ | 169/201 [02:32<00:27,  1.15it/s]Loss: 0.00880:  85%|████████▍ | 170/201 [02:33<00:26,  1.15it/s]Loss: 0.00875:  85%|████████▍ | 170/201 [02:33<00:26,  1.15it/s]Loss: 0.00875:  85%|████████▌ | 171/201 [02:34<00:26,  1.15it/s]Loss: 0.00891:  85%|████████▌ | 171/201 [02:34<00:26,  1.15it/s]Loss: 0.00891:  86%|████████▌ | 172/201 [02:35<00:25,  1.15it/s]Loss: 0.00893:  86%|████████▌ | 172/201 [02:35<00:25,  1.15it/s]Loss: 0.00893:  86%|████████▌ | 173/201 [02:36<00:24,  1.15it/s]Loss: 0.00878:  86%|████████▌ | 173/201 [02:36<00:24,  1.15it/s]Loss: 0.00878:  87%|████████▋ | 174/201 [02:36<00:23,  1.15it/s]Loss: 0.00870:  87%|████████▋ | 174/201 [02:36<00:23,  1.15it/s]Loss: 0.00870:  87%|████████▋ | 175/201 [02:37<00:22,  1.15it/s]Loss: 0.00872:  87%|████████▋ | 175/201 [02:37<00:22,  1.15it/s]Loss: 0.00872:  88%|████████▊ | 176/201 [02:38<00:21,  1.15it/s]Loss: 0.00868:  88%|████████▊ | 176/201 [02:38<00:21,  1.15it/s]Loss: 0.00868:  88%|████████▊ | 177/201 [02:39<00:20,  1.15it/s]Loss: 0.00870:  88%|████████▊ | 177/201 [02:39<00:20,  1.15it/s]Loss: 0.00870:  89%|████████▊ | 178/201 [02:40<00:19,  1.15it/s]Loss: 0.00867:  89%|████████▊ | 178/201 [02:40<00:19,  1.15it/s]Loss: 0.00867:  89%|████████▉ | 179/201 [02:41<00:19,  1.15it/s]Loss: 0.00862:  89%|████████▉ | 179/201 [02:41<00:19,  1.15it/s]Loss: 0.00862:  90%|████████▉ | 180/201 [02:42<00:18,  1.15it/s]Loss: 0.00876:  90%|████████▉ | 180/201 [02:42<00:18,  1.15it/s]Loss: 0.00876:  90%|█████████ | 181/201 [02:43<00:17,  1.14it/s]Loss: 0.00874:  90%|█████████ | 181/201 [02:43<00:17,  1.14it/s]Loss: 0.00874:  91%|█████████ | 182/201 [02:43<00:16,  1.15it/s]Loss: 0.00870:  91%|█████████ | 182/201 [02:43<00:16,  1.15it/s]Loss: 0.00870:  91%|█████████ | 183/201 [02:44<00:15,  1.15it/s]Loss: 0.00863:  91%|█████████ | 183/201 [02:44<00:15,  1.15it/s]Loss: 0.00863:  92%|█████████▏| 184/201 [02:45<00:14,  1.15it/s]Loss: 0.00854:  92%|█████████▏| 184/201 [02:45<00:14,  1.15it/s]Loss: 0.00854:  92%|█████████▏| 185/201 [02:46<00:13,  1.15it/s]Loss: 0.00854:  92%|█████████▏| 185/201 [02:46<00:13,  1.15it/s]Loss: 0.00854:  93%|█████████▎| 186/201 [02:47<00:13,  1.15it/s]Loss: 0.00847:  93%|█████████▎| 186/201 [02:47<00:13,  1.15it/s]Loss: 0.00847:  93%|█████████▎| 187/201 [02:48<00:12,  1.15it/s]Loss: 0.00851:  93%|█████████▎| 187/201 [02:48<00:12,  1.15it/s]Loss: 0.00851:  94%|█████████▎| 188/201 [02:49<00:11,  1.15it/s]Loss: 0.00851:  94%|█████████▎| 188/201 [02:49<00:11,  1.15it/s]Loss: 0.00851:  94%|█████████▍| 189/201 [02:49<00:10,  1.15it/s]Loss: 0.00845:  94%|█████████▍| 189/201 [02:49<00:10,  1.15it/s]Loss: 0.00845:  95%|█████████▍| 190/201 [02:50<00:09,  1.15it/s]Loss: 0.00849:  95%|█████████▍| 190/201 [02:50<00:09,  1.15it/s]Loss: 0.00849:  95%|█████████▌| 191/201 [02:51<00:08,  1.15it/s]Loss: 0.00848:  95%|█████████▌| 191/201 [02:51<00:08,  1.15it/s]Loss: 0.00848:  96%|█████████▌| 192/201 [02:52<00:07,  1.15it/s]Loss: 0.00851:  96%|█████████▌| 192/201 [02:52<00:07,  1.15it/s]Loss: 0.00851:  96%|█████████▌| 193/201 [02:53<00:06,  1.15it/s]Loss: 0.00846:  96%|█████████▌| 193/201 [02:53<00:06,  1.15it/s]Loss: 0.00846:  97%|█████████▋| 194/201 [02:54<00:06,  1.15it/s]Loss: 0.00853:  97%|█████████▋| 194/201 [02:54<00:06,  1.15it/s]Loss: 0.00853:  97%|█████████▋| 195/201 [02:55<00:05,  1.15it/s]Loss: 0.00859:  97%|█████████▋| 195/201 [02:55<00:05,  1.15it/s]Loss: 0.00859:  98%|█████████▊| 196/201 [02:56<00:04,  1.15it/s]Loss: 0.00851:  98%|█████████▊| 196/201 [02:56<00:04,  1.15it/s]Loss: 0.00851:  98%|█████████▊| 197/201 [02:56<00:03,  1.15it/s]Loss: 0.00849:  98%|█████████▊| 197/201 [02:56<00:03,  1.15it/s]Loss: 0.00849:  99%|█████████▊| 198/201 [02:57<00:02,  1.15it/s]Loss: 0.00858:  99%|█████████▊| 198/201 [02:57<00:02,  1.15it/s]Loss: 0.00858:  99%|█████████▉| 199/201 [02:58<00:01,  1.15it/s]Loss: 0.00844:  99%|█████████▉| 199/201 [02:58<00:01,  1.15it/s]Loss: 0.00844: 100%|█████████▉| 200/201 [02:59<00:00,  1.15it/s]Loss: 0.00848: 100%|█████████▉| 200/201 [02:59<00:00,  1.15it/s]Loss: 0.00848: 100%|██████████| 201/201 [03:00<00:00,  1.14it/s]Loss: 0.00801: 100%|██████████| 201/201 [03:00<00:00,  1.14it/s]Loss: 0.00801: 100%|██████████| 201/201 [03:00<00:00,  1.11it/s]Load volume "/media/storage0/qadwu/floats/mechhand_640x220x229_float32_raw_640x220x229_float.cvol"
Loaded

max loss: 0.15871195495128632
Densities: min=0.0, max=0.9998326301574707, mean=0.1682886779308319
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 180.43727827072144 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json
Latent space memory: 13.2MiB
Latent space memory: 13.2MiB
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/mechhand_640x220x229_float32_raw_640x220x229_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 17, 'n_features_per_level': 8, 'n_levels': 7, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 4, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 3462656
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.04it/s]1it [00:00,  3.04it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=0.999988317489624, mean=0.39815032482147217
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.47it/s]Render: : 1it [00:00,  2.47it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [640, 220, 229], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/mechhand-20220926010852-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 7, 'n_features_per_level': 8, 'log2_hashmap_size': 17, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 4}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<00:58,  3.41it/s]Loss: 0.15889:   0%|          | 1/201 [00:00<00:58,  3.41it/s]Loss: 0.15889:   1%|          | 2/201 [00:00<00:53,  3.75it/s]Loss: 0.05668:   1%|          | 2/201 [00:00<00:53,  3.75it/s]Loss: 0.05668:   1%|▏         | 3/201 [00:00<00:51,  3.87it/s]Loss: 0.04248:   1%|▏         | 3/201 [00:00<00:51,  3.87it/s]Loss: 0.04248:   2%|▏         | 4/201 [00:01<00:50,  3.93it/s]Loss: 0.03487:   2%|▏         | 4/201 [00:01<00:50,  3.93it/s]Loss: 0.03487:   2%|▏         | 5/201 [00:01<00:49,  3.96it/s]Loss: 0.02945:   2%|▏         | 5/201 [00:01<00:49,  3.96it/s]Loss: 0.02945:   3%|▎         | 6/201 [00:01<00:48,  3.98it/s]Loss: 0.02591:   3%|▎         | 6/201 [00:01<00:48,  3.98it/s]Loss: 0.02591:   3%|▎         | 7/201 [00:01<00:48,  4.00it/s]Loss: 0.02514:   3%|▎         | 7/201 [00:01<00:48,  4.00it/s]Loss: 0.02514:   4%|▍         | 8/201 [00:02<00:48,  4.01it/s]Loss: 0.02290:   4%|▍         | 8/201 [00:02<00:48,  4.01it/s]Loss: 0.02290:   4%|▍         | 9/201 [00:02<00:47,  4.01it/s]Loss: 0.02154:   4%|▍         | 9/201 [00:02<00:47,  4.01it/s]Loss: 0.02154:   5%|▍         | 10/201 [00:02<00:47,  4.02it/s]Loss: 0.02084:   5%|▍         | 10/201 [00:02<00:47,  4.02it/s]Loss: 0.02084:   5%|▌         | 11/201 [00:02<00:47,  4.02it/s]Loss: 0.01939:   5%|▌         | 11/201 [00:02<00:47,  4.02it/s]Loss: 0.01939:   6%|▌         | 12/201 [00:03<00:47,  4.02it/s]Loss: 0.01974:   6%|▌         | 12/201 [00:03<00:47,  4.02it/s]Loss: 0.01974:   6%|▋         | 13/201 [00:03<00:46,  4.02it/s]Loss: 0.01870:   6%|▋         | 13/201 [00:03<00:46,  4.02it/s]Loss: 0.01870:   7%|▋         | 14/201 [00:03<00:46,  4.02it/s]Loss: 0.01852:   7%|▋         | 14/201 [00:03<00:46,  4.02it/s]Loss: 0.01852:   7%|▋         | 15/201 [00:03<00:46,  4.02it/s]Loss: 0.01824:   7%|▋         | 15/201 [00:03<00:46,  4.02it/s]Loss: 0.01824:   8%|▊         | 16/201 [00:04<00:45,  4.02it/s]Loss: 0.01731:   8%|▊         | 16/201 [00:04<00:45,  4.02it/s]Loss: 0.01731:   8%|▊         | 17/201 [00:04<00:45,  4.03it/s]Loss: 0.01773:   8%|▊         | 17/201 [00:04<00:45,  4.03it/s]Loss: 0.01773:   9%|▉         | 18/201 [00:04<00:45,  4.03it/s]Loss: 0.01733:   9%|▉         | 18/201 [00:04<00:45,  4.03it/s]Loss: 0.01733:   9%|▉         | 19/201 [00:04<00:45,  4.02it/s]Loss: 0.01695:   9%|▉         | 19/201 [00:04<00:45,  4.02it/s]Loss: 0.01695:  10%|▉         | 20/201 [00:05<00:44,  4.02it/s]Loss: 0.01658:  10%|▉         | 20/201 [00:05<00:44,  4.02it/s]Loss: 0.01658:  10%|█         | 21/201 [00:05<00:46,  3.88it/s]Loss: 0.01721:  10%|█         | 21/201 [00:05<00:46,  3.88it/s]Loss: 0.01721:  11%|█         | 22/201 [00:05<00:45,  3.89it/s]Loss: 0.01620:  11%|█         | 22/201 [00:05<00:45,  3.89it/s]Loss: 0.01620:  11%|█▏        | 23/201 [00:05<00:45,  3.94it/s]Loss: 0.01537:  11%|█▏        | 23/201 [00:05<00:45,  3.94it/s]Loss: 0.01537:  12%|█▏        | 24/201 [00:06<00:44,  3.97it/s]Loss: 0.01640:  12%|█▏        | 24/201 [00:06<00:44,  3.97it/s]Loss: 0.01640:  12%|█▏        | 25/201 [00:06<00:44,  3.99it/s]Loss: 0.01582:  12%|█▏        | 25/201 [00:06<00:44,  3.99it/s]Loss: 0.01582:  13%|█▎        | 26/201 [00:06<00:43,  4.01it/s]Loss: 0.01573:  13%|█▎        | 26/201 [00:06<00:43,  4.01it/s]Loss: 0.01573:  13%|█▎        | 27/201 [00:06<00:43,  4.02it/s]Loss: 0.01465:  13%|█▎        | 27/201 [00:06<00:43,  4.02it/s]Loss: 0.01465:  14%|█▍        | 28/201 [00:07<00:42,  4.03it/s]Loss: 0.01530:  14%|█▍        | 28/201 [00:07<00:42,  4.03it/s]Loss: 0.01530:  14%|█▍        | 29/201 [00:07<00:42,  4.03it/s]Loss: 0.01572:  14%|█▍        | 29/201 [00:07<00:42,  4.03it/s]Loss: 0.01572:  15%|█▍        | 30/201 [00:07<00:42,  4.04it/s]Loss: 0.01507:  15%|█▍        | 30/201 [00:07<00:42,  4.04it/s]Loss: 0.01507:  15%|█▌        | 31/201 [00:07<00:42,  4.04it/s]Loss: 0.01470:  15%|█▌        | 31/201 [00:07<00:42,  4.04it/s]Loss: 0.01470:  16%|█▌        | 32/201 [00:08<00:41,  4.04it/s]Loss: 0.01473:  16%|█▌        | 32/201 [00:08<00:41,  4.04it/s]Loss: 0.01473:  16%|█▋        | 33/201 [00:08<00:41,  4.04it/s]Loss: 0.01481:  16%|█▋        | 33/201 [00:08<00:41,  4.04it/s]Loss: 0.01481:  17%|█▋        | 34/201 [00:08<00:41,  4.04it/s]Loss: 0.01447:  17%|█▋        | 34/201 [00:08<00:41,  4.04it/s]Loss: 0.01447:  17%|█▋        | 35/201 [00:08<00:41,  4.03it/s]Loss: 0.01402:  17%|█▋        | 35/201 [00:08<00:41,  4.03it/s]Loss: 0.01402:  18%|█▊        | 36/201 [00:09<00:40,  4.04it/s]Loss: 0.01387:  18%|█▊        | 36/201 [00:09<00:40,  4.04it/s]Loss: 0.01387:  18%|█▊        | 37/201 [00:09<00:40,  4.04it/s]Loss: 0.01444:  18%|█▊        | 37/201 [00:09<00:40,  4.04it/s]Loss: 0.01444:  19%|█▉        | 38/201 [00:09<00:40,  4.04it/s]Loss: 0.01409:  19%|█▉        | 38/201 [00:09<00:40,  4.04it/s]Loss: 0.01409:  19%|█▉        | 39/201 [00:09<00:40,  4.05it/s]Loss: 0.01406:  19%|█▉        | 39/201 [00:09<00:40,  4.05it/s]Loss: 0.01406:  20%|█▉        | 40/201 [00:09<00:39,  4.05it/s]Loss: 0.01355:  20%|█▉        | 40/201 [00:09<00:39,  4.05it/s]Loss: 0.01355:  20%|██        | 41/201 [00:10<00:40,  3.97it/s]Loss: 0.01340:  20%|██        | 41/201 [00:10<00:40,  3.97it/s]Loss: 0.01340:  21%|██        | 42/201 [00:10<00:39,  3.99it/s]Loss: 0.01333:  21%|██        | 42/201 [00:10<00:39,  3.99it/s]Loss: 0.01333:  21%|██▏       | 43/201 [00:10<00:39,  4.01it/s]Loss: 0.01438:  21%|██▏       | 43/201 [00:10<00:39,  4.01it/s]Loss: 0.01438:  22%|██▏       | 44/201 [00:11<00:39,  4.01it/s]Loss: 0.01332:  22%|██▏       | 44/201 [00:11<00:39,  4.01it/s]Loss: 0.01332:  22%|██▏       | 45/201 [00:11<00:38,  4.02it/s]Loss: 0.01310:  22%|██▏       | 45/201 [00:11<00:38,  4.02it/s]Loss: 0.01310:  23%|██▎       | 46/201 [00:11<00:38,  4.03it/s]Loss: 0.01377:  23%|██▎       | 46/201 [00:11<00:38,  4.03it/s]Loss: 0.01377:  23%|██▎       | 47/201 [00:11<00:38,  4.03it/s]Loss: 0.01301:  23%|██▎       | 47/201 [00:11<00:38,  4.03it/s]Loss: 0.01301:  24%|██▍       | 48/201 [00:12<00:38,  3.98it/s]Loss: 0.01367:  24%|██▍       | 48/201 [00:12<00:38,  3.98it/s]Loss: 0.01367:  24%|██▍       | 49/201 [00:12<00:38,  4.00it/s]Loss: 0.01338:  24%|██▍       | 49/201 [00:12<00:38,  4.00it/s]Loss: 0.01338:  25%|██▍       | 50/201 [00:12<00:37,  4.01it/s]Loss: 0.01344:  25%|██▍       | 50/201 [00:12<00:37,  4.01it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.26s/it][A1it [00:01,  1.26s/it]
Loss: 0.01344:  25%|██▌       | 51/201 [00:14<01:34,  1.59it/s]Loss: 0.00627:  25%|██▌       | 51/201 [00:14<01:34,  1.59it/s]Loss: 0.00627:  26%|██▌       | 52/201 [00:14<01:16,  1.95it/s]Loss: 0.00506:  26%|██▌       | 52/201 [00:14<01:16,  1.95it/s]Loss: 0.00506:  26%|██▋       | 53/201 [00:14<01:04,  2.31it/s]Loss: 0.00460:  26%|██▋       | 53/201 [00:14<01:04,  2.31it/s]Loss: 0.00460:  27%|██▋       | 54/201 [00:14<00:55,  2.66it/s]Loss: 0.00436:  27%|██▋       | 54/201 [00:14<00:55,  2.66it/s]Loss: 0.00436:  27%|██▋       | 55/201 [00:14<00:49,  2.97it/s]Loss: 0.00419:  27%|██▋       | 55/201 [00:14<00:49,  2.97it/s]Loss: 0.00419:  28%|██▊       | 56/201 [00:15<00:44,  3.24it/s]Loss: 0.00406:  28%|██▊       | 56/201 [00:15<00:44,  3.24it/s]Loss: 0.00406:  28%|██▊       | 57/201 [00:15<00:41,  3.46it/s]Loss: 0.00395:  28%|██▊       | 57/201 [00:15<00:41,  3.46it/s]Loss: 0.00395:  29%|██▉       | 58/201 [00:15<00:39,  3.63it/s]Loss: 0.00386:  29%|██▉       | 58/201 [00:15<00:39,  3.63it/s]Loss: 0.00386:  29%|██▉       | 59/201 [00:15<00:37,  3.76it/s]Loss: 0.00379:  29%|██▉       | 59/201 [00:15<00:37,  3.76it/s]Loss: 0.00379:  30%|██▉       | 60/201 [00:16<00:36,  3.85it/s]Loss: 0.00372:  30%|██▉       | 60/201 [00:16<00:36,  3.85it/s]Loss: 0.00372:  30%|███       | 61/201 [00:16<00:36,  3.84it/s]Loss: 0.00366:  30%|███       | 61/201 [00:16<00:36,  3.84it/s]Loss: 0.00366:  31%|███       | 62/201 [00:16<00:35,  3.92it/s]Loss: 0.00361:  31%|███       | 62/201 [00:16<00:35,  3.92it/s]Loss: 0.00361:  31%|███▏      | 63/201 [00:16<00:34,  3.97it/s]Loss: 0.00356:  31%|███▏      | 63/201 [00:16<00:34,  3.97it/s]Loss: 0.00356:  32%|███▏      | 64/201 [00:17<00:34,  4.01it/s]Loss: 0.00351:  32%|███▏      | 64/201 [00:17<00:34,  4.01it/s]Loss: 0.00351:  32%|███▏      | 65/201 [00:17<00:33,  4.04it/s]Loss: 0.00347:  32%|███▏      | 65/201 [00:17<00:33,  4.04it/s]Loss: 0.00347:  33%|███▎      | 66/201 [00:17<00:33,  4.06it/s]Loss: 0.00345:  33%|███▎      | 66/201 [00:17<00:33,  4.06it/s]Loss: 0.00345:  33%|███▎      | 67/201 [00:17<00:32,  4.08it/s]Loss: 0.00342:  33%|███▎      | 67/201 [00:17<00:32,  4.08it/s]Loss: 0.00342:  34%|███▍      | 68/201 [00:18<00:32,  4.09it/s]Loss: 0.00340:  34%|███▍      | 68/201 [00:18<00:32,  4.09it/s]Loss: 0.00340:  34%|███▍      | 69/201 [00:18<00:32,  4.09it/s]Loss: 0.00335:  34%|███▍      | 69/201 [00:18<00:32,  4.09it/s]Loss: 0.00335:  35%|███▍      | 70/201 [00:18<00:31,  4.10it/s]Loss: 0.00334:  35%|███▍      | 70/201 [00:18<00:31,  4.10it/s]Loss: 0.00334:  35%|███▌      | 71/201 [00:18<00:31,  4.10it/s]Loss: 0.00331:  35%|███▌      | 71/201 [00:18<00:31,  4.10it/s]Loss: 0.00331:  36%|███▌      | 72/201 [00:19<00:31,  4.10it/s]Loss: 0.00329:  36%|███▌      | 72/201 [00:19<00:31,  4.10it/s]Loss: 0.00329:  36%|███▋      | 73/201 [00:19<00:31,  4.11it/s]Loss: 0.00327:  36%|███▋      | 73/201 [00:19<00:31,  4.11it/s]Loss: 0.00327:  37%|███▋      | 74/201 [00:19<00:30,  4.11it/s]Loss: 0.00326:  37%|███▋      | 74/201 [00:19<00:30,  4.11it/s]Loss: 0.00326:  37%|███▋      | 75/201 [00:19<00:30,  4.11it/s]Loss: 0.00324:  37%|███▋      | 75/201 [00:19<00:30,  4.11it/s]Loss: 0.00324:  38%|███▊      | 76/201 [00:20<00:30,  4.11it/s]Loss: 0.00321:  38%|███▊      | 76/201 [00:20<00:30,  4.11it/s]Loss: 0.00321:  38%|███▊      | 77/201 [00:20<00:30,  4.11it/s]Loss: 0.00319:  38%|███▊      | 77/201 [00:20<00:30,  4.11it/s]Loss: 0.00319:  39%|███▉      | 78/201 [00:20<00:29,  4.11it/s]Loss: 0.00318:  39%|███▉      | 78/201 [00:20<00:29,  4.11it/s]Loss: 0.00318:  39%|███▉      | 79/201 [00:20<00:29,  4.11it/s]Loss: 0.00319:  39%|███▉      | 79/201 [00:20<00:29,  4.11it/s]Loss: 0.00319:  40%|███▉      | 80/201 [00:21<00:29,  4.11it/s]Loss: 0.00317:  40%|███▉      | 80/201 [00:21<00:29,  4.11it/s]Loss: 0.00317:  40%|████      | 81/201 [00:21<00:29,  4.01it/s]Loss: 0.00314:  40%|████      | 81/201 [00:21<00:29,  4.01it/s]Loss: 0.00314:  41%|████      | 82/201 [00:21<00:29,  4.04it/s]Loss: 0.00313:  41%|████      | 82/201 [00:21<00:29,  4.04it/s]Loss: 0.00313:  41%|████▏     | 83/201 [00:21<00:29,  4.06it/s]Loss: 0.00312:  41%|████▏     | 83/201 [00:21<00:29,  4.06it/s]Loss: 0.00312:  42%|████▏     | 84/201 [00:22<00:28,  4.07it/s]Loss: 0.00312:  42%|████▏     | 84/201 [00:22<00:28,  4.07it/s]Loss: 0.00312:  42%|████▏     | 85/201 [00:22<00:28,  4.09it/s]Loss: 0.00310:  42%|████▏     | 85/201 [00:22<00:28,  4.09it/s]Loss: 0.00310:  43%|████▎     | 86/201 [00:22<00:27,  4.13it/s]Loss: 0.00310:  43%|████▎     | 86/201 [00:22<00:27,  4.13it/s]Loss: 0.00310:  43%|████▎     | 87/201 [00:22<00:27,  4.15it/s]Loss: 0.00309:  43%|████▎     | 87/201 [00:22<00:27,  4.15it/s]Loss: 0.00309:  44%|████▍     | 88/201 [00:23<00:27,  4.13it/s]Loss: 0.00313:  44%|████▍     | 88/201 [00:23<00:27,  4.13it/s]Loss: 0.00313:  44%|████▍     | 89/201 [00:23<00:27,  4.13it/s]Loss: 0.00309:  44%|████▍     | 89/201 [00:23<00:27,  4.13it/s]Loss: 0.00309:  45%|████▍     | 90/201 [00:23<00:26,  4.12it/s]Loss: 0.00306:  45%|████▍     | 90/201 [00:23<00:26,  4.12it/s]Loss: 0.00306:  45%|████▌     | 91/201 [00:23<00:26,  4.12it/s]Loss: 0.00305:  45%|████▌     | 91/201 [00:23<00:26,  4.12it/s]Loss: 0.00305:  46%|████▌     | 92/201 [00:24<00:26,  4.12it/s]Loss: 0.00308:  46%|████▌     | 92/201 [00:24<00:26,  4.12it/s]Loss: 0.00308:  46%|████▋     | 93/201 [00:24<00:26,  4.11it/s]Loss: 0.00302:  46%|████▋     | 93/201 [00:24<00:26,  4.11it/s]Loss: 0.00302:  47%|████▋     | 94/201 [00:24<00:26,  4.11it/s]Loss: 0.00301:  47%|████▋     | 94/201 [00:24<00:26,  4.11it/s]Loss: 0.00301:  47%|████▋     | 95/201 [00:24<00:25,  4.12it/s]Loss: 0.00301:  47%|████▋     | 95/201 [00:24<00:25,  4.12it/s]Loss: 0.00301:  48%|████▊     | 96/201 [00:24<00:25,  4.12it/s]Loss: 0.00305:  48%|████▊     | 96/201 [00:24<00:25,  4.12it/s]Loss: 0.00305:  48%|████▊     | 97/201 [00:25<00:25,  4.12it/s]Loss: 0.00302:  48%|████▊     | 97/201 [00:25<00:25,  4.12it/s]Loss: 0.00302:  49%|████▉     | 98/201 [00:25<00:24,  4.13it/s]Loss: 0.00300:  49%|████▉     | 98/201 [00:25<00:24,  4.13it/s]Loss: 0.00300:  49%|████▉     | 99/201 [00:25<00:24,  4.13it/s]Loss: 0.00304:  49%|████▉     | 99/201 [00:25<00:24,  4.13it/s]Loss: 0.00304:  50%|████▉     | 100/201 [00:25<00:24,  4.13it/s]Loss: 0.00303:  50%|████▉     | 100/201 [00:25<00:24,  4.13it/s]Loss: 0.00303:  50%|█████     | 101/201 [00:26<00:24,  4.02it/s]Loss: 0.00271:  50%|█████     | 101/201 [00:26<00:24,  4.02it/s]max loss: 0.5340796709060669
Densities: min=0.0, max=0.9999869465827942, mean=0.08157794177532196
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.31s/it][A1it [00:01,  1.31s/it]
Loss: 0.00271:  51%|█████     | 102/201 [00:27<01:03,  1.55it/s]Loss: 0.00926:  51%|█████     | 102/201 [00:27<01:03,  1.55it/s]Loss: 0.00926:  51%|█████     | 103/201 [00:28<00:51,  1.91it/s]Loss: 0.00836:  51%|█████     | 103/201 [00:28<00:51,  1.91it/s]Loss: 0.00836:  52%|█████▏    | 104/201 [00:28<00:42,  2.27it/s]Loss: 0.00789:  52%|█████▏    | 104/201 [00:28<00:42,  2.27it/s]Loss: 0.00789:  52%|█████▏    | 105/201 [00:28<00:36,  2.62it/s]Loss: 0.00760:  52%|█████▏    | 105/201 [00:28<00:36,  2.62it/s]Loss: 0.00760:  53%|█████▎    | 106/201 [00:28<00:32,  2.93it/s]Loss: 0.00737:  53%|█████▎    | 106/201 [00:28<00:32,  2.93it/s]Loss: 0.00737:  53%|█████▎    | 107/201 [00:29<00:29,  3.20it/s]Loss: 0.00721:  53%|█████▎    | 107/201 [00:29<00:29,  3.20it/s]Loss: 0.00721:  54%|█████▎    | 108/201 [00:29<00:27,  3.42it/s]Loss: 0.00709:  54%|█████▎    | 108/201 [00:29<00:27,  3.42it/s]Loss: 0.00709:  54%|█████▍    | 109/201 [00:29<00:25,  3.59it/s]Loss: 0.00697:  54%|█████▍    | 109/201 [00:29<00:25,  3.59it/s]Loss: 0.00697:  55%|█████▍    | 110/201 [00:29<00:24,  3.72it/s]Loss: 0.00689:  55%|█████▍    | 110/201 [00:29<00:24,  3.72it/s]Loss: 0.00689:  55%|█████▌    | 111/201 [00:30<00:23,  3.82it/s]Loss: 0.00683:  55%|█████▌    | 111/201 [00:30<00:23,  3.82it/s]Loss: 0.00683:  56%|█████▌    | 112/201 [00:30<00:22,  3.90it/s]Loss: 0.00687:  56%|█████▌    | 112/201 [00:30<00:22,  3.90it/s]Loss: 0.00687:  56%|█████▌    | 113/201 [00:30<00:22,  3.95it/s]Loss: 0.00669:  56%|█████▌    | 113/201 [00:30<00:22,  3.95it/s]Loss: 0.00669:  57%|█████▋    | 114/201 [00:30<00:21,  3.99it/s]Loss: 0.00665:  57%|█████▋    | 114/201 [00:30<00:21,  3.99it/s]Loss: 0.00665:  57%|█████▋    | 115/201 [00:30<00:21,  4.01it/s]Loss: 0.00661:  57%|█████▋    | 115/201 [00:30<00:21,  4.01it/s]Loss: 0.00661:  58%|█████▊    | 116/201 [00:31<00:21,  4.03it/s]Loss: 0.00660:  58%|█████▊    | 116/201 [00:31<00:21,  4.03it/s]Loss: 0.00660:  58%|█████▊    | 117/201 [00:31<00:20,  4.05it/s]Loss: 0.00649:  58%|█████▊    | 117/201 [00:31<00:20,  4.05it/s]Loss: 0.00649:  59%|█████▊    | 118/201 [00:31<00:20,  4.05it/s]Loss: 0.00646:  59%|█████▊    | 118/201 [00:31<00:20,  4.05it/s]Loss: 0.00646:  59%|█████▉    | 119/201 [00:31<00:20,  4.06it/s]Loss: 0.00652:  59%|█████▉    | 119/201 [00:31<00:20,  4.06it/s]Loss: 0.00652:  60%|█████▉    | 120/201 [00:32<00:19,  4.07it/s]Loss: 0.00657:  60%|█████▉    | 120/201 [00:32<00:19,  4.07it/s]Loss: 0.00657:  60%|██████    | 121/201 [00:32<00:20,  3.97it/s]Loss: 0.00647:  60%|██████    | 121/201 [00:32<00:20,  3.97it/s]Loss: 0.00647:  61%|██████    | 122/201 [00:32<00:19,  4.01it/s]Loss: 0.00661:  61%|██████    | 122/201 [00:32<00:19,  4.01it/s]Loss: 0.00661:  61%|██████    | 123/201 [00:32<00:19,  4.03it/s]Loss: 0.00644:  61%|██████    | 123/201 [00:32<00:19,  4.03it/s]Loss: 0.00644:  62%|██████▏   | 124/201 [00:33<00:19,  4.04it/s]Loss: 0.00633:  62%|██████▏   | 124/201 [00:33<00:19,  4.04it/s]Loss: 0.00633:  62%|██████▏   | 125/201 [00:33<00:18,  4.05it/s]Loss: 0.00626:  62%|██████▏   | 125/201 [00:33<00:18,  4.05it/s]Loss: 0.00626:  63%|██████▎   | 126/201 [00:33<00:18,  4.06it/s]Loss: 0.00630:  63%|██████▎   | 126/201 [00:33<00:18,  4.06it/s]Loss: 0.00630:  63%|██████▎   | 127/201 [00:33<00:18,  4.07it/s]Loss: 0.00631:  63%|██████▎   | 127/201 [00:33<00:18,  4.07it/s]Loss: 0.00631:  64%|██████▎   | 128/201 [00:34<00:17,  4.07it/s]Loss: 0.00620:  64%|██████▎   | 128/201 [00:34<00:17,  4.07it/s]Loss: 0.00620:  64%|██████▍   | 129/201 [00:34<00:17,  4.07it/s]Loss: 0.00635:  64%|██████▍   | 129/201 [00:34<00:17,  4.07it/s]Loss: 0.00635:  65%|██████▍   | 130/201 [00:34<00:17,  4.07it/s]Loss: 0.00647:  65%|██████▍   | 130/201 [00:34<00:17,  4.07it/s]Loss: 0.00647:  65%|██████▌   | 131/201 [00:34<00:17,  4.07it/s]Loss: 0.00635:  65%|██████▌   | 131/201 [00:34<00:17,  4.07it/s]Loss: 0.00635:  66%|██████▌   | 132/201 [00:35<00:16,  4.08it/s]Loss: 0.00611:  66%|██████▌   | 132/201 [00:35<00:16,  4.08it/s]Loss: 0.00611:  66%|██████▌   | 133/201 [00:35<00:16,  4.08it/s]Loss: 0.00624:  66%|██████▌   | 133/201 [00:35<00:16,  4.08it/s]Loss: 0.00624:  67%|██████▋   | 134/201 [00:35<00:16,  4.08it/s]Loss: 0.00617:  67%|██████▋   | 134/201 [00:35<00:16,  4.08it/s]Loss: 0.00617:  67%|██████▋   | 135/201 [00:35<00:16,  4.08it/s]Loss: 0.00626:  67%|██████▋   | 135/201 [00:35<00:16,  4.08it/s]Loss: 0.00626:  68%|██████▊   | 136/201 [00:36<00:15,  4.08it/s]Loss: 0.00610:  68%|██████▊   | 136/201 [00:36<00:15,  4.08it/s]Loss: 0.00610:  68%|██████▊   | 137/201 [00:36<00:15,  4.08it/s]Loss: 0.00630:  68%|██████▊   | 137/201 [00:36<00:15,  4.08it/s]Loss: 0.00630:  69%|██████▊   | 138/201 [00:36<00:15,  4.08it/s]Loss: 0.00624:  69%|██████▊   | 138/201 [00:36<00:15,  4.08it/s]Loss: 0.00624:  69%|██████▉   | 139/201 [00:36<00:15,  4.08it/s]Loss: 0.00629:  69%|██████▉   | 139/201 [00:36<00:15,  4.08it/s]Loss: 0.00629:  70%|██████▉   | 140/201 [00:37<00:14,  4.08it/s]Loss: 0.00600:  70%|██████▉   | 140/201 [00:37<00:14,  4.08it/s]Loss: 0.00600:  70%|███████   | 141/201 [00:37<00:15,  3.97it/s]Loss: 0.00611:  70%|███████   | 141/201 [00:37<00:15,  3.97it/s]Loss: 0.00611:  71%|███████   | 142/201 [00:37<00:14,  4.01it/s]Loss: 0.00614:  71%|███████   | 142/201 [00:37<00:14,  4.01it/s]Loss: 0.00614:  71%|███████   | 143/201 [00:37<00:14,  4.03it/s]Loss: 0.00609:  71%|███████   | 143/201 [00:37<00:14,  4.03it/s]Loss: 0.00609:  72%|███████▏  | 144/201 [00:38<00:14,  4.04it/s]Loss: 0.00597:  72%|███████▏  | 144/201 [00:38<00:14,  4.04it/s]Loss: 0.00597:  72%|███████▏  | 145/201 [00:38<00:13,  4.05it/s]Loss: 0.00617:  72%|███████▏  | 145/201 [00:38<00:13,  4.05it/s]Loss: 0.00617:  73%|███████▎  | 146/201 [00:38<00:13,  4.06it/s]Loss: 0.00611:  73%|███████▎  | 146/201 [00:38<00:13,  4.06it/s]Loss: 0.00611:  73%|███████▎  | 147/201 [00:38<00:13,  4.08it/s]Loss: 0.00607:  73%|███████▎  | 147/201 [00:38<00:13,  4.08it/s]Loss: 0.00607:  74%|███████▎  | 148/201 [00:39<00:12,  4.12it/s]Loss: 0.00596:  74%|███████▎  | 148/201 [00:39<00:12,  4.12it/s]Loss: 0.00596:  74%|███████▍  | 149/201 [00:39<00:12,  4.15it/s]Loss: 0.00588:  74%|███████▍  | 149/201 [00:39<00:12,  4.15it/s]Loss: 0.00588:  75%|███████▍  | 150/201 [00:39<00:12,  4.17it/s]Loss: 0.00611:  75%|███████▍  | 150/201 [00:39<00:12,  4.17it/s]Loss: 0.00611:  75%|███████▌  | 151/201 [00:39<00:11,  4.18it/s]Loss: 0.00624:  75%|███████▌  | 151/201 [00:39<00:11,  4.18it/s]Loss: 0.00624:  76%|███████▌  | 152/201 [00:40<00:11,  4.19it/s]Loss: 0.00615:  76%|███████▌  | 152/201 [00:40<00:11,  4.19it/s]max loss: 0.14514212310314178
Densities: min=0.0, max=0.9999451041221619, mean=0.1770777553319931
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.30s/it][A1it [00:01,  1.30s/it]
Loss: 0.00615:  76%|███████▌  | 153/201 [00:41<00:30,  1.58it/s]Loss: 0.00855:  76%|███████▌  | 153/201 [00:41<00:30,  1.58it/s]Loss: 0.00855:  77%|███████▋  | 154/201 [00:41<00:24,  1.93it/s]Loss: 0.00790:  77%|███████▋  | 154/201 [00:41<00:24,  1.93it/s]Loss: 0.00790:  77%|███████▋  | 155/201 [00:42<00:20,  2.29it/s]Loss: 0.00758:  77%|███████▋  | 155/201 [00:42<00:20,  2.29it/s]Loss: 0.00758:  78%|███████▊  | 156/201 [00:42<00:17,  2.64it/s]Loss: 0.00739:  78%|███████▊  | 156/201 [00:42<00:17,  2.64it/s]Loss: 0.00739:  78%|███████▊  | 157/201 [00:42<00:14,  2.95it/s]Loss: 0.00723:  78%|███████▊  | 157/201 [00:42<00:14,  2.95it/s]Loss: 0.00723:  79%|███████▊  | 158/201 [00:42<00:13,  3.21it/s]Loss: 0.00743:  79%|███████▊  | 158/201 [00:42<00:13,  3.21it/s]Loss: 0.00743:  79%|███████▉  | 159/201 [00:43<00:12,  3.43it/s]Loss: 0.00751:  79%|███████▉  | 159/201 [00:43<00:12,  3.43it/s]Loss: 0.00751:  80%|███████▉  | 160/201 [00:43<00:11,  3.60it/s]Loss: 0.00720:  80%|███████▉  | 160/201 [00:43<00:11,  3.60it/s]Loss: 0.00720:  80%|████████  | 161/201 [00:43<00:10,  3.68it/s]Loss: 0.00724:  80%|████████  | 161/201 [00:43<00:10,  3.68it/s]Loss: 0.00724:  81%|████████  | 162/201 [00:43<00:10,  3.83it/s]Loss: 0.00745:  81%|████████  | 162/201 [00:43<00:10,  3.83it/s]Loss: 0.00745:  81%|████████  | 163/201 [00:44<00:09,  3.94it/s]Loss: 0.00731:  81%|████████  | 163/201 [00:44<00:09,  3.94it/s]Loss: 0.00731:  82%|████████▏ | 164/201 [00:44<00:09,  4.01it/s]Loss: 0.00722:  82%|████████▏ | 164/201 [00:44<00:09,  4.01it/s]Loss: 0.00722:  82%|████████▏ | 165/201 [00:44<00:08,  4.07it/s]Loss: 0.00709:  82%|████████▏ | 165/201 [00:44<00:08,  4.07it/s]Loss: 0.00709:  83%|████████▎ | 166/201 [00:44<00:08,  4.11it/s]Loss: 0.00696:  83%|████████▎ | 166/201 [00:44<00:08,  4.11it/s]Loss: 0.00696:  83%|████████▎ | 167/201 [00:45<00:08,  4.14it/s]Loss: 0.00707:  83%|████████▎ | 167/201 [00:45<00:08,  4.14it/s]Loss: 0.00707:  84%|████████▎ | 168/201 [00:45<00:07,  4.16it/s]Loss: 0.00685:  84%|████████▎ | 168/201 [00:45<00:07,  4.16it/s]Loss: 0.00685:  84%|████████▍ | 169/201 [00:45<00:07,  4.18it/s]Loss: 0.00716:  84%|████████▍ | 169/201 [00:45<00:07,  4.18it/s]Loss: 0.00716:  85%|████████▍ | 170/201 [00:45<00:07,  4.18it/s]Loss: 0.00689:  85%|████████▍ | 170/201 [00:45<00:07,  4.18it/s]Loss: 0.00689:  85%|████████▌ | 171/201 [00:45<00:07,  4.19it/s]Loss: 0.00696:  85%|████████▌ | 171/201 [00:45<00:07,  4.19it/s]Loss: 0.00696:  86%|████████▌ | 172/201 [00:46<00:06,  4.20it/s]Loss: 0.00688:  86%|████████▌ | 172/201 [00:46<00:06,  4.20it/s]Loss: 0.00688:  86%|████████▌ | 173/201 [00:46<00:06,  4.20it/s]Loss: 0.00678:  86%|████████▌ | 173/201 [00:46<00:06,  4.20it/s]Loss: 0.00678:  87%|████████▋ | 174/201 [00:46<00:06,  4.20it/s]Loss: 0.00690:  87%|████████▋ | 174/201 [00:46<00:06,  4.20it/s]Loss: 0.00690:  87%|████████▋ | 175/201 [00:46<00:06,  4.20it/s]Loss: 0.00670:  87%|████████▋ | 175/201 [00:46<00:06,  4.20it/s]Loss: 0.00670:  88%|████████▊ | 176/201 [00:47<00:05,  4.21it/s]Loss: 0.00669:  88%|████████▊ | 176/201 [00:47<00:05,  4.21it/s]Loss: 0.00669:  88%|████████▊ | 177/201 [00:47<00:05,  4.21it/s]Loss: 0.00663:  88%|████████▊ | 177/201 [00:47<00:05,  4.21it/s]Loss: 0.00663:  89%|████████▊ | 178/201 [00:47<00:05,  4.21it/s]Loss: 0.00669:  89%|████████▊ | 178/201 [00:47<00:05,  4.21it/s]Loss: 0.00669:  89%|████████▉ | 179/201 [00:47<00:05,  4.21it/s]Loss: 0.00657:  89%|████████▉ | 179/201 [00:47<00:05,  4.21it/s]Loss: 0.00657:  90%|████████▉ | 180/201 [00:48<00:04,  4.21it/s]Loss: 0.00651:  90%|████████▉ | 180/201 [00:48<00:04,  4.21it/s]Loss: 0.00651:  90%|█████████ | 181/201 [00:48<00:04,  4.10it/s]Loss: 0.00667:  90%|█████████ | 181/201 [00:48<00:04,  4.10it/s]Loss: 0.00667:  91%|█████████ | 182/201 [00:48<00:04,  4.14it/s]Loss: 0.00652:  91%|█████████ | 182/201 [00:48<00:04,  4.14it/s]Loss: 0.00652:  91%|█████████ | 183/201 [00:48<00:04,  4.16it/s]Loss: 0.00655:  91%|█████████ | 183/201 [00:48<00:04,  4.16it/s]Loss: 0.00655:  92%|█████████▏| 184/201 [00:49<00:04,  4.17it/s]Loss: 0.00660:  92%|█████████▏| 184/201 [00:49<00:04,  4.17it/s]Loss: 0.00660:  92%|█████████▏| 185/201 [00:49<00:03,  4.14it/s]Loss: 0.00658:  92%|█████████▏| 185/201 [00:49<00:03,  4.14it/s]Loss: 0.00658:  93%|█████████▎| 186/201 [00:49<00:03,  4.12it/s]Loss: 0.00664:  93%|█████████▎| 186/201 [00:49<00:03,  4.12it/s]Loss: 0.00664:  93%|█████████▎| 187/201 [00:49<00:03,  4.10it/s]Loss: 0.00645:  93%|█████████▎| 187/201 [00:49<00:03,  4.10it/s]Loss: 0.00645:  94%|█████████▎| 188/201 [00:50<00:03,  4.09it/s]Loss: 0.00638:  94%|█████████▎| 188/201 [00:50<00:03,  4.09it/s]Loss: 0.00638:  94%|█████████▍| 189/201 [00:50<00:02,  4.07it/s]Loss: 0.00642:  94%|█████████▍| 189/201 [00:50<00:02,  4.07it/s]Loss: 0.00642:  95%|█████████▍| 190/201 [00:50<00:02,  4.07it/s]Loss: 0.00645:  95%|█████████▍| 190/201 [00:50<00:02,  4.07it/s]Loss: 0.00645:  95%|█████████▌| 191/201 [00:50<00:02,  4.07it/s]Loss: 0.00648:  95%|█████████▌| 191/201 [00:50<00:02,  4.07it/s]Loss: 0.00648:  96%|█████████▌| 192/201 [00:51<00:02,  4.07it/s]Loss: 0.00633:  96%|█████████▌| 192/201 [00:51<00:02,  4.07it/s]Loss: 0.00633:  96%|█████████▌| 193/201 [00:51<00:01,  4.07it/s]Loss: 0.00655:  96%|█████████▌| 193/201 [00:51<00:01,  4.07it/s]Loss: 0.00655:  97%|█████████▋| 194/201 [00:51<00:01,  4.07it/s]Loss: 0.00631:  97%|█████████▋| 194/201 [00:51<00:01,  4.07it/s]Loss: 0.00631:  97%|█████████▋| 195/201 [00:51<00:01,  4.07it/s]Loss: 0.00635:  97%|█████████▋| 195/201 [00:51<00:01,  4.07it/s]Loss: 0.00635:  98%|█████████▊| 196/201 [00:52<00:01,  4.05it/s]Loss: 0.00638:  98%|█████████▊| 196/201 [00:52<00:01,  4.05it/s]Loss: 0.00638:  98%|█████████▊| 197/201 [00:52<00:00,  4.04it/s]Loss: 0.00634:  98%|█████████▊| 197/201 [00:52<00:00,  4.04it/s]Loss: 0.00634:  99%|█████████▊| 198/201 [00:52<00:00,  4.05it/s]Loss: 0.00628:  99%|█████████▊| 198/201 [00:52<00:00,  4.05it/s]Loss: 0.00628:  99%|█████████▉| 199/201 [00:52<00:00,  4.03it/s]Loss: 0.00629:  99%|█████████▉| 199/201 [00:52<00:00,  4.03it/s]Loss: 0.00629: 100%|█████████▉| 200/201 [00:53<00:00,  4.05it/s]Loss: 0.00624: 100%|█████████▉| 200/201 [00:53<00:00,  4.05it/s]Loss: 0.00624: 100%|██████████| 201/201 [00:53<00:00,  3.96it/s]Loss: 0.00568: 100%|██████████| 201/201 [00:53<00:00,  3.96it/s]Loss: 0.00568: 100%|██████████| 201/201 [00:53<00:00,  3.77it/s]
max loss: 0.0996246263384819
Densities: min=0.0, max=0.9998326301574707, mean=0.19090840220451355
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/mechhand_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 53.29255652427673 seconds
-1.0 2.0673828
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/chameleon_1024x1024x1080_float32_raw_1024x1024x1080_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json
Initialize network
Latent space memory: 57.4MiB
# of network parameters: 15072577
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.02it/s]1it [00:00,  3.02it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.330952912569046
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.70it/s]Render: : 1it [00:00,  2.70it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 98, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1024, 1024, 1080], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<05:45,  1.73s/it]Loss: 0.10978:   0%|          | 1/201 [00:01<05:45,  1.73s/it]Loss: 0.10978:   1%|          | 2/201 [00:02<04:02,  1.22s/it]Loss: 0.03002:   1%|          | 2/201 [00:02<04:02,  1.22s/it]Loss: 0.03002:   1%|▏         | 3/201 [00:03<03:29,  1.06s/it]Loss: 0.02229:   1%|▏         | 3/201 [00:03<03:29,  1.06s/it]Loss: 0.02229:   2%|▏         | 4/201 [00:04<03:13,  1.02it/s]Loss: 0.01756:   2%|▏         | 4/201 [00:04<03:13,  1.02it/s]Loss: 0.01756:   2%|▏         | 5/201 [00:05<03:04,  1.06it/s]Loss: 0.01589:   2%|▏         | 5/201 [00:05<03:04,  1.06it/s]Loss: 0.01589:   3%|▎         | 6/201 [00:06<02:58,  1.09it/s]Loss: 0.01511:   3%|▎         | 6/201 [00:06<02:58,  1.09it/s]Loss: 0.01511:   3%|▎         | 7/201 [00:06<02:54,  1.11it/s]Loss: 0.01404:   3%|▎         | 7/201 [00:06<02:54,  1.11it/s]Loss: 0.01404:   4%|▍         | 8/201 [00:07<02:52,  1.12it/s]Loss: 0.01370:   4%|▍         | 8/201 [00:07<02:52,  1.12it/s]Loss: 0.01370:   4%|▍         | 9/201 [00:08<02:49,  1.13it/s]Loss: 0.01351:   4%|▍         | 9/201 [00:08<02:49,  1.13it/s]Loss: 0.01351:   5%|▍         | 10/201 [00:09<02:47,  1.14it/s]Loss: 0.01270:   5%|▍         | 10/201 [00:09<02:47,  1.14it/s]Loss: 0.01270:   5%|▌         | 11/201 [00:10<02:46,  1.14it/s]Loss: 0.01272:   5%|▌         | 11/201 [00:10<02:46,  1.14it/s]Loss: 0.01272:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.01228:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.01228:   6%|▋         | 13/201 [00:12<02:43,  1.15it/s]Loss: 0.01189:   6%|▋         | 13/201 [00:12<02:43,  1.15it/s]Loss: 0.01189:   7%|▋         | 14/201 [00:13<02:42,  1.15it/s]Loss: 0.01184:   7%|▋         | 14/201 [00:13<02:42,  1.15it/s]Loss: 0.01184:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.01177:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.01177:   8%|▊         | 16/201 [00:14<02:40,  1.15it/s]Loss: 0.01138:   8%|▊         | 16/201 [00:14<02:40,  1.15it/s]Loss: 0.01138:   8%|▊         | 17/201 [00:15<02:39,  1.15it/s]Loss: 0.01102:   8%|▊         | 17/201 [00:15<02:39,  1.15it/s]Loss: 0.01102:   9%|▉         | 18/201 [00:16<02:38,  1.15it/s]Loss: 0.01090:   9%|▉         | 18/201 [00:16<02:38,  1.15it/s]Loss: 0.01090:   9%|▉         | 19/201 [00:17<02:38,  1.15it/s]Loss: 0.01083:   9%|▉         | 19/201 [00:17<02:38,  1.15it/s]Loss: 0.01083:  10%|▉         | 20/201 [00:18<02:37,  1.15it/s]Loss: 0.01040:  10%|▉         | 20/201 [00:18<02:37,  1.15it/s]Loss: 0.01040:  10%|█         | 21/201 [00:19<02:44,  1.09it/s]Loss: 0.01050:  10%|█         | 21/201 [00:19<02:44,  1.09it/s]Loss: 0.01050:  11%|█         | 22/201 [00:20<02:41,  1.11it/s]Loss: 0.01011:  11%|█         | 22/201 [00:20<02:41,  1.11it/s]Loss: 0.01011:  11%|█▏        | 23/201 [00:20<02:38,  1.12it/s]Loss: 0.00980:  11%|█▏        | 23/201 [00:20<02:38,  1.12it/s]Loss: 0.00980:  12%|█▏        | 24/201 [00:21<02:36,  1.13it/s]Loss: 0.00979:  12%|█▏        | 24/201 [00:21<02:36,  1.13it/s]Loss: 0.00979:  12%|█▏        | 25/201 [00:22<02:34,  1.14it/s]Loss: 0.01013:  12%|█▏        | 25/201 [00:22<02:34,  1.14it/s]Loss: 0.01013:  13%|█▎        | 26/201 [00:23<02:33,  1.14it/s]Loss: 0.01010:  13%|█▎        | 26/201 [00:23<02:33,  1.14it/s]Loss: 0.01010:  13%|█▎        | 27/201 [00:24<02:32,  1.14it/s]Loss: 0.00972:  13%|█▎        | 27/201 [00:24<02:32,  1.14it/s]Loss: 0.00972:  14%|█▍        | 28/201 [00:25<02:31,  1.15it/s]Loss: 0.00936:  14%|█▍        | 28/201 [00:25<02:31,  1.15it/s]Loss: 0.00936:  14%|█▍        | 29/201 [00:26<02:29,  1.15it/s]Loss: 0.00924:  14%|█▍        | 29/201 [00:26<02:29,  1.15it/s]Loss: 0.00924:  15%|█▍        | 30/201 [00:27<02:28,  1.15it/s]Loss: 0.00915:  15%|█▍        | 30/201 [00:27<02:28,  1.15it/s]Loss: 0.00915:  15%|█▌        | 31/201 [00:27<02:27,  1.15it/s]Loss: 0.00903:  15%|█▌        | 31/201 [00:27<02:27,  1.15it/s]Loss: 0.00903:  16%|█▌        | 32/201 [00:28<02:26,  1.15it/s]Loss: 0.00897:  16%|█▌        | 32/201 [00:28<02:26,  1.15it/s]Loss: 0.00897:  16%|█▋        | 33/201 [00:29<02:26,  1.15it/s]Loss: 0.00884:  16%|█▋        | 33/201 [00:29<02:26,  1.15it/s]Loss: 0.00884:  17%|█▋        | 34/201 [00:30<02:25,  1.15it/s]Loss: 0.00871:  17%|█▋        | 34/201 [00:30<02:25,  1.15it/s]Loss: 0.00871:  17%|█▋        | 35/201 [00:31<02:24,  1.15it/s]Loss: 0.00874:  17%|█▋        | 35/201 [00:31<02:24,  1.15it/s]Loss: 0.00874:  18%|█▊        | 36/201 [00:32<02:23,  1.15it/s]Loss: 0.00854:  18%|█▊        | 36/201 [00:32<02:23,  1.15it/s]Loss: 0.00854:  18%|█▊        | 37/201 [00:33<02:22,  1.15it/s]Loss: 0.00837:  18%|█▊        | 37/201 [00:33<02:22,  1.15it/s]Loss: 0.00837:  19%|█▉        | 38/201 [00:34<02:21,  1.15it/s]Loss: 0.00855:  19%|█▉        | 38/201 [00:34<02:21,  1.15it/s]Loss: 0.00855:  19%|█▉        | 39/201 [00:34<02:20,  1.15it/s]Loss: 0.00840:  19%|█▉        | 39/201 [00:34<02:20,  1.15it/s]Loss: 0.00840:  20%|█▉        | 40/201 [00:35<02:19,  1.15it/s]Loss: 0.00824:  20%|█▉        | 40/201 [00:35<02:19,  1.15it/s]Loss: 0.00824:  20%|██        | 41/201 [00:36<02:26,  1.09it/s]Loss: 0.00822:  20%|██        | 41/201 [00:36<02:26,  1.09it/s]Loss: 0.00822:  21%|██        | 42/201 [00:37<02:22,  1.11it/s]Loss: 0.00813:  21%|██        | 42/201 [00:37<02:22,  1.11it/s]Loss: 0.00813:  21%|██▏       | 43/201 [00:38<02:20,  1.12it/s]Loss: 0.00804:  21%|██▏       | 43/201 [00:38<02:20,  1.12it/s]Loss: 0.00804:  22%|██▏       | 44/201 [00:39<02:18,  1.13it/s]Loss: 0.00800:  22%|██▏       | 44/201 [00:39<02:18,  1.13it/s]Loss: 0.00800:  22%|██▏       | 45/201 [00:40<02:17,  1.14it/s]Loss: 0.00787:  22%|██▏       | 45/201 [00:40<02:17,  1.14it/s]Loss: 0.00787:  23%|██▎       | 46/201 [00:41<02:15,  1.14it/s]Loss: 0.00784:  23%|██▎       | 46/201 [00:41<02:15,  1.14it/s]Loss: 0.00784:  23%|██▎       | 47/201 [00:41<02:14,  1.14it/s]Loss: 0.00775:  23%|██▎       | 47/201 [00:41<02:14,  1.14it/s]Loss: 0.00775:  24%|██▍       | 48/201 [00:42<02:13,  1.15it/s]Loss: 0.00763:  24%|██▍       | 48/201 [00:42<02:13,  1.15it/s]Loss: 0.00763:  24%|██▍       | 49/201 [00:43<02:12,  1.15it/s]Loss: 0.00762:  24%|██▍       | 49/201 [00:43<02:12,  1.15it/s]Loss: 0.00762:  25%|██▍       | 50/201 [00:44<02:11,  1.15it/s]Loss: 0.00762:  25%|██▍       | 50/201 [00:44<02:11,  1.15it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.70s/it][A1it [00:01,  1.70s/it]
Loss: 0.00762:  25%|██▌       | 51/201 [00:47<03:32,  1.42s/it]Loss: 0.00954:  25%|██▌       | 51/201 [00:47<03:32,  1.42s/it]Loss: 0.00954:  26%|██▌       | 52/201 [00:48<03:11,  1.29s/it]Loss: 0.00815:  26%|██▌       | 52/201 [00:48<03:11,  1.29s/it]Loss: 0.00815:  26%|██▋       | 53/201 [00:49<02:57,  1.20s/it]Loss: 0.00814:  26%|██▋       | 53/201 [00:49<02:57,  1.20s/it]Loss: 0.00814:  27%|██▋       | 54/201 [00:50<02:46,  1.13s/it]Loss: 0.00610:  27%|██▋       | 54/201 [00:50<02:46,  1.13s/it]Loss: 0.00610:  27%|██▋       | 55/201 [00:51<02:39,  1.09s/it]Loss: 0.00537:  27%|██▋       | 55/201 [00:51<02:39,  1.09s/it]Loss: 0.00537:  28%|██▊       | 56/201 [00:52<02:33,  1.06s/it]Loss: 0.00510:  28%|██▊       | 56/201 [00:52<02:33,  1.06s/it]Loss: 0.00510:  28%|██▊       | 57/201 [00:53<02:29,  1.04s/it]Loss: 0.00489:  28%|██▊       | 57/201 [00:53<02:29,  1.04s/it]Loss: 0.00489:  29%|██▉       | 58/201 [00:54<02:26,  1.02s/it]Loss: 0.00478:  29%|██▉       | 58/201 [00:54<02:26,  1.02s/it]Loss: 0.00478:  29%|██▉       | 59/201 [00:55<02:23,  1.01s/it]Loss: 0.00467:  29%|██▉       | 59/201 [00:55<02:23,  1.01s/it]Loss: 0.00467:  30%|██▉       | 60/201 [00:56<02:21,  1.00s/it]Loss: 0.00457:  30%|██▉       | 60/201 [00:56<02:21,  1.00s/it]Loss: 0.00457:  30%|███       | 61/201 [00:57<02:26,  1.04s/it]Loss: 0.00485:  30%|███       | 61/201 [00:57<02:26,  1.04s/it]Loss: 0.00485:  31%|███       | 62/201 [00:58<02:22,  1.02s/it]Loss: 0.00464:  31%|███       | 62/201 [00:58<02:22,  1.02s/it]Loss: 0.00464:  31%|███▏      | 63/201 [00:59<02:19,  1.01s/it]Loss: 0.00442:  31%|███▏      | 63/201 [00:59<02:19,  1.01s/it]Loss: 0.00442:  32%|███▏      | 64/201 [01:00<02:17,  1.01s/it]Loss: 0.00429:  32%|███▏      | 64/201 [01:00<02:17,  1.01s/it]Loss: 0.00429:  32%|███▏      | 65/201 [01:01<02:15,  1.00it/s]Loss: 0.00421:  32%|███▏      | 65/201 [01:01<02:15,  1.00it/s]Loss: 0.00421:  33%|███▎      | 66/201 [01:02<02:14,  1.01it/s]Loss: 0.00423:  33%|███▎      | 66/201 [01:02<02:14,  1.01it/s]Loss: 0.00423:  33%|███▎      | 67/201 [01:03<02:13,  1.01it/s]Loss: 0.00440:  33%|███▎      | 67/201 [01:03<02:13,  1.01it/s]Loss: 0.00440:  34%|███▍      | 68/201 [01:04<02:11,  1.01it/s]Loss: 0.00446:  34%|███▍      | 68/201 [01:04<02:11,  1.01it/s]Loss: 0.00446:  34%|███▍      | 69/201 [01:05<02:10,  1.01it/s]Loss: 0.00419:  34%|███▍      | 69/201 [01:05<02:10,  1.01it/s]Loss: 0.00419:  35%|███▍      | 70/201 [01:06<02:09,  1.01it/s]Loss: 0.00420:  35%|███▍      | 70/201 [01:06<02:09,  1.01it/s]Loss: 0.00420:  35%|███▌      | 71/201 [01:07<02:08,  1.01it/s]Loss: 0.00426:  35%|███▌      | 71/201 [01:07<02:08,  1.01it/s]Loss: 0.00426:  36%|███▌      | 72/201 [01:08<02:07,  1.01it/s]Loss: 0.00402:  36%|███▌      | 72/201 [01:08<02:07,  1.01it/s]Loss: 0.00402:  36%|███▋      | 73/201 [01:09<02:06,  1.01it/s]Loss: 0.00392:  36%|███▋      | 73/201 [01:09<02:06,  1.01it/s]Loss: 0.00392:  37%|███▋      | 74/201 [01:10<02:05,  1.01it/s]Loss: 0.00392:  37%|███▋      | 74/201 [01:10<02:05,  1.01it/s]Loss: 0.00392:  37%|███▋      | 75/201 [01:11<02:04,  1.01it/s]Loss: 0.00408:  37%|███▋      | 75/201 [01:11<02:04,  1.01it/s]Loss: 0.00408:  38%|███▊      | 76/201 [01:12<02:03,  1.01it/s]Loss: 0.00422:  38%|███▊      | 76/201 [01:12<02:03,  1.01it/s]Loss: 0.00422:  38%|███▊      | 77/201 [01:13<02:02,  1.01it/s]Loss: 0.00426:  38%|███▊      | 77/201 [01:13<02:02,  1.01it/s]Loss: 0.00426:  39%|███▉      | 78/201 [01:14<02:01,  1.01it/s]Loss: 0.00466:  39%|███▉      | 78/201 [01:14<02:01,  1.01it/s]Loss: 0.00466:  39%|███▉      | 79/201 [01:15<02:00,  1.01it/s]Loss: 0.00446:  39%|███▉      | 79/201 [01:15<02:00,  1.01it/s]Loss: 0.00446:  40%|███▉      | 80/201 [01:16<01:59,  1.01it/s]Loss: 0.00622:  40%|███▉      | 80/201 [01:16<01:59,  1.01it/s]Loss: 0.00622:  40%|████      | 81/201 [01:17<02:04,  1.03s/it]Loss: 0.00479:  40%|████      | 81/201 [01:17<02:04,  1.03s/it]Loss: 0.00479:  41%|████      | 82/201 [01:18<02:01,  1.02s/it]Loss: 0.00637:  41%|████      | 82/201 [01:18<02:01,  1.02s/it]Loss: 0.00637:  41%|████▏     | 83/201 [01:19<01:59,  1.01s/it]Loss: 0.00463:  41%|████▏     | 83/201 [01:19<01:59,  1.01s/it]Loss: 0.00463:  42%|████▏     | 84/201 [01:20<01:57,  1.00s/it]Loss: 0.00411:  42%|████▏     | 84/201 [01:20<01:57,  1.00s/it]Loss: 0.00411:  42%|████▏     | 85/201 [01:21<01:55,  1.00it/s]Loss: 0.00397:  42%|████▏     | 85/201 [01:21<01:55,  1.00it/s]Loss: 0.00397:  43%|████▎     | 86/201 [01:22<01:54,  1.01it/s]Loss: 0.00396:  43%|████▎     | 86/201 [01:22<01:54,  1.01it/s]Loss: 0.00396:  43%|████▎     | 87/201 [01:23<01:53,  1.01it/s]Loss: 0.00387:  43%|████▎     | 87/201 [01:23<01:53,  1.01it/s]Loss: 0.00387:  44%|████▍     | 88/201 [01:24<01:52,  1.01it/s]Loss: 0.00379:  44%|████▍     | 88/201 [01:24<01:52,  1.01it/s]Loss: 0.00379:  44%|████▍     | 89/201 [01:25<01:50,  1.01it/s]Loss: 0.00379:  44%|████▍     | 89/201 [01:25<01:50,  1.01it/s]Loss: 0.00379:  45%|████▍     | 90/201 [01:26<01:49,  1.01it/s]Loss: 0.00377:  45%|████▍     | 90/201 [01:26<01:49,  1.01it/s]Loss: 0.00377:  45%|████▌     | 91/201 [01:27<01:48,  1.01it/s]Loss: 0.00369:  45%|████▌     | 91/201 [01:27<01:48,  1.01it/s]Loss: 0.00369:  46%|████▌     | 92/201 [01:28<01:47,  1.01it/s]Loss: 0.00375:  46%|████▌     | 92/201 [01:28<01:47,  1.01it/s]Loss: 0.00375:  46%|████▋     | 93/201 [01:28<01:46,  1.02it/s]Loss: 0.00368:  46%|████▋     | 93/201 [01:28<01:46,  1.02it/s]Loss: 0.00368:  47%|████▋     | 94/201 [01:29<01:45,  1.02it/s]Loss: 0.00368:  47%|████▋     | 94/201 [01:29<01:45,  1.02it/s]Loss: 0.00368:  47%|████▋     | 95/201 [01:30<01:44,  1.02it/s]Loss: 0.00368:  47%|████▋     | 95/201 [01:30<01:44,  1.02it/s]Loss: 0.00368:  48%|████▊     | 96/201 [01:31<01:43,  1.02it/s]Loss: 0.00374:  48%|████▊     | 96/201 [01:31<01:43,  1.02it/s]Loss: 0.00374:  48%|████▊     | 97/201 [01:32<01:42,  1.02it/s]Loss: 0.00364:  48%|████▊     | 97/201 [01:32<01:42,  1.02it/s]Loss: 0.00364:  49%|████▉     | 98/201 [01:33<01:41,  1.02it/s]Loss: 0.00352:  49%|████▉     | 98/201 [01:33<01:41,  1.02it/s]Loss: 0.00352:  49%|████▉     | 99/201 [01:34<01:40,  1.02it/s]Loss: 0.00366:  49%|████▉     | 99/201 [01:34<01:40,  1.02it/s]Loss: 0.00366:  50%|████▉     | 100/201 [01:35<01:39,  1.02it/s]Loss: 0.00361:  50%|████▉     | 100/201 [01:35<01:39,  1.02it/s]Loss: 0.00361:  50%|█████     | 101/201 [01:36<01:42,  1.03s/it]Loss: 0.00275:  50%|█████     | 101/201 [01:36<01:42,  1.03s/it]max loss: 0.3369285464286804
Densities: min=0.0, max=1.0, mean=0.07580611109733582
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.57s/it][A1it [00:01,  1.57s/it]
Loss: 0.00275:  51%|█████     | 102/201 [01:39<02:25,  1.47s/it]Loss: 0.00527:  51%|█████     | 102/201 [01:39<02:25,  1.47s/it]Loss: 0.00527:  51%|█████     | 103/201 [01:40<02:08,  1.31s/it]Loss: 0.00492:  51%|█████     | 103/201 [01:40<02:08,  1.31s/it]Loss: 0.00492:  52%|█████▏    | 104/201 [01:41<01:56,  1.20s/it]Loss: 0.00476:  52%|█████▏    | 104/201 [01:41<01:56,  1.20s/it]Loss: 0.00476:  52%|█████▏    | 105/201 [01:42<01:47,  1.12s/it]Loss: 0.00468:  52%|█████▏    | 105/201 [01:42<01:47,  1.12s/it]Loss: 0.00468:  53%|█████▎    | 106/201 [01:43<01:41,  1.07s/it]Loss: 0.00462:  53%|█████▎    | 106/201 [01:43<01:41,  1.07s/it]Loss: 0.00462:  53%|█████▎    | 107/201 [01:44<01:36,  1.03s/it]Loss: 0.00456:  53%|█████▎    | 107/201 [01:44<01:36,  1.03s/it]Loss: 0.00456:  54%|█████▎    | 108/201 [01:45<01:33,  1.00s/it]Loss: 0.00452:  54%|█████▎    | 108/201 [01:45<01:33,  1.00s/it]Loss: 0.00452:  54%|█████▍    | 109/201 [01:46<01:30,  1.02it/s]Loss: 0.00448:  54%|█████▍    | 109/201 [01:46<01:30,  1.02it/s]Loss: 0.00448:  55%|█████▍    | 110/201 [01:47<01:28,  1.03it/s]Loss: 0.00445:  55%|█████▍    | 110/201 [01:47<01:28,  1.03it/s]Loss: 0.00445:  55%|█████▌    | 111/201 [01:47<01:26,  1.04it/s]Loss: 0.00442:  55%|█████▌    | 111/201 [01:47<01:26,  1.04it/s]Loss: 0.00442:  56%|█████▌    | 112/201 [01:48<01:24,  1.05it/s]Loss: 0.00439:  56%|█████▌    | 112/201 [01:48<01:24,  1.05it/s]Loss: 0.00439:  56%|█████▌    | 113/201 [01:49<01:23,  1.05it/s]Loss: 0.00436:  56%|█████▌    | 113/201 [01:49<01:23,  1.05it/s]Loss: 0.00436:  57%|█████▋    | 114/201 [01:50<01:22,  1.06it/s]Loss: 0.00435:  57%|█████▋    | 114/201 [01:50<01:22,  1.06it/s]Loss: 0.00435:  57%|█████▋    | 115/201 [01:51<01:21,  1.06it/s]Loss: 0.00450:  57%|█████▋    | 115/201 [01:51<01:21,  1.06it/s]Loss: 0.00450:  58%|█████▊    | 116/201 [01:52<01:20,  1.06it/s]Loss: 0.00446:  58%|█████▊    | 116/201 [01:52<01:20,  1.06it/s]Loss: 0.00446:  58%|█████▊    | 117/201 [01:53<01:19,  1.06it/s]Loss: 0.00443:  58%|█████▊    | 117/201 [01:53<01:19,  1.06it/s]Loss: 0.00443:  59%|█████▊    | 118/201 [01:54<01:18,  1.06it/s]Loss: 0.00441:  59%|█████▊    | 118/201 [01:54<01:18,  1.06it/s]Loss: 0.00441:  59%|█████▉    | 119/201 [01:55<01:17,  1.06it/s]Loss: 0.00440:  59%|█████▉    | 119/201 [01:55<01:17,  1.06it/s]Loss: 0.00440:  60%|█████▉    | 120/201 [01:56<01:16,  1.06it/s]Loss: 0.00440:  60%|█████▉    | 120/201 [01:56<01:16,  1.06it/s]Loss: 0.00440:  60%|██████    | 121/201 [01:57<01:19,  1.01it/s]Loss: 0.00438:  60%|██████    | 121/201 [01:57<01:19,  1.01it/s]Loss: 0.00438:  61%|██████    | 122/201 [01:58<01:16,  1.03it/s]Loss: 0.00437:  61%|██████    | 122/201 [01:58<01:16,  1.03it/s]Loss: 0.00437:  61%|██████    | 123/201 [01:59<01:15,  1.04it/s]Loss: 0.00435:  61%|██████    | 123/201 [01:59<01:15,  1.04it/s]Loss: 0.00435:  62%|██████▏   | 124/201 [02:00<01:13,  1.04it/s]Loss: 0.00434:  62%|██████▏   | 124/201 [02:00<01:13,  1.04it/s]Loss: 0.00434:  62%|██████▏   | 125/201 [02:01<01:12,  1.05it/s]Loss: 0.00434:  62%|██████▏   | 125/201 [02:01<01:12,  1.05it/s]Loss: 0.00434:  63%|██████▎   | 126/201 [02:02<01:11,  1.05it/s]Loss: 0.00430:  63%|██████▎   | 126/201 [02:02<01:11,  1.05it/s]Loss: 0.00430:  63%|██████▎   | 127/201 [02:03<01:10,  1.06it/s]Loss: 0.00431:  63%|██████▎   | 127/201 [02:03<01:10,  1.06it/s]Loss: 0.00431:  64%|██████▎   | 128/201 [02:04<01:09,  1.06it/s]Loss: 0.00432:  64%|██████▎   | 128/201 [02:04<01:09,  1.06it/s]Loss: 0.00432:  64%|██████▍   | 129/201 [02:05<01:08,  1.06it/s]Loss: 0.00429:  64%|██████▍   | 129/201 [02:05<01:08,  1.06it/s]Loss: 0.00429:  65%|██████▍   | 130/201 [02:06<01:06,  1.06it/s]Loss: 0.00426:  65%|██████▍   | 130/201 [02:06<01:06,  1.06it/s]Loss: 0.00426:  65%|██████▌   | 131/201 [02:06<01:06,  1.06it/s]Loss: 0.00428:  65%|██████▌   | 131/201 [02:06<01:06,  1.06it/s]Loss: 0.00428:  66%|██████▌   | 132/201 [02:07<01:05,  1.06it/s]Loss: 0.00427:  66%|██████▌   | 132/201 [02:07<01:05,  1.06it/s]Loss: 0.00427:  66%|██████▌   | 133/201 [02:08<01:04,  1.06it/s]Loss: 0.00427:  66%|██████▌   | 133/201 [02:08<01:04,  1.06it/s]Loss: 0.00427:  67%|██████▋   | 134/201 [02:09<01:03,  1.06it/s]Loss: 0.00422:  67%|██████▋   | 134/201 [02:09<01:03,  1.06it/s]Loss: 0.00422:  67%|██████▋   | 135/201 [02:10<01:02,  1.06it/s]Loss: 0.00426:  67%|██████▋   | 135/201 [02:10<01:02,  1.06it/s]Loss: 0.00426:  68%|██████▊   | 136/201 [02:11<01:01,  1.06it/s]Loss: 0.00424:  68%|██████▊   | 136/201 [02:11<01:01,  1.06it/s]Loss: 0.00424:  68%|██████▊   | 137/201 [02:12<01:00,  1.06it/s]Loss: 0.00421:  68%|██████▊   | 137/201 [02:12<01:00,  1.06it/s]Loss: 0.00421:  69%|██████▊   | 138/201 [02:13<00:59,  1.06it/s]Loss: 0.00422:  69%|██████▊   | 138/201 [02:13<00:59,  1.06it/s]Loss: 0.00422:  69%|██████▉   | 139/201 [02:14<00:58,  1.06it/s]Loss: 0.00423:  69%|██████▉   | 139/201 [02:14<00:58,  1.06it/s]Loss: 0.00423:  70%|██████▉   | 140/201 [02:15<00:57,  1.06it/s]Loss: 0.00418:  70%|██████▉   | 140/201 [02:15<00:57,  1.06it/s]Loss: 0.00418:  70%|███████   | 141/201 [02:16<00:59,  1.01it/s]Loss: 0.00419:  70%|███████   | 141/201 [02:16<00:59,  1.01it/s]Loss: 0.00419:  71%|███████   | 142/201 [02:17<00:57,  1.03it/s]Loss: 0.00416:  71%|███████   | 142/201 [02:17<00:57,  1.03it/s]Loss: 0.00416:  71%|███████   | 143/201 [02:18<00:55,  1.04it/s]Loss: 0.00416:  71%|███████   | 143/201 [02:18<00:55,  1.04it/s]Loss: 0.00416:  72%|███████▏  | 144/201 [02:19<00:54,  1.05it/s]Loss: 0.00415:  72%|███████▏  | 144/201 [02:19<00:54,  1.05it/s]Loss: 0.00415:  72%|███████▏  | 145/201 [02:20<00:53,  1.05it/s]Loss: 0.00412:  72%|███████▏  | 145/201 [02:20<00:53,  1.05it/s]Loss: 0.00412:  73%|███████▎  | 146/201 [02:21<00:52,  1.05it/s]Loss: 0.00419:  73%|███████▎  | 146/201 [02:21<00:52,  1.05it/s]Loss: 0.00419:  73%|███████▎  | 147/201 [02:22<00:51,  1.06it/s]Loss: 0.00422:  73%|███████▎  | 147/201 [02:22<00:51,  1.06it/s]Loss: 0.00422:  74%|███████▎  | 148/201 [02:23<00:50,  1.06it/s]Loss: 0.00413:  74%|███████▎  | 148/201 [02:23<00:50,  1.06it/s]Loss: 0.00413:  74%|███████▍  | 149/201 [02:24<00:49,  1.06it/s]Loss: 0.00410:  74%|███████▍  | 149/201 [02:24<00:49,  1.06it/s]Loss: 0.00410:  75%|███████▍  | 150/201 [02:24<00:48,  1.06it/s]Loss: 0.00409:  75%|███████▍  | 150/201 [02:24<00:48,  1.06it/s]Loss: 0.00409:  75%|███████▌  | 151/201 [02:25<00:47,  1.06it/s]Loss: 0.00411:  75%|███████▌  | 151/201 [02:25<00:47,  1.06it/s]Loss: 0.00411:  76%|███████▌  | 152/201 [02:26<00:46,  1.06it/s]Loss: 0.00407:  76%|███████▌  | 152/201 [02:26<00:46,  1.06it/s]max loss: 0.09122703969478607
Densities: min=0.0, max=1.0, mean=0.17386411130428314
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.58s/it][A1it [00:01,  1.58s/it]
Loss: 0.00407:  76%|███████▌  | 153/201 [02:29<01:07,  1.41s/it]Loss: 0.00493:  76%|███████▌  | 153/201 [02:29<01:07,  1.41s/it]Loss: 0.00493:  77%|███████▋  | 154/201 [02:30<00:59,  1.27s/it]Loss: 0.00474:  77%|███████▋  | 154/201 [02:30<00:59,  1.27s/it]Loss: 0.00474:  77%|███████▋  | 155/201 [02:31<00:53,  1.17s/it]Loss: 0.00467:  77%|███████▋  | 155/201 [02:31<00:53,  1.17s/it]Loss: 0.00467:  78%|███████▊  | 156/201 [02:32<00:49,  1.10s/it]Loss: 0.00463:  78%|███████▊  | 156/201 [02:32<00:49,  1.10s/it]Loss: 0.00463:  78%|███████▊  | 157/201 [02:33<00:46,  1.05s/it]Loss: 0.00462:  78%|███████▊  | 157/201 [02:33<00:46,  1.05s/it]Loss: 0.00462:  79%|███████▊  | 158/201 [02:34<00:43,  1.01s/it]Loss: 0.00460:  79%|███████▊  | 158/201 [02:34<00:43,  1.01s/it]Loss: 0.00460:  79%|███████▉  | 159/201 [02:34<00:41,  1.01it/s]Loss: 0.00457:  79%|███████▉  | 159/201 [02:34<00:41,  1.01it/s]Loss: 0.00457:  80%|███████▉  | 160/201 [02:35<00:39,  1.03it/s]Loss: 0.00453:  80%|███████▉  | 160/201 [02:35<00:39,  1.03it/s]Loss: 0.00453:  80%|████████  | 161/201 [02:37<00:40,  1.01s/it]Loss: 0.00456:  80%|████████  | 161/201 [02:37<00:40,  1.01s/it]Loss: 0.00456:  81%|████████  | 162/201 [02:37<00:38,  1.02it/s]Loss: 0.00448:  81%|████████  | 162/201 [02:37<00:38,  1.02it/s]Loss: 0.00448:  81%|████████  | 163/201 [02:38<00:36,  1.03it/s]Loss: 0.00456:  81%|████████  | 163/201 [02:38<00:36,  1.03it/s]Loss: 0.00456:  82%|████████▏ | 164/201 [02:39<00:35,  1.04it/s]Loss: 0.00449:  82%|████████▏ | 164/201 [02:39<00:35,  1.04it/s]Loss: 0.00449:  82%|████████▏ | 165/201 [02:40<00:34,  1.05it/s]Loss: 0.00442:  82%|████████▏ | 165/201 [02:40<00:34,  1.05it/s]Loss: 0.00442:  83%|████████▎ | 166/201 [02:41<00:33,  1.06it/s]Loss: 0.00449:  83%|████████▎ | 166/201 [02:41<00:33,  1.06it/s]Loss: 0.00449:  83%|████████▎ | 167/201 [02:42<00:31,  1.06it/s]Loss: 0.00444:  83%|████████▎ | 167/201 [02:42<00:31,  1.06it/s]Loss: 0.00444:  84%|████████▎ | 168/201 [02:43<00:30,  1.07it/s]Loss: 0.00441:  84%|████████▎ | 168/201 [02:43<00:30,  1.07it/s]Loss: 0.00441:  84%|████████▍ | 169/201 [02:44<00:29,  1.07it/s]Loss: 0.00440:  84%|████████▍ | 169/201 [02:44<00:29,  1.07it/s]Loss: 0.00440:  85%|████████▍ | 170/201 [02:45<00:28,  1.07it/s]Loss: 0.00440:  85%|████████▍ | 170/201 [02:45<00:28,  1.07it/s]Loss: 0.00440:  85%|████████▌ | 171/201 [02:46<00:28,  1.07it/s]Loss: 0.00438:  85%|████████▌ | 171/201 [02:46<00:28,  1.07it/s]Loss: 0.00438:  86%|████████▌ | 172/201 [02:47<00:27,  1.07it/s]Loss: 0.00433:  86%|████████▌ | 172/201 [02:47<00:27,  1.07it/s]Loss: 0.00433:  86%|████████▌ | 173/201 [02:48<00:26,  1.07it/s]Loss: 0.00436:  86%|████████▌ | 173/201 [02:48<00:26,  1.07it/s]Loss: 0.00436:  87%|████████▋ | 174/201 [02:49<00:25,  1.07it/s]Loss: 0.00438:  87%|████████▋ | 174/201 [02:49<00:25,  1.07it/s]Loss: 0.00438:  87%|████████▋ | 175/201 [02:50<00:24,  1.07it/s]Loss: 0.00437:  87%|████████▋ | 175/201 [02:50<00:24,  1.07it/s]Loss: 0.00437:  88%|████████▊ | 176/201 [02:50<00:23,  1.07it/s]Loss: 0.00433:  88%|████████▊ | 176/201 [02:50<00:23,  1.07it/s]Loss: 0.00433:  88%|████████▊ | 177/201 [02:51<00:22,  1.07it/s]Loss: 0.00432:  88%|████████▊ | 177/201 [02:51<00:22,  1.07it/s]Loss: 0.00432:  89%|████████▊ | 178/201 [02:52<00:21,  1.07it/s]Loss: 0.00426:  89%|████████▊ | 178/201 [02:52<00:21,  1.07it/s]Loss: 0.00426:  89%|████████▉ | 179/201 [02:53<00:20,  1.07it/s]Loss: 0.00430:  89%|████████▉ | 179/201 [02:53<00:20,  1.07it/s]Loss: 0.00430:  90%|████████▉ | 180/201 [02:54<00:19,  1.07it/s]Loss: 0.00436:  90%|████████▉ | 180/201 [02:54<00:19,  1.07it/s]Loss: 0.00436:  90%|█████████ | 181/201 [02:55<00:19,  1.02it/s]Loss: 0.00434:  90%|█████████ | 181/201 [02:55<00:19,  1.02it/s]Loss: 0.00434:  91%|█████████ | 182/201 [02:56<00:18,  1.04it/s]Loss: 0.00425:  91%|█████████ | 182/201 [02:56<00:18,  1.04it/s]Loss: 0.00425:  91%|█████████ | 183/201 [02:57<00:17,  1.05it/s]Loss: 0.00423:  91%|█████████ | 183/201 [02:57<00:17,  1.05it/s]Loss: 0.00423:  92%|█████████▏| 184/201 [02:58<00:16,  1.06it/s]Loss: 0.00427:  92%|█████████▏| 184/201 [02:58<00:16,  1.06it/s]Loss: 0.00427:  92%|█████████▏| 185/201 [02:59<00:15,  1.06it/s]Loss: 0.00426:  92%|█████████▏| 185/201 [02:59<00:15,  1.06it/s]Loss: 0.00426:  93%|█████████▎| 186/201 [03:00<00:14,  1.07it/s]Loss: 0.00424:  93%|█████████▎| 186/201 [03:00<00:14,  1.07it/s]Loss: 0.00424:  93%|█████████▎| 187/201 [03:01<00:13,  1.07it/s]Loss: 0.00424:  93%|█████████▎| 187/201 [03:01<00:13,  1.07it/s]Loss: 0.00424:  94%|█████████▎| 188/201 [03:02<00:12,  1.07it/s]Loss: 0.00422:  94%|█████████▎| 188/201 [03:02<00:12,  1.07it/s]Loss: 0.00422:  94%|█████████▍| 189/201 [03:03<00:11,  1.07it/s]Loss: 0.00422:  94%|█████████▍| 189/201 [03:03<00:11,  1.07it/s]Loss: 0.00422:  95%|█████████▍| 190/201 [03:04<00:10,  1.07it/s]Loss: 0.00419:  95%|█████████▍| 190/201 [03:04<00:10,  1.07it/s]Loss: 0.00419:  95%|█████████▌| 191/201 [03:05<00:09,  1.07it/s]Loss: 0.00421:  95%|█████████▌| 191/201 [03:05<00:09,  1.07it/s]Loss: 0.00421:  96%|█████████▌| 192/201 [03:06<00:08,  1.07it/s]Loss: 0.00425:  96%|█████████▌| 192/201 [03:06<00:08,  1.07it/s]Loss: 0.00425:  96%|█████████▌| 193/201 [03:06<00:07,  1.07it/s]Loss: 0.00420:  96%|█████████▌| 193/201 [03:06<00:07,  1.07it/s]Loss: 0.00420:  97%|█████████▋| 194/201 [03:07<00:06,  1.07it/s]Loss: 0.00419:  97%|█████████▋| 194/201 [03:07<00:06,  1.07it/s]Loss: 0.00419:  97%|█████████▋| 195/201 [03:08<00:05,  1.07it/s]Loss: 0.00414:  97%|█████████▋| 195/201 [03:08<00:05,  1.07it/s]Loss: 0.00414:  98%|█████████▊| 196/201 [03:09<00:04,  1.07it/s]Loss: 0.00416:  98%|█████████▊| 196/201 [03:09<00:04,  1.07it/s]Loss: 0.00416:  98%|█████████▊| 197/201 [03:10<00:03,  1.07it/s]Loss: 0.00420:  98%|█████████▊| 197/201 [03:10<00:03,  1.07it/s]Loss: 0.00420:  99%|█████████▊| 198/201 [03:11<00:02,  1.07it/s]Loss: 0.00416:  99%|█████████▊| 198/201 [03:11<00:02,  1.07it/s]Loss: 0.00416:  99%|█████████▉| 199/201 [03:12<00:01,  1.07it/s]Loss: 0.00416:  99%|█████████▉| 199/201 [03:12<00:01,  1.07it/s]Loss: 0.00416: 100%|█████████▉| 200/201 [03:13<00:00,  1.07it/s]Loss: 0.00414: 100%|█████████▉| 200/201 [03:13<00:00,  1.07it/s]Loss: 0.00414: 100%|██████████| 201/201 [03:14<00:00,  1.02it/s]Loss: 0.00376: 100%|██████████| 201/201 [03:14<00:00,  1.02it/s]Loss: 0.00376: 100%|██████████| 201/201 [03:14<00:00,  1.03it/s]Load volume "/media/storage0/qadwu/floats/chameleon_1024x1024x1080_float32_raw_1024x1024x1080_float.cvol"
Loaded

max loss: 0.06194005534052849
Densities: min=0.0, max=1.0, mean=0.1875186562538147
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 194.55755305290222 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json
Latent space memory: 57.4MiB
Latent space memory: 57.4MiB
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/chameleon_1024x1024x1080_float32_raw_1024x1024x1080_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 8, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 3, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 14992896
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  2.94it/s]1it [00:00,  2.94it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.3309516906738281
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.69it/s]Render: : 1it [00:00,  2.69it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1024, 1024, 1080], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/chameleon-20220916174935-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 8, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 3}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<01:35,  2.09it/s]Loss: 0.10120:   0%|          | 1/201 [00:00<01:35,  2.09it/s]Loss: 0.10120:   1%|          | 2/201 [00:00<01:16,  2.61it/s]Loss: 0.02228:   1%|          | 2/201 [00:00<01:16,  2.61it/s]Loss: 0.02228:   1%|▏         | 3/201 [00:01<01:10,  2.83it/s]Loss: 0.01461:   1%|▏         | 3/201 [00:01<01:10,  2.83it/s]Loss: 0.01461:   2%|▏         | 4/201 [00:01<01:06,  2.94it/s]Loss: 0.01193:   2%|▏         | 4/201 [00:01<01:06,  2.94it/s]Loss: 0.01193:   2%|▏         | 5/201 [00:01<01:05,  3.01it/s]Loss: 0.01119:   2%|▏         | 5/201 [00:01<01:05,  3.01it/s]Loss: 0.01119:   3%|▎         | 6/201 [00:02<01:03,  3.05it/s]Loss: 0.01188:   3%|▎         | 6/201 [00:02<01:03,  3.05it/s]Loss: 0.01188:   3%|▎         | 7/201 [00:02<01:02,  3.08it/s]Loss: 0.01200:   3%|▎         | 7/201 [00:02<01:02,  3.08it/s]Loss: 0.01200:   4%|▍         | 8/201 [00:02<01:02,  3.10it/s]Loss: 0.01218:   4%|▍         | 8/201 [00:02<01:02,  3.10it/s]Loss: 0.01218:   4%|▍         | 9/201 [00:03<01:01,  3.11it/s]Loss: 0.01018:   4%|▍         | 9/201 [00:03<01:01,  3.11it/s]Loss: 0.01018:   5%|▍         | 10/201 [00:03<01:01,  3.12it/s]Loss: 0.00987:   5%|▍         | 10/201 [00:03<01:01,  3.12it/s]Loss: 0.00987:   5%|▌         | 11/201 [00:03<01:00,  3.12it/s]Loss: 0.01018:   5%|▌         | 11/201 [00:03<01:00,  3.12it/s]Loss: 0.01018:   6%|▌         | 12/201 [00:03<01:00,  3.13it/s]Loss: 0.01013:   6%|▌         | 12/201 [00:03<01:00,  3.13it/s]Loss: 0.01013:   6%|▋         | 13/201 [00:04<01:00,  3.13it/s]Loss: 0.00895:   6%|▋         | 13/201 [00:04<01:00,  3.13it/s]Loss: 0.00895:   7%|▋         | 14/201 [00:04<00:59,  3.13it/s]Loss: 0.00932:   7%|▋         | 14/201 [00:04<00:59,  3.13it/s]Loss: 0.00932:   7%|▋         | 15/201 [00:04<00:59,  3.14it/s]Loss: 0.00930:   7%|▋         | 15/201 [00:04<00:59,  3.14it/s]Loss: 0.00930:   8%|▊         | 16/201 [00:05<00:58,  3.14it/s]Loss: 0.00932:   8%|▊         | 16/201 [00:05<00:58,  3.14it/s]Loss: 0.00932:   8%|▊         | 17/201 [00:05<00:58,  3.14it/s]Loss: 0.00895:   8%|▊         | 17/201 [00:05<00:58,  3.14it/s]Loss: 0.00895:   9%|▉         | 18/201 [00:05<00:58,  3.14it/s]Loss: 0.01036:   9%|▉         | 18/201 [00:05<00:58,  3.14it/s]Loss: 0.01036:   9%|▉         | 19/201 [00:06<00:58,  3.14it/s]Loss: 0.00826:   9%|▉         | 19/201 [00:06<00:58,  3.14it/s]Loss: 0.00826:  10%|▉         | 20/201 [00:06<00:57,  3.14it/s]Loss: 0.00801:  10%|▉         | 20/201 [00:06<00:57,  3.14it/s]Loss: 0.00801:  10%|█         | 21/201 [00:07<01:05,  2.75it/s]Loss: 0.00712:  10%|█         | 21/201 [00:07<01:05,  2.75it/s]Loss: 0.00712:  11%|█         | 22/201 [00:07<01:02,  2.86it/s]Loss: 0.00719:  11%|█         | 22/201 [00:07<01:02,  2.86it/s]Loss: 0.00719:  11%|█▏        | 23/201 [00:07<01:00,  2.94it/s]Loss: 0.00686:  11%|█▏        | 23/201 [00:07<01:00,  2.94it/s]Loss: 0.00686:  12%|█▏        | 24/201 [00:07<00:59,  3.00it/s]Loss: 0.01185:  12%|█▏        | 24/201 [00:07<00:59,  3.00it/s]Loss: 0.01185:  12%|█▏        | 25/201 [00:08<00:57,  3.04it/s]Loss: 0.01024:  12%|█▏        | 25/201 [00:08<00:57,  3.04it/s]Loss: 0.01024:  13%|█▎        | 26/201 [00:08<00:57,  3.07it/s]Loss: 0.00867:  13%|█▎        | 26/201 [00:08<00:57,  3.07it/s]Loss: 0.00867:  13%|█▎        | 27/201 [00:08<00:56,  3.09it/s]Loss: 0.01033:  13%|█▎        | 27/201 [00:08<00:56,  3.09it/s]Loss: 0.01033:  14%|█▍        | 28/201 [00:09<00:55,  3.10it/s]Loss: 0.01311:  14%|█▍        | 28/201 [00:09<00:55,  3.10it/s]Loss: 0.01311:  14%|█▍        | 29/201 [00:09<00:55,  3.11it/s]Loss: 0.02319:  14%|█▍        | 29/201 [00:09<00:55,  3.11it/s]Loss: 0.02319:  15%|█▍        | 30/201 [00:09<00:54,  3.12it/s]Loss: 0.01843:  15%|█▍        | 30/201 [00:09<00:54,  3.12it/s]Loss: 0.01843:  15%|█▌        | 31/201 [00:10<00:54,  3.13it/s]Loss: 0.00690:  15%|█▌        | 31/201 [00:10<00:54,  3.13it/s]Loss: 0.00690:  16%|█▌        | 32/201 [00:10<00:54,  3.13it/s]Loss: 0.00592:  16%|█▌        | 32/201 [00:10<00:54,  3.13it/s]Loss: 0.00592:  16%|█▋        | 33/201 [00:10<00:53,  3.13it/s]Loss: 0.00737:  16%|█▋        | 33/201 [00:10<00:53,  3.13it/s]Loss: 0.00737:  17%|█▋        | 34/201 [00:11<00:53,  3.13it/s]Loss: 0.00655:  17%|█▋        | 34/201 [00:11<00:53,  3.13it/s]Loss: 0.00655:  17%|█▋        | 35/201 [00:11<00:52,  3.13it/s]Loss: 0.00717:  17%|█▋        | 35/201 [00:11<00:52,  3.13it/s]Loss: 0.00717:  18%|█▊        | 36/201 [00:11<00:52,  3.14it/s]Loss: 0.01185:  18%|█▊        | 36/201 [00:11<00:52,  3.14it/s]Loss: 0.01185:  18%|█▊        | 37/201 [00:12<00:52,  3.14it/s]Loss: 0.00933:  18%|█▊        | 37/201 [00:12<00:52,  3.14it/s]Loss: 0.00933:  19%|█▉        | 38/201 [00:12<00:51,  3.14it/s]Loss: 0.00676:  19%|█▉        | 38/201 [00:12<00:51,  3.14it/s]Loss: 0.00676:  19%|█▉        | 39/201 [00:12<00:51,  3.14it/s]Loss: 0.00720:  19%|█▉        | 39/201 [00:12<00:51,  3.14it/s]Loss: 0.00720:  20%|█▉        | 40/201 [00:13<00:51,  3.14it/s]Loss: 0.00608:  20%|█▉        | 40/201 [00:13<00:51,  3.14it/s]Loss: 0.00608:  20%|██        | 41/201 [00:13<00:58,  2.74it/s]Loss: 0.00560:  20%|██        | 41/201 [00:13<00:58,  2.74it/s]Loss: 0.00560:  21%|██        | 42/201 [00:13<00:55,  2.86it/s]Loss: 0.00561:  21%|██        | 42/201 [00:13<00:55,  2.86it/s]Loss: 0.00561:  21%|██▏       | 43/201 [00:14<00:53,  2.94it/s]Loss: 0.00562:  21%|██▏       | 43/201 [00:14<00:53,  2.94it/s]Loss: 0.00562:  22%|██▏       | 44/201 [00:14<00:52,  3.00it/s]Loss: 0.00562:  22%|██▏       | 44/201 [00:14<00:52,  3.00it/s]Loss: 0.00562:  22%|██▏       | 45/201 [00:14<00:51,  3.04it/s]Loss: 0.00537:  22%|██▏       | 45/201 [00:14<00:51,  3.04it/s]Loss: 0.00537:  23%|██▎       | 46/201 [00:15<00:50,  3.07it/s]Loss: 0.00527:  23%|██▎       | 46/201 [00:15<00:50,  3.07it/s]Loss: 0.00527:  23%|██▎       | 47/201 [00:15<00:49,  3.09it/s]Loss: 0.00546:  23%|██▎       | 47/201 [00:15<00:49,  3.09it/s]Loss: 0.00546:  24%|██▍       | 48/201 [00:15<00:49,  3.10it/s]Loss: 0.00538:  24%|██▍       | 48/201 [00:15<00:49,  3.10it/s]Loss: 0.00538:  24%|██▍       | 49/201 [00:16<00:48,  3.11it/s]Loss: 0.00963:  24%|██▍       | 49/201 [00:16<00:48,  3.11it/s]Loss: 0.00963:  25%|██▍       | 50/201 [00:16<00:48,  3.11it/s]Loss: 0.01066:  25%|██▍       | 50/201 [00:16<00:48,  3.11it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.20s/it][A1it [00:01,  1.20s/it]
Loss: 0.01066:  25%|██▌       | 51/201 [00:17<01:42,  1.46it/s]Loss: 0.00577:  25%|██▌       | 51/201 [00:17<01:42,  1.46it/s]Loss: 0.00577:  26%|██▌       | 52/201 [00:18<01:25,  1.74it/s]Loss: 0.00446:  26%|██▌       | 52/201 [00:18<01:25,  1.74it/s]Loss: 0.00446:  26%|██▋       | 53/201 [00:18<01:13,  2.01it/s]Loss: 0.00391:  26%|██▋       | 53/201 [00:18<01:13,  2.01it/s]Loss: 0.00391:  27%|██▋       | 54/201 [00:18<01:05,  2.25it/s]Loss: 0.00359:  27%|██▋       | 54/201 [00:18<01:05,  2.25it/s]Loss: 0.00359:  27%|██▋       | 55/201 [00:19<00:59,  2.45it/s]Loss: 0.00334:  27%|██▋       | 55/201 [00:19<00:59,  2.45it/s]Loss: 0.00334:  28%|██▊       | 56/201 [00:19<00:55,  2.62it/s]Loss: 0.00317:  28%|██▊       | 56/201 [00:19<00:55,  2.62it/s]Loss: 0.00317:  28%|██▊       | 57/201 [00:19<00:52,  2.75it/s]Loss: 0.00300:  28%|██▊       | 57/201 [00:19<00:52,  2.75it/s]Loss: 0.00300:  29%|██▉       | 58/201 [00:20<00:50,  2.86it/s]Loss: 0.00289:  29%|██▉       | 58/201 [00:20<00:50,  2.86it/s]Loss: 0.00289:  29%|██▉       | 59/201 [00:20<00:48,  2.93it/s]Loss: 0.00283:  29%|██▉       | 59/201 [00:20<00:48,  2.93it/s]Loss: 0.00283:  30%|██▉       | 60/201 [00:20<00:47,  2.99it/s]Loss: 0.00278:  30%|██▉       | 60/201 [00:20<00:47,  2.99it/s]Loss: 0.00278:  30%|███       | 61/201 [00:21<00:52,  2.66it/s]Loss: 0.00292:  30%|███       | 61/201 [00:21<00:52,  2.66it/s]Loss: 0.00292:  31%|███       | 62/201 [00:21<00:49,  2.79it/s]Loss: 0.00278:  31%|███       | 62/201 [00:21<00:49,  2.79it/s]Loss: 0.00278:  31%|███▏      | 63/201 [00:21<00:47,  2.88it/s]Loss: 0.00270:  31%|███▏      | 63/201 [00:21<00:47,  2.88it/s]Loss: 0.00270:  32%|███▏      | 64/201 [00:22<00:46,  2.95it/s]Loss: 0.00268:  32%|███▏      | 64/201 [00:22<00:46,  2.95it/s]Loss: 0.00268:  32%|███▏      | 65/201 [00:22<00:45,  3.00it/s]Loss: 0.00261:  32%|███▏      | 65/201 [00:22<00:45,  3.00it/s]Loss: 0.00261:  33%|███▎      | 66/201 [00:22<00:44,  3.03it/s]Loss: 0.00274:  33%|███▎      | 66/201 [00:22<00:44,  3.03it/s]Loss: 0.00274:  33%|███▎      | 67/201 [00:23<00:43,  3.06it/s]Loss: 0.00258:  33%|███▎      | 67/201 [00:23<00:43,  3.06it/s]Loss: 0.00258:  34%|███▍      | 68/201 [00:23<00:43,  3.08it/s]Loss: 0.00270:  34%|███▍      | 68/201 [00:23<00:43,  3.08it/s]Loss: 0.00270:  34%|███▍      | 69/201 [00:23<00:42,  3.09it/s]Loss: 0.00267:  34%|███▍      | 69/201 [00:23<00:42,  3.09it/s]Loss: 0.00267:  35%|███▍      | 70/201 [00:24<00:42,  3.10it/s]Loss: 0.00263:  35%|███▍      | 70/201 [00:24<00:42,  3.10it/s]Loss: 0.00263:  35%|███▌      | 71/201 [00:24<00:41,  3.11it/s]Loss: 0.00265:  35%|███▌      | 71/201 [00:24<00:41,  3.11it/s]Loss: 0.00265:  36%|███▌      | 72/201 [00:24<00:41,  3.11it/s]Loss: 0.00265:  36%|███▌      | 72/201 [00:24<00:41,  3.11it/s]Loss: 0.00265:  36%|███▋      | 73/201 [00:25<00:41,  3.11it/s]Loss: 0.00260:  36%|███▋      | 73/201 [00:25<00:41,  3.11it/s]Loss: 0.00260:  37%|███▋      | 74/201 [00:25<00:40,  3.12it/s]Loss: 0.00256:  37%|███▋      | 74/201 [00:25<00:40,  3.12it/s]Loss: 0.00256:  37%|███▋      | 75/201 [00:25<00:40,  3.12it/s]Loss: 0.00261:  37%|███▋      | 75/201 [00:25<00:40,  3.12it/s]Loss: 0.00261:  38%|███▊      | 76/201 [00:26<00:40,  3.12it/s]Loss: 0.00281:  38%|███▊      | 76/201 [00:26<00:40,  3.12it/s]Loss: 0.00281:  38%|███▊      | 77/201 [00:26<00:39,  3.12it/s]Loss: 0.00279:  38%|███▊      | 77/201 [00:26<00:39,  3.12it/s]Loss: 0.00279:  39%|███▉      | 78/201 [00:26<00:39,  3.12it/s]Loss: 0.00267:  39%|███▉      | 78/201 [00:26<00:39,  3.12it/s]Loss: 0.00267:  39%|███▉      | 79/201 [00:27<00:39,  3.12it/s]Loss: 0.00265:  39%|███▉      | 79/201 [00:27<00:39,  3.12it/s]Loss: 0.00265:  40%|███▉      | 80/201 [00:27<00:38,  3.12it/s]Loss: 0.00277:  40%|███▉      | 80/201 [00:27<00:38,  3.12it/s]Loss: 0.00277:  40%|████      | 81/201 [00:27<00:43,  2.74it/s]Loss: 0.00267:  40%|████      | 81/201 [00:27<00:43,  2.74it/s]Loss: 0.00267:  41%|████      | 82/201 [00:28<00:41,  2.85it/s]Loss: 0.00274:  41%|████      | 82/201 [00:28<00:41,  2.85it/s]Loss: 0.00274:  41%|████▏     | 83/201 [00:28<00:40,  2.93it/s]Loss: 0.00257:  41%|████▏     | 83/201 [00:28<00:40,  2.93it/s]Loss: 0.00257:  42%|████▏     | 84/201 [00:28<00:39,  2.98it/s]Loss: 0.00267:  42%|████▏     | 84/201 [00:28<00:39,  2.98it/s]Loss: 0.00267:  42%|████▏     | 85/201 [00:29<00:38,  3.02it/s]Loss: 0.00274:  42%|████▏     | 85/201 [00:29<00:38,  3.02it/s]Loss: 0.00274:  43%|████▎     | 86/201 [00:29<00:37,  3.05it/s]Loss: 0.00336:  43%|████▎     | 86/201 [00:29<00:37,  3.05it/s]Loss: 0.00336:  43%|████▎     | 87/201 [00:29<00:37,  3.07it/s]Loss: 0.00267:  43%|████▎     | 87/201 [00:29<00:37,  3.07it/s]Loss: 0.00267:  44%|████▍     | 88/201 [00:30<00:36,  3.09it/s]Loss: 0.00283:  44%|████▍     | 88/201 [00:30<00:36,  3.09it/s]Loss: 0.00283:  44%|████▍     | 89/201 [00:30<00:36,  3.10it/s]Loss: 0.00271:  44%|████▍     | 89/201 [00:30<00:36,  3.10it/s]Loss: 0.00271:  45%|████▍     | 90/201 [00:30<00:35,  3.10it/s]Loss: 0.00268:  45%|████▍     | 90/201 [00:30<00:35,  3.10it/s]Loss: 0.00268:  45%|████▌     | 91/201 [00:31<00:35,  3.11it/s]Loss: 0.00298:  45%|████▌     | 91/201 [00:31<00:35,  3.11it/s]Loss: 0.00298:  46%|████▌     | 92/201 [00:31<00:35,  3.11it/s]Loss: 0.00269:  46%|████▌     | 92/201 [00:31<00:35,  3.11it/s]Loss: 0.00269:  46%|████▋     | 93/201 [00:31<00:34,  3.11it/s]Loss: 0.00283:  46%|████▋     | 93/201 [00:31<00:34,  3.11it/s]Loss: 0.00283:  47%|████▋     | 94/201 [00:31<00:34,  3.12it/s]Loss: 0.00275:  47%|████▋     | 94/201 [00:31<00:34,  3.12it/s]Loss: 0.00275:  47%|████▋     | 95/201 [00:32<00:33,  3.12it/s]Loss: 0.00270:  47%|████▋     | 95/201 [00:32<00:33,  3.12it/s]Loss: 0.00270:  48%|████▊     | 96/201 [00:32<00:33,  3.12it/s]Loss: 0.00286:  48%|████▊     | 96/201 [00:32<00:33,  3.12it/s]Loss: 0.00286:  48%|████▊     | 97/201 [00:32<00:33,  3.12it/s]Loss: 0.00281:  48%|████▊     | 97/201 [00:32<00:33,  3.12it/s]Loss: 0.00281:  49%|████▉     | 98/201 [00:33<00:32,  3.12it/s]Loss: 0.00276:  49%|████▉     | 98/201 [00:33<00:32,  3.12it/s]Loss: 0.00276:  49%|████▉     | 99/201 [00:33<00:32,  3.12it/s]Loss: 0.00291:  49%|████▉     | 99/201 [00:33<00:32,  3.12it/s]Loss: 0.00291:  50%|████▉     | 100/201 [00:33<00:32,  3.12it/s]Loss: 0.00302:  50%|████▉     | 100/201 [00:33<00:32,  3.12it/s]Loss: 0.00302:  50%|█████     | 101/201 [00:34<00:36,  2.74it/s]Loss: 0.00219:  50%|█████     | 101/201 [00:34<00:36,  2.74it/s]max loss: 0.10924012959003448
Densities: min=0.0, max=1.0, mean=0.16825062036514282
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.34s/it][A1it [00:01,  1.34s/it]
Loss: 0.00219:  51%|█████     | 102/201 [00:36<01:14,  1.32it/s]Loss: 0.00392:  51%|█████     | 102/201 [00:36<01:14,  1.32it/s]Loss: 0.00392:  51%|█████     | 103/201 [00:36<01:01,  1.60it/s]Loss: 0.00338:  51%|█████     | 103/201 [00:36<01:01,  1.60it/s]Loss: 0.00338:  52%|█████▏    | 104/201 [00:36<00:51,  1.87it/s]Loss: 0.00310:  52%|█████▏    | 104/201 [00:36<00:51,  1.87it/s]Loss: 0.00310:  52%|█████▏    | 105/201 [00:37<00:45,  2.12it/s]Loss: 0.00291:  52%|█████▏    | 105/201 [00:37<00:45,  2.12it/s]Loss: 0.00291:  53%|█████▎    | 106/201 [00:37<00:40,  2.35it/s]Loss: 0.00276:  53%|█████▎    | 106/201 [00:37<00:40,  2.35it/s]Loss: 0.00276:  53%|█████▎    | 107/201 [00:37<00:37,  2.54it/s]Loss: 0.00265:  53%|█████▎    | 107/201 [00:37<00:37,  2.54it/s]Loss: 0.00265:  54%|█████▎    | 108/201 [00:37<00:34,  2.69it/s]Loss: 0.00255:  54%|█████▎    | 108/201 [00:37<00:34,  2.69it/s]Loss: 0.00255:  54%|█████▍    | 109/201 [00:38<00:32,  2.80it/s]Loss: 0.00247:  54%|█████▍    | 109/201 [00:38<00:32,  2.80it/s]Loss: 0.00247:  55%|█████▍    | 110/201 [00:38<00:31,  2.89it/s]Loss: 0.00241:  55%|█████▍    | 110/201 [00:38<00:31,  2.89it/s]Loss: 0.00241:  55%|█████▌    | 111/201 [00:38<00:30,  2.96it/s]Loss: 0.00236:  55%|█████▌    | 111/201 [00:38<00:30,  2.96it/s]Loss: 0.00236:  56%|█████▌    | 112/201 [00:39<00:29,  3.00it/s]Loss: 0.00230:  56%|█████▌    | 112/201 [00:39<00:29,  3.00it/s]Loss: 0.00230:  56%|█████▌    | 113/201 [00:39<00:28,  3.04it/s]Loss: 0.00225:  56%|█████▌    | 113/201 [00:39<00:28,  3.04it/s]Loss: 0.00225:  57%|█████▋    | 114/201 [00:39<00:28,  3.06it/s]Loss: 0.00222:  57%|█████▋    | 114/201 [00:39<00:28,  3.06it/s]Loss: 0.00222:  57%|█████▋    | 115/201 [00:40<00:27,  3.08it/s]Loss: 0.00220:  57%|█████▋    | 115/201 [00:40<00:27,  3.08it/s]Loss: 0.00220:  58%|█████▊    | 116/201 [00:40<00:27,  3.09it/s]Loss: 0.00217:  58%|█████▊    | 116/201 [00:40<00:27,  3.09it/s]Loss: 0.00217:  58%|█████▊    | 117/201 [00:40<00:27,  3.10it/s]Loss: 0.00214:  58%|█████▊    | 117/201 [00:40<00:27,  3.10it/s]Loss: 0.00214:  59%|█████▊    | 118/201 [00:41<00:26,  3.11it/s]Loss: 0.00219:  59%|█████▊    | 118/201 [00:41<00:26,  3.11it/s]Loss: 0.00219:  59%|█████▉    | 119/201 [00:41<00:26,  3.11it/s]Loss: 0.00217:  59%|█████▉    | 119/201 [00:41<00:26,  3.11it/s]Loss: 0.00217:  60%|█████▉    | 120/201 [00:41<00:26,  3.11it/s]Loss: 0.00224:  60%|█████▉    | 120/201 [00:41<00:26,  3.11it/s]Loss: 0.00224:  60%|██████    | 121/201 [00:42<00:29,  2.73it/s]Loss: 0.00219:  60%|██████    | 121/201 [00:42<00:29,  2.73it/s]Loss: 0.00219:  61%|██████    | 122/201 [00:42<00:27,  2.84it/s]Loss: 0.00212:  61%|██████    | 122/201 [00:42<00:27,  2.84it/s]Loss: 0.00212:  61%|██████    | 123/201 [00:42<00:26,  2.92it/s]Loss: 0.00224:  61%|██████    | 123/201 [00:42<00:26,  2.92it/s]Loss: 0.00224:  62%|██████▏   | 124/201 [00:43<00:25,  2.97it/s]Loss: 0.00211:  62%|██████▏   | 124/201 [00:43<00:25,  2.97it/s]Loss: 0.00211:  62%|██████▏   | 125/201 [00:43<00:25,  3.01it/s]Loss: 0.00211:  62%|██████▏   | 125/201 [00:43<00:25,  3.01it/s]Loss: 0.00211:  63%|██████▎   | 126/201 [00:43<00:24,  3.04it/s]Loss: 0.00212:  63%|██████▎   | 126/201 [00:43<00:24,  3.04it/s]Loss: 0.00212:  63%|██████▎   | 127/201 [00:44<00:24,  3.06it/s]Loss: 0.00210:  63%|██████▎   | 127/201 [00:44<00:24,  3.06it/s]Loss: 0.00210:  64%|██████▎   | 128/201 [00:44<00:23,  3.08it/s]Loss: 0.00212:  64%|██████▎   | 128/201 [00:44<00:23,  3.08it/s]Loss: 0.00212:  64%|██████▍   | 129/201 [00:44<00:23,  3.09it/s]Loss: 0.00212:  64%|██████▍   | 129/201 [00:44<00:23,  3.09it/s]Loss: 0.00212:  65%|██████▍   | 130/201 [00:45<00:22,  3.10it/s]Loss: 0.00213:  65%|██████▍   | 130/201 [00:45<00:22,  3.10it/s]Loss: 0.00213:  65%|██████▌   | 131/201 [00:45<00:22,  3.10it/s]Loss: 0.00224:  65%|██████▌   | 131/201 [00:45<00:22,  3.10it/s]Loss: 0.00224:  66%|██████▌   | 132/201 [00:45<00:22,  3.11it/s]Loss: 0.00219:  66%|██████▌   | 132/201 [00:45<00:22,  3.11it/s]Loss: 0.00219:  66%|██████▌   | 133/201 [00:46<00:21,  3.11it/s]Loss: 0.00208:  66%|██████▌   | 133/201 [00:46<00:21,  3.11it/s]Loss: 0.00208:  67%|██████▋   | 134/201 [00:46<00:21,  3.11it/s]Loss: 0.00203:  67%|██████▋   | 134/201 [00:46<00:21,  3.11it/s]Loss: 0.00203:  67%|██████▋   | 135/201 [00:46<00:21,  3.11it/s]Loss: 0.00208:  67%|██████▋   | 135/201 [00:46<00:21,  3.11it/s]Loss: 0.00208:  68%|██████▊   | 136/201 [00:47<00:20,  3.11it/s]Loss: 0.00204:  68%|██████▊   | 136/201 [00:47<00:20,  3.11it/s]Loss: 0.00204:  68%|██████▊   | 137/201 [00:47<00:20,  3.11it/s]Loss: 0.00207:  68%|██████▊   | 137/201 [00:47<00:20,  3.11it/s]Loss: 0.00207:  69%|██████▊   | 138/201 [00:47<00:20,  3.11it/s]Loss: 0.00220:  69%|██████▊   | 138/201 [00:47<00:20,  3.11it/s]Loss: 0.00220:  69%|██████▉   | 139/201 [00:48<00:19,  3.12it/s]Loss: 0.00211:  69%|██████▉   | 139/201 [00:48<00:19,  3.12it/s]Loss: 0.00211:  70%|██████▉   | 140/201 [00:48<00:19,  3.12it/s]Loss: 0.00208:  70%|██████▉   | 140/201 [00:48<00:19,  3.12it/s]Loss: 0.00208:  70%|███████   | 141/201 [00:48<00:21,  2.73it/s]Loss: 0.00197:  70%|███████   | 141/201 [00:48<00:21,  2.73it/s]Loss: 0.00197:  71%|███████   | 142/201 [00:49<00:20,  2.84it/s]Loss: 0.00197:  71%|███████   | 142/201 [00:49<00:20,  2.84it/s]Loss: 0.00197:  71%|███████   | 143/201 [00:49<00:19,  2.92it/s]Loss: 0.00211:  71%|███████   | 143/201 [00:49<00:19,  2.92it/s]Loss: 0.00211:  72%|███████▏  | 144/201 [00:49<00:19,  2.97it/s]Loss: 0.00193:  72%|███████▏  | 144/201 [00:49<00:19,  2.97it/s]Loss: 0.00193:  72%|███████▏  | 145/201 [00:50<00:18,  3.01it/s]Loss: 0.00228:  72%|███████▏  | 145/201 [00:50<00:18,  3.01it/s]Loss: 0.00228:  73%|███████▎  | 146/201 [00:50<00:18,  3.04it/s]Loss: 0.00252:  73%|███████▎  | 146/201 [00:50<00:18,  3.04it/s]Loss: 0.00252:  73%|███████▎  | 147/201 [00:50<00:17,  3.06it/s]Loss: 0.00222:  73%|███████▎  | 147/201 [00:50<00:17,  3.06it/s]Loss: 0.00222:  74%|███████▎  | 148/201 [00:51<00:17,  3.07it/s]Loss: 0.00218:  74%|███████▎  | 148/201 [00:51<00:17,  3.07it/s]Loss: 0.00218:  74%|███████▍  | 149/201 [00:51<00:16,  3.09it/s]Loss: 0.00247:  74%|███████▍  | 149/201 [00:51<00:16,  3.09it/s]Loss: 0.00247:  75%|███████▍  | 150/201 [00:51<00:16,  3.10it/s]Loss: 0.00275:  75%|███████▍  | 150/201 [00:51<00:16,  3.10it/s]Loss: 0.00275:  75%|███████▌  | 151/201 [00:52<00:16,  3.10it/s]Loss: 0.00272:  75%|███████▌  | 151/201 [00:52<00:16,  3.10it/s]Loss: 0.00272:  76%|███████▌  | 152/201 [00:52<00:15,  3.09it/s]Loss: 0.00388:  76%|███████▌  | 152/201 [00:52<00:15,  3.09it/s]max loss: 0.09347470849752426
Densities: min=0.0, max=1.0, mean=0.16983525454998016
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.34s/it][A1it [00:01,  1.34s/it]
Loss: 0.00388:  76%|███████▌  | 153/201 [00:54<00:34,  1.38it/s]Loss: 0.00412:  76%|███████▌  | 153/201 [00:54<00:34,  1.38it/s]Loss: 0.00412:  77%|███████▋  | 154/201 [00:54<00:28,  1.65it/s]Loss: 0.00343:  77%|███████▋  | 154/201 [00:54<00:28,  1.65it/s]Loss: 0.00343:  77%|███████▋  | 155/201 [00:54<00:23,  1.92it/s]Loss: 0.00313:  77%|███████▋  | 155/201 [00:54<00:23,  1.92it/s]Loss: 0.00313:  78%|███████▊  | 156/201 [00:55<00:20,  2.17it/s]Loss: 0.00294:  78%|███████▊  | 156/201 [00:55<00:20,  2.17it/s]Loss: 0.00294:  78%|███████▊  | 157/201 [00:55<00:18,  2.39it/s]Loss: 0.00280:  78%|███████▊  | 157/201 [00:55<00:18,  2.39it/s]Loss: 0.00280:  79%|███████▊  | 158/201 [00:55<00:16,  2.57it/s]Loss: 0.00272:  79%|███████▊  | 158/201 [00:55<00:16,  2.57it/s]Loss: 0.00272:  79%|███████▉  | 159/201 [00:55<00:15,  2.71it/s]Loss: 0.00265:  79%|███████▉  | 159/201 [00:55<00:15,  2.71it/s]Loss: 0.00265:  80%|███████▉  | 160/201 [00:56<00:14,  2.82it/s]Loss: 0.00267:  80%|███████▉  | 160/201 [00:56<00:14,  2.82it/s]Loss: 0.00267:  80%|████████  | 161/201 [00:56<00:15,  2.57it/s]Loss: 0.00263:  80%|████████  | 161/201 [00:56<00:15,  2.57it/s]Loss: 0.00263:  81%|████████  | 162/201 [00:57<00:14,  2.72it/s]Loss: 0.00258:  81%|████████  | 162/201 [00:57<00:14,  2.72it/s]Loss: 0.00258:  81%|████████  | 163/201 [00:57<00:13,  2.83it/s]Loss: 0.00261:  81%|████████  | 163/201 [00:57<00:13,  2.83it/s]Loss: 0.00261:  82%|████████▏ | 164/201 [00:57<00:12,  2.91it/s]Loss: 0.00260:  82%|████████▏ | 164/201 [00:57<00:12,  2.91it/s]Loss: 0.00260:  82%|████████▏ | 165/201 [00:58<00:12,  2.97it/s]Loss: 0.00252:  82%|████████▏ | 165/201 [00:58<00:12,  2.97it/s]Loss: 0.00252:  83%|████████▎ | 166/201 [00:58<00:11,  3.01it/s]Loss: 0.00249:  83%|████████▎ | 166/201 [00:58<00:11,  3.01it/s]Loss: 0.00249:  83%|████████▎ | 167/201 [00:58<00:11,  3.04it/s]Loss: 0.00242:  83%|████████▎ | 167/201 [00:58<00:11,  3.04it/s]Loss: 0.00242:  84%|████████▎ | 168/201 [00:59<00:10,  3.07it/s]Loss: 0.00251:  84%|████████▎ | 168/201 [00:59<00:10,  3.07it/s]Loss: 0.00251:  84%|████████▍ | 169/201 [00:59<00:10,  3.08it/s]Loss: 0.00238:  84%|████████▍ | 169/201 [00:59<00:10,  3.08it/s]Loss: 0.00238:  85%|████████▍ | 170/201 [00:59<00:10,  3.09it/s]Loss: 0.00250:  85%|████████▍ | 170/201 [00:59<00:10,  3.09it/s]Loss: 0.00250:  85%|████████▌ | 171/201 [00:59<00:09,  3.10it/s]Loss: 0.00239:  85%|████████▌ | 171/201 [00:59<00:09,  3.10it/s]Loss: 0.00239:  86%|████████▌ | 172/201 [01:00<00:09,  3.11it/s]Loss: 0.00252:  86%|████████▌ | 172/201 [01:00<00:09,  3.11it/s]Loss: 0.00252:  86%|████████▌ | 173/201 [01:00<00:09,  3.11it/s]Loss: 0.00247:  86%|████████▌ | 173/201 [01:00<00:09,  3.11it/s]Loss: 0.00247:  87%|████████▋ | 174/201 [01:00<00:08,  3.11it/s]Loss: 0.00240:  87%|████████▋ | 174/201 [01:00<00:08,  3.11it/s]Loss: 0.00240:  87%|████████▋ | 175/201 [01:01<00:08,  3.11it/s]Loss: 0.00242:  87%|████████▋ | 175/201 [01:01<00:08,  3.11it/s]Loss: 0.00242:  88%|████████▊ | 176/201 [01:01<00:08,  3.11it/s]Loss: 0.00242:  88%|████████▊ | 176/201 [01:01<00:08,  3.11it/s]Loss: 0.00242:  88%|████████▊ | 177/201 [01:01<00:07,  3.11it/s]Loss: 0.00240:  88%|████████▊ | 177/201 [01:01<00:07,  3.11it/s]Loss: 0.00240:  89%|████████▊ | 178/201 [01:02<00:07,  3.11it/s]Loss: 0.00247:  89%|████████▊ | 178/201 [01:02<00:07,  3.11it/s]Loss: 0.00247:  89%|████████▉ | 179/201 [01:02<00:07,  3.11it/s]Loss: 0.00250:  89%|████████▉ | 179/201 [01:02<00:07,  3.11it/s]Loss: 0.00250:  90%|████████▉ | 180/201 [01:02<00:06,  3.11it/s]Loss: 0.00250:  90%|████████▉ | 180/201 [01:02<00:06,  3.11it/s]Loss: 0.00250:  90%|█████████ | 181/201 [01:03<00:07,  2.73it/s]Loss: 0.00232:  90%|█████████ | 181/201 [01:03<00:07,  2.73it/s]Loss: 0.00232:  91%|█████████ | 182/201 [01:03<00:06,  2.84it/s]Loss: 0.00230:  91%|█████████ | 182/201 [01:03<00:06,  2.84it/s]Loss: 0.00230:  91%|█████████ | 183/201 [01:03<00:06,  2.92it/s]Loss: 0.00241:  91%|█████████ | 183/201 [01:03<00:06,  2.92it/s]Loss: 0.00241:  92%|█████████▏| 184/201 [01:04<00:05,  2.97it/s]Loss: 0.00239:  92%|█████████▏| 184/201 [01:04<00:05,  2.97it/s]Loss: 0.00239:  92%|█████████▏| 185/201 [01:04<00:05,  3.01it/s]Loss: 0.00250:  92%|█████████▏| 185/201 [01:04<00:05,  3.01it/s]Loss: 0.00250:  93%|█████████▎| 186/201 [01:04<00:04,  3.04it/s]Loss: 0.00229:  93%|█████████▎| 186/201 [01:04<00:04,  3.04it/s]Loss: 0.00229:  93%|█████████▎| 187/201 [01:05<00:04,  3.06it/s]Loss: 0.00232:  93%|█████████▎| 187/201 [01:05<00:04,  3.06it/s]Loss: 0.00232:  94%|█████████▎| 188/201 [01:05<00:04,  3.07it/s]Loss: 0.00219:  94%|█████████▎| 188/201 [01:05<00:04,  3.07it/s]Loss: 0.00219:  94%|█████████▍| 189/201 [01:05<00:03,  3.09it/s]Loss: 0.00225:  94%|█████████▍| 189/201 [01:05<00:03,  3.09it/s]Loss: 0.00225:  95%|█████████▍| 190/201 [01:06<00:03,  3.09it/s]Loss: 0.00233:  95%|█████████▍| 190/201 [01:06<00:03,  3.09it/s]Loss: 0.00233:  95%|█████████▌| 191/201 [01:06<00:03,  3.10it/s]Loss: 0.00241:  95%|█████████▌| 191/201 [01:06<00:03,  3.10it/s]Loss: 0.00241:  96%|█████████▌| 192/201 [01:06<00:02,  3.11it/s]Loss: 0.00220:  96%|█████████▌| 192/201 [01:06<00:02,  3.11it/s]Loss: 0.00220:  96%|█████████▌| 193/201 [01:07<00:02,  3.11it/s]Loss: 0.00232:  96%|█████████▌| 193/201 [01:07<00:02,  3.11it/s]Loss: 0.00232:  97%|█████████▋| 194/201 [01:07<00:02,  3.11it/s]Loss: 0.00241:  97%|█████████▋| 194/201 [01:07<00:02,  3.11it/s]Loss: 0.00241:  97%|█████████▋| 195/201 [01:07<00:01,  3.11it/s]Loss: 0.00219:  97%|█████████▋| 195/201 [01:07<00:01,  3.11it/s]Loss: 0.00219:  98%|█████████▊| 196/201 [01:08<00:01,  3.11it/s]Loss: 0.00233:  98%|█████████▊| 196/201 [01:08<00:01,  3.11it/s]Loss: 0.00233:  98%|█████████▊| 197/201 [01:08<00:01,  3.11it/s]Loss: 0.00218:  98%|█████████▊| 197/201 [01:08<00:01,  3.11it/s]Loss: 0.00218:  99%|█████████▊| 198/201 [01:08<00:00,  3.12it/s]Loss: 0.00229:  99%|█████████▊| 198/201 [01:08<00:00,  3.12it/s]Loss: 0.00229:  99%|█████████▉| 199/201 [01:09<00:00,  3.12it/s]Loss: 0.00231:  99%|█████████▉| 199/201 [01:09<00:00,  3.12it/s]Loss: 0.00231: 100%|█████████▉| 200/201 [01:09<00:00,  3.12it/s]Loss: 0.00213: 100%|█████████▉| 200/201 [01:09<00:00,  3.12it/s]Loss: 0.00213: 100%|██████████| 201/201 [01:09<00:00,  2.75it/s]Loss: 0.00177: 100%|██████████| 201/201 [01:09<00:00,  2.75it/s]Loss: 0.00177: 100%|██████████| 201/201 [01:09<00:00,  2.87it/s]
max loss: 0.08134974539279938
Densities: min=0.0, max=1.0, mean=0.18809500336647034
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/chameleon_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 69.92035174369812 seconds
-1.0 2.1015625
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/supernova_432x432x432_float32_raw_432x432x432_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json
Initialize network
Latent space memory: 17.5MiB
# of network parameters: 4609281
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.36it/s]1it [00:00,  3.36it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=1.1987038321854566e-14, max=0.994645893573761, mean=0.41394054889678955
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00, 252.05it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 66, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [432, 432, 432], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<04:24,  1.32s/it]Loss: 0.12483:   0%|          | 1/201 [00:01<04:24,  1.32s/it]Loss: 0.12483:   1%|          | 2/201 [00:01<02:55,  1.13it/s]Loss: 0.02420:   1%|          | 2/201 [00:01<02:55,  1.13it/s]Loss: 0.02420:   1%|▏         | 3/201 [00:02<02:26,  1.35it/s]Loss: 0.01463:   1%|▏         | 3/201 [00:02<02:26,  1.35it/s]Loss: 0.01463:   2%|▏         | 4/201 [00:03<02:13,  1.48it/s]Loss: 0.01339:   2%|▏         | 4/201 [00:03<02:13,  1.48it/s]Loss: 0.01339:   2%|▏         | 5/201 [00:03<02:05,  1.56it/s]Loss: 0.01303:   2%|▏         | 5/201 [00:03<02:05,  1.56it/s]Loss: 0.01303:   3%|▎         | 6/201 [00:04<02:00,  1.62it/s]Loss: 0.01228:   3%|▎         | 6/201 [00:04<02:00,  1.62it/s]Loss: 0.01228:   3%|▎         | 7/201 [00:04<01:57,  1.65it/s]Loss: 0.01177:   3%|▎         | 7/201 [00:04<01:57,  1.65it/s]Loss: 0.01177:   4%|▍         | 8/201 [00:05<01:55,  1.68it/s]Loss: 0.01135:   4%|▍         | 8/201 [00:05<01:55,  1.68it/s]Loss: 0.01135:   4%|▍         | 9/201 [00:05<01:53,  1.70it/s]Loss: 0.01092:   4%|▍         | 9/201 [00:05<01:53,  1.70it/s]Loss: 0.01092:   5%|▍         | 10/201 [00:06<01:51,  1.71it/s]Loss: 0.01057:   5%|▍         | 10/201 [00:06<01:51,  1.71it/s]Loss: 0.01057:   5%|▌         | 11/201 [00:07<01:50,  1.71it/s]Loss: 0.01016:   5%|▌         | 11/201 [00:07<01:50,  1.71it/s]Loss: 0.01016:   6%|▌         | 12/201 [00:07<01:49,  1.72it/s]Loss: 0.00990:   6%|▌         | 12/201 [00:07<01:49,  1.72it/s]Loss: 0.00990:   6%|▋         | 13/201 [00:08<01:49,  1.72it/s]Loss: 0.00960:   6%|▋         | 13/201 [00:08<01:49,  1.72it/s]Loss: 0.00960:   7%|▋         | 14/201 [00:08<01:48,  1.73it/s]Loss: 0.00928:   7%|▋         | 14/201 [00:08<01:48,  1.73it/s]Loss: 0.00928:   7%|▋         | 15/201 [00:09<01:47,  1.73it/s]Loss: 0.00894:   7%|▋         | 15/201 [00:09<01:47,  1.73it/s]Loss: 0.00894:   8%|▊         | 16/201 [00:09<01:46,  1.73it/s]Loss: 0.00867:   8%|▊         | 16/201 [00:09<01:46,  1.73it/s]Loss: 0.00867:   8%|▊         | 17/201 [00:10<01:46,  1.73it/s]Loss: 0.00848:   8%|▊         | 17/201 [00:10<01:46,  1.73it/s]Loss: 0.00848:   9%|▉         | 18/201 [00:11<01:45,  1.73it/s]Loss: 0.00850:   9%|▉         | 18/201 [00:11<01:45,  1.73it/s]Loss: 0.00850:   9%|▉         | 19/201 [00:11<01:45,  1.73it/s]Loss: 0.00841:   9%|▉         | 19/201 [00:11<01:45,  1.73it/s]Loss: 0.00841:  10%|▉         | 20/201 [00:12<01:44,  1.73it/s]Loss: 0.00810:  10%|▉         | 20/201 [00:12<01:44,  1.73it/s]Loss: 0.00810:  10%|█         | 21/201 [00:12<01:45,  1.70it/s]Loss: 0.00794:  10%|█         | 21/201 [00:12<01:45,  1.70it/s]Loss: 0.00794:  11%|█         | 22/201 [00:13<01:44,  1.72it/s]Loss: 0.00778:  11%|█         | 22/201 [00:13<01:44,  1.72it/s]Loss: 0.00778:  11%|█▏        | 23/201 [00:14<01:43,  1.72it/s]Loss: 0.00766:  11%|█▏        | 23/201 [00:14<01:43,  1.72it/s]Loss: 0.00766:  12%|█▏        | 24/201 [00:14<01:42,  1.73it/s]Loss: 0.00775:  12%|█▏        | 24/201 [00:14<01:42,  1.73it/s]Loss: 0.00775:  12%|█▏        | 25/201 [00:15<01:41,  1.73it/s]Loss: 0.00748:  12%|█▏        | 25/201 [00:15<01:41,  1.73it/s]Loss: 0.00748:  13%|█▎        | 26/201 [00:15<01:41,  1.73it/s]Loss: 0.00754:  13%|█▎        | 26/201 [00:15<01:41,  1.73it/s]Loss: 0.00754:  13%|█▎        | 27/201 [00:16<01:40,  1.73it/s]Loss: 0.00742:  13%|█▎        | 27/201 [00:16<01:40,  1.73it/s]Loss: 0.00742:  14%|█▍        | 28/201 [00:16<01:39,  1.73it/s]Loss: 0.00725:  14%|█▍        | 28/201 [00:16<01:39,  1.73it/s]Loss: 0.00725:  14%|█▍        | 29/201 [00:17<01:39,  1.73it/s]Loss: 0.00718:  14%|█▍        | 29/201 [00:17<01:39,  1.73it/s]Loss: 0.00718:  15%|█▍        | 30/201 [00:18<01:38,  1.73it/s]Loss: 0.00707:  15%|█▍        | 30/201 [00:18<01:38,  1.73it/s]Loss: 0.00707:  15%|█▌        | 31/201 [00:18<01:38,  1.73it/s]Loss: 0.00703:  15%|█▌        | 31/201 [00:18<01:38,  1.73it/s]Loss: 0.00703:  16%|█▌        | 32/201 [00:19<01:37,  1.74it/s]Loss: 0.00695:  16%|█▌        | 32/201 [00:19<01:37,  1.74it/s]Loss: 0.00695:  16%|█▋        | 33/201 [00:19<01:36,  1.74it/s]Loss: 0.00724:  16%|█▋        | 33/201 [00:19<01:36,  1.74it/s]Loss: 0.00724:  17%|█▋        | 34/201 [00:20<01:35,  1.74it/s]Loss: 0.00712:  17%|█▋        | 34/201 [00:20<01:35,  1.74it/s]Loss: 0.00712:  17%|█▋        | 35/201 [00:20<01:35,  1.74it/s]Loss: 0.00701:  17%|█▋        | 35/201 [00:20<01:35,  1.74it/s]Loss: 0.00701:  18%|█▊        | 36/201 [00:21<01:34,  1.74it/s]Loss: 0.00685:  18%|█▊        | 36/201 [00:21<01:34,  1.74it/s]Loss: 0.00685:  18%|█▊        | 37/201 [00:22<01:34,  1.74it/s]Loss: 0.00677:  18%|█▊        | 37/201 [00:22<01:34,  1.74it/s]Loss: 0.00677:  19%|█▉        | 38/201 [00:22<01:33,  1.74it/s]Loss: 0.00669:  19%|█▉        | 38/201 [00:22<01:33,  1.74it/s]Loss: 0.00669:  19%|█▉        | 39/201 [00:23<01:33,  1.74it/s]Loss: 0.00656:  19%|█▉        | 39/201 [00:23<01:33,  1.74it/s]Loss: 0.00656:  20%|█▉        | 40/201 [00:23<01:32,  1.74it/s]Loss: 0.00643:  20%|█▉        | 40/201 [00:23<01:32,  1.74it/s]Loss: 0.00643:  20%|██        | 41/201 [00:24<01:33,  1.71it/s]Loss: 0.00642:  20%|██        | 41/201 [00:24<01:33,  1.71it/s]Loss: 0.00642:  21%|██        | 42/201 [00:25<01:32,  1.72it/s]Loss: 0.00645:  21%|██        | 42/201 [00:25<01:32,  1.72it/s]Loss: 0.00645:  21%|██▏       | 43/201 [00:25<01:31,  1.72it/s]Loss: 0.00638:  21%|██▏       | 43/201 [00:25<01:31,  1.72it/s]Loss: 0.00638:  22%|██▏       | 44/201 [00:26<01:30,  1.73it/s]Loss: 0.00627:  22%|██▏       | 44/201 [00:26<01:30,  1.73it/s]Loss: 0.00627:  22%|██▏       | 45/201 [00:26<01:30,  1.73it/s]Loss: 0.00637:  22%|██▏       | 45/201 [00:26<01:30,  1.73it/s]Loss: 0.00637:  23%|██▎       | 46/201 [00:27<01:29,  1.73it/s]Loss: 0.00620:  23%|██▎       | 46/201 [00:27<01:29,  1.73it/s]Loss: 0.00620:  23%|██▎       | 47/201 [00:27<01:28,  1.73it/s]Loss: 0.00623:  23%|██▎       | 47/201 [00:27<01:28,  1.73it/s]Loss: 0.00623:  24%|██▍       | 48/201 [00:28<01:28,  1.73it/s]Loss: 0.00626:  24%|██▍       | 48/201 [00:28<01:28,  1.73it/s]Loss: 0.00626:  24%|██▍       | 49/201 [00:29<01:27,  1.73it/s]Loss: 0.00608:  24%|██▍       | 49/201 [00:29<01:27,  1.73it/s]Loss: 0.00608:  25%|██▍       | 50/201 [00:29<01:27,  1.73it/s]Loss: 0.00612:  25%|██▍       | 50/201 [00:29<01:27,  1.73it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.46s/it][A1it [00:01,  1.46s/it]
Loss: 0.00612:  25%|██▌       | 51/201 [00:31<02:32,  1.02s/it]Loss: 0.00955:  25%|██▌       | 51/201 [00:31<02:32,  1.02s/it]Loss: 0.00955:  26%|██▌       | 52/201 [00:32<02:12,  1.13it/s]Loss: 0.00854:  26%|██▌       | 52/201 [00:32<02:12,  1.13it/s]Loss: 0.00854:  26%|██▋       | 53/201 [00:32<01:57,  1.26it/s]Loss: 0.00710:  26%|██▋       | 53/201 [00:32<01:57,  1.26it/s]Loss: 0.00710:  27%|██▋       | 54/201 [00:33<01:47,  1.37it/s]Loss: 0.00540:  27%|██▋       | 54/201 [00:33<01:47,  1.37it/s]Loss: 0.00540:  27%|██▋       | 55/201 [00:33<01:40,  1.46it/s]Loss: 0.00488:  27%|██▋       | 55/201 [00:33<01:40,  1.46it/s]Loss: 0.00488:  28%|██▊       | 56/201 [00:34<01:35,  1.53it/s]Loss: 0.00463:  28%|██▊       | 56/201 [00:34<01:35,  1.53it/s]Loss: 0.00463:  28%|██▊       | 57/201 [00:35<01:31,  1.58it/s]Loss: 0.00452:  28%|██▊       | 57/201 [00:35<01:31,  1.58it/s]Loss: 0.00452:  29%|██▉       | 58/201 [00:35<01:28,  1.62it/s]Loss: 0.00473:  29%|██▉       | 58/201 [00:35<01:28,  1.62it/s]Loss: 0.00473:  29%|██▉       | 59/201 [00:36<01:26,  1.64it/s]Loss: 0.00418:  29%|██▉       | 59/201 [00:36<01:26,  1.64it/s]Loss: 0.00418:  30%|██▉       | 60/201 [00:36<01:24,  1.66it/s]Loss: 0.00404:  30%|██▉       | 60/201 [00:36<01:24,  1.66it/s]Loss: 0.00404:  30%|███       | 61/201 [00:37<01:24,  1.66it/s]Loss: 0.00407:  30%|███       | 61/201 [00:37<01:24,  1.66it/s]Loss: 0.00407:  31%|███       | 62/201 [00:38<01:22,  1.68it/s]Loss: 0.00400:  31%|███       | 62/201 [00:38<01:22,  1.68it/s]Loss: 0.00400:  31%|███▏      | 63/201 [00:38<01:21,  1.69it/s]Loss: 0.00384:  31%|███▏      | 63/201 [00:38<01:21,  1.69it/s]Loss: 0.00384:  32%|███▏      | 64/201 [00:39<01:20,  1.70it/s]Loss: 0.00381:  32%|███▏      | 64/201 [00:39<01:20,  1.70it/s]Loss: 0.00381:  32%|███▏      | 65/201 [00:39<01:19,  1.70it/s]Loss: 0.00374:  32%|███▏      | 65/201 [00:39<01:19,  1.70it/s]Loss: 0.00374:  33%|███▎      | 66/201 [00:40<01:19,  1.71it/s]Loss: 0.00369:  33%|███▎      | 66/201 [00:40<01:19,  1.71it/s]Loss: 0.00369:  33%|███▎      | 67/201 [00:41<01:18,  1.71it/s]Loss: 0.00364:  33%|███▎      | 67/201 [00:41<01:18,  1.71it/s]Loss: 0.00364:  34%|███▍      | 68/201 [00:41<01:17,  1.71it/s]Loss: 0.00365:  34%|███▍      | 68/201 [00:41<01:17,  1.71it/s]Loss: 0.00365:  34%|███▍      | 69/201 [00:42<01:17,  1.71it/s]Loss: 0.00346:  34%|███▍      | 69/201 [00:42<01:17,  1.71it/s]Loss: 0.00346:  35%|███▍      | 70/201 [00:42<01:16,  1.71it/s]Loss: 0.00325:  35%|███▍      | 70/201 [00:42<01:16,  1.71it/s]Loss: 0.00325:  35%|███▌      | 71/201 [00:43<01:15,  1.72it/s]Loss: 0.00364:  35%|███▌      | 71/201 [00:43<01:15,  1.72it/s]Loss: 0.00364:  36%|███▌      | 72/201 [00:43<01:15,  1.72it/s]Loss: 0.00430:  36%|███▌      | 72/201 [00:43<01:15,  1.72it/s]Loss: 0.00430:  36%|███▋      | 73/201 [00:44<01:14,  1.72it/s]Loss: 0.00358:  36%|███▋      | 73/201 [00:44<01:14,  1.72it/s]Loss: 0.00358:  37%|███▋      | 74/201 [00:45<01:13,  1.72it/s]Loss: 0.00344:  37%|███▋      | 74/201 [00:45<01:13,  1.72it/s]Loss: 0.00344:  37%|███▋      | 75/201 [00:45<01:13,  1.72it/s]Loss: 0.00345:  37%|███▋      | 75/201 [00:45<01:13,  1.72it/s]Loss: 0.00345:  38%|███▊      | 76/201 [00:46<01:12,  1.71it/s]Loss: 0.00360:  38%|███▊      | 76/201 [00:46<01:12,  1.71it/s]Loss: 0.00360:  38%|███▊      | 77/201 [00:46<01:12,  1.72it/s]Loss: 0.00350:  38%|███▊      | 77/201 [00:46<01:12,  1.72it/s]Loss: 0.00350:  39%|███▉      | 78/201 [00:47<01:11,  1.72it/s]Loss: 0.00327:  39%|███▉      | 78/201 [00:47<01:11,  1.72it/s]Loss: 0.00327:  39%|███▉      | 79/201 [00:48<01:11,  1.72it/s]Loss: 0.00331:  39%|███▉      | 79/201 [00:48<01:11,  1.72it/s]Loss: 0.00331:  40%|███▉      | 80/201 [00:48<01:10,  1.72it/s]Loss: 0.00320:  40%|███▉      | 80/201 [00:48<01:10,  1.72it/s]Loss: 0.00320:  40%|████      | 81/201 [00:49<01:10,  1.69it/s]Loss: 0.00325:  40%|████      | 81/201 [00:49<01:10,  1.69it/s]Loss: 0.00325:  41%|████      | 82/201 [00:49<01:09,  1.70it/s]Loss: 0.00334:  41%|████      | 82/201 [00:49<01:09,  1.70it/s]Loss: 0.00334:  41%|████▏     | 83/201 [00:50<01:09,  1.71it/s]Loss: 0.00350:  41%|████▏     | 83/201 [00:50<01:09,  1.71it/s]Loss: 0.00350:  42%|████▏     | 84/201 [00:50<01:08,  1.71it/s]Loss: 0.00321:  42%|████▏     | 84/201 [00:50<01:08,  1.71it/s]Loss: 0.00321:  42%|████▏     | 85/201 [00:51<01:07,  1.71it/s]Loss: 0.00319:  42%|████▏     | 85/201 [00:51<01:07,  1.71it/s]Loss: 0.00319:  43%|████▎     | 86/201 [00:52<01:07,  1.71it/s]Loss: 0.00312:  43%|████▎     | 86/201 [00:52<01:07,  1.71it/s]Loss: 0.00312:  43%|████▎     | 87/201 [00:52<01:06,  1.72it/s]Loss: 0.00337:  43%|████▎     | 87/201 [00:52<01:06,  1.72it/s]Loss: 0.00337:  44%|████▍     | 88/201 [00:53<01:05,  1.72it/s]Loss: 0.00336:  44%|████▍     | 88/201 [00:53<01:05,  1.72it/s]Loss: 0.00336:  44%|████▍     | 89/201 [00:53<01:05,  1.72it/s]Loss: 0.00324:  44%|████▍     | 89/201 [00:53<01:05,  1.72it/s]Loss: 0.00324:  45%|████▍     | 90/201 [00:54<01:04,  1.72it/s]Loss: 0.00266:  45%|████▍     | 90/201 [00:54<01:04,  1.72it/s]Loss: 0.00266:  45%|████▌     | 91/201 [00:55<01:04,  1.72it/s]Loss: 0.00269:  45%|████▌     | 91/201 [00:55<01:04,  1.72it/s]Loss: 0.00269:  46%|████▌     | 92/201 [00:55<01:03,  1.72it/s]Loss: 0.00328:  46%|████▌     | 92/201 [00:55<01:03,  1.72it/s]Loss: 0.00328:  46%|████▋     | 93/201 [00:56<01:02,  1.72it/s]Loss: 0.00332:  46%|████▋     | 93/201 [00:56<01:02,  1.72it/s]Loss: 0.00332:  47%|████▋     | 94/201 [00:56<01:02,  1.72it/s]Loss: 0.00345:  47%|████▋     | 94/201 [00:56<01:02,  1.72it/s]Loss: 0.00345:  47%|████▋     | 95/201 [00:57<01:01,  1.72it/s]Loss: 0.00320:  47%|████▋     | 95/201 [00:57<01:01,  1.72it/s]Loss: 0.00320:  48%|████▊     | 96/201 [00:57<01:01,  1.72it/s]Loss: 0.00309:  48%|████▊     | 96/201 [00:57<01:01,  1.72it/s]Loss: 0.00309:  48%|████▊     | 97/201 [00:58<01:00,  1.72it/s]Loss: 0.00311:  48%|████▊     | 97/201 [00:58<01:00,  1.72it/s]Loss: 0.00311:  49%|████▉     | 98/201 [00:59<00:59,  1.72it/s]Loss: 0.00319:  49%|████▉     | 98/201 [00:59<00:59,  1.72it/s]Loss: 0.00319:  49%|████▉     | 99/201 [00:59<00:59,  1.72it/s]Loss: 0.00318:  49%|████▉     | 99/201 [00:59<00:59,  1.72it/s]Loss: 0.00318:  50%|████▉     | 100/201 [01:00<00:58,  1.72it/s]Loss: 0.00309:  50%|████▉     | 100/201 [01:00<00:58,  1.72it/s]Loss: 0.00309:  50%|█████     | 101/201 [01:00<00:58,  1.70it/s]Loss: 0.00248:  50%|█████     | 101/201 [01:00<00:58,  1.70it/s]max loss: 0.41608911752700806
Densities: min=2.310280246053736e-15, max=0.9978476762771606, mean=0.08888787776231766
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.47s/it][A1it [00:01,  1.47s/it]
Loss: 0.00248:  51%|█████     | 102/201 [01:02<01:41,  1.03s/it]Loss: 0.00507:  51%|█████     | 102/201 [01:02<01:41,  1.03s/it]Loss: 0.00507:  51%|█████     | 103/201 [01:03<01:27,  1.12it/s]Loss: 0.00483:  51%|█████     | 103/201 [01:03<01:27,  1.12it/s]Loss: 0.00483:  52%|█████▏    | 104/201 [01:04<01:17,  1.25it/s]Loss: 0.00475:  52%|█████▏    | 104/201 [01:04<01:17,  1.25it/s]Loss: 0.00475:  52%|█████▏    | 105/201 [01:04<01:10,  1.36it/s]Loss: 0.00469:  52%|█████▏    | 105/201 [01:04<01:10,  1.36it/s]Loss: 0.00469:  53%|█████▎    | 106/201 [01:05<01:05,  1.45it/s]Loss: 0.00467:  53%|█████▎    | 106/201 [01:05<01:05,  1.45it/s]Loss: 0.00467:  53%|█████▎    | 107/201 [01:05<01:01,  1.52it/s]Loss: 0.00465:  53%|█████▎    | 107/201 [01:05<01:01,  1.52it/s]Loss: 0.00465:  54%|█████▎    | 108/201 [01:06<00:59,  1.57it/s]Loss: 0.00463:  54%|█████▎    | 108/201 [01:06<00:59,  1.57it/s]Loss: 0.00463:  54%|█████▍    | 109/201 [01:07<00:57,  1.61it/s]Loss: 0.00461:  54%|█████▍    | 109/201 [01:07<00:57,  1.61it/s]Loss: 0.00461:  55%|█████▍    | 110/201 [01:07<00:55,  1.64it/s]Loss: 0.00473:  55%|█████▍    | 110/201 [01:07<00:55,  1.64it/s]Loss: 0.00473:  55%|█████▌    | 111/201 [01:08<00:54,  1.66it/s]Loss: 0.00470:  55%|█████▌    | 111/201 [01:08<00:54,  1.66it/s]Loss: 0.00470:  56%|█████▌    | 112/201 [01:08<00:53,  1.68it/s]Loss: 0.00471:  56%|█████▌    | 112/201 [01:08<00:53,  1.68it/s]Loss: 0.00471:  56%|█████▌    | 113/201 [01:09<00:52,  1.69it/s]Loss: 0.00468:  56%|█████▌    | 113/201 [01:09<00:52,  1.69it/s]Loss: 0.00468:  57%|█████▋    | 114/201 [01:09<00:51,  1.70it/s]Loss: 0.00467:  57%|█████▋    | 114/201 [01:09<00:51,  1.70it/s]Loss: 0.00467:  57%|█████▋    | 115/201 [01:10<00:50,  1.70it/s]Loss: 0.00467:  57%|█████▋    | 115/201 [01:10<00:50,  1.70it/s]Loss: 0.00467:  58%|█████▊    | 116/201 [01:11<00:49,  1.71it/s]Loss: 0.00465:  58%|█████▊    | 116/201 [01:11<00:49,  1.71it/s]Loss: 0.00465:  58%|█████▊    | 117/201 [01:11<00:49,  1.71it/s]Loss: 0.00465:  58%|█████▊    | 117/201 [01:11<00:49,  1.71it/s]Loss: 0.00465:  59%|█████▊    | 118/201 [01:12<00:48,  1.71it/s]Loss: 0.00464:  59%|█████▊    | 118/201 [01:12<00:48,  1.71it/s]Loss: 0.00464:  59%|█████▉    | 119/201 [01:12<00:47,  1.71it/s]Loss: 0.00461:  59%|█████▉    | 119/201 [01:12<00:47,  1.71it/s]Loss: 0.00461:  60%|█████▉    | 120/201 [01:13<00:47,  1.71it/s]Loss: 0.00464:  60%|█████▉    | 120/201 [01:13<00:47,  1.71it/s]Loss: 0.00464:  60%|██████    | 121/201 [01:14<00:47,  1.69it/s]Loss: 0.00460:  60%|██████    | 121/201 [01:14<00:47,  1.69it/s]Loss: 0.00460:  61%|██████    | 122/201 [01:14<00:46,  1.70it/s]Loss: 0.00457:  61%|██████    | 122/201 [01:14<00:46,  1.70it/s]Loss: 0.00457:  61%|██████    | 123/201 [01:15<00:45,  1.70it/s]Loss: 0.00457:  61%|██████    | 123/201 [01:15<00:45,  1.70it/s]Loss: 0.00457:  62%|██████▏   | 124/201 [01:15<00:45,  1.71it/s]Loss: 0.00455:  62%|██████▏   | 124/201 [01:15<00:45,  1.71it/s]Loss: 0.00455:  62%|██████▏   | 125/201 [01:16<00:44,  1.71it/s]Loss: 0.00455:  62%|██████▏   | 125/201 [01:16<00:44,  1.71it/s]Loss: 0.00455:  63%|██████▎   | 126/201 [01:16<00:43,  1.71it/s]Loss: 0.00456:  63%|██████▎   | 126/201 [01:16<00:43,  1.71it/s]Loss: 0.00456:  63%|██████▎   | 127/201 [01:17<00:43,  1.71it/s]Loss: 0.00454:  63%|██████▎   | 127/201 [01:17<00:43,  1.71it/s]Loss: 0.00454:  64%|██████▎   | 128/201 [01:18<00:42,  1.71it/s]Loss: 0.00451:  64%|██████▎   | 128/201 [01:18<00:42,  1.71it/s]Loss: 0.00451:  64%|██████▍   | 129/201 [01:18<00:42,  1.71it/s]Loss: 0.00452:  64%|██████▍   | 129/201 [01:18<00:42,  1.71it/s]Loss: 0.00452:  65%|██████▍   | 130/201 [01:19<00:41,  1.72it/s]Loss: 0.00451:  65%|██████▍   | 130/201 [01:19<00:41,  1.72it/s]Loss: 0.00451:  65%|██████▌   | 131/201 [01:19<00:40,  1.72it/s]Loss: 0.00449:  65%|██████▌   | 131/201 [01:19<00:40,  1.72it/s]Loss: 0.00449:  66%|██████▌   | 132/201 [01:20<00:40,  1.72it/s]Loss: 0.00452:  66%|██████▌   | 132/201 [01:20<00:40,  1.72it/s]Loss: 0.00452:  66%|██████▌   | 133/201 [01:21<00:39,  1.73it/s]Loss: 0.00449:  66%|██████▌   | 133/201 [01:21<00:39,  1.73it/s]Loss: 0.00449:  67%|██████▋   | 134/201 [01:21<00:38,  1.73it/s]Loss: 0.00445:  67%|██████▋   | 134/201 [01:21<00:38,  1.73it/s]Loss: 0.00445:  67%|██████▋   | 135/201 [01:22<00:38,  1.73it/s]Loss: 0.00447:  67%|██████▋   | 135/201 [01:22<00:38,  1.73it/s]Loss: 0.00447:  68%|██████▊   | 136/201 [01:22<00:37,  1.73it/s]Loss: 0.00448:  68%|██████▊   | 136/201 [01:22<00:37,  1.73it/s]Loss: 0.00448:  68%|██████▊   | 137/201 [01:23<00:36,  1.73it/s]Loss: 0.00445:  68%|██████▊   | 137/201 [01:23<00:36,  1.73it/s]Loss: 0.00445:  69%|██████▊   | 138/201 [01:23<00:36,  1.73it/s]Loss: 0.00445:  69%|██████▊   | 138/201 [01:23<00:36,  1.73it/s]Loss: 0.00445:  69%|██████▉   | 139/201 [01:24<00:35,  1.73it/s]Loss: 0.00444:  69%|██████▉   | 139/201 [01:24<00:35,  1.73it/s]Loss: 0.00444:  70%|██████▉   | 140/201 [01:25<00:35,  1.73it/s]Loss: 0.00444:  70%|██████▉   | 140/201 [01:25<00:35,  1.73it/s]Loss: 0.00444:  70%|███████   | 141/201 [01:25<00:35,  1.71it/s]Loss: 0.00446:  70%|███████   | 141/201 [01:25<00:35,  1.71it/s]Loss: 0.00446:  71%|███████   | 142/201 [01:26<00:34,  1.72it/s]Loss: 0.00439:  71%|███████   | 142/201 [01:26<00:34,  1.72it/s]Loss: 0.00439:  71%|███████   | 143/201 [01:26<00:33,  1.72it/s]Loss: 0.00441:  71%|███████   | 143/201 [01:26<00:33,  1.72it/s]Loss: 0.00441:  72%|███████▏  | 144/201 [01:27<00:33,  1.72it/s]Loss: 0.00441:  72%|███████▏  | 144/201 [01:27<00:33,  1.72it/s]Loss: 0.00441:  72%|███████▏  | 145/201 [01:27<00:32,  1.73it/s]Loss: 0.00440:  72%|███████▏  | 145/201 [01:27<00:32,  1.73it/s]Loss: 0.00440:  73%|███████▎  | 146/201 [01:28<00:31,  1.73it/s]Loss: 0.00438:  73%|███████▎  | 146/201 [01:28<00:31,  1.73it/s]Loss: 0.00438:  73%|███████▎  | 147/201 [01:29<00:31,  1.73it/s]Loss: 0.00437:  73%|███████▎  | 147/201 [01:29<00:31,  1.73it/s]Loss: 0.00437:  74%|███████▎  | 148/201 [01:29<00:30,  1.73it/s]Loss: 0.00437:  74%|███████▎  | 148/201 [01:29<00:30,  1.73it/s]Loss: 0.00437:  74%|███████▍  | 149/201 [01:30<00:30,  1.73it/s]Loss: 0.00440:  74%|███████▍  | 149/201 [01:30<00:30,  1.73it/s]Loss: 0.00440:  75%|███████▍  | 150/201 [01:30<00:29,  1.72it/s]Loss: 0.00436:  75%|███████▍  | 150/201 [01:30<00:29,  1.72it/s]Loss: 0.00436:  75%|███████▌  | 151/201 [01:31<00:29,  1.72it/s]Loss: 0.00439:  75%|███████▌  | 151/201 [01:31<00:29,  1.72it/s]Loss: 0.00439:  76%|███████▌  | 152/201 [01:32<00:28,  1.72it/s]Loss: 0.00434:  76%|███████▌  | 152/201 [01:32<00:28,  1.72it/s]max loss: 0.07628389447927475
Densities: min=2.764855723790807e-15, max=0.996854305267334, mean=0.24182501435279846
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.49s/it][A1it [00:01,  1.49s/it]
Loss: 0.00434:  76%|███████▌  | 153/201 [01:34<00:49,  1.03s/it]Loss: 0.00451:  76%|███████▌  | 153/201 [01:34<00:49,  1.03s/it]Loss: 0.00451:  77%|███████▋  | 154/201 [01:34<00:42,  1.12it/s]Loss: 0.00442:  77%|███████▋  | 154/201 [01:34<00:42,  1.12it/s]Loss: 0.00442:  77%|███████▋  | 155/201 [01:35<00:36,  1.25it/s]Loss: 0.00439:  77%|███████▋  | 155/201 [01:35<00:36,  1.25it/s]Loss: 0.00439:  78%|███████▊  | 156/201 [01:35<00:33,  1.36it/s]Loss: 0.00441:  78%|███████▊  | 156/201 [01:35<00:33,  1.36it/s]Loss: 0.00441:  78%|███████▊  | 157/201 [01:36<00:30,  1.45it/s]Loss: 0.00441:  78%|███████▊  | 157/201 [01:36<00:30,  1.45it/s]Loss: 0.00441:  79%|███████▊  | 158/201 [01:37<00:28,  1.52it/s]Loss: 0.00436:  79%|███████▊  | 158/201 [01:37<00:28,  1.52it/s]Loss: 0.00436:  79%|███████▉  | 159/201 [01:37<00:26,  1.57it/s]Loss: 0.00435:  79%|███████▉  | 159/201 [01:37<00:26,  1.57it/s]Loss: 0.00435:  80%|███████▉  | 160/201 [01:38<00:25,  1.61it/s]Loss: 0.00438:  80%|███████▉  | 160/201 [01:38<00:25,  1.61it/s]Loss: 0.00438:  80%|████████  | 161/201 [01:38<00:24,  1.62it/s]Loss: 0.00437:  80%|████████  | 161/201 [01:38<00:24,  1.62it/s]Loss: 0.00437:  81%|████████  | 162/201 [01:39<00:23,  1.65it/s]Loss: 0.00438:  81%|████████  | 162/201 [01:39<00:23,  1.65it/s]Loss: 0.00438:  81%|████████  | 163/201 [01:39<00:22,  1.66it/s]Loss: 0.00432:  81%|████████  | 163/201 [01:39<00:22,  1.66it/s]Loss: 0.00432:  82%|████████▏ | 164/201 [01:40<00:22,  1.68it/s]Loss: 0.00433:  82%|████████▏ | 164/201 [01:40<00:22,  1.68it/s]Loss: 0.00433:  82%|████████▏ | 165/201 [01:41<00:21,  1.69it/s]Loss: 0.00430:  82%|████████▏ | 165/201 [01:41<00:21,  1.69it/s]Loss: 0.00430:  83%|████████▎ | 166/201 [01:41<00:20,  1.70it/s]Loss: 0.00432:  83%|████████▎ | 166/201 [01:41<00:20,  1.70it/s]Loss: 0.00432:  83%|████████▎ | 167/201 [01:42<00:19,  1.70it/s]Loss: 0.00430:  83%|████████▎ | 167/201 [01:42<00:19,  1.70it/s]Loss: 0.00430:  84%|████████▎ | 168/201 [01:42<00:19,  1.71it/s]Loss: 0.00430:  84%|████████▎ | 168/201 [01:42<00:19,  1.71it/s]Loss: 0.00430:  84%|████████▍ | 169/201 [01:43<00:18,  1.71it/s]Loss: 0.00427:  84%|████████▍ | 169/201 [01:43<00:18,  1.71it/s]Loss: 0.00427:  85%|████████▍ | 170/201 [01:44<00:18,  1.71it/s]Loss: 0.00429:  85%|████████▍ | 170/201 [01:44<00:18,  1.71it/s]Loss: 0.00429:  85%|████████▌ | 171/201 [01:44<00:17,  1.71it/s]Loss: 0.00431:  85%|████████▌ | 171/201 [01:44<00:17,  1.71it/s]Loss: 0.00431:  86%|████████▌ | 172/201 [01:45<00:16,  1.71it/s]Loss: 0.00427:  86%|████████▌ | 172/201 [01:45<00:16,  1.71it/s]Loss: 0.00427:  86%|████████▌ | 173/201 [01:45<00:16,  1.71it/s]Loss: 0.00428:  86%|████████▌ | 173/201 [01:45<00:16,  1.71it/s]Loss: 0.00428:  87%|████████▋ | 174/201 [01:46<00:15,  1.71it/s]Loss: 0.00424:  87%|████████▋ | 174/201 [01:46<00:15,  1.71it/s]Loss: 0.00424:  87%|████████▋ | 175/201 [01:46<00:15,  1.71it/s]Loss: 0.00426:  87%|████████▋ | 175/201 [01:46<00:15,  1.71it/s]Loss: 0.00426:  88%|████████▊ | 176/201 [01:47<00:14,  1.71it/s]Loss: 0.00423:  88%|████████▊ | 176/201 [01:47<00:14,  1.71it/s]Loss: 0.00423:  88%|████████▊ | 177/201 [01:48<00:14,  1.71it/s]Loss: 0.00425:  88%|████████▊ | 177/201 [01:48<00:14,  1.71it/s]Loss: 0.00425:  89%|████████▊ | 178/201 [01:48<00:13,  1.71it/s]Loss: 0.00422:  89%|████████▊ | 178/201 [01:48<00:13,  1.71it/s]Loss: 0.00422:  89%|████████▉ | 179/201 [01:49<00:12,  1.71it/s]Loss: 0.00423:  89%|████████▉ | 179/201 [01:49<00:12,  1.71it/s]Loss: 0.00423:  90%|████████▉ | 180/201 [01:49<00:12,  1.72it/s]Loss: 0.00425:  90%|████████▉ | 180/201 [01:49<00:12,  1.72it/s]Loss: 0.00425:  90%|█████████ | 181/201 [01:50<00:11,  1.69it/s]Loss: 0.00427:  90%|█████████ | 181/201 [01:50<00:11,  1.69it/s]Loss: 0.00427:  91%|█████████ | 182/201 [01:51<00:11,  1.70it/s]Loss: 0.00423:  91%|█████████ | 182/201 [01:51<00:11,  1.70it/s]Loss: 0.00423:  91%|█████████ | 183/201 [01:51<00:10,  1.71it/s]Loss: 0.00417:  91%|█████████ | 183/201 [01:51<00:10,  1.71it/s]Loss: 0.00417:  92%|█████████▏| 184/201 [01:52<00:09,  1.71it/s]Loss: 0.00423:  92%|█████████▏| 184/201 [01:52<00:09,  1.71it/s]Loss: 0.00423:  92%|█████████▏| 185/201 [01:52<00:09,  1.71it/s]Loss: 0.00417:  92%|█████████▏| 185/201 [01:52<00:09,  1.71it/s]Loss: 0.00417:  93%|█████████▎| 186/201 [01:53<00:08,  1.71it/s]Loss: 0.00421:  93%|█████████▎| 186/201 [01:53<00:08,  1.71it/s]Loss: 0.00421:  93%|█████████▎| 187/201 [01:53<00:08,  1.71it/s]Loss: 0.00422:  93%|█████████▎| 187/201 [01:53<00:08,  1.71it/s]Loss: 0.00422:  94%|█████████▎| 188/201 [01:54<00:07,  1.71it/s]Loss: 0.00418:  94%|█████████▎| 188/201 [01:54<00:07,  1.71it/s]Loss: 0.00418:  94%|█████████▍| 189/201 [01:55<00:06,  1.72it/s]Loss: 0.00420:  94%|█████████▍| 189/201 [01:55<00:06,  1.72it/s]Loss: 0.00420:  95%|█████████▍| 190/201 [01:55<00:06,  1.72it/s]Loss: 0.00416:  95%|█████████▍| 190/201 [01:55<00:06,  1.72it/s]Loss: 0.00416:  95%|█████████▌| 191/201 [01:56<00:05,  1.72it/s]Loss: 0.00419:  95%|█████████▌| 191/201 [01:56<00:05,  1.72it/s]Loss: 0.00419:  96%|█████████▌| 192/201 [01:56<00:05,  1.72it/s]Loss: 0.00419:  96%|█████████▌| 192/201 [01:56<00:05,  1.72it/s]Loss: 0.00419:  96%|█████████▌| 193/201 [01:57<00:04,  1.71it/s]Loss: 0.00418:  96%|█████████▌| 193/201 [01:57<00:04,  1.71it/s]Loss: 0.00418:  97%|█████████▋| 194/201 [01:58<00:04,  1.71it/s]Loss: 0.00418:  97%|█████████▋| 194/201 [01:58<00:04,  1.71it/s]Loss: 0.00418:  97%|█████████▋| 195/201 [01:58<00:03,  1.71it/s]Loss: 0.00416:  97%|█████████▋| 195/201 [01:58<00:03,  1.71it/s]Loss: 0.00416:  98%|█████████▊| 196/201 [01:59<00:02,  1.72it/s]Loss: 0.00406:  98%|█████████▊| 196/201 [01:59<00:02,  1.72it/s]Loss: 0.00406:  98%|█████████▊| 197/201 [01:59<00:02,  1.72it/s]Loss: 0.00399:  98%|█████████▊| 197/201 [01:59<00:02,  1.72it/s]Loss: 0.00399:  99%|█████████▊| 198/201 [02:00<00:01,  1.72it/s]Loss: 0.00397:  99%|█████████▊| 198/201 [02:00<00:01,  1.72it/s]Loss: 0.00397:  99%|█████████▉| 199/201 [02:00<00:01,  1.71it/s]Loss: 0.00405:  99%|█████████▉| 199/201 [02:00<00:01,  1.71it/s]Loss: 0.00405: 100%|█████████▉| 200/201 [02:01<00:00,  1.72it/s]Loss: 0.00414: 100%|█████████▉| 200/201 [02:01<00:00,  1.72it/s]Loss: 0.00414: 100%|██████████| 201/201 [02:02<00:00,  1.69it/s]Loss: 0.00385: 100%|██████████| 201/201 [02:02<00:00,  1.69it/s]Loss: 0.00385: 100%|██████████| 201/201 [02:02<00:00,  1.65it/s]Load volume "/media/storage0/qadwu/floats/supernova_432x432x432_float32_raw_432x432x432_float.cvol"
Loaded

max loss: 0.07332523167133331
Densities: min=9.371014333709338e-15, max=0.9995036125183105, mean=0.24119672179222107
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 122.16489005088806 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json
Latent space memory: 17.5MiB
Latent space memory: 17.5MiB
Warps shared: 7 , warps mixed: 7
Loaded, output mode: density:direct
Warps shared: 7 , warps mixed: 7
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/supernova_432x432x432_float32_raw_432x432x432_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 17, 'n_features_per_level': 8, 'n_levels': 8, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 2, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 4503040
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.33it/s]1it [00:00,  3.33it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=1.1987038321854566e-14, max=0.994645893573761, mean=0.4139447808265686
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00, 97.09it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [432, 432, 432], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/supernova-20220916175236-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 8, 'n_features_per_level': 8, 'log2_hashmap_size': 17, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 2}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<00:58,  3.41it/s]Loss: 0.08518:   0%|          | 1/201 [00:00<00:58,  3.41it/s]Loss: 0.08518:   1%|          | 2/201 [00:00<00:52,  3.82it/s]Loss: 0.01489:   1%|          | 2/201 [00:00<00:52,  3.82it/s]Loss: 0.01489:   1%|▏         | 3/201 [00:00<00:49,  3.97it/s]Loss: 0.01263:   1%|▏         | 3/201 [00:00<00:49,  3.97it/s]Loss: 0.01263:   2%|▏         | 4/201 [00:01<00:48,  4.05it/s]Loss: 0.01179:   2%|▏         | 4/201 [00:01<00:48,  4.05it/s]Loss: 0.01179:   2%|▏         | 5/201 [00:01<00:47,  4.09it/s]Loss: 0.01088:   2%|▏         | 5/201 [00:01<00:47,  4.09it/s]Loss: 0.01088:   3%|▎         | 6/201 [00:01<00:47,  4.12it/s]Loss: 0.00998:   3%|▎         | 6/201 [00:01<00:47,  4.12it/s]Loss: 0.00998:   3%|▎         | 7/201 [00:01<00:46,  4.14it/s]Loss: 0.00975:   3%|▎         | 7/201 [00:01<00:46,  4.14it/s]Loss: 0.00975:   4%|▍         | 8/201 [00:01<00:46,  4.15it/s]Loss: 0.00924:   4%|▍         | 8/201 [00:01<00:46,  4.15it/s]Loss: 0.00924:   4%|▍         | 9/201 [00:02<00:46,  4.15it/s]Loss: 0.00909:   4%|▍         | 9/201 [00:02<00:46,  4.15it/s]Loss: 0.00909:   5%|▍         | 10/201 [00:02<00:45,  4.16it/s]Loss: 0.00897:   5%|▍         | 10/201 [00:02<00:45,  4.16it/s]Loss: 0.00897:   5%|▌         | 11/201 [00:02<00:45,  4.16it/s]Loss: 0.00882:   5%|▌         | 11/201 [00:02<00:45,  4.16it/s]Loss: 0.00882:   6%|▌         | 12/201 [00:02<00:45,  4.17it/s]Loss: 0.00872:   6%|▌         | 12/201 [00:02<00:45,  4.17it/s]Loss: 0.00872:   6%|▋         | 13/201 [00:03<00:45,  4.17it/s]Loss: 0.00835:   6%|▋         | 13/201 [00:03<00:45,  4.17it/s]Loss: 0.00835:   7%|▋         | 14/201 [00:03<00:45,  4.15it/s]Loss: 0.00845:   7%|▋         | 14/201 [00:03<00:45,  4.15it/s]Loss: 0.00845:   7%|▋         | 15/201 [00:03<00:44,  4.15it/s]Loss: 0.00826:   7%|▋         | 15/201 [00:03<00:44,  4.15it/s]Loss: 0.00826:   8%|▊         | 16/201 [00:03<00:44,  4.16it/s]Loss: 0.00819:   8%|▊         | 16/201 [00:03<00:44,  4.16it/s]Loss: 0.00819:   8%|▊         | 17/201 [00:04<00:44,  4.15it/s]Loss: 0.00802:   8%|▊         | 17/201 [00:04<00:44,  4.15it/s]Loss: 0.00802:   9%|▉         | 18/201 [00:04<00:44,  4.15it/s]Loss: 0.00994:   9%|▉         | 18/201 [00:04<00:44,  4.15it/s]Loss: 0.00994:   9%|▉         | 19/201 [00:04<00:43,  4.16it/s]Loss: 0.01018:   9%|▉         | 19/201 [00:04<00:43,  4.16it/s]Loss: 0.01018:  10%|▉         | 20/201 [00:04<00:43,  4.16it/s]Loss: 0.00820:  10%|▉         | 20/201 [00:04<00:43,  4.16it/s]Loss: 0.00820:  10%|█         | 21/201 [00:05<00:44,  4.03it/s]Loss: 0.00767:  10%|█         | 21/201 [00:05<00:44,  4.03it/s]Loss: 0.00767:  11%|█         | 22/201 [00:05<00:43,  4.07it/s]Loss: 0.00915:  11%|█         | 22/201 [00:05<00:43,  4.07it/s]Loss: 0.00915:  11%|█▏        | 23/201 [00:05<00:43,  4.10it/s]Loss: 0.00919:  11%|█▏        | 23/201 [00:05<00:43,  4.10it/s]Loss: 0.00919:  12%|█▏        | 24/201 [00:05<00:43,  4.10it/s]Loss: 0.00794:  12%|█▏        | 24/201 [00:05<00:43,  4.10it/s]Loss: 0.00794:  12%|█▏        | 25/201 [00:06<00:43,  4.09it/s]Loss: 0.00977:  12%|█▏        | 25/201 [00:06<00:43,  4.09it/s]Loss: 0.00977:  13%|█▎        | 26/201 [00:06<00:42,  4.10it/s]Loss: 0.00753:  13%|█▎        | 26/201 [00:06<00:42,  4.10it/s]Loss: 0.00753:  13%|█▎        | 27/201 [00:06<00:42,  4.12it/s]Loss: 0.00675:  13%|█▎        | 27/201 [00:06<00:42,  4.12it/s]Loss: 0.00675:  14%|█▍        | 28/201 [00:06<00:41,  4.14it/s]Loss: 0.00690:  14%|█▍        | 28/201 [00:06<00:41,  4.14it/s]Loss: 0.00690:  14%|█▍        | 29/201 [00:07<00:41,  4.15it/s]Loss: 0.00883:  14%|█▍        | 29/201 [00:07<00:41,  4.15it/s]Loss: 0.00883:  15%|█▍        | 30/201 [00:07<00:41,  4.14it/s]Loss: 0.00828:  15%|█▍        | 30/201 [00:07<00:41,  4.14it/s]Loss: 0.00828:  15%|█▌        | 31/201 [00:07<00:40,  4.15it/s]Loss: 0.00758:  15%|█▌        | 31/201 [00:07<00:40,  4.15it/s]Loss: 0.00758:  16%|█▌        | 32/201 [00:07<00:40,  4.16it/s]Loss: 0.00762:  16%|█▌        | 32/201 [00:07<00:40,  4.16it/s]Loss: 0.00762:  16%|█▋        | 33/201 [00:08<00:40,  4.17it/s]Loss: 0.00757:  16%|█▋        | 33/201 [00:08<00:40,  4.17it/s]Loss: 0.00757:  17%|█▋        | 34/201 [00:08<00:40,  4.17it/s]Loss: 0.00782:  17%|█▋        | 34/201 [00:08<00:40,  4.17it/s]Loss: 0.00782:  17%|█▋        | 35/201 [00:08<00:39,  4.17it/s]Loss: 0.00681:  17%|█▋        | 35/201 [00:08<00:39,  4.17it/s]Loss: 0.00681:  18%|█▊        | 36/201 [00:08<00:39,  4.17it/s]Loss: 0.00825:  18%|█▊        | 36/201 [00:08<00:39,  4.17it/s]Loss: 0.00825:  18%|█▊        | 37/201 [00:08<00:39,  4.17it/s]Loss: 0.00746:  18%|█▊        | 37/201 [00:08<00:39,  4.17it/s]Loss: 0.00746:  19%|█▉        | 38/201 [00:09<00:39,  4.18it/s]Loss: 0.00701:  19%|█▉        | 38/201 [00:09<00:39,  4.18it/s]Loss: 0.00701:  19%|█▉        | 39/201 [00:09<00:38,  4.18it/s]Loss: 0.00710:  19%|█▉        | 39/201 [00:09<00:38,  4.18it/s]Loss: 0.00710:  20%|█▉        | 40/201 [00:09<00:38,  4.18it/s]Loss: 0.00740:  20%|█▉        | 40/201 [00:09<00:38,  4.18it/s]Loss: 0.00740:  20%|██        | 41/201 [00:09<00:39,  4.05it/s]Loss: 0.00716:  20%|██        | 41/201 [00:09<00:39,  4.05it/s]Loss: 0.00716:  21%|██        | 42/201 [00:10<00:38,  4.08it/s]Loss: 0.00700:  21%|██        | 42/201 [00:10<00:38,  4.08it/s]Loss: 0.00700:  21%|██▏       | 43/201 [00:10<00:38,  4.11it/s]Loss: 0.00726:  21%|██▏       | 43/201 [00:10<00:38,  4.11it/s]Loss: 0.00726:  22%|██▏       | 44/201 [00:10<00:37,  4.13it/s]Loss: 0.00717:  22%|██▏       | 44/201 [00:10<00:37,  4.13it/s]Loss: 0.00717:  22%|██▏       | 45/201 [00:10<00:37,  4.15it/s]Loss: 0.00630:  22%|██▏       | 45/201 [00:10<00:37,  4.15it/s]Loss: 0.00630:  23%|██▎       | 46/201 [00:11<00:37,  4.14it/s]Loss: 0.00751:  23%|██▎       | 46/201 [00:11<00:37,  4.14it/s]Loss: 0.00751:  23%|██▎       | 47/201 [00:11<00:37,  4.14it/s]Loss: 0.01203:  23%|██▎       | 47/201 [00:11<00:37,  4.14it/s]Loss: 0.01203:  24%|██▍       | 48/201 [00:11<00:36,  4.15it/s]Loss: 0.00736:  24%|██▍       | 48/201 [00:11<00:36,  4.15it/s]Loss: 0.00736:  24%|██▍       | 49/201 [00:11<00:36,  4.16it/s]Loss: 0.00671:  24%|██▍       | 49/201 [00:11<00:36,  4.16it/s]Loss: 0.00671:  25%|██▍       | 50/201 [00:12<00:36,  4.16it/s]Loss: 0.00589:  25%|██▍       | 50/201 [00:12<00:36,  4.16it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.17s/it][A1it [00:01,  1.17s/it]
Loss: 0.00589:  25%|██▌       | 51/201 [00:13<01:29,  1.69it/s]Loss: 0.00399:  25%|██▌       | 51/201 [00:13<01:29,  1.69it/s]Loss: 0.00399:  26%|██▌       | 52/201 [00:13<01:12,  2.05it/s]Loss: 0.00339:  26%|██▌       | 52/201 [00:13<01:12,  2.05it/s]Loss: 0.00339:  26%|██▋       | 53/201 [00:14<01:00,  2.43it/s]Loss: 0.00320:  26%|██▋       | 53/201 [00:14<01:00,  2.43it/s]Loss: 0.00320:  27%|██▋       | 54/201 [00:14<00:52,  2.78it/s]Loss: 0.00319:  27%|██▋       | 54/201 [00:14<00:52,  2.78it/s]Loss: 0.00319:  27%|██▋       | 55/201 [00:14<00:47,  3.10it/s]Loss: 0.00317:  27%|██▋       | 55/201 [00:14<00:47,  3.10it/s]Loss: 0.00317:  28%|██▊       | 56/201 [00:14<00:43,  3.37it/s]Loss: 0.00314:  28%|██▊       | 56/201 [00:14<00:43,  3.37it/s]Loss: 0.00314:  28%|██▊       | 57/201 [00:14<00:40,  3.58it/s]Loss: 0.00324:  28%|██▊       | 57/201 [00:14<00:40,  3.58it/s]Loss: 0.00324:  29%|██▉       | 58/201 [00:15<00:38,  3.75it/s]Loss: 0.00315:  29%|██▉       | 58/201 [00:15<00:38,  3.75it/s]Loss: 0.00315:  29%|██▉       | 59/201 [00:15<00:36,  3.86it/s]Loss: 0.00313:  29%|██▉       | 59/201 [00:15<00:36,  3.86it/s]Loss: 0.00313:  30%|██▉       | 60/201 [00:15<00:35,  3.93it/s]Loss: 0.00318:  30%|██▉       | 60/201 [00:15<00:35,  3.93it/s]Loss: 0.00318:  30%|███       | 61/201 [00:15<00:35,  3.90it/s]Loss: 0.00316:  30%|███       | 61/201 [00:15<00:35,  3.90it/s]Loss: 0.00316:  31%|███       | 62/201 [00:16<00:34,  3.99it/s]Loss: 0.00314:  31%|███       | 62/201 [00:16<00:34,  3.99it/s]Loss: 0.00314:  31%|███▏      | 63/201 [00:16<00:34,  4.06it/s]Loss: 0.00317:  31%|███▏      | 63/201 [00:16<00:34,  4.06it/s]Loss: 0.00317:  32%|███▏      | 64/201 [00:16<00:33,  4.10it/s]Loss: 0.00317:  32%|███▏      | 64/201 [00:16<00:33,  4.10it/s]Loss: 0.00317:  32%|███▏      | 65/201 [00:16<00:32,  4.14it/s]Loss: 0.00319:  32%|███▏      | 65/201 [00:16<00:32,  4.14it/s]Loss: 0.00319:  33%|███▎      | 66/201 [00:17<00:32,  4.16it/s]Loss: 0.00324:  33%|███▎      | 66/201 [00:17<00:32,  4.16it/s]Loss: 0.00324:  33%|███▎      | 67/201 [00:17<00:32,  4.18it/s]Loss: 0.00317:  33%|███▎      | 67/201 [00:17<00:32,  4.18it/s]Loss: 0.00317:  34%|███▍      | 68/201 [00:17<00:31,  4.20it/s]Loss: 0.00315:  34%|███▍      | 68/201 [00:17<00:31,  4.20it/s]Loss: 0.00315:  34%|███▍      | 69/201 [00:17<00:31,  4.20it/s]Loss: 0.00323:  34%|███▍      | 69/201 [00:17<00:31,  4.20it/s]Loss: 0.00323:  35%|███▍      | 70/201 [00:18<00:31,  4.21it/s]Loss: 0.00317:  35%|███▍      | 70/201 [00:18<00:31,  4.21it/s]Loss: 0.00317:  35%|███▌      | 71/201 [00:18<00:30,  4.21it/s]Loss: 0.00315:  35%|███▌      | 71/201 [00:18<00:30,  4.21it/s]Loss: 0.00315:  36%|███▌      | 72/201 [00:18<00:30,  4.22it/s]Loss: 0.00327:  36%|███▌      | 72/201 [00:18<00:30,  4.22it/s]Loss: 0.00327:  36%|███▋      | 73/201 [00:18<00:30,  4.22it/s]Loss: 0.00327:  36%|███▋      | 73/201 [00:18<00:30,  4.22it/s]Loss: 0.00327:  37%|███▋      | 74/201 [00:19<00:30,  4.22it/s]Loss: 0.00323:  37%|███▋      | 74/201 [00:19<00:30,  4.22it/s]Loss: 0.00323:  37%|███▋      | 75/201 [00:19<00:29,  4.22it/s]Loss: 0.00337:  37%|███▋      | 75/201 [00:19<00:29,  4.22it/s]Loss: 0.00337:  38%|███▊      | 76/201 [00:19<00:29,  4.22it/s]Loss: 0.00334:  38%|███▊      | 76/201 [00:19<00:29,  4.22it/s]Loss: 0.00334:  38%|███▊      | 77/201 [00:19<00:29,  4.21it/s]Loss: 0.00319:  38%|███▊      | 77/201 [00:19<00:29,  4.21it/s]Loss: 0.00319:  39%|███▉      | 78/201 [00:19<00:29,  4.18it/s]Loss: 0.00331:  39%|███▉      | 78/201 [00:19<00:29,  4.18it/s]Loss: 0.00331:  39%|███▉      | 79/201 [00:20<00:29,  4.18it/s]Loss: 0.00318:  39%|███▉      | 79/201 [00:20<00:29,  4.18it/s]Loss: 0.00318:  40%|███▉      | 80/201 [00:20<00:28,  4.19it/s]Loss: 0.00330:  40%|███▉      | 80/201 [00:20<00:28,  4.19it/s]Loss: 0.00330:  40%|████      | 81/201 [00:20<00:29,  4.07it/s]Loss: 0.00334:  40%|████      | 81/201 [00:20<00:29,  4.07it/s]Loss: 0.00334:  41%|████      | 82/201 [00:20<00:28,  4.11it/s]Loss: 0.00331:  41%|████      | 82/201 [00:20<00:28,  4.11it/s]Loss: 0.00331:  41%|████▏     | 83/201 [00:21<00:28,  4.15it/s]Loss: 0.00331:  41%|████▏     | 83/201 [00:21<00:28,  4.15it/s]Loss: 0.00331:  42%|████▏     | 84/201 [00:21<00:28,  4.17it/s]Loss: 0.00319:  42%|████▏     | 84/201 [00:21<00:28,  4.17it/s]Loss: 0.00319:  42%|████▏     | 85/201 [00:21<00:27,  4.19it/s]Loss: 0.00339:  42%|████▏     | 85/201 [00:21<00:27,  4.19it/s]Loss: 0.00339:  43%|████▎     | 86/201 [00:21<00:27,  4.20it/s]Loss: 0.00314:  43%|████▎     | 86/201 [00:21<00:27,  4.20it/s]Loss: 0.00314:  43%|████▎     | 87/201 [00:22<00:27,  4.20it/s]Loss: 0.00326:  43%|████▎     | 87/201 [00:22<00:27,  4.20it/s]Loss: 0.00326:  44%|████▍     | 88/201 [00:22<00:26,  4.21it/s]Loss: 0.00322:  44%|████▍     | 88/201 [00:22<00:26,  4.21it/s]Loss: 0.00322:  44%|████▍     | 89/201 [00:22<00:26,  4.21it/s]Loss: 0.00342:  44%|████▍     | 89/201 [00:22<00:26,  4.21it/s]Loss: 0.00342:  45%|████▍     | 90/201 [00:22<00:26,  4.18it/s]Loss: 0.00341:  45%|████▍     | 90/201 [00:22<00:26,  4.18it/s]Loss: 0.00341:  45%|████▌     | 91/201 [00:23<00:26,  4.17it/s]Loss: 0.00337:  45%|████▌     | 91/201 [00:23<00:26,  4.17it/s]Loss: 0.00337:  46%|████▌     | 92/201 [00:23<00:26,  4.19it/s]Loss: 0.00433:  46%|████▌     | 92/201 [00:23<00:26,  4.19it/s]Loss: 0.00433:  46%|████▋     | 93/201 [00:23<00:25,  4.20it/s]Loss: 0.00440:  46%|████▋     | 93/201 [00:23<00:25,  4.20it/s]Loss: 0.00440:  47%|████▋     | 94/201 [00:23<00:25,  4.20it/s]Loss: 0.00333:  47%|████▋     | 94/201 [00:23<00:25,  4.20it/s]Loss: 0.00333:  47%|████▋     | 95/201 [00:24<00:25,  4.21it/s]Loss: 0.00329:  47%|████▋     | 95/201 [00:24<00:25,  4.21it/s]Loss: 0.00329:  48%|████▊     | 96/201 [00:24<00:24,  4.21it/s]Loss: 0.00336:  48%|████▊     | 96/201 [00:24<00:24,  4.21it/s]Loss: 0.00336:  48%|████▊     | 97/201 [00:24<00:24,  4.22it/s]Loss: 0.00336:  48%|████▊     | 97/201 [00:24<00:24,  4.22it/s]Loss: 0.00336:  49%|████▉     | 98/201 [00:24<00:24,  4.22it/s]Loss: 0.00323:  49%|████▉     | 98/201 [00:24<00:24,  4.22it/s]Loss: 0.00323:  49%|████▉     | 99/201 [00:24<00:24,  4.22it/s]Loss: 0.00339:  49%|████▉     | 99/201 [00:24<00:24,  4.22it/s]Loss: 0.00339:  50%|████▉     | 100/201 [00:25<00:23,  4.22it/s]Loss: 0.00334:  50%|████▉     | 100/201 [00:25<00:23,  4.22it/s]Loss: 0.00334:  50%|█████     | 101/201 [00:25<00:24,  4.09it/s]Loss: 0.00256:  50%|█████     | 101/201 [00:25<00:24,  4.09it/s]max loss: 0.05768975242972374
Densities: min=2.310280246053736e-15, max=0.9948866367340088, mean=0.2509554922580719
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.28s/it][A1it [00:01,  1.28s/it]
Loss: 0.00256:  51%|█████     | 102/201 [00:27<01:02,  1.59it/s]Loss: 0.00359:  51%|█████     | 102/201 [00:27<01:02,  1.59it/s]Loss: 0.00359:  51%|█████     | 103/201 [00:27<00:50,  1.95it/s]Loss: 0.00325:  51%|█████     | 103/201 [00:27<00:50,  1.95it/s]Loss: 0.00325:  52%|█████▏    | 104/201 [00:27<00:41,  2.33it/s]Loss: 0.00307:  52%|█████▏    | 104/201 [00:27<00:41,  2.33it/s]Loss: 0.00307:  52%|█████▏    | 105/201 [00:27<00:35,  2.69it/s]Loss: 0.00296:  52%|█████▏    | 105/201 [00:27<00:35,  2.69it/s]Loss: 0.00296:  53%|█████▎    | 106/201 [00:27<00:31,  3.01it/s]Loss: 0.00290:  53%|█████▎    | 106/201 [00:27<00:31,  3.01it/s]Loss: 0.00290:  53%|█████▎    | 107/201 [00:28<00:28,  3.29it/s]Loss: 0.00286:  53%|█████▎    | 107/201 [00:28<00:28,  3.29it/s]Loss: 0.00286:  54%|█████▎    | 108/201 [00:28<00:26,  3.52it/s]Loss: 0.00284:  54%|█████▎    | 108/201 [00:28<00:26,  3.52it/s]Loss: 0.00284:  54%|█████▍    | 109/201 [00:28<00:24,  3.69it/s]Loss: 0.00285:  54%|█████▍    | 109/201 [00:28<00:24,  3.69it/s]Loss: 0.00285:  55%|█████▍    | 110/201 [00:28<00:23,  3.80it/s]Loss: 0.00284:  55%|█████▍    | 110/201 [00:28<00:23,  3.80it/s]Loss: 0.00284:  55%|█████▌    | 111/201 [00:29<00:23,  3.91it/s]Loss: 0.00282:  55%|█████▌    | 111/201 [00:29<00:23,  3.91it/s]Loss: 0.00282:  56%|█████▌    | 112/201 [00:29<00:22,  4.00it/s]Loss: 0.00280:  56%|█████▌    | 112/201 [00:29<00:22,  4.00it/s]Loss: 0.00280:  56%|█████▌    | 113/201 [00:29<00:21,  4.06it/s]Loss: 0.00278:  56%|█████▌    | 113/201 [00:29<00:21,  4.06it/s]Loss: 0.00278:  57%|█████▋    | 114/201 [00:29<00:21,  4.10it/s]Loss: 0.00275:  57%|█████▋    | 114/201 [00:29<00:21,  4.10it/s]Loss: 0.00275:  57%|█████▋    | 115/201 [00:30<00:20,  4.13it/s]Loss: 0.00282:  57%|█████▋    | 115/201 [00:30<00:20,  4.13it/s]Loss: 0.00282:  58%|█████▊    | 116/201 [00:30<00:20,  4.16it/s]Loss: 0.00281:  58%|█████▊    | 116/201 [00:30<00:20,  4.16it/s]Loss: 0.00281:  58%|█████▊    | 117/201 [00:30<00:20,  4.17it/s]Loss: 0.00277:  58%|█████▊    | 117/201 [00:30<00:20,  4.17it/s]Loss: 0.00277:  59%|█████▊    | 118/201 [00:30<00:19,  4.18it/s]Loss: 0.00276:  59%|█████▊    | 118/201 [00:30<00:19,  4.18it/s]Loss: 0.00276:  59%|█████▉    | 119/201 [00:31<00:19,  4.19it/s]Loss: 0.00276:  59%|█████▉    | 119/201 [00:31<00:19,  4.19it/s]Loss: 0.00276:  60%|█████▉    | 120/201 [00:31<00:19,  4.20it/s]Loss: 0.00277:  60%|█████▉    | 120/201 [00:31<00:19,  4.20it/s]Loss: 0.00277:  60%|██████    | 121/201 [00:31<00:19,  4.07it/s]Loss: 0.00273:  60%|██████    | 121/201 [00:31<00:19,  4.07it/s]Loss: 0.00273:  61%|██████    | 122/201 [00:31<00:19,  4.11it/s]Loss: 0.00279:  61%|██████    | 122/201 [00:31<00:19,  4.11it/s]Loss: 0.00279:  61%|██████    | 123/201 [00:32<00:18,  4.14it/s]Loss: 0.00275:  61%|██████    | 123/201 [00:32<00:18,  4.14it/s]Loss: 0.00275:  62%|██████▏   | 124/201 [00:32<00:18,  4.16it/s]Loss: 0.00282:  62%|██████▏   | 124/201 [00:32<00:18,  4.16it/s]Loss: 0.00282:  62%|██████▏   | 125/201 [00:32<00:18,  4.17it/s]Loss: 0.00273:  62%|██████▏   | 125/201 [00:32<00:18,  4.17it/s]Loss: 0.00273:  63%|██████▎   | 126/201 [00:32<00:17,  4.18it/s]Loss: 0.00274:  63%|██████▎   | 126/201 [00:32<00:17,  4.18it/s]Loss: 0.00274:  63%|██████▎   | 127/201 [00:32<00:17,  4.19it/s]Loss: 0.00278:  63%|██████▎   | 127/201 [00:32<00:17,  4.19it/s]Loss: 0.00278:  64%|██████▎   | 128/201 [00:33<00:17,  4.20it/s]Loss: 0.00279:  64%|██████▎   | 128/201 [00:33<00:17,  4.20it/s]Loss: 0.00279:  64%|██████▍   | 129/201 [00:33<00:17,  4.20it/s]Loss: 0.00271:  64%|██████▍   | 129/201 [00:33<00:17,  4.20it/s]Loss: 0.00271:  65%|██████▍   | 130/201 [00:33<00:16,  4.20it/s]Loss: 0.00283:  65%|██████▍   | 130/201 [00:33<00:16,  4.20it/s]Loss: 0.00283:  65%|██████▌   | 131/201 [00:33<00:16,  4.20it/s]Loss: 0.00271:  65%|██████▌   | 131/201 [00:33<00:16,  4.20it/s]Loss: 0.00271:  66%|██████▌   | 132/201 [00:34<00:16,  4.20it/s]Loss: 0.00279:  66%|██████▌   | 132/201 [00:34<00:16,  4.20it/s]Loss: 0.00279:  66%|██████▌   | 133/201 [00:34<00:16,  4.18it/s]Loss: 0.00273:  66%|██████▌   | 133/201 [00:34<00:16,  4.18it/s]Loss: 0.00273:  67%|██████▋   | 134/201 [00:34<00:16,  4.19it/s]Loss: 0.00280:  67%|██████▋   | 134/201 [00:34<00:16,  4.19it/s]Loss: 0.00280:  67%|██████▋   | 135/201 [00:34<00:15,  4.19it/s]Loss: 0.00276:  67%|██████▋   | 135/201 [00:34<00:15,  4.19it/s]Loss: 0.00276:  68%|██████▊   | 136/201 [00:35<00:15,  4.20it/s]Loss: 0.00274:  68%|██████▊   | 136/201 [00:35<00:15,  4.20it/s]Loss: 0.00274:  68%|██████▊   | 137/201 [00:35<00:15,  4.20it/s]Loss: 0.00271:  68%|██████▊   | 137/201 [00:35<00:15,  4.20it/s]Loss: 0.00271:  69%|██████▊   | 138/201 [00:35<00:14,  4.21it/s]Loss: 0.00275:  69%|██████▊   | 138/201 [00:35<00:14,  4.21it/s]Loss: 0.00275:  69%|██████▉   | 139/201 [00:35<00:14,  4.22it/s]Loss: 0.00273:  69%|██████▉   | 139/201 [00:35<00:14,  4.22it/s]Loss: 0.00273:  70%|██████▉   | 140/201 [00:36<00:14,  4.22it/s]Loss: 0.00273:  70%|██████▉   | 140/201 [00:36<00:14,  4.22it/s]Loss: 0.00273:  70%|███████   | 141/201 [00:36<00:14,  4.05it/s]Loss: 0.00270:  70%|███████   | 141/201 [00:36<00:14,  4.05it/s]Loss: 0.00270:  71%|███████   | 142/201 [00:36<00:14,  4.10it/s]Loss: 0.00273:  71%|███████   | 142/201 [00:36<00:14,  4.10it/s]Loss: 0.00273:  71%|███████   | 143/201 [00:36<00:14,  4.13it/s]Loss: 0.00274:  71%|███████   | 143/201 [00:36<00:14,  4.13it/s]Loss: 0.00274:  72%|███████▏  | 144/201 [00:37<00:13,  4.16it/s]Loss: 0.00261:  72%|███████▏  | 144/201 [00:37<00:13,  4.16it/s]Loss: 0.00261:  72%|███████▏  | 145/201 [00:37<00:13,  4.17it/s]Loss: 0.00270:  72%|███████▏  | 145/201 [00:37<00:13,  4.17it/s]Loss: 0.00270:  73%|███████▎  | 146/201 [00:37<00:13,  4.19it/s]Loss: 0.00265:  73%|███████▎  | 146/201 [00:37<00:13,  4.19it/s]Loss: 0.00265:  73%|███████▎  | 147/201 [00:37<00:12,  4.19it/s]Loss: 0.00265:  73%|███████▎  | 147/201 [00:37<00:12,  4.19it/s]Loss: 0.00265:  74%|███████▎  | 148/201 [00:38<00:12,  4.20it/s]Loss: 0.00269:  74%|███████▎  | 148/201 [00:38<00:12,  4.20it/s]Loss: 0.00269:  74%|███████▍  | 149/201 [00:38<00:12,  4.20it/s]Loss: 0.00267:  74%|███████▍  | 149/201 [00:38<00:12,  4.20it/s]Loss: 0.00267:  75%|███████▍  | 150/201 [00:38<00:12,  4.21it/s]Loss: 0.00262:  75%|███████▍  | 150/201 [00:38<00:12,  4.21it/s]Loss: 0.00262:  75%|███████▌  | 151/201 [00:38<00:11,  4.21it/s]Loss: 0.00271:  75%|███████▌  | 151/201 [00:38<00:11,  4.21it/s]Loss: 0.00271:  76%|███████▌  | 152/201 [00:38<00:11,  4.21it/s]Loss: 0.00266:  76%|███████▌  | 152/201 [00:38<00:11,  4.21it/s]max loss: 0.034530267119407654
Densities: min=2.764855723790807e-15, max=0.996854305267334, mean=0.30103781819343567
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.28s/it][A1it [00:01,  1.28s/it]
Loss: 0.00266:  76%|███████▌  | 153/201 [00:40<00:29,  1.60it/s]Loss: 0.00327:  76%|███████▌  | 153/201 [00:40<00:29,  1.60it/s]Loss: 0.00327:  77%|███████▋  | 154/201 [00:40<00:23,  1.96it/s]Loss: 0.00299:  77%|███████▋  | 154/201 [00:40<00:23,  1.96it/s]Loss: 0.00299:  77%|███████▋  | 155/201 [00:40<00:19,  2.34it/s]Loss: 0.00289:  77%|███████▋  | 155/201 [00:40<00:19,  2.34it/s]Loss: 0.00289:  78%|███████▊  | 156/201 [00:41<00:16,  2.70it/s]Loss: 0.00286:  78%|███████▊  | 156/201 [00:41<00:16,  2.70it/s]Loss: 0.00286:  78%|███████▊  | 157/201 [00:41<00:14,  3.02it/s]Loss: 0.00288:  78%|███████▊  | 157/201 [00:41<00:14,  3.02it/s]Loss: 0.00288:  79%|███████▊  | 158/201 [00:41<00:13,  3.30it/s]Loss: 0.00283:  79%|███████▊  | 158/201 [00:41<00:13,  3.30it/s]Loss: 0.00283:  79%|███████▉  | 159/201 [00:41<00:11,  3.53it/s]Loss: 0.00293:  79%|███████▉  | 159/201 [00:41<00:11,  3.53it/s]Loss: 0.00293:  80%|███████▉  | 160/201 [00:42<00:11,  3.70it/s]Loss: 0.00287:  80%|███████▉  | 160/201 [00:42<00:11,  3.70it/s]Loss: 0.00287:  80%|████████  | 161/201 [00:42<00:10,  3.68it/s]Loss: 0.00290:  80%|████████  | 161/201 [00:42<00:10,  3.68it/s]Loss: 0.00290:  81%|████████  | 162/201 [00:42<00:10,  3.83it/s]Loss: 0.00285:  81%|████████  | 162/201 [00:42<00:10,  3.83it/s]Loss: 0.00285:  81%|████████  | 163/201 [00:42<00:09,  3.94it/s]Loss: 0.00281:  81%|████████  | 163/201 [00:42<00:09,  3.94it/s]Loss: 0.00281:  82%|████████▏ | 164/201 [00:43<00:09,  4.01it/s]Loss: 0.00282:  82%|████████▏ | 164/201 [00:43<00:09,  4.01it/s]Loss: 0.00282:  82%|████████▏ | 165/201 [00:43<00:08,  4.07it/s]Loss: 0.00292:  82%|████████▏ | 165/201 [00:43<00:08,  4.07it/s]Loss: 0.00292:  83%|████████▎ | 166/201 [00:43<00:08,  4.11it/s]Loss: 0.00280:  83%|████████▎ | 166/201 [00:43<00:08,  4.11it/s]Loss: 0.00280:  83%|████████▎ | 167/201 [00:43<00:08,  4.14it/s]Loss: 0.00284:  83%|████████▎ | 167/201 [00:43<00:08,  4.14it/s]Loss: 0.00284:  84%|████████▎ | 168/201 [00:44<00:07,  4.16it/s]Loss: 0.00281:  84%|████████▎ | 168/201 [00:44<00:07,  4.16it/s]Loss: 0.00281:  84%|████████▍ | 169/201 [00:44<00:07,  4.18it/s]Loss: 0.00275:  84%|████████▍ | 169/201 [00:44<00:07,  4.18it/s]Loss: 0.00275:  85%|████████▍ | 170/201 [00:44<00:07,  4.19it/s]Loss: 0.00287:  85%|████████▍ | 170/201 [00:44<00:07,  4.19it/s]Loss: 0.00287:  85%|████████▌ | 171/201 [00:44<00:07,  4.20it/s]Loss: 0.00281:  85%|████████▌ | 171/201 [00:44<00:07,  4.20it/s]Loss: 0.00281:  86%|████████▌ | 172/201 [00:45<00:06,  4.20it/s]Loss: 0.00269:  86%|████████▌ | 172/201 [00:45<00:06,  4.20it/s]Loss: 0.00269:  86%|████████▌ | 173/201 [00:45<00:06,  4.21it/s]Loss: 0.00267:  86%|████████▌ | 173/201 [00:45<00:06,  4.21it/s]Loss: 0.00267:  87%|████████▋ | 174/201 [00:45<00:06,  4.21it/s]Loss: 0.00283:  87%|████████▋ | 174/201 [00:45<00:06,  4.21it/s]Loss: 0.00283:  87%|████████▋ | 175/201 [00:45<00:06,  4.21it/s]Loss: 0.00279:  87%|████████▋ | 175/201 [00:45<00:06,  4.21it/s]Loss: 0.00279:  88%|████████▊ | 176/201 [00:45<00:05,  4.21it/s]Loss: 0.00275:  88%|████████▊ | 176/201 [00:45<00:05,  4.21it/s]Loss: 0.00275:  88%|████████▊ | 177/201 [00:46<00:05,  4.21it/s]Loss: 0.00274:  88%|████████▊ | 177/201 [00:46<00:05,  4.21it/s]Loss: 0.00274:  89%|████████▊ | 178/201 [00:46<00:05,  4.18it/s]Loss: 0.00272:  89%|████████▊ | 178/201 [00:46<00:05,  4.18it/s]Loss: 0.00272:  89%|████████▉ | 179/201 [00:46<00:05,  4.16it/s]Loss: 0.00264:  89%|████████▉ | 179/201 [00:46<00:05,  4.16it/s]Loss: 0.00264:  90%|████████▉ | 180/201 [00:46<00:05,  4.17it/s]Loss: 0.00275:  90%|████████▉ | 180/201 [00:46<00:05,  4.17it/s]Loss: 0.00275:  90%|█████████ | 181/201 [00:47<00:04,  4.05it/s]Loss: 0.00271:  90%|█████████ | 181/201 [00:47<00:04,  4.05it/s]Loss: 0.00271:  91%|█████████ | 182/201 [00:47<00:04,  4.10it/s]Loss: 0.00261:  91%|█████████ | 182/201 [00:47<00:04,  4.10it/s]Loss: 0.00261:  91%|█████████ | 183/201 [00:47<00:04,  4.13it/s]Loss: 0.00273:  91%|█████████ | 183/201 [00:47<00:04,  4.13it/s]Loss: 0.00273:  92%|█████████▏| 184/201 [00:47<00:04,  4.16it/s]Loss: 0.00263:  92%|█████████▏| 184/201 [00:47<00:04,  4.16it/s]Loss: 0.00263:  92%|█████████▏| 185/201 [00:48<00:03,  4.17it/s]Loss: 0.00273:  92%|█████████▏| 185/201 [00:48<00:03,  4.17it/s]Loss: 0.00273:  93%|█████████▎| 186/201 [00:48<00:03,  4.19it/s]Loss: 0.00264:  93%|█████████▎| 186/201 [00:48<00:03,  4.19it/s]Loss: 0.00264:  93%|█████████▎| 187/201 [00:48<00:03,  4.17it/s]Loss: 0.00267:  93%|█████████▎| 187/201 [00:48<00:03,  4.17it/s]Loss: 0.00267:  94%|█████████▎| 188/201 [00:48<00:03,  4.14it/s]Loss: 0.00258:  94%|█████████▎| 188/201 [00:48<00:03,  4.14it/s]Loss: 0.00258:  94%|█████████▍| 189/201 [00:49<00:02,  4.16it/s]Loss: 0.00263:  94%|█████████▍| 189/201 [00:49<00:02,  4.16it/s]Loss: 0.00263:  95%|█████████▍| 190/201 [00:49<00:02,  4.18it/s]Loss: 0.00266:  95%|█████████▍| 190/201 [00:49<00:02,  4.18it/s]Loss: 0.00266:  95%|█████████▌| 191/201 [00:49<00:02,  4.18it/s]Loss: 0.00267:  95%|█████████▌| 191/201 [00:49<00:02,  4.18it/s]Loss: 0.00267:  96%|█████████▌| 192/201 [00:49<00:02,  4.19it/s]Loss: 0.00258:  96%|█████████▌| 192/201 [00:49<00:02,  4.19it/s]Loss: 0.00258:  96%|█████████▌| 193/201 [00:50<00:01,  4.20it/s]Loss: 0.00253:  96%|█████████▌| 193/201 [00:50<00:01,  4.20it/s]Loss: 0.00253:  97%|█████████▋| 194/201 [00:50<00:01,  4.20it/s]Loss: 0.00269:  97%|█████████▋| 194/201 [00:50<00:01,  4.20it/s]Loss: 0.00269:  97%|█████████▋| 195/201 [00:50<00:01,  4.21it/s]Loss: 0.00267:  97%|█████████▋| 195/201 [00:50<00:01,  4.21it/s]Loss: 0.00267:  98%|█████████▊| 196/201 [00:50<00:01,  4.21it/s]Loss: 0.00251:  98%|█████████▊| 196/201 [00:50<00:01,  4.21it/s]Loss: 0.00251:  98%|█████████▊| 197/201 [00:51<00:00,  4.21it/s]Loss: 0.00258:  98%|█████████▊| 197/201 [00:51<00:00,  4.21it/s]Loss: 0.00258:  99%|█████████▊| 198/201 [00:51<00:00,  4.21it/s]Loss: 0.00265:  99%|█████████▊| 198/201 [00:51<00:00,  4.21it/s]Loss: 0.00265:  99%|█████████▉| 199/201 [00:51<00:00,  4.21it/s]Loss: 0.00249:  99%|█████████▉| 199/201 [00:51<00:00,  4.21it/s]Loss: 0.00249: 100%|█████████▉| 200/201 [00:51<00:00,  4.22it/s]Loss: 0.00259: 100%|█████████▉| 200/201 [00:51<00:00,  4.22it/s]Loss: 0.00259: 100%|██████████| 201/201 [00:52<00:00,  4.09it/s]Loss: 0.00212: 100%|██████████| 201/201 [00:52<00:00,  4.09it/s]Loss: 0.00212: 100%|██████████| 201/201 [00:52<00:00,  3.87it/s]
max loss: 0.031160250306129456
Densities: min=9.367968403231012e-15, max=0.9995036125183105, mean=0.3028338551521301
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/supernova_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 52.003448486328125 seconds
-1.0 2.0048828
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/1atm_heatrelease_1152x320x853_float32_raw_1152x320x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_1atm.json
Initialize network
Latent space memory: 57.4MiB
# of network parameters: 15076737
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.43it/s]1it [00:00,  4.43it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.9459043741226196
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  1.96it/s]Render: : 1it [00:00,  1.96it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_1atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 98, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 320, 853], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<06:37,  1.99s/it]Loss: 0.16382:   0%|          | 1/201 [00:01<06:37,  1.99s/it]Loss: 0.16382:   1%|          | 2/201 [00:03<04:55,  1.48s/it]Loss: 0.06313:   1%|          | 2/201 [00:03<04:55,  1.48s/it]Loss: 0.06313:   1%|▏         | 3/201 [00:04<04:22,  1.33s/it]Loss: 0.02982:   1%|▏         | 3/201 [00:04<04:22,  1.33s/it]Loss: 0.02982:   2%|▏         | 4/201 [00:05<04:06,  1.25s/it]Loss: 0.03003:   2%|▏         | 4/201 [00:05<04:06,  1.25s/it]Loss: 0.03003:   2%|▏         | 5/201 [00:06<03:57,  1.21s/it]Loss: 0.02768:   2%|▏         | 5/201 [00:06<03:57,  1.21s/it]Loss: 0.02768:   3%|▎         | 6/201 [00:07<03:51,  1.19s/it]Loss: 0.02206:   3%|▎         | 6/201 [00:07<03:51,  1.19s/it]Loss: 0.02206:   3%|▎         | 7/201 [00:08<03:47,  1.17s/it]Loss: 0.01977:   3%|▎         | 7/201 [00:08<03:47,  1.17s/it]Loss: 0.01977:   4%|▍         | 8/201 [00:09<03:44,  1.16s/it]Loss: 0.01835:   4%|▍         | 8/201 [00:09<03:44,  1.16s/it]Loss: 0.01835:   4%|▍         | 9/201 [00:11<03:41,  1.16s/it]Loss: 0.01878:   4%|▍         | 9/201 [00:11<03:41,  1.16s/it]Loss: 0.01878:   5%|▍         | 10/201 [00:12<03:39,  1.15s/it]Loss: 0.02130:   5%|▍         | 10/201 [00:12<03:39,  1.15s/it]Loss: 0.02130:   5%|▌         | 11/201 [00:13<03:38,  1.15s/it]Loss: 0.02303:   5%|▌         | 11/201 [00:13<03:38,  1.15s/it]Loss: 0.02303:   6%|▌         | 12/201 [00:14<03:36,  1.15s/it]Loss: 0.01525:   6%|▌         | 12/201 [00:14<03:36,  1.15s/it]Loss: 0.01525:   6%|▋         | 13/201 [00:15<03:34,  1.14s/it]Loss: 0.01759:   6%|▋         | 13/201 [00:15<03:34,  1.14s/it]Loss: 0.01759:   7%|▋         | 14/201 [00:16<03:33,  1.14s/it]Loss: 0.01454:   7%|▋         | 14/201 [00:16<03:33,  1.14s/it]Loss: 0.01454:   7%|▋         | 15/201 [00:17<03:32,  1.14s/it]Loss: 0.01054:   7%|▋         | 15/201 [00:17<03:32,  1.14s/it]Loss: 0.01054:   8%|▊         | 16/201 [00:19<03:31,  1.14s/it]Loss: 0.01007:   8%|▊         | 16/201 [00:19<03:31,  1.14s/it]Loss: 0.01007:   8%|▊         | 17/201 [00:20<03:29,  1.14s/it]Loss: 0.00978:   8%|▊         | 17/201 [00:20<03:29,  1.14s/it]Loss: 0.00978:   9%|▉         | 18/201 [00:21<03:28,  1.14s/it]Loss: 0.00951:   9%|▉         | 18/201 [00:21<03:28,  1.14s/it]Loss: 0.00951:   9%|▉         | 19/201 [00:22<03:27,  1.14s/it]Loss: 0.00929:   9%|▉         | 19/201 [00:22<03:27,  1.14s/it]Loss: 0.00929:  10%|▉         | 20/201 [00:23<03:26,  1.14s/it]Loss: 0.00906:  10%|▉         | 20/201 [00:23<03:26,  1.14s/it]Loss: 0.00906:  10%|█         | 21/201 [00:24<03:33,  1.19s/it]Loss: 0.00891:  10%|█         | 21/201 [00:24<03:33,  1.19s/it]Loss: 0.00891:  11%|█         | 22/201 [00:26<03:29,  1.17s/it]Loss: 0.00872:  11%|█         | 22/201 [00:26<03:29,  1.17s/it]Loss: 0.00872:  11%|█▏        | 23/201 [00:27<03:26,  1.16s/it]Loss: 0.00857:  11%|█▏        | 23/201 [00:27<03:26,  1.16s/it]Loss: 0.00857:  12%|█▏        | 24/201 [00:28<03:24,  1.15s/it]Loss: 0.00852:  12%|█▏        | 24/201 [00:28<03:24,  1.15s/it]Loss: 0.00852:  12%|█▏        | 25/201 [00:29<03:22,  1.15s/it]Loss: 0.00826:  12%|█▏        | 25/201 [00:29<03:22,  1.15s/it]Loss: 0.00826:  13%|█▎        | 26/201 [00:30<03:20,  1.15s/it]Loss: 0.00820:  13%|█▎        | 26/201 [00:30<03:20,  1.15s/it]Loss: 0.00820:  13%|█▎        | 27/201 [00:31<03:19,  1.15s/it]Loss: 0.00810:  13%|█▎        | 27/201 [00:31<03:19,  1.15s/it]Loss: 0.00810:  14%|█▍        | 28/201 [00:32<03:17,  1.14s/it]Loss: 0.00799:  14%|█▍        | 28/201 [00:32<03:17,  1.14s/it]Loss: 0.00799:  14%|█▍        | 29/201 [00:34<03:16,  1.14s/it]Loss: 0.00783:  14%|█▍        | 29/201 [00:34<03:16,  1.14s/it]Loss: 0.00783:  15%|█▍        | 30/201 [00:35<03:15,  1.14s/it]Loss: 0.00770:  15%|█▍        | 30/201 [00:35<03:15,  1.14s/it]Loss: 0.00770:  15%|█▌        | 31/201 [00:36<03:13,  1.14s/it]Loss: 0.00760:  15%|█▌        | 31/201 [00:36<03:13,  1.14s/it]Loss: 0.00760:  16%|█▌        | 32/201 [00:37<03:12,  1.14s/it]Loss: 0.00745:  16%|█▌        | 32/201 [00:37<03:12,  1.14s/it]Loss: 0.00745:  16%|█▋        | 33/201 [00:38<03:11,  1.14s/it]Loss: 0.00737:  16%|█▋        | 33/201 [00:38<03:11,  1.14s/it]Loss: 0.00737:  17%|█▋        | 34/201 [00:39<03:10,  1.14s/it]Loss: 0.00753:  17%|█▋        | 34/201 [00:39<03:10,  1.14s/it]Loss: 0.00753:  17%|█▋        | 35/201 [00:40<03:09,  1.14s/it]Loss: 0.00733:  17%|█▋        | 35/201 [00:40<03:09,  1.14s/it]Loss: 0.00733:  18%|█▊        | 36/201 [00:42<03:08,  1.14s/it]Loss: 0.00726:  18%|█▊        | 36/201 [00:42<03:08,  1.14s/it]Loss: 0.00726:  18%|█▊        | 37/201 [00:43<03:06,  1.14s/it]Loss: 0.00714:  18%|█▊        | 37/201 [00:43<03:06,  1.14s/it]Loss: 0.00714:  19%|█▉        | 38/201 [00:44<03:05,  1.14s/it]Loss: 0.00702:  19%|█▉        | 38/201 [00:44<03:05,  1.14s/it]Loss: 0.00702:  19%|█▉        | 39/201 [00:45<03:04,  1.14s/it]Loss: 0.00692:  19%|█▉        | 39/201 [00:45<03:04,  1.14s/it]Loss: 0.00692:  20%|█▉        | 40/201 [00:46<03:03,  1.14s/it]Loss: 0.00691:  20%|█▉        | 40/201 [00:46<03:03,  1.14s/it]Loss: 0.00691:  20%|██        | 41/201 [00:47<03:11,  1.20s/it]Loss: 0.01117:  20%|██        | 41/201 [00:47<03:11,  1.20s/it]Loss: 0.01117:  21%|██        | 42/201 [00:49<03:06,  1.17s/it]Loss: 0.01507:  21%|██        | 42/201 [00:49<03:06,  1.17s/it]Loss: 0.01507:  21%|██▏       | 43/201 [00:50<03:03,  1.16s/it]Loss: 0.01073:  21%|██▏       | 43/201 [00:50<03:03,  1.16s/it]Loss: 0.01073:  22%|██▏       | 44/201 [00:51<03:01,  1.16s/it]Loss: 0.01523:  22%|██▏       | 44/201 [00:51<03:01,  1.16s/it]Loss: 0.01523:  22%|██▏       | 45/201 [00:52<02:59,  1.15s/it]Loss: 0.01114:  22%|██▏       | 45/201 [00:52<02:59,  1.15s/it]Loss: 0.01114:  23%|██▎       | 46/201 [00:53<02:57,  1.15s/it]Loss: 0.01019:  23%|██▎       | 46/201 [00:53<02:57,  1.15s/it]Loss: 0.01019:  23%|██▎       | 47/201 [00:54<02:56,  1.15s/it]Loss: 0.00983:  23%|██▎       | 47/201 [00:54<02:56,  1.15s/it]Loss: 0.00983:  24%|██▍       | 48/201 [00:55<02:54,  1.14s/it]Loss: 0.00982:  24%|██▍       | 48/201 [00:55<02:54,  1.14s/it]Loss: 0.00982:  24%|██▍       | 49/201 [00:57<02:53,  1.14s/it]Loss: 0.00971:  24%|██▍       | 49/201 [00:57<02:53,  1.14s/it]Loss: 0.00971:  25%|██▍       | 50/201 [00:58<02:52,  1.14s/it]Loss: 0.00936:  25%|██▍       | 50/201 [00:58<02:52,  1.14s/it]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.45s/it][A1it [00:01,  1.45s/it]
Loss: 0.00936:  25%|██▌       | 51/201 [01:00<03:53,  1.56s/it]Loss: 0.07312:  25%|██▌       | 51/201 [01:00<03:53,  1.56s/it]Loss: 0.07312:  26%|██▌       | 52/201 [01:01<03:31,  1.42s/it]Loss: 0.05163:  26%|██▌       | 52/201 [01:01<03:31,  1.42s/it]Loss: 0.05163:  26%|██▋       | 53/201 [01:02<03:14,  1.32s/it]Loss: 0.04251:  26%|██▋       | 53/201 [01:02<03:14,  1.32s/it]Loss: 0.04251:  27%|██▋       | 54/201 [01:03<03:03,  1.25s/it]Loss: 0.03807:  27%|██▋       | 54/201 [01:03<03:03,  1.25s/it]Loss: 0.03807:  27%|██▋       | 55/201 [01:05<02:55,  1.20s/it]Loss: 0.03555:  27%|██▋       | 55/201 [01:05<02:55,  1.20s/it]Loss: 0.03555:  28%|██▊       | 56/201 [01:06<02:48,  1.16s/it]Loss: 0.03382:  28%|██▊       | 56/201 [01:06<02:48,  1.16s/it]Loss: 0.03382:  28%|██▊       | 57/201 [01:07<02:44,  1.14s/it]Loss: 0.03278:  28%|██▊       | 57/201 [01:07<02:44,  1.14s/it]Loss: 0.03278:  29%|██▉       | 58/201 [01:08<02:40,  1.12s/it]Loss: 0.03089:  29%|██▉       | 58/201 [01:08<02:40,  1.12s/it]Loss: 0.03089:  29%|██▉       | 59/201 [01:09<02:38,  1.11s/it]Loss: 0.02996:  29%|██▉       | 59/201 [01:09<02:38,  1.11s/it]Loss: 0.02996:  30%|██▉       | 60/201 [01:10<02:35,  1.10s/it]Loss: 0.02913:  30%|██▉       | 60/201 [01:10<02:35,  1.10s/it]Loss: 0.02913:  30%|███       | 61/201 [01:11<02:40,  1.15s/it]Loss: 0.02844:  30%|███       | 61/201 [01:11<02:40,  1.15s/it]Loss: 0.02844:  31%|███       | 62/201 [01:12<02:36,  1.12s/it]Loss: 0.02760:  31%|███       | 62/201 [01:12<02:36,  1.12s/it]Loss: 0.02760:  31%|███▏      | 63/201 [01:13<02:33,  1.11s/it]Loss: 0.02665:  31%|███▏      | 63/201 [01:13<02:33,  1.11s/it]Loss: 0.02665:  32%|███▏      | 64/201 [01:14<02:31,  1.11s/it]Loss: 0.02711:  32%|███▏      | 64/201 [01:14<02:31,  1.11s/it]Loss: 0.02711:  32%|███▏      | 65/201 [01:16<02:29,  1.10s/it]Loss: 0.02618:  32%|███▏      | 65/201 [01:16<02:29,  1.10s/it]Loss: 0.02618:  33%|███▎      | 66/201 [01:17<02:27,  1.09s/it]Loss: 0.02521:  33%|███▎      | 66/201 [01:17<02:27,  1.09s/it]Loss: 0.02521:  33%|███▎      | 67/201 [01:18<02:26,  1.09s/it]Loss: 0.02489:  33%|███▎      | 67/201 [01:18<02:26,  1.09s/it]Loss: 0.02489:  34%|███▍      | 68/201 [01:19<02:25,  1.09s/it]Loss: 0.02442:  34%|███▍      | 68/201 [01:19<02:25,  1.09s/it]Loss: 0.02442:  34%|███▍      | 69/201 [01:20<02:23,  1.09s/it]Loss: 0.02413:  34%|███▍      | 69/201 [01:20<02:23,  1.09s/it]Loss: 0.02413:  35%|███▍      | 70/201 [01:21<02:22,  1.09s/it]Loss: 0.02417:  35%|███▍      | 70/201 [01:21<02:22,  1.09s/it]Loss: 0.02417:  35%|███▌      | 71/201 [01:22<02:21,  1.09s/it]Loss: 0.02335:  35%|███▌      | 71/201 [01:22<02:21,  1.09s/it]Loss: 0.02335:  36%|███▌      | 72/201 [01:23<02:20,  1.09s/it]Loss: 0.02337:  36%|███▌      | 72/201 [01:23<02:20,  1.09s/it]Loss: 0.02337:  36%|███▋      | 73/201 [01:24<02:19,  1.09s/it]Loss: 0.02305:  36%|███▋      | 73/201 [01:24<02:19,  1.09s/it]Loss: 0.02305:  37%|███▋      | 74/201 [01:25<02:18,  1.09s/it]Loss: 0.02279:  37%|███▋      | 74/201 [01:25<02:18,  1.09s/it]Loss: 0.02279:  37%|███▋      | 75/201 [01:26<02:16,  1.09s/it]Loss: 0.02244:  37%|███▋      | 75/201 [01:26<02:16,  1.09s/it]Loss: 0.02244:  38%|███▊      | 76/201 [01:27<02:15,  1.09s/it]Loss: 0.02260:  38%|███▊      | 76/201 [01:27<02:15,  1.09s/it]Loss: 0.02260:  38%|███▊      | 77/201 [01:29<02:14,  1.09s/it]Loss: 0.02171:  38%|███▊      | 77/201 [01:29<02:14,  1.09s/it]Loss: 0.02171:  39%|███▉      | 78/201 [01:30<02:13,  1.09s/it]Loss: 0.02203:  39%|███▉      | 78/201 [01:30<02:13,  1.09s/it]Loss: 0.02203:  39%|███▉      | 79/201 [01:31<02:12,  1.09s/it]Loss: 0.02196:  39%|███▉      | 79/201 [01:31<02:12,  1.09s/it]Loss: 0.02196:  40%|███▉      | 80/201 [01:32<02:11,  1.09s/it]Loss: 0.02157:  40%|███▉      | 80/201 [01:32<02:11,  1.09s/it]Loss: 0.02157:  40%|████      | 81/201 [01:33<02:15,  1.13s/it]Loss: 0.02128:  40%|████      | 81/201 [01:33<02:15,  1.13s/it]Loss: 0.02128:  41%|████      | 82/201 [01:34<02:12,  1.11s/it]Loss: 0.02106:  41%|████      | 82/201 [01:34<02:12,  1.11s/it]Loss: 0.02106:  41%|████▏     | 83/201 [01:35<02:10,  1.11s/it]Loss: 0.02044:  41%|████▏     | 83/201 [01:35<02:10,  1.11s/it]Loss: 0.02044:  42%|████▏     | 84/201 [01:36<02:08,  1.10s/it]Loss: 0.02015:  42%|████▏     | 84/201 [01:36<02:08,  1.10s/it]Loss: 0.02015:  42%|████▏     | 85/201 [01:37<02:07,  1.10s/it]Loss: 0.02054:  42%|████▏     | 85/201 [01:37<02:07,  1.10s/it]Loss: 0.02054:  43%|████▎     | 86/201 [01:38<02:05,  1.09s/it]Loss: 0.02077:  43%|████▎     | 86/201 [01:38<02:05,  1.09s/it]Loss: 0.02077:  43%|████▎     | 87/201 [01:40<02:04,  1.09s/it]Loss: 0.02073:  43%|████▎     | 87/201 [01:40<02:04,  1.09s/it]Loss: 0.02073:  44%|████▍     | 88/201 [01:41<02:03,  1.09s/it]Loss: 0.02045:  44%|████▍     | 88/201 [01:41<02:03,  1.09s/it]Loss: 0.02045:  44%|████▍     | 89/201 [01:42<02:01,  1.09s/it]Loss: 0.02045:  44%|████▍     | 89/201 [01:42<02:01,  1.09s/it]Loss: 0.02045:  45%|████▍     | 90/201 [01:43<02:00,  1.09s/it]Loss: 0.02046:  45%|████▍     | 90/201 [01:43<02:00,  1.09s/it]Loss: 0.02046:  45%|████▌     | 91/201 [01:44<01:59,  1.09s/it]Loss: 0.02065:  45%|████▌     | 91/201 [01:44<01:59,  1.09s/it]Loss: 0.02065:  46%|████▌     | 92/201 [01:45<01:58,  1.09s/it]Loss: 0.02026:  46%|████▌     | 92/201 [01:45<01:58,  1.09s/it]Loss: 0.02026:  46%|████▋     | 93/201 [01:46<01:57,  1.09s/it]Loss: 0.02014:  46%|████▋     | 93/201 [01:46<01:57,  1.09s/it]Loss: 0.02014:  47%|████▋     | 94/201 [01:47<01:56,  1.09s/it]Loss: 0.01986:  47%|████▋     | 94/201 [01:47<01:56,  1.09s/it]Loss: 0.01986:  47%|████▋     | 95/201 [01:48<01:55,  1.09s/it]Loss: 0.01984:  47%|████▋     | 95/201 [01:48<01:55,  1.09s/it]Loss: 0.01984:  48%|████▊     | 96/201 [01:49<01:54,  1.09s/it]Loss: 0.01929:  48%|████▊     | 96/201 [01:49<01:54,  1.09s/it]Loss: 0.01929:  48%|████▊     | 97/201 [01:50<01:52,  1.09s/it]Loss: 0.01897:  48%|████▊     | 97/201 [01:50<01:52,  1.09s/it]Loss: 0.01897:  49%|████▉     | 98/201 [01:52<01:51,  1.09s/it]Loss: 0.01898:  49%|████▉     | 98/201 [01:52<01:51,  1.09s/it]Loss: 0.01898:  49%|████▉     | 99/201 [01:53<01:50,  1.09s/it]Loss: 0.01974:  49%|████▉     | 99/201 [01:53<01:50,  1.09s/it]Loss: 0.01974:  50%|████▉     | 100/201 [01:54<01:49,  1.09s/it]Loss: 0.01880:  50%|████▉     | 100/201 [01:54<01:49,  1.09s/it]Loss: 0.01880:  50%|█████     | 101/201 [01:55<01:53,  1.13s/it]Loss: 0.01712:  50%|█████     | 101/201 [01:55<01:53,  1.13s/it]max loss: 0.7495930194854736
Densities: min=0.0, max=1.0, mean=0.6712018251419067
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.57s/it][A1it [00:01,  1.57s/it]
Loss: 0.01712:  51%|█████     | 102/201 [01:58<02:37,  1.59s/it]Loss: 0.02289:  51%|█████     | 102/201 [01:58<02:37,  1.59s/it]Loss: 0.02289:  51%|█████     | 103/201 [01:59<02:21,  1.44s/it]Loss: 0.02086:  51%|█████     | 103/201 [01:59<02:21,  1.44s/it]Loss: 0.02086:  52%|█████▏    | 104/201 [02:00<02:09,  1.34s/it]Loss: 0.01994:  52%|█████▏    | 104/201 [02:00<02:09,  1.34s/it]Loss: 0.01994:  52%|█████▏    | 105/201 [02:01<02:01,  1.26s/it]Loss: 0.01936:  52%|█████▏    | 105/201 [02:01<02:01,  1.26s/it]Loss: 0.01936:  53%|█████▎    | 106/201 [02:02<01:55,  1.21s/it]Loss: 0.01893:  53%|█████▎    | 106/201 [02:02<01:55,  1.21s/it]Loss: 0.01893:  53%|█████▎    | 107/201 [02:03<01:50,  1.18s/it]Loss: 0.01889:  53%|█████▎    | 107/201 [02:03<01:50,  1.18s/it]Loss: 0.01889:  54%|█████▎    | 108/201 [02:04<01:47,  1.15s/it]Loss: 0.01860:  54%|█████▎    | 108/201 [02:04<01:47,  1.15s/it]Loss: 0.01860:  54%|█████▍    | 109/201 [02:05<01:44,  1.13s/it]Loss: 0.01825:  54%|█████▍    | 109/201 [02:05<01:44,  1.13s/it]Loss: 0.01825:  55%|█████▍    | 110/201 [02:06<01:41,  1.12s/it]Loss: 0.01811:  55%|█████▍    | 110/201 [02:06<01:41,  1.12s/it]Loss: 0.01811:  55%|█████▌    | 111/201 [02:07<01:40,  1.11s/it]Loss: 0.01793:  55%|█████▌    | 111/201 [02:07<01:40,  1.11s/it]Loss: 0.01793:  56%|█████▌    | 112/201 [02:09<01:38,  1.11s/it]Loss: 0.01780:  56%|█████▌    | 112/201 [02:09<01:38,  1.11s/it]Loss: 0.01780:  56%|█████▌    | 113/201 [02:10<01:36,  1.10s/it]Loss: 0.01756:  56%|█████▌    | 113/201 [02:10<01:36,  1.10s/it]Loss: 0.01756:  57%|█████▋    | 114/201 [02:11<01:35,  1.10s/it]Loss: 0.01728:  57%|█████▋    | 114/201 [02:11<01:35,  1.10s/it]Loss: 0.01728:  57%|█████▋    | 115/201 [02:12<01:34,  1.10s/it]Loss: 0.01754:  57%|█████▋    | 115/201 [02:12<01:34,  1.10s/it]Loss: 0.01754:  58%|█████▊    | 116/201 [02:13<01:33,  1.10s/it]Loss: 0.01711:  58%|█████▊    | 116/201 [02:13<01:33,  1.10s/it]Loss: 0.01711:  58%|█████▊    | 117/201 [02:14<01:31,  1.09s/it]Loss: 0.01705:  58%|█████▊    | 117/201 [02:14<01:31,  1.09s/it]Loss: 0.01705:  59%|█████▊    | 118/201 [02:15<01:30,  1.09s/it]Loss: 0.01689:  59%|█████▊    | 118/201 [02:15<01:30,  1.09s/it]Loss: 0.01689:  59%|█████▉    | 119/201 [02:16<01:29,  1.09s/it]Loss: 0.01720:  59%|█████▉    | 119/201 [02:16<01:29,  1.09s/it]Loss: 0.01720:  60%|█████▉    | 120/201 [02:17<01:28,  1.09s/it]Loss: 0.01704:  60%|█████▉    | 120/201 [02:17<01:28,  1.09s/it]Loss: 0.01704:  60%|██████    | 121/201 [02:18<01:31,  1.14s/it]Loss: 0.01695:  60%|██████    | 121/201 [02:18<01:31,  1.14s/it]Loss: 0.01695:  61%|██████    | 122/201 [02:20<01:28,  1.12s/it]Loss: 0.01662:  61%|██████    | 122/201 [02:20<01:28,  1.12s/it]Loss: 0.01662:  61%|██████    | 123/201 [02:21<01:26,  1.11s/it]Loss: 0.01659:  61%|██████    | 123/201 [02:21<01:26,  1.11s/it]Loss: 0.01659:  62%|██████▏   | 124/201 [02:22<01:25,  1.11s/it]Loss: 0.01658:  62%|██████▏   | 124/201 [02:22<01:25,  1.11s/it]Loss: 0.01658:  62%|██████▏   | 125/201 [02:23<01:23,  1.10s/it]Loss: 0.01658:  62%|██████▏   | 125/201 [02:23<01:23,  1.10s/it]Loss: 0.01658:  63%|██████▎   | 126/201 [02:24<01:22,  1.10s/it]Loss: 0.01609:  63%|██████▎   | 126/201 [02:24<01:22,  1.10s/it]Loss: 0.01609:  63%|██████▎   | 127/201 [02:25<01:21,  1.10s/it]Loss: 0.01648:  63%|██████▎   | 127/201 [02:25<01:21,  1.10s/it]Loss: 0.01648:  64%|██████▎   | 128/201 [02:26<01:19,  1.10s/it]Loss: 0.01664:  64%|██████▎   | 128/201 [02:26<01:19,  1.10s/it]Loss: 0.01664:  64%|██████▍   | 129/201 [02:27<01:18,  1.09s/it]Loss: 0.01585:  64%|██████▍   | 129/201 [02:27<01:18,  1.09s/it]Loss: 0.01585:  65%|██████▍   | 130/201 [02:28<01:17,  1.09s/it]Loss: 0.01634:  65%|██████▍   | 130/201 [02:28<01:17,  1.09s/it]Loss: 0.01634:  65%|██████▌   | 131/201 [02:29<01:16,  1.09s/it]Loss: 0.01623:  65%|██████▌   | 131/201 [02:29<01:16,  1.09s/it]Loss: 0.01623:  66%|██████▌   | 132/201 [02:30<01:15,  1.09s/it]Loss: 0.01593:  66%|██████▌   | 132/201 [02:30<01:15,  1.09s/it]Loss: 0.01593:  66%|██████▌   | 133/201 [02:32<01:14,  1.09s/it]Loss: 0.01592:  66%|██████▌   | 133/201 [02:32<01:14,  1.09s/it]Loss: 0.01592:  67%|██████▋   | 134/201 [02:33<01:13,  1.09s/it]Loss: 0.01597:  67%|██████▋   | 134/201 [02:33<01:13,  1.09s/it]Loss: 0.01597:  67%|██████▋   | 135/201 [02:34<01:12,  1.09s/it]Loss: 0.01594:  67%|██████▋   | 135/201 [02:34<01:12,  1.09s/it]Loss: 0.01594:  68%|██████▊   | 136/201 [02:35<01:10,  1.09s/it]Loss: 0.01549:  68%|██████▊   | 136/201 [02:35<01:10,  1.09s/it]Loss: 0.01549:  68%|██████▊   | 137/201 [02:36<01:09,  1.09s/it]Loss: 0.01548:  68%|██████▊   | 137/201 [02:36<01:09,  1.09s/it]Loss: 0.01548:  69%|██████▊   | 138/201 [02:37<01:08,  1.09s/it]Loss: 0.01569:  69%|██████▊   | 138/201 [02:37<01:08,  1.09s/it]Loss: 0.01569:  69%|██████▉   | 139/201 [02:38<01:07,  1.09s/it]Loss: 0.01586:  69%|██████▉   | 139/201 [02:38<01:07,  1.09s/it]Loss: 0.01586:  70%|██████▉   | 140/201 [02:39<01:06,  1.09s/it]Loss: 0.01563:  70%|██████▉   | 140/201 [02:39<01:06,  1.09s/it]Loss: 0.01563:  70%|███████   | 141/201 [02:40<01:08,  1.14s/it]Loss: 0.01542:  70%|███████   | 141/201 [02:40<01:08,  1.14s/it]Loss: 0.01542:  71%|███████   | 142/201 [02:42<01:06,  1.12s/it]Loss: 0.01559:  71%|███████   | 142/201 [02:42<01:06,  1.12s/it]Loss: 0.01559:  71%|███████   | 143/201 [02:43<01:04,  1.11s/it]Loss: 0.01562:  71%|███████   | 143/201 [02:43<01:04,  1.11s/it]Loss: 0.01562:  72%|███████▏  | 144/201 [02:44<01:03,  1.11s/it]Loss: 0.01534:  72%|███████▏  | 144/201 [02:44<01:03,  1.11s/it]Loss: 0.01534:  72%|███████▏  | 145/201 [02:45<01:01,  1.10s/it]Loss: 0.01526:  72%|███████▏  | 145/201 [02:45<01:01,  1.10s/it]Loss: 0.01526:  73%|███████▎  | 146/201 [02:46<01:00,  1.10s/it]Loss: 0.01531:  73%|███████▎  | 146/201 [02:46<01:00,  1.10s/it]Loss: 0.01531:  73%|███████▎  | 147/201 [02:47<00:59,  1.10s/it]Loss: 0.01517:  73%|███████▎  | 147/201 [02:47<00:59,  1.10s/it]Loss: 0.01517:  74%|███████▎  | 148/201 [02:48<00:58,  1.10s/it]Loss: 0.01532:  74%|███████▎  | 148/201 [02:48<00:58,  1.10s/it]Loss: 0.01532:  74%|███████▍  | 149/201 [02:49<00:56,  1.09s/it]Loss: 0.01510:  74%|███████▍  | 149/201 [02:49<00:56,  1.09s/it]Loss: 0.01510:  75%|███████▍  | 150/201 [02:50<00:55,  1.09s/it]Loss: 0.01519:  75%|███████▍  | 150/201 [02:50<00:55,  1.09s/it]Loss: 0.01519:  75%|███████▌  | 151/201 [02:51<00:54,  1.09s/it]Loss: 0.01523:  75%|███████▌  | 151/201 [02:51<00:54,  1.09s/it]Loss: 0.01523:  76%|███████▌  | 152/201 [02:52<00:53,  1.09s/it]Loss: 0.01506:  76%|███████▌  | 152/201 [02:52<00:53,  1.09s/it]max loss: 0.3402029871940613
Densities: min=0.0, max=1.0, mean=0.711997389793396
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.59s/it][A1it [00:01,  1.59s/it]
Loss: 0.01506:  76%|███████▌  | 153/201 [02:55<01:15,  1.57s/it]Loss: 0.02043:  76%|███████▌  | 153/201 [02:55<01:15,  1.57s/it]Loss: 0.02043:  77%|███████▋  | 154/201 [02:56<01:07,  1.43s/it]Loss: 0.01868:  77%|███████▋  | 154/201 [02:56<01:07,  1.43s/it]Loss: 0.01868:  77%|███████▋  | 155/201 [02:57<01:01,  1.33s/it]Loss: 0.01791:  77%|███████▋  | 155/201 [02:57<01:01,  1.33s/it]Loss: 0.01791:  78%|███████▊  | 156/201 [02:58<00:56,  1.26s/it]Loss: 0.01744:  78%|███████▊  | 156/201 [02:58<00:56,  1.26s/it]Loss: 0.01744:  78%|███████▊  | 157/201 [03:00<00:53,  1.21s/it]Loss: 0.01719:  78%|███████▊  | 157/201 [03:00<00:53,  1.21s/it]Loss: 0.01719:  79%|███████▊  | 158/201 [03:01<00:50,  1.17s/it]Loss: 0.01685:  79%|███████▊  | 158/201 [03:01<00:50,  1.17s/it]Loss: 0.01685:  79%|███████▉  | 159/201 [03:02<00:48,  1.15s/it]Loss: 0.01679:  79%|███████▉  | 159/201 [03:02<00:48,  1.15s/it]Loss: 0.01679:  80%|███████▉  | 160/201 [03:03<00:46,  1.13s/it]Loss: 0.01654:  80%|███████▉  | 160/201 [03:03<00:46,  1.13s/it]Loss: 0.01654:  80%|████████  | 161/201 [03:04<00:46,  1.17s/it]Loss: 0.01653:  80%|████████  | 161/201 [03:04<00:46,  1.17s/it]Loss: 0.01653:  81%|████████  | 162/201 [03:05<00:44,  1.14s/it]Loss: 0.01644:  81%|████████  | 162/201 [03:05<00:44,  1.14s/it]Loss: 0.01644:  81%|████████  | 163/201 [03:06<00:42,  1.13s/it]Loss: 0.01617:  81%|████████  | 163/201 [03:06<00:42,  1.13s/it]Loss: 0.01617:  82%|████████▏ | 164/201 [03:07<00:41,  1.12s/it]Loss: 0.01620:  82%|████████▏ | 164/201 [03:07<00:41,  1.12s/it]Loss: 0.01620:  82%|████████▏ | 165/201 [03:08<00:40,  1.11s/it]Loss: 0.01597:  82%|████████▏ | 165/201 [03:08<00:40,  1.11s/it]Loss: 0.01597:  83%|████████▎ | 166/201 [03:10<00:38,  1.11s/it]Loss: 0.01517:  83%|████████▎ | 166/201 [03:10<00:38,  1.11s/it]Loss: 0.01517:  83%|████████▎ | 167/201 [03:11<00:37,  1.10s/it]Loss: 0.01497:  83%|████████▎ | 167/201 [03:11<00:37,  1.10s/it]Loss: 0.01497:  84%|████████▎ | 168/201 [03:12<00:36,  1.10s/it]Loss: 0.01485:  84%|████████▎ | 168/201 [03:12<00:36,  1.10s/it]Loss: 0.01485:  84%|████████▍ | 169/201 [03:13<00:35,  1.10s/it]Loss: 0.01479:  84%|████████▍ | 169/201 [03:13<00:35,  1.10s/it]Loss: 0.01479:  85%|████████▍ | 170/201 [03:14<00:34,  1.10s/it]Loss: 0.01467:  85%|████████▍ | 170/201 [03:14<00:34,  1.10s/it]Loss: 0.01467:  85%|████████▌ | 171/201 [03:15<00:32,  1.10s/it]Loss: 0.01459:  85%|████████▌ | 171/201 [03:15<00:32,  1.10s/it]Loss: 0.01459:  86%|████████▌ | 172/201 [03:16<00:31,  1.10s/it]Loss: 0.01455:  86%|████████▌ | 172/201 [03:16<00:31,  1.10s/it]Loss: 0.01455:  86%|████████▌ | 173/201 [03:17<00:30,  1.10s/it]Loss: 0.01448:  86%|████████▌ | 173/201 [03:17<00:30,  1.10s/it]Loss: 0.01448:  87%|████████▋ | 174/201 [03:18<00:29,  1.10s/it]Loss: 0.01441:  87%|████████▋ | 174/201 [03:18<00:29,  1.10s/it]Loss: 0.01441:  87%|████████▋ | 175/201 [03:19<00:28,  1.10s/it]Loss: 0.01435:  87%|████████▋ | 175/201 [03:19<00:28,  1.10s/it]Loss: 0.01435:  88%|████████▊ | 176/201 [03:20<00:27,  1.09s/it]Loss: 0.01429:  88%|████████▊ | 176/201 [03:20<00:27,  1.09s/it]Loss: 0.01429:  88%|████████▊ | 177/201 [03:22<00:26,  1.09s/it]Loss: 0.01424:  88%|████████▊ | 177/201 [03:22<00:26,  1.09s/it]Loss: 0.01424:  89%|████████▊ | 178/201 [03:23<00:25,  1.09s/it]Loss: 0.01418:  89%|████████▊ | 178/201 [03:23<00:25,  1.09s/it]Loss: 0.01418:  89%|████████▉ | 179/201 [03:24<00:24,  1.09s/it]Loss: 0.01414:  89%|████████▉ | 179/201 [03:24<00:24,  1.09s/it]Loss: 0.01414:  90%|████████▉ | 180/201 [03:25<00:22,  1.09s/it]Loss: 0.01410:  90%|████████▉ | 180/201 [03:25<00:22,  1.09s/it]Loss: 0.01410:  90%|█████████ | 181/201 [03:26<00:22,  1.14s/it]Loss: 0.01407:  90%|█████████ | 181/201 [03:26<00:22,  1.14s/it]Loss: 0.01407:  91%|█████████ | 182/201 [03:27<00:21,  1.13s/it]Loss: 0.01401:  91%|█████████ | 182/201 [03:27<00:21,  1.13s/it]Loss: 0.01401:  91%|█████████ | 183/201 [03:28<00:20,  1.12s/it]Loss: 0.01397:  91%|█████████ | 183/201 [03:28<00:20,  1.12s/it]Loss: 0.01397:  92%|█████████▏| 184/201 [03:29<00:18,  1.11s/it]Loss: 0.01395:  92%|█████████▏| 184/201 [03:29<00:18,  1.11s/it]Loss: 0.01395:  92%|█████████▏| 185/201 [03:30<00:17,  1.10s/it]Loss: 0.01387:  92%|█████████▏| 185/201 [03:30<00:17,  1.10s/it]Loss: 0.01387:  93%|█████████▎| 186/201 [03:32<00:16,  1.10s/it]Loss: 0.01389:  93%|█████████▎| 186/201 [03:32<00:16,  1.10s/it]Loss: 0.01389:  93%|█████████▎| 187/201 [03:33<00:15,  1.10s/it]Loss: 0.01392:  93%|█████████▎| 187/201 [03:33<00:15,  1.10s/it]Loss: 0.01392:  94%|█████████▎| 188/201 [03:34<00:14,  1.10s/it]Loss: 0.01382:  94%|█████████▎| 188/201 [03:34<00:14,  1.10s/it]Loss: 0.01382:  94%|█████████▍| 189/201 [03:35<00:13,  1.10s/it]Loss: 0.01374:  94%|█████████▍| 189/201 [03:35<00:13,  1.10s/it]Loss: 0.01374:  95%|█████████▍| 190/201 [03:36<00:12,  1.10s/it]Loss: 0.01376:  95%|█████████▍| 190/201 [03:36<00:12,  1.10s/it]Loss: 0.01376:  95%|█████████▌| 191/201 [03:37<00:10,  1.10s/it]Loss: 0.01374:  95%|█████████▌| 191/201 [03:37<00:10,  1.10s/it]Loss: 0.01374:  96%|█████████▌| 192/201 [03:38<00:09,  1.10s/it]Loss: 0.01375:  96%|█████████▌| 192/201 [03:38<00:09,  1.10s/it]Loss: 0.01375:  96%|█████████▌| 193/201 [03:39<00:08,  1.10s/it]Loss: 0.01378:  96%|█████████▌| 193/201 [03:39<00:08,  1.10s/it]Loss: 0.01378:  97%|█████████▋| 194/201 [03:40<00:07,  1.10s/it]Loss: 0.01414:  97%|█████████▋| 194/201 [03:40<00:07,  1.10s/it]Loss: 0.01414:  97%|█████████▋| 195/201 [03:41<00:06,  1.10s/it]Loss: 0.01492:  97%|█████████▋| 195/201 [03:41<00:06,  1.10s/it]Loss: 0.01492:  98%|█████████▊| 196/201 [03:43<00:05,  1.09s/it]Loss: 0.01483:  98%|█████████▊| 196/201 [03:43<00:05,  1.09s/it]Loss: 0.01483:  98%|█████████▊| 197/201 [03:44<00:04,  1.09s/it]Loss: 0.01445:  98%|█████████▊| 197/201 [03:44<00:04,  1.09s/it]Loss: 0.01445:  99%|█████████▊| 198/201 [03:45<00:03,  1.09s/it]Loss: 0.01437:  99%|█████████▊| 198/201 [03:45<00:03,  1.09s/it]Loss: 0.01437:  99%|█████████▉| 199/201 [03:46<00:02,  1.09s/it]Loss: 0.01436:  99%|█████████▉| 199/201 [03:46<00:02,  1.09s/it]Loss: 0.01436: 100%|█████████▉| 200/201 [03:47<00:01,  1.09s/it]Loss: 0.01432: 100%|█████████▉| 200/201 [03:47<00:01,  1.09s/it]Loss: 0.01432: 100%|██████████| 201/201 [03:48<00:00,  1.14s/it]Loss: 0.01337: 100%|██████████| 201/201 [03:48<00:00,  1.14s/it]Loss: 0.01337: 100%|██████████| 201/201 [03:48<00:00,  1.14s/it]Load volume "/media/storage0/qadwu/floats/1atm_heatrelease_1152x320x853_float32_raw_1152x320x853_float.cvol"
Loaded

max loss: 0.2721790075302124
Densities: min=0.0, max=1.0, mean=0.7121576070785522
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 228.65958428382874 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_1atm.json
Latent space memory: 57.4MiB
Latent space memory: 57.4MiB
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/1atm_heatrelease_1152x320x853_float32_raw_1152x320x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_1atm.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 8, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 4, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 14996992
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.26it/s]1it [00:00,  4.16it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.9459121227264404
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  1.94it/s]Render: : 1it [00:00,  1.94it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_1atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 320, 853], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/1atmheatrelease-20220916175751-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 8, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 4}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<01:38,  2.02it/s]Loss: 0.46412:   0%|          | 1/201 [00:00<01:38,  2.02it/s]Loss: 0.46412:   1%|          | 2/201 [00:00<01:20,  2.49it/s]Loss: 0.08857:   1%|          | 2/201 [00:00<01:20,  2.49it/s]Loss: 0.08857:   1%|▏         | 3/201 [00:01<01:14,  2.67it/s]Loss: 0.04283:   1%|▏         | 3/201 [00:01<01:14,  2.67it/s]Loss: 0.04283:   2%|▏         | 4/201 [00:01<01:11,  2.77it/s]Loss: 0.03725:   2%|▏         | 4/201 [00:01<01:11,  2.77it/s]Loss: 0.03725:   2%|▏         | 5/201 [00:01<01:09,  2.83it/s]Loss: 0.03779:   2%|▏         | 5/201 [00:01<01:09,  2.83it/s]Loss: 0.03779:   3%|▎         | 6/201 [00:02<01:07,  2.87it/s]Loss: 0.03433:   3%|▎         | 6/201 [00:02<01:07,  2.87it/s]Loss: 0.03433:   3%|▎         | 7/201 [00:02<01:07,  2.89it/s]Loss: 0.05551:   3%|▎         | 7/201 [00:02<01:07,  2.89it/s]Loss: 0.05551:   4%|▍         | 8/201 [00:02<01:06,  2.91it/s]Loss: 0.03874:   4%|▍         | 8/201 [00:02<01:06,  2.91it/s]Loss: 0.03874:   4%|▍         | 9/201 [00:03<01:05,  2.92it/s]Loss: 0.03178:   4%|▍         | 9/201 [00:03<01:05,  2.92it/s]Loss: 0.03178:   5%|▍         | 10/201 [00:03<01:05,  2.92it/s]Loss: 0.03994:   5%|▍         | 10/201 [00:03<01:05,  2.92it/s]Loss: 0.03994:   5%|▌         | 11/201 [00:03<01:04,  2.93it/s]Loss: 0.02763:   5%|▌         | 11/201 [00:03<01:04,  2.93it/s]Loss: 0.02763:   6%|▌         | 12/201 [00:04<01:04,  2.92it/s]Loss: 0.02955:   6%|▌         | 12/201 [00:04<01:04,  2.92it/s]Loss: 0.02955:   6%|▋         | 13/201 [00:04<01:04,  2.92it/s]Loss: 0.03611:   6%|▋         | 13/201 [00:04<01:04,  2.92it/s]Loss: 0.03611:   7%|▋         | 14/201 [00:04<01:04,  2.89it/s]Loss: 0.05913:   7%|▋         | 14/201 [00:04<01:04,  2.89it/s]Loss: 0.05913:   7%|▋         | 15/201 [00:05<01:04,  2.90it/s]Loss: 0.04415:   7%|▋         | 15/201 [00:05<01:04,  2.90it/s]Loss: 0.04415:   8%|▊         | 16/201 [00:05<01:03,  2.91it/s]Loss: 0.04864:   8%|▊         | 16/201 [00:05<01:03,  2.91it/s]Loss: 0.04864:   8%|▊         | 17/201 [00:05<01:03,  2.92it/s]Loss: 0.07317:   8%|▊         | 17/201 [00:05<01:03,  2.92it/s]Loss: 0.07317:   9%|▉         | 18/201 [00:06<01:02,  2.92it/s]Loss: 0.02181:   9%|▉         | 18/201 [00:06<01:02,  2.92it/s]Loss: 0.02181:   9%|▉         | 19/201 [00:06<01:02,  2.93it/s]Loss: 0.02404:   9%|▉         | 19/201 [00:06<01:02,  2.93it/s]Loss: 0.02404:  10%|▉         | 20/201 [00:06<01:01,  2.93it/s]Loss: 0.02955:  10%|▉         | 20/201 [00:06<01:01,  2.93it/s]Loss: 0.02955:  10%|█         | 21/201 [00:07<01:09,  2.60it/s]Loss: 0.07366:  10%|█         | 21/201 [00:07<01:09,  2.60it/s]Loss: 0.07366:  11%|█         | 22/201 [00:07<01:06,  2.70it/s]Loss: 0.04505:  11%|█         | 22/201 [00:07<01:06,  2.70it/s]Loss: 0.04505:  11%|█▏        | 23/201 [00:08<01:04,  2.76it/s]Loss: 0.03565:  11%|█▏        | 23/201 [00:08<01:04,  2.76it/s]Loss: 0.03565:  12%|█▏        | 24/201 [00:08<01:02,  2.81it/s]Loss: 0.06489:  12%|█▏        | 24/201 [00:08<01:02,  2.81it/s]Loss: 0.06489:  12%|█▏        | 25/201 [00:08<01:01,  2.85it/s]Loss: 0.06303:  12%|█▏        | 25/201 [00:08<01:01,  2.85it/s]Loss: 0.06303:  13%|█▎        | 26/201 [00:09<01:00,  2.87it/s]Loss: 0.06980:  13%|█▎        | 26/201 [00:09<01:00,  2.87it/s]Loss: 0.06980:  13%|█▎        | 27/201 [00:09<01:00,  2.89it/s]Loss: 0.05290:  13%|█▎        | 27/201 [00:09<01:00,  2.89it/s]Loss: 0.05290:  14%|█▍        | 28/201 [00:09<00:59,  2.91it/s]Loss: 0.03028:  14%|█▍        | 28/201 [00:09<00:59,  2.91it/s]Loss: 0.03028:  14%|█▍        | 29/201 [00:10<00:58,  2.92it/s]Loss: 0.03044:  14%|█▍        | 29/201 [00:10<00:58,  2.92it/s]Loss: 0.03044:  15%|█▍        | 30/201 [00:10<00:58,  2.92it/s]Loss: 0.02184:  15%|█▍        | 30/201 [00:10<00:58,  2.92it/s]Loss: 0.02184:  15%|█▌        | 31/201 [00:10<00:58,  2.92it/s]Loss: 0.01557:  15%|█▌        | 31/201 [00:10<00:58,  2.92it/s]Loss: 0.01557:  16%|█▌        | 32/201 [00:11<00:57,  2.93it/s]Loss: 0.02948:  16%|█▌        | 32/201 [00:11<00:57,  2.93it/s]Loss: 0.02948:  16%|█▋        | 33/201 [00:11<00:57,  2.93it/s]Loss: 0.04574:  16%|█▋        | 33/201 [00:11<00:57,  2.93it/s]Loss: 0.04574:  17%|█▋        | 34/201 [00:11<00:57,  2.93it/s]Loss: 0.04893:  17%|█▋        | 34/201 [00:11<00:57,  2.93it/s]Loss: 0.04893:  17%|█▋        | 35/201 [00:12<00:56,  2.93it/s]Loss: 0.02565:  17%|█▋        | 35/201 [00:12<00:56,  2.93it/s]Loss: 0.02565:  18%|█▊        | 36/201 [00:12<00:56,  2.93it/s]Loss: 0.01558:  18%|█▊        | 36/201 [00:12<00:56,  2.93it/s]Loss: 0.01558:  18%|█▊        | 37/201 [00:12<00:55,  2.93it/s]Loss: 0.01529:  18%|█▊        | 37/201 [00:12<00:55,  2.93it/s]Loss: 0.01529:  19%|█▉        | 38/201 [00:13<00:55,  2.93it/s]Loss: 0.02730:  19%|█▉        | 38/201 [00:13<00:55,  2.93it/s]Loss: 0.02730:  19%|█▉        | 39/201 [00:13<00:55,  2.93it/s]Loss: 0.02102:  19%|█▉        | 39/201 [00:13<00:55,  2.93it/s]Loss: 0.02102:  20%|█▉        | 40/201 [00:13<00:54,  2.93it/s]Loss: 0.02436:  20%|█▉        | 40/201 [00:13<00:54,  2.93it/s]Loss: 0.02436:  20%|██        | 41/201 [00:14<01:01,  2.60it/s]Loss: 0.02987:  20%|██        | 41/201 [00:14<01:01,  2.60it/s]Loss: 0.02987:  21%|██        | 42/201 [00:14<00:58,  2.70it/s]Loss: 0.03461:  21%|██        | 42/201 [00:14<00:58,  2.70it/s]Loss: 0.03461:  21%|██▏       | 43/201 [00:15<00:57,  2.77it/s]Loss: 0.03247:  21%|██▏       | 43/201 [00:15<00:57,  2.77it/s]Loss: 0.03247:  22%|██▏       | 44/201 [00:15<00:55,  2.81it/s]Loss: 0.03628:  22%|██▏       | 44/201 [00:15<00:55,  2.81it/s]Loss: 0.03628:  22%|██▏       | 45/201 [00:15<00:54,  2.85it/s]Loss: 0.02659:  22%|██▏       | 45/201 [00:15<00:54,  2.85it/s]Loss: 0.02659:  23%|██▎       | 46/201 [00:16<00:53,  2.87it/s]Loss: 0.05647:  23%|██▎       | 46/201 [00:16<00:53,  2.87it/s]Loss: 0.05647:  23%|██▎       | 47/201 [00:16<00:53,  2.89it/s]Loss: 0.04864:  23%|██▎       | 47/201 [00:16<00:53,  2.89it/s]Loss: 0.04864:  24%|██▍       | 48/201 [00:16<00:52,  2.90it/s]Loss: 0.02627:  24%|██▍       | 48/201 [00:16<00:52,  2.90it/s]Loss: 0.02627:  24%|██▍       | 49/201 [00:17<00:52,  2.91it/s]Loss: 0.03866:  24%|██▍       | 49/201 [00:17<00:52,  2.91it/s]Loss: 0.03866:  25%|██▍       | 50/201 [00:17<00:51,  2.92it/s]Loss: 0.03803:  25%|██▍       | 50/201 [00:17<00:51,  2.92it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.11s/it][A1it [00:01,  1.11s/it]
Loss: 0.03803:  25%|██▌       | 51/201 [00:18<01:41,  1.47it/s]Loss: 0.06161:  25%|██▌       | 51/201 [00:18<01:41,  1.47it/s]Loss: 0.06161:  26%|██▌       | 52/201 [00:19<01:25,  1.73it/s]Loss: 0.04347:  26%|██▌       | 52/201 [00:19<01:25,  1.73it/s]Loss: 0.04347:  26%|██▋       | 53/201 [00:19<01:14,  1.98it/s]Loss: 0.03834:  26%|██▋       | 53/201 [00:19<01:14,  1.98it/s]Loss: 0.03834:  27%|██▋       | 54/201 [00:19<01:07,  2.19it/s]Loss: 0.03502:  27%|██▋       | 54/201 [00:19<01:07,  2.19it/s]Loss: 0.03502:  27%|██▋       | 55/201 [00:20<01:01,  2.37it/s]Loss: 0.03334:  27%|██▋       | 55/201 [00:20<01:01,  2.37it/s]Loss: 0.03334:  28%|██▊       | 56/201 [00:20<00:57,  2.52it/s]Loss: 0.03194:  28%|██▊       | 56/201 [00:20<00:57,  2.52it/s]Loss: 0.03194:  28%|██▊       | 57/201 [00:20<00:54,  2.63it/s]Loss: 0.03069:  28%|██▊       | 57/201 [00:20<00:54,  2.63it/s]Loss: 0.03069:  29%|██▉       | 58/201 [00:21<00:52,  2.72it/s]Loss: 0.02948:  29%|██▉       | 58/201 [00:21<00:52,  2.72it/s]Loss: 0.02948:  29%|██▉       | 59/201 [00:21<00:51,  2.78it/s]Loss: 0.02893:  29%|██▉       | 59/201 [00:21<00:51,  2.78it/s]Loss: 0.02893:  30%|██▉       | 60/201 [00:22<00:49,  2.83it/s]Loss: 0.02787:  30%|██▉       | 60/201 [00:22<00:49,  2.83it/s]Loss: 0.02787:  30%|███       | 61/201 [00:22<00:55,  2.54it/s]Loss: 0.02792:  30%|███       | 61/201 [00:22<00:55,  2.54it/s]Loss: 0.02792:  31%|███       | 62/201 [00:22<00:52,  2.66it/s]Loss: 0.02658:  31%|███       | 62/201 [00:22<00:52,  2.66it/s]Loss: 0.02658:  31%|███▏      | 63/201 [00:23<00:50,  2.74it/s]Loss: 0.02620:  31%|███▏      | 63/201 [00:23<00:50,  2.74it/s]Loss: 0.02620:  32%|███▏      | 64/201 [00:23<00:48,  2.80it/s]Loss: 0.02574:  32%|███▏      | 64/201 [00:23<00:48,  2.80it/s]Loss: 0.02574:  32%|███▏      | 65/201 [00:23<00:47,  2.84it/s]Loss: 0.02535:  32%|███▏      | 65/201 [00:23<00:47,  2.84it/s]Loss: 0.02535:  33%|███▎      | 66/201 [00:24<00:47,  2.87it/s]Loss: 0.02512:  33%|███▎      | 66/201 [00:24<00:47,  2.87it/s]Loss: 0.02512:  33%|███▎      | 67/201 [00:24<00:46,  2.89it/s]Loss: 0.02523:  33%|███▎      | 67/201 [00:24<00:46,  2.89it/s]Loss: 0.02523:  34%|███▍      | 68/201 [00:24<00:45,  2.91it/s]Loss: 0.02488:  34%|███▍      | 68/201 [00:24<00:45,  2.91it/s]Loss: 0.02488:  34%|███▍      | 69/201 [00:25<00:45,  2.92it/s]Loss: 0.02469:  34%|███▍      | 69/201 [00:25<00:45,  2.92it/s]Loss: 0.02469:  35%|███▍      | 70/201 [00:25<00:44,  2.93it/s]Loss: 0.02480:  35%|███▍      | 70/201 [00:25<00:44,  2.93it/s]Loss: 0.02480:  35%|███▌      | 71/201 [00:25<00:44,  2.93it/s]Loss: 0.02378:  35%|███▌      | 71/201 [00:25<00:44,  2.93it/s]Loss: 0.02378:  36%|███▌      | 72/201 [00:26<00:43,  2.93it/s]Loss: 0.02284:  36%|███▌      | 72/201 [00:26<00:43,  2.93it/s]Loss: 0.02284:  36%|███▋      | 73/201 [00:26<00:43,  2.94it/s]Loss: 0.02412:  36%|███▋      | 73/201 [00:26<00:43,  2.94it/s]Loss: 0.02412:  37%|███▋      | 74/201 [00:26<00:43,  2.94it/s]Loss: 0.02437:  37%|███▋      | 74/201 [00:26<00:43,  2.94it/s]Loss: 0.02437:  37%|███▋      | 75/201 [00:27<00:42,  2.94it/s]Loss: 0.02379:  37%|███▋      | 75/201 [00:27<00:42,  2.94it/s]Loss: 0.02379:  38%|███▊      | 76/201 [00:27<00:42,  2.94it/s]Loss: 0.02345:  38%|███▊      | 76/201 [00:27<00:42,  2.94it/s]Loss: 0.02345:  38%|███▊      | 77/201 [00:27<00:42,  2.94it/s]Loss: 0.02324:  38%|███▊      | 77/201 [00:27<00:42,  2.94it/s]Loss: 0.02324:  39%|███▉      | 78/201 [00:28<00:41,  2.94it/s]Loss: 0.02331:  39%|███▉      | 78/201 [00:28<00:41,  2.94it/s]Loss: 0.02331:  39%|███▉      | 79/201 [00:28<00:41,  2.94it/s]Loss: 0.02271:  39%|███▉      | 79/201 [00:28<00:41,  2.94it/s]Loss: 0.02271:  40%|███▉      | 80/201 [00:28<00:41,  2.94it/s]Loss: 0.02334:  40%|███▉      | 80/201 [00:28<00:41,  2.94it/s]Loss: 0.02334:  40%|████      | 81/201 [00:29<00:46,  2.60it/s]Loss: 0.02311:  40%|████      | 81/201 [00:29<00:46,  2.60it/s]Loss: 0.02311:  41%|████      | 82/201 [00:29<00:44,  2.70it/s]Loss: 0.02233:  41%|████      | 82/201 [00:29<00:44,  2.70it/s]Loss: 0.02233:  41%|████▏     | 83/201 [00:30<00:42,  2.77it/s]Loss: 0.02242:  41%|████▏     | 83/201 [00:30<00:42,  2.77it/s]Loss: 0.02242:  42%|████▏     | 84/201 [00:30<00:41,  2.82it/s]Loss: 0.02187:  42%|████▏     | 84/201 [00:30<00:41,  2.82it/s]Loss: 0.02187:  42%|████▏     | 85/201 [00:30<00:40,  2.85it/s]Loss: 0.02223:  42%|████▏     | 85/201 [00:30<00:40,  2.85it/s]Loss: 0.02223:  43%|████▎     | 86/201 [00:31<00:39,  2.88it/s]Loss: 0.02183:  43%|████▎     | 86/201 [00:31<00:39,  2.88it/s]Loss: 0.02183:  43%|████▎     | 87/201 [00:31<00:39,  2.90it/s]Loss: 0.02170:  43%|████▎     | 87/201 [00:31<00:39,  2.90it/s]Loss: 0.02170:  44%|████▍     | 88/201 [00:31<00:38,  2.91it/s]Loss: 0.02166:  44%|████▍     | 88/201 [00:31<00:38,  2.91it/s]Loss: 0.02166:  44%|████▍     | 89/201 [00:32<00:38,  2.92it/s]Loss: 0.02140:  44%|████▍     | 89/201 [00:32<00:38,  2.92it/s]Loss: 0.02140:  45%|████▍     | 90/201 [00:32<00:37,  2.94it/s]Loss: 0.02138:  45%|████▍     | 90/201 [00:32<00:37,  2.94it/s]Loss: 0.02138:  45%|████▌     | 91/201 [00:32<00:37,  2.95it/s]Loss: 0.02120:  45%|████▌     | 91/201 [00:32<00:37,  2.95it/s]Loss: 0.02120:  46%|████▌     | 92/201 [00:33<00:37,  2.94it/s]Loss: 0.02122:  46%|████▌     | 92/201 [00:33<00:37,  2.94it/s]Loss: 0.02122:  46%|████▋     | 93/201 [00:33<00:36,  2.94it/s]Loss: 0.02118:  46%|████▋     | 93/201 [00:33<00:36,  2.94it/s]Loss: 0.02118:  47%|████▋     | 94/201 [00:33<00:36,  2.94it/s]Loss: 0.02150:  47%|████▋     | 94/201 [00:33<00:36,  2.94it/s]Loss: 0.02150:  47%|████▋     | 95/201 [00:34<00:36,  2.94it/s]Loss: 0.02040:  47%|████▋     | 95/201 [00:34<00:36,  2.94it/s]Loss: 0.02040:  48%|████▊     | 96/201 [00:34<00:35,  2.94it/s]Loss: 0.02118:  48%|████▊     | 96/201 [00:34<00:35,  2.94it/s]Loss: 0.02118:  48%|████▊     | 97/201 [00:34<00:35,  2.94it/s]Loss: 0.02108:  48%|████▊     | 97/201 [00:34<00:35,  2.94it/s]Loss: 0.02108:  49%|████▉     | 98/201 [00:35<00:35,  2.94it/s]Loss: 0.02023:  49%|████▉     | 98/201 [00:35<00:35,  2.94it/s]Loss: 0.02023:  49%|████▉     | 99/201 [00:35<00:34,  2.94it/s]Loss: 0.02095:  49%|████▉     | 99/201 [00:35<00:34,  2.94it/s]Loss: 0.02095:  50%|████▉     | 100/201 [00:35<00:34,  2.94it/s]Loss: 0.02145:  50%|████▉     | 100/201 [00:35<00:34,  2.94it/s]Loss: 0.02145:  50%|█████     | 101/201 [00:36<00:38,  2.60it/s]Loss: 0.01338:  50%|█████     | 101/201 [00:36<00:38,  2.60it/s]max loss: 0.8827731013298035
Densities: min=0.0, max=1.0, mean=0.821015477180481
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.24s/it][A1it [00:01,  1.24s/it]
Loss: 0.01338:  51%|█████     | 102/201 [00:37<01:13,  1.34it/s]Loss: 0.04625:  51%|█████     | 102/201 [00:37<01:13,  1.34it/s]Loss: 0.04625:  51%|█████     | 103/201 [00:38<01:01,  1.60it/s]Loss: 0.03909:  51%|█████     | 103/201 [00:38<01:01,  1.60it/s]Loss: 0.03909:  52%|█████▏    | 104/201 [00:38<00:52,  1.86it/s]Loss: 0.03498:  52%|█████▏    | 104/201 [00:38<00:52,  1.86it/s]Loss: 0.03498:  52%|█████▏    | 105/201 [00:38<00:45,  2.09it/s]Loss: 0.03216:  52%|█████▏    | 105/201 [00:38<00:45,  2.09it/s]Loss: 0.03216:  53%|█████▎    | 106/201 [00:39<00:41,  2.29it/s]Loss: 0.03001:  53%|█████▎    | 106/201 [00:39<00:41,  2.29it/s]Loss: 0.03001:  53%|█████▎    | 107/201 [00:39<00:38,  2.46it/s]Loss: 0.02829:  53%|█████▎    | 107/201 [00:39<00:38,  2.46it/s]Loss: 0.02829:  54%|█████▎    | 108/201 [00:40<00:35,  2.59it/s]Loss: 0.02686:  54%|█████▎    | 108/201 [00:40<00:35,  2.59it/s]Loss: 0.02686:  54%|█████▍    | 109/201 [00:40<00:34,  2.69it/s]Loss: 0.02561:  54%|█████▍    | 109/201 [00:40<00:34,  2.69it/s]Loss: 0.02561:  55%|█████▍    | 110/201 [00:40<00:32,  2.77it/s]Loss: 0.02458:  55%|█████▍    | 110/201 [00:40<00:32,  2.77it/s]Loss: 0.02458:  55%|█████▌    | 111/201 [00:41<00:31,  2.82it/s]Loss: 0.02362:  55%|█████▌    | 111/201 [00:41<00:31,  2.82it/s]Loss: 0.02362:  56%|█████▌    | 112/201 [00:41<00:31,  2.86it/s]Loss: 0.02279:  56%|█████▌    | 112/201 [00:41<00:31,  2.86it/s]Loss: 0.02279:  56%|█████▌    | 113/201 [00:41<00:30,  2.89it/s]Loss: 0.02202:  56%|█████▌    | 113/201 [00:41<00:30,  2.89it/s]Loss: 0.02202:  57%|█████▋    | 114/201 [00:42<00:29,  2.91it/s]Loss: 0.02133:  57%|█████▋    | 114/201 [00:42<00:29,  2.91it/s]Loss: 0.02133:  57%|█████▋    | 115/201 [00:42<00:29,  2.93it/s]Loss: 0.02071:  57%|█████▋    | 115/201 [00:42<00:29,  2.93it/s]Loss: 0.02071:  58%|█████▊    | 116/201 [00:42<00:28,  2.94it/s]Loss: 0.02015:  58%|█████▊    | 116/201 [00:42<00:28,  2.94it/s]Loss: 0.02015:  58%|█████▊    | 117/201 [00:43<00:28,  2.94it/s]Loss: 0.01961:  58%|█████▊    | 117/201 [00:43<00:28,  2.94it/s]Loss: 0.01961:  59%|█████▊    | 118/201 [00:43<00:28,  2.95it/s]Loss: 0.01914:  59%|█████▊    | 118/201 [00:43<00:28,  2.95it/s]Loss: 0.01914:  59%|█████▉    | 119/201 [00:43<00:27,  2.95it/s]Loss: 0.01880:  59%|█████▉    | 119/201 [00:43<00:27,  2.95it/s]Loss: 0.01880:  60%|█████▉    | 120/201 [00:44<00:27,  2.95it/s]Loss: 0.01845:  60%|█████▉    | 120/201 [00:44<00:27,  2.95it/s]Loss: 0.01845:  60%|██████    | 121/201 [00:44<00:30,  2.61it/s]Loss: 0.01806:  60%|██████    | 121/201 [00:44<00:30,  2.61it/s]Loss: 0.01806:  61%|██████    | 122/201 [00:44<00:29,  2.71it/s]Loss: 0.01776:  61%|██████    | 122/201 [00:44<00:29,  2.71it/s]Loss: 0.01776:  61%|██████    | 123/201 [00:45<00:28,  2.78it/s]Loss: 0.01741:  61%|██████    | 123/201 [00:45<00:28,  2.78it/s]Loss: 0.01741:  62%|██████▏   | 124/201 [00:45<00:27,  2.83it/s]Loss: 0.01713:  62%|██████▏   | 124/201 [00:45<00:27,  2.83it/s]Loss: 0.01713:  62%|██████▏   | 125/201 [00:45<00:26,  2.87it/s]Loss: 0.01673:  62%|██████▏   | 125/201 [00:45<00:26,  2.87it/s]Loss: 0.01673:  63%|██████▎   | 126/201 [00:46<00:25,  2.89it/s]Loss: 0.01655:  63%|██████▎   | 126/201 [00:46<00:25,  2.89it/s]Loss: 0.01655:  63%|██████▎   | 127/201 [00:46<00:25,  2.91it/s]Loss: 0.01638:  63%|██████▎   | 127/201 [00:46<00:25,  2.91it/s]Loss: 0.01638:  64%|██████▎   | 128/201 [00:46<00:24,  2.93it/s]Loss: 0.01605:  64%|██████▎   | 128/201 [00:46<00:24,  2.93it/s]Loss: 0.01605:  64%|██████▍   | 129/201 [00:47<00:24,  2.94it/s]Loss: 0.01600:  64%|██████▍   | 129/201 [00:47<00:24,  2.94it/s]Loss: 0.01600:  65%|██████▍   | 130/201 [00:47<00:24,  2.94it/s]Loss: 0.01569:  65%|██████▍   | 130/201 [00:47<00:24,  2.94it/s]Loss: 0.01569:  65%|██████▌   | 131/201 [00:47<00:23,  2.95it/s]Loss: 0.01547:  65%|██████▌   | 131/201 [00:47<00:23,  2.95it/s]Loss: 0.01547:  66%|██████▌   | 132/201 [00:48<00:23,  2.95it/s]Loss: 0.01534:  66%|██████▌   | 132/201 [00:48<00:23,  2.95it/s]Loss: 0.01534:  66%|██████▌   | 133/201 [00:48<00:23,  2.95it/s]Loss: 0.01522:  66%|██████▌   | 133/201 [00:48<00:23,  2.95it/s]Loss: 0.01522:  67%|██████▋   | 134/201 [00:48<00:22,  2.95it/s]Loss: 0.01551:  67%|██████▋   | 134/201 [00:48<00:22,  2.95it/s]Loss: 0.01551:  67%|██████▋   | 135/201 [00:49<00:22,  2.95it/s]Loss: 0.01513:  67%|██████▋   | 135/201 [00:49<00:22,  2.95it/s]Loss: 0.01513:  68%|██████▊   | 136/201 [00:49<00:21,  2.96it/s]Loss: 0.01458:  68%|██████▊   | 136/201 [00:49<00:21,  2.96it/s]Loss: 0.01458:  68%|██████▊   | 137/201 [00:49<00:21,  2.96it/s]Loss: 0.01480:  68%|██████▊   | 137/201 [00:49<00:21,  2.96it/s]Loss: 0.01480:  69%|██████▊   | 138/201 [00:50<00:21,  2.95it/s]Loss: 0.01540:  69%|██████▊   | 138/201 [00:50<00:21,  2.95it/s]Loss: 0.01540:  69%|██████▉   | 139/201 [00:50<00:20,  2.95it/s]Loss: 0.01619:  69%|██████▉   | 139/201 [00:50<00:20,  2.95it/s]Loss: 0.01619:  70%|██████▉   | 140/201 [00:50<00:20,  2.96it/s]Loss: 0.01557:  70%|██████▉   | 140/201 [00:50<00:20,  2.96it/s]Loss: 0.01557:  70%|███████   | 141/201 [00:51<00:22,  2.62it/s]Loss: 0.01466:  70%|███████   | 141/201 [00:51<00:22,  2.62it/s]Loss: 0.01466:  71%|███████   | 142/201 [00:51<00:21,  2.72it/s]Loss: 0.01416:  71%|███████   | 142/201 [00:51<00:21,  2.72it/s]Loss: 0.01416:  71%|███████   | 143/201 [00:52<00:20,  2.79it/s]Loss: 0.01382:  71%|███████   | 143/201 [00:52<00:20,  2.79it/s]Loss: 0.01382:  72%|███████▏  | 144/201 [00:52<00:20,  2.84it/s]Loss: 0.01362:  72%|███████▏  | 144/201 [00:52<00:20,  2.84it/s]Loss: 0.01362:  72%|███████▏  | 145/201 [00:52<00:19,  2.87it/s]Loss: 0.01389:  72%|███████▏  | 145/201 [00:52<00:19,  2.87it/s]Loss: 0.01389:  73%|███████▎  | 146/201 [00:53<00:18,  2.90it/s]Loss: 0.01431:  73%|███████▎  | 146/201 [00:53<00:18,  2.90it/s]Loss: 0.01431:  73%|███████▎  | 147/201 [00:53<00:18,  2.92it/s]Loss: 0.01322:  73%|███████▎  | 147/201 [00:53<00:18,  2.92it/s]Loss: 0.01322:  74%|███████▎  | 148/201 [00:53<00:18,  2.93it/s]Loss: 0.01344:  74%|███████▎  | 148/201 [00:53<00:18,  2.93it/s]Loss: 0.01344:  74%|███████▍  | 149/201 [00:54<00:17,  2.94it/s]Loss: 0.01327:  74%|███████▍  | 149/201 [00:54<00:17,  2.94it/s]Loss: 0.01327:  75%|███████▍  | 150/201 [00:54<00:17,  2.95it/s]Loss: 0.01299:  75%|███████▍  | 150/201 [00:54<00:17,  2.95it/s]Loss: 0.01299:  75%|███████▌  | 151/201 [00:54<00:16,  2.95it/s]Loss: 0.01423:  75%|███████▌  | 151/201 [00:54<00:16,  2.95it/s]Loss: 0.01423:  76%|███████▌  | 152/201 [00:55<00:16,  2.95it/s]Loss: 0.01450:  76%|███████▌  | 152/201 [00:55<00:16,  2.95it/s]max loss: 0.38098791241645813
Densities: min=0.0, max=1.0, mean=0.7238084077835083
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.26s/it][A1it [00:01,  1.26s/it]
Loss: 0.01450:  76%|███████▌  | 153/201 [00:56<00:34,  1.39it/s]Loss: 0.03812:  76%|███████▌  | 153/201 [00:56<00:34,  1.39it/s]Loss: 0.03812:  77%|███████▋  | 154/201 [00:57<00:28,  1.65it/s]Loss: 0.03321:  77%|███████▋  | 154/201 [00:57<00:28,  1.65it/s]Loss: 0.03321:  77%|███████▋  | 155/201 [00:57<00:24,  1.91it/s]Loss: 0.03052:  77%|███████▋  | 155/201 [00:57<00:24,  1.91it/s]Loss: 0.03052:  78%|███████▊  | 156/201 [00:57<00:21,  2.14it/s]Loss: 0.02859:  78%|███████▊  | 156/201 [00:57<00:21,  2.14it/s]Loss: 0.02859:  78%|███████▊  | 157/201 [00:58<00:18,  2.33it/s]Loss: 0.02770:  78%|███████▊  | 157/201 [00:58<00:18,  2.33it/s]Loss: 0.02770:  79%|███████▊  | 158/201 [00:58<00:17,  2.49it/s]Loss: 0.02658:  79%|███████▊  | 158/201 [00:58<00:17,  2.49it/s]Loss: 0.02658:  79%|███████▉  | 159/201 [00:58<00:16,  2.62it/s]Loss: 0.02591:  79%|███████▉  | 159/201 [00:58<00:16,  2.62it/s]Loss: 0.02591:  80%|███████▉  | 160/201 [00:59<00:15,  2.71it/s]Loss: 0.02485:  80%|███████▉  | 160/201 [00:59<00:15,  2.71it/s]Loss: 0.02485:  80%|████████  | 161/201 [00:59<00:16,  2.48it/s]Loss: 0.02244:  80%|████████  | 161/201 [00:59<00:16,  2.48it/s]Loss: 0.02244:  81%|████████  | 162/201 [00:59<00:14,  2.61it/s]Loss: 0.02127:  81%|████████  | 162/201 [00:59<00:14,  2.61it/s]Loss: 0.02127:  81%|████████  | 163/201 [01:00<00:14,  2.71it/s]Loss: 0.02051:  81%|████████  | 163/201 [01:00<00:14,  2.71it/s]Loss: 0.02051:  82%|████████▏ | 164/201 [01:00<00:13,  2.78it/s]Loss: 0.01996:  82%|████████▏ | 164/201 [01:00<00:13,  2.78it/s]Loss: 0.01996:  82%|████████▏ | 165/201 [01:00<00:12,  2.83it/s]Loss: 0.01944:  82%|████████▏ | 165/201 [01:00<00:12,  2.83it/s]Loss: 0.01944:  83%|████████▎ | 166/201 [01:01<00:12,  2.87it/s]Loss: 0.01904:  83%|████████▎ | 166/201 [01:01<00:12,  2.87it/s]Loss: 0.01904:  83%|████████▎ | 167/201 [01:01<00:11,  2.90it/s]Loss: 0.01868:  83%|████████▎ | 167/201 [01:01<00:11,  2.90it/s]Loss: 0.01868:  84%|████████▎ | 168/201 [01:01<00:11,  2.92it/s]Loss: 0.01833:  84%|████████▎ | 168/201 [01:01<00:11,  2.92it/s]Loss: 0.01833:  84%|████████▍ | 169/201 [01:02<00:10,  2.93it/s]Loss: 0.01803:  84%|████████▍ | 169/201 [01:02<00:10,  2.93it/s]Loss: 0.01803:  85%|████████▍ | 170/201 [01:02<00:10,  2.94it/s]Loss: 0.01780:  85%|████████▍ | 170/201 [01:02<00:10,  2.94it/s]Loss: 0.01780:  85%|████████▌ | 171/201 [01:02<00:10,  2.95it/s]Loss: 0.01731:  85%|████████▌ | 171/201 [01:02<00:10,  2.95it/s]Loss: 0.01731:  86%|████████▌ | 172/201 [01:03<00:09,  2.96it/s]Loss: 0.01701:  86%|████████▌ | 172/201 [01:03<00:09,  2.96it/s]Loss: 0.01701:  86%|████████▌ | 173/201 [01:03<00:09,  2.96it/s]Loss: 0.01690:  86%|████████▌ | 173/201 [01:03<00:09,  2.96it/s]Loss: 0.01690:  87%|████████▋ | 174/201 [01:03<00:09,  2.96it/s]Loss: 0.01655:  87%|████████▋ | 174/201 [01:03<00:09,  2.96it/s]Loss: 0.01655:  87%|████████▋ | 175/201 [01:04<00:08,  2.96it/s]Loss: 0.01666:  87%|████████▋ | 175/201 [01:04<00:08,  2.96it/s]Loss: 0.01666:  88%|████████▊ | 176/201 [01:04<00:08,  2.96it/s]Loss: 0.01632:  88%|████████▊ | 176/201 [01:04<00:08,  2.96it/s]Loss: 0.01632:  88%|████████▊ | 177/201 [01:05<00:08,  2.96it/s]Loss: 0.01611:  88%|████████▊ | 177/201 [01:05<00:08,  2.96it/s]Loss: 0.01611:  89%|████████▊ | 178/201 [01:05<00:07,  2.96it/s]Loss: 0.01596:  89%|████████▊ | 178/201 [01:05<00:07,  2.96it/s]Loss: 0.01596:  89%|████████▉ | 179/201 [01:05<00:07,  2.96it/s]Loss: 0.01597:  89%|████████▉ | 179/201 [01:05<00:07,  2.96it/s]Loss: 0.01597:  90%|████████▉ | 180/201 [01:06<00:07,  2.96it/s]Loss: 0.01558:  90%|████████▉ | 180/201 [01:06<00:07,  2.96it/s]Loss: 0.01558:  90%|█████████ | 181/201 [01:06<00:07,  2.59it/s]Loss: 0.01587:  90%|█████████ | 181/201 [01:06<00:07,  2.59it/s]Loss: 0.01587:  91%|█████████ | 182/201 [01:06<00:07,  2.70it/s]Loss: 0.01534:  91%|█████████ | 182/201 [01:06<00:07,  2.70it/s]Loss: 0.01534:  91%|█████████ | 183/201 [01:07<00:06,  2.77it/s]Loss: 0.01530:  91%|█████████ | 183/201 [01:07<00:06,  2.77it/s]Loss: 0.01530:  92%|█████████▏| 184/201 [01:07<00:06,  2.83it/s]Loss: 0.01520:  92%|█████████▏| 184/201 [01:07<00:06,  2.83it/s]Loss: 0.01520:  92%|█████████▏| 185/201 [01:07<00:05,  2.87it/s]Loss: 0.01495:  92%|█████████▏| 185/201 [01:07<00:05,  2.87it/s]Loss: 0.01495:  93%|█████████▎| 186/201 [01:08<00:05,  2.90it/s]Loss: 0.01463:  93%|█████████▎| 186/201 [01:08<00:05,  2.90it/s]Loss: 0.01463:  93%|█████████▎| 187/201 [01:08<00:04,  2.92it/s]Loss: 0.01482:  93%|█████████▎| 187/201 [01:08<00:04,  2.92it/s]Loss: 0.01482:  94%|█████████▎| 188/201 [01:08<00:04,  2.93it/s]Loss: 0.01485:  94%|█████████▎| 188/201 [01:08<00:04,  2.93it/s]Loss: 0.01485:  94%|█████████▍| 189/201 [01:09<00:04,  2.94it/s]Loss: 0.01459:  94%|█████████▍| 189/201 [01:09<00:04,  2.94it/s]Loss: 0.01459:  95%|█████████▍| 190/201 [01:09<00:03,  2.95it/s]Loss: 0.01465:  95%|█████████▍| 190/201 [01:09<00:03,  2.95it/s]Loss: 0.01465:  95%|█████████▌| 191/201 [01:09<00:03,  2.95it/s]Loss: 0.01499:  95%|█████████▌| 191/201 [01:09<00:03,  2.95it/s]Loss: 0.01499:  96%|█████████▌| 192/201 [01:10<00:03,  2.96it/s]Loss: 0.01499:  96%|█████████▌| 192/201 [01:10<00:03,  2.96it/s]Loss: 0.01499:  96%|█████████▌| 193/201 [01:10<00:02,  2.96it/s]Loss: 0.01524:  96%|█████████▌| 193/201 [01:10<00:02,  2.96it/s]Loss: 0.01524:  97%|█████████▋| 194/201 [01:10<00:02,  2.96it/s]Loss: 0.01490:  97%|█████████▋| 194/201 [01:10<00:02,  2.96it/s]Loss: 0.01490:  97%|█████████▋| 195/201 [01:11<00:02,  2.96it/s]Loss: 0.01495:  97%|█████████▋| 195/201 [01:11<00:02,  2.96it/s]Loss: 0.01495:  98%|█████████▊| 196/201 [01:11<00:01,  2.96it/s]Loss: 0.01534:  98%|█████████▊| 196/201 [01:11<00:01,  2.96it/s]Loss: 0.01534:  98%|█████████▊| 197/201 [01:11<00:01,  2.96it/s]Loss: 0.01525:  98%|█████████▊| 197/201 [01:11<00:01,  2.96it/s]Loss: 0.01525:  99%|█████████▊| 198/201 [01:12<00:01,  2.96it/s]Loss: 0.01496:  99%|█████████▊| 198/201 [01:12<00:01,  2.96it/s]Loss: 0.01496:  99%|█████████▉| 199/201 [01:12<00:00,  2.96it/s]Loss: 0.01490:  99%|█████████▉| 199/201 [01:12<00:00,  2.96it/s]Loss: 0.01490: 100%|█████████▉| 200/201 [01:12<00:00,  2.96it/s]Loss: 0.01336: 100%|█████████▉| 200/201 [01:12<00:00,  2.96it/s]Loss: 0.01336: 100%|██████████| 201/201 [01:13<00:00,  2.62it/s]Loss: 0.01179: 100%|██████████| 201/201 [01:13<00:00,  2.62it/s]Loss: 0.01179: 100%|██████████| 201/201 [01:13<00:00,  2.74it/s]
max loss: 0.3008183240890503
Densities: min=0.0, max=1.0, mean=0.7074240446090698
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_1atm_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 73.41361999511719 seconds
-1.0 2.2304688
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/10atm_heatrelease_1152x426x853_float32_raw_1152x426x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_10atm.json
Initialize network
Latent space memory: 57.4MiB
# of network parameters: 15076737
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.50it/s]1it [00:00,  4.50it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.9658718109130859
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:01,  1.66s/it]Render: : 1it [00:01,  1.66s/it]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_10atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 98, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 426, 853], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<06:37,  1.99s/it]Loss: 0.15422:   0%|          | 1/201 [00:01<06:37,  1.99s/it]Loss: 0.15422:   1%|          | 2/201 [00:03<04:54,  1.48s/it]Loss: 0.05256:   1%|          | 2/201 [00:03<04:54,  1.48s/it]Loss: 0.05256:   1%|▏         | 3/201 [00:04<04:22,  1.33s/it]Loss: 0.03421:   1%|▏         | 3/201 [00:04<04:22,  1.33s/it]Loss: 0.03421:   2%|▏         | 4/201 [00:05<04:06,  1.25s/it]Loss: 0.02564:   2%|▏         | 4/201 [00:05<04:06,  1.25s/it]Loss: 0.02564:   2%|▏         | 5/201 [00:06<03:57,  1.21s/it]Loss: 0.02601:   2%|▏         | 5/201 [00:06<03:57,  1.21s/it]Loss: 0.02601:   3%|▎         | 6/201 [00:07<03:51,  1.19s/it]Loss: 0.01968:   3%|▎         | 6/201 [00:07<03:51,  1.19s/it]Loss: 0.01968:   3%|▎         | 7/201 [00:08<03:47,  1.17s/it]Loss: 0.02160:   3%|▎         | 7/201 [00:08<03:47,  1.17s/it]Loss: 0.02160:   4%|▍         | 8/201 [00:09<03:44,  1.16s/it]Loss: 0.02071:   4%|▍         | 8/201 [00:09<03:44,  1.16s/it]Loss: 0.02071:   4%|▍         | 9/201 [00:11<03:42,  1.16s/it]Loss: 0.01999:   4%|▍         | 9/201 [00:11<03:42,  1.16s/it]Loss: 0.01999:   5%|▍         | 10/201 [00:12<03:40,  1.15s/it]Loss: 0.01943:   5%|▍         | 10/201 [00:12<03:40,  1.15s/it]Loss: 0.01943:   5%|▌         | 11/201 [00:13<03:38,  1.15s/it]Loss: 0.01880:   5%|▌         | 11/201 [00:13<03:38,  1.15s/it]Loss: 0.01880:   6%|▌         | 12/201 [00:14<03:36,  1.15s/it]Loss: 0.01819:   6%|▌         | 12/201 [00:14<03:36,  1.15s/it]Loss: 0.01819:   6%|▋         | 13/201 [00:15<03:35,  1.14s/it]Loss: 0.01783:   6%|▋         | 13/201 [00:15<03:35,  1.14s/it]Loss: 0.01783:   7%|▋         | 14/201 [00:16<03:33,  1.14s/it]Loss: 0.01727:   7%|▋         | 14/201 [00:16<03:33,  1.14s/it]Loss: 0.01727:   7%|▋         | 15/201 [00:17<03:32,  1.14s/it]Loss: 0.01685:   7%|▋         | 15/201 [00:17<03:32,  1.14s/it]Loss: 0.01685:   8%|▊         | 16/201 [00:19<03:31,  1.14s/it]Loss: 0.01621:   8%|▊         | 16/201 [00:19<03:31,  1.14s/it]Loss: 0.01621:   8%|▊         | 17/201 [00:20<03:30,  1.14s/it]Loss: 0.01590:   8%|▊         | 17/201 [00:20<03:30,  1.14s/it]Loss: 0.01590:   9%|▉         | 18/201 [00:21<03:28,  1.14s/it]Loss: 0.01552:   9%|▉         | 18/201 [00:21<03:28,  1.14s/it]Loss: 0.01552:   9%|▉         | 19/201 [00:22<03:27,  1.14s/it]Loss: 0.01524:   9%|▉         | 19/201 [00:22<03:27,  1.14s/it]Loss: 0.01524:  10%|▉         | 20/201 [00:23<03:26,  1.14s/it]Loss: 0.01465:  10%|▉         | 20/201 [00:23<03:26,  1.14s/it]Loss: 0.01465:  10%|█         | 21/201 [00:24<03:33,  1.19s/it]Loss: 0.01439:  10%|█         | 21/201 [00:24<03:33,  1.19s/it]Loss: 0.01439:  11%|█         | 22/201 [00:26<03:29,  1.17s/it]Loss: 0.01413:  11%|█         | 22/201 [00:26<03:29,  1.17s/it]Loss: 0.01413:  11%|█▏        | 23/201 [00:27<03:26,  1.16s/it]Loss: 0.01382:  11%|█▏        | 23/201 [00:27<03:26,  1.16s/it]Loss: 0.01382:  12%|█▏        | 24/201 [00:28<03:24,  1.15s/it]Loss: 0.01347:  12%|█▏        | 24/201 [00:28<03:24,  1.15s/it]Loss: 0.01347:  12%|█▏        | 25/201 [00:29<03:22,  1.15s/it]Loss: 0.01326:  12%|█▏        | 25/201 [00:29<03:22,  1.15s/it]Loss: 0.01326:  13%|█▎        | 26/201 [00:30<03:20,  1.15s/it]Loss: 0.01308:  13%|█▎        | 26/201 [00:30<03:20,  1.15s/it]Loss: 0.01308:  13%|█▎        | 27/201 [00:31<03:19,  1.15s/it]Loss: 0.01280:  13%|█▎        | 27/201 [00:31<03:19,  1.15s/it]Loss: 0.01280:  14%|█▍        | 28/201 [00:32<03:18,  1.14s/it]Loss: 0.01243:  14%|█▍        | 28/201 [00:32<03:18,  1.14s/it]Loss: 0.01243:  14%|█▍        | 29/201 [00:34<03:16,  1.14s/it]Loss: 0.01237:  14%|█▍        | 29/201 [00:34<03:16,  1.14s/it]Loss: 0.01237:  15%|█▍        | 30/201 [00:35<03:15,  1.14s/it]Loss: 0.01212:  15%|█▍        | 30/201 [00:35<03:15,  1.14s/it]Loss: 0.01212:  15%|█▌        | 31/201 [00:36<03:14,  1.14s/it]Loss: 0.01204:  15%|█▌        | 31/201 [00:36<03:14,  1.14s/it]Loss: 0.01204:  16%|█▌        | 32/201 [00:37<03:12,  1.14s/it]Loss: 0.01183:  16%|█▌        | 32/201 [00:37<03:12,  1.14s/it]Loss: 0.01183:  16%|█▋        | 33/201 [00:38<03:11,  1.14s/it]Loss: 0.01166:  16%|█▋        | 33/201 [00:38<03:11,  1.14s/it]Loss: 0.01166:  17%|█▋        | 34/201 [00:39<03:10,  1.14s/it]Loss: 0.01129:  17%|█▋        | 34/201 [00:39<03:10,  1.14s/it]Loss: 0.01129:  17%|█▋        | 35/201 [00:40<03:09,  1.14s/it]Loss: 0.01117:  17%|█▋        | 35/201 [00:40<03:09,  1.14s/it]Loss: 0.01117:  18%|█▊        | 36/201 [00:42<03:08,  1.14s/it]Loss: 0.01108:  18%|█▊        | 36/201 [00:42<03:08,  1.14s/it]Loss: 0.01108:  18%|█▊        | 37/201 [00:43<03:07,  1.14s/it]Loss: 0.01094:  18%|█▊        | 37/201 [00:43<03:07,  1.14s/it]Loss: 0.01094:  19%|█▉        | 38/201 [00:44<03:06,  1.14s/it]Loss: 0.01085:  19%|█▉        | 38/201 [00:44<03:06,  1.14s/it]Loss: 0.01085:  19%|█▉        | 39/201 [00:45<03:04,  1.14s/it]Loss: 0.01055:  19%|█▉        | 39/201 [00:45<03:04,  1.14s/it]Loss: 0.01055:  20%|█▉        | 40/201 [00:46<03:03,  1.14s/it]Loss: 0.01046:  20%|█▉        | 40/201 [00:46<03:03,  1.14s/it]Loss: 0.01046:  20%|██        | 41/201 [00:47<03:10,  1.19s/it]Loss: 0.01044:  20%|██        | 41/201 [00:47<03:10,  1.19s/it]Loss: 0.01044:  21%|██        | 42/201 [00:49<03:06,  1.17s/it]Loss: 0.01022:  21%|██        | 42/201 [00:49<03:06,  1.17s/it]Loss: 0.01022:  21%|██▏       | 43/201 [00:50<03:03,  1.16s/it]Loss: 0.01012:  21%|██▏       | 43/201 [00:50<03:03,  1.16s/it]Loss: 0.01012:  22%|██▏       | 44/201 [00:51<03:01,  1.16s/it]Loss: 0.00992:  22%|██▏       | 44/201 [00:51<03:01,  1.16s/it]Loss: 0.00992:  22%|██▏       | 45/201 [00:52<02:59,  1.15s/it]Loss: 0.01009:  22%|██▏       | 45/201 [00:52<02:59,  1.15s/it]Loss: 0.01009:  23%|██▎       | 46/201 [00:53<02:57,  1.15s/it]Loss: 0.00995:  23%|██▎       | 46/201 [00:53<02:57,  1.15s/it]Loss: 0.00995:  23%|██▎       | 47/201 [00:54<02:56,  1.15s/it]Loss: 0.00968:  23%|██▎       | 47/201 [00:54<02:56,  1.15s/it]Loss: 0.00968:  24%|██▍       | 48/201 [00:55<02:55,  1.15s/it]Loss: 0.00955:  24%|██▍       | 48/201 [00:55<02:55,  1.15s/it]Loss: 0.00955:  24%|██▍       | 49/201 [00:57<02:53,  1.14s/it]Loss: 0.00965:  24%|██▍       | 49/201 [00:57<02:53,  1.14s/it]Loss: 0.00965:  25%|██▍       | 50/201 [00:58<02:52,  1.14s/it]Loss: 0.00933:  25%|██▍       | 50/201 [00:58<02:52,  1.14s/it]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.44s/it][A1it [00:01,  1.44s/it]
Loss: 0.00933:  25%|██▌       | 51/201 [01:00<03:53,  1.56s/it]Loss: 0.09066:  25%|██▌       | 51/201 [01:00<03:53,  1.56s/it]Loss: 0.09066:  26%|██▌       | 52/201 [01:01<03:31,  1.42s/it]Loss: 0.07074:  26%|██▌       | 52/201 [01:01<03:31,  1.42s/it]Loss: 0.07074:  26%|██▋       | 53/201 [01:02<03:14,  1.32s/it]Loss: 0.06075:  26%|██▋       | 53/201 [01:02<03:14,  1.32s/it]Loss: 0.06075:  27%|██▋       | 54/201 [01:03<03:03,  1.25s/it]Loss: 0.05706:  27%|██▋       | 54/201 [01:03<03:03,  1.25s/it]Loss: 0.05706:  27%|██▋       | 55/201 [01:05<02:54,  1.20s/it]Loss: 0.05163:  27%|██▋       | 55/201 [01:05<02:54,  1.20s/it]Loss: 0.05163:  28%|██▊       | 56/201 [01:06<02:48,  1.16s/it]Loss: 0.04847:  28%|██▊       | 56/201 [01:06<02:48,  1.16s/it]Loss: 0.04847:  28%|██▊       | 57/201 [01:07<02:44,  1.14s/it]Loss: 0.04692:  28%|██▊       | 57/201 [01:07<02:44,  1.14s/it]Loss: 0.04692:  29%|██▉       | 58/201 [01:08<02:40,  1.12s/it]Loss: 0.04460:  29%|██▉       | 58/201 [01:08<02:40,  1.12s/it]Loss: 0.04460:  29%|██▉       | 59/201 [01:09<02:37,  1.11s/it]Loss: 0.04366:  29%|██▉       | 59/201 [01:09<02:37,  1.11s/it]Loss: 0.04366:  30%|██▉       | 60/201 [01:10<02:35,  1.10s/it]Loss: 0.04199:  30%|██▉       | 60/201 [01:10<02:35,  1.10s/it]Loss: 0.04199:  30%|███       | 61/201 [01:11<02:40,  1.15s/it]Loss: 0.04057:  30%|███       | 61/201 [01:11<02:40,  1.15s/it]Loss: 0.04057:  31%|███       | 62/201 [01:12<02:36,  1.13s/it]Loss: 0.03940:  31%|███       | 62/201 [01:12<02:36,  1.13s/it]Loss: 0.03940:  31%|███▏      | 63/201 [01:13<02:33,  1.11s/it]Loss: 0.03832:  31%|███▏      | 63/201 [01:13<02:33,  1.11s/it]Loss: 0.03832:  32%|███▏      | 64/201 [01:14<02:31,  1.11s/it]Loss: 0.03803:  32%|███▏      | 64/201 [01:14<02:31,  1.11s/it]Loss: 0.03803:  32%|███▏      | 65/201 [01:16<02:29,  1.10s/it]Loss: 0.03704:  32%|███▏      | 65/201 [01:16<02:29,  1.10s/it]Loss: 0.03704:  33%|███▎      | 66/201 [01:17<02:27,  1.10s/it]Loss: 0.03628:  33%|███▎      | 66/201 [01:17<02:27,  1.10s/it]Loss: 0.03628:  33%|███▎      | 67/201 [01:18<02:26,  1.09s/it]Loss: 0.03554:  33%|███▎      | 67/201 [01:18<02:26,  1.09s/it]Loss: 0.03554:  34%|███▍      | 68/201 [01:19<02:25,  1.09s/it]Loss: 0.03647:  34%|███▍      | 68/201 [01:19<02:25,  1.09s/it]Loss: 0.03647:  34%|███▍      | 69/201 [01:20<02:23,  1.09s/it]Loss: 0.03542:  34%|███▍      | 69/201 [01:20<02:23,  1.09s/it]Loss: 0.03542:  35%|███▍      | 70/201 [01:21<02:22,  1.09s/it]Loss: 0.03418:  35%|███▍      | 70/201 [01:21<02:22,  1.09s/it]Loss: 0.03418:  35%|███▌      | 71/201 [01:22<02:21,  1.09s/it]Loss: 0.03346:  35%|███▌      | 71/201 [01:22<02:21,  1.09s/it]Loss: 0.03346:  36%|███▌      | 72/201 [01:23<02:20,  1.09s/it]Loss: 0.03319:  36%|███▌      | 72/201 [01:23<02:20,  1.09s/it]Loss: 0.03319:  36%|███▋      | 73/201 [01:24<02:19,  1.09s/it]Loss: 0.03314:  36%|███▋      | 73/201 [01:24<02:19,  1.09s/it]Loss: 0.03314:  37%|███▋      | 74/201 [01:25<02:17,  1.09s/it]Loss: 0.03274:  37%|███▋      | 74/201 [01:25<02:17,  1.09s/it]Loss: 0.03274:  37%|███▋      | 75/201 [01:26<02:16,  1.09s/it]Loss: 0.03247:  37%|███▋      | 75/201 [01:26<02:16,  1.09s/it]Loss: 0.03247:  38%|███▊      | 76/201 [01:27<02:15,  1.09s/it]Loss: 0.03181:  38%|███▊      | 76/201 [01:27<02:15,  1.09s/it]Loss: 0.03181:  38%|███▊      | 77/201 [01:29<02:14,  1.09s/it]Loss: 0.03120:  38%|███▊      | 77/201 [01:29<02:14,  1.09s/it]Loss: 0.03120:  39%|███▉      | 78/201 [01:30<02:13,  1.09s/it]Loss: 0.03106:  39%|███▉      | 78/201 [01:30<02:13,  1.09s/it]Loss: 0.03106:  39%|███▉      | 79/201 [01:31<02:12,  1.09s/it]Loss: 0.03068:  39%|███▉      | 79/201 [01:31<02:12,  1.09s/it]Loss: 0.03068:  40%|███▉      | 80/201 [01:32<02:11,  1.09s/it]Loss: 0.03044:  40%|███▉      | 80/201 [01:32<02:11,  1.09s/it]Loss: 0.03044:  40%|████      | 81/201 [01:33<02:15,  1.13s/it]Loss: 0.03058:  40%|████      | 81/201 [01:33<02:15,  1.13s/it]Loss: 0.03058:  41%|████      | 82/201 [01:34<02:12,  1.12s/it]Loss: 0.03073:  41%|████      | 82/201 [01:34<02:12,  1.12s/it]Loss: 0.03073:  41%|████▏     | 83/201 [01:35<02:10,  1.11s/it]Loss: 0.03004:  41%|████▏     | 83/201 [01:35<02:10,  1.11s/it]Loss: 0.03004:  42%|████▏     | 84/201 [01:36<02:08,  1.10s/it]Loss: 0.02963:  42%|████▏     | 84/201 [01:36<02:08,  1.10s/it]Loss: 0.02963:  42%|████▏     | 85/201 [01:37<02:07,  1.10s/it]Loss: 0.02964:  42%|████▏     | 85/201 [01:37<02:07,  1.10s/it]Loss: 0.02964:  43%|████▎     | 86/201 [01:38<02:05,  1.09s/it]Loss: 0.02934:  43%|████▎     | 86/201 [01:38<02:05,  1.09s/it]Loss: 0.02934:  43%|████▎     | 87/201 [01:40<02:04,  1.09s/it]Loss: 0.02925:  43%|████▎     | 87/201 [01:40<02:04,  1.09s/it]Loss: 0.02925:  44%|████▍     | 88/201 [01:41<02:03,  1.09s/it]Loss: 0.02873:  44%|████▍     | 88/201 [01:41<02:03,  1.09s/it]Loss: 0.02873:  44%|████▍     | 89/201 [01:42<02:01,  1.09s/it]Loss: 0.02868:  44%|████▍     | 89/201 [01:42<02:01,  1.09s/it]Loss: 0.02868:  45%|████▍     | 90/201 [01:43<02:00,  1.09s/it]Loss: 0.02871:  45%|████▍     | 90/201 [01:43<02:00,  1.09s/it]Loss: 0.02871:  45%|████▌     | 91/201 [01:44<01:59,  1.09s/it]Loss: 0.02847:  45%|████▌     | 91/201 [01:44<01:59,  1.09s/it]Loss: 0.02847:  46%|████▌     | 92/201 [01:45<01:58,  1.09s/it]Loss: 0.02827:  46%|████▌     | 92/201 [01:45<01:58,  1.09s/it]Loss: 0.02827:  46%|████▋     | 93/201 [01:46<01:57,  1.09s/it]Loss: 0.02827:  46%|████▋     | 93/201 [01:46<01:57,  1.09s/it]Loss: 0.02827:  47%|████▋     | 94/201 [01:47<01:56,  1.09s/it]Loss: 0.02793:  47%|████▋     | 94/201 [01:47<01:56,  1.09s/it]Loss: 0.02793:  47%|████▋     | 95/201 [01:48<01:55,  1.09s/it]Loss: 0.02772:  47%|████▋     | 95/201 [01:48<01:55,  1.09s/it]Loss: 0.02772:  48%|████▊     | 96/201 [01:49<01:53,  1.09s/it]Loss: 0.02756:  48%|████▊     | 96/201 [01:49<01:53,  1.09s/it]Loss: 0.02756:  48%|████▊     | 97/201 [01:50<01:52,  1.08s/it]Loss: 0.02746:  48%|████▊     | 97/201 [01:50<01:52,  1.08s/it]Loss: 0.02746:  49%|████▉     | 98/201 [01:52<01:51,  1.08s/it]Loss: 0.02735:  49%|████▉     | 98/201 [01:52<01:51,  1.08s/it]Loss: 0.02735:  49%|████▉     | 99/201 [01:53<01:50,  1.08s/it]Loss: 0.02730:  49%|████▉     | 99/201 [01:53<01:50,  1.08s/it]Loss: 0.02730:  50%|████▉     | 100/201 [01:54<01:49,  1.08s/it]Loss: 0.02713:  50%|████▉     | 100/201 [01:54<01:49,  1.08s/it]Loss: 0.02713:  50%|█████     | 101/201 [01:55<01:53,  1.13s/it]Loss: 0.02465:  50%|█████     | 101/201 [01:55<01:53,  1.13s/it]max loss: 0.9120456576347351
Densities: min=0.0, max=1.0, mean=0.8143836855888367
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.57s/it][A1it [00:01,  1.57s/it]
Loss: 0.02465:  51%|█████     | 102/201 [01:58<02:37,  1.59s/it]Loss: 0.03593:  51%|█████     | 102/201 [01:58<02:37,  1.59s/it]Loss: 0.03593:  51%|█████     | 103/201 [01:59<02:21,  1.44s/it]Loss: 0.03265:  51%|█████     | 103/201 [01:59<02:21,  1.44s/it]Loss: 0.03265:  52%|█████▏    | 104/201 [02:00<02:09,  1.34s/it]Loss: 0.03084:  52%|█████▏    | 104/201 [02:00<02:09,  1.34s/it]Loss: 0.03084:  52%|█████▏    | 105/201 [02:01<02:01,  1.26s/it]Loss: 0.02970:  52%|█████▏    | 105/201 [02:01<02:01,  1.26s/it]Loss: 0.02970:  53%|█████▎    | 106/201 [02:02<01:55,  1.21s/it]Loss: 0.02882:  53%|█████▎    | 106/201 [02:02<01:55,  1.21s/it]Loss: 0.02882:  53%|█████▎    | 107/201 [02:03<01:50,  1.18s/it]Loss: 0.02824:  53%|█████▎    | 107/201 [02:03<01:50,  1.18s/it]Loss: 0.02824:  54%|█████▎    | 108/201 [02:04<01:47,  1.15s/it]Loss: 0.02772:  54%|█████▎    | 108/201 [02:04<01:47,  1.15s/it]Loss: 0.02772:  54%|█████▍    | 109/201 [02:05<01:44,  1.14s/it]Loss: 0.02739:  54%|█████▍    | 109/201 [02:05<01:44,  1.14s/it]Loss: 0.02739:  55%|█████▍    | 110/201 [02:06<01:42,  1.12s/it]Loss: 0.02703:  55%|█████▍    | 110/201 [02:06<01:42,  1.12s/it]Loss: 0.02703:  55%|█████▌    | 111/201 [02:07<01:40,  1.11s/it]Loss: 0.02662:  55%|█████▌    | 111/201 [02:07<01:40,  1.11s/it]Loss: 0.02662:  56%|█████▌    | 112/201 [02:09<01:38,  1.11s/it]Loss: 0.02624:  56%|█████▌    | 112/201 [02:09<01:38,  1.11s/it]Loss: 0.02624:  56%|█████▌    | 113/201 [02:10<01:37,  1.10s/it]Loss: 0.02604:  56%|█████▌    | 113/201 [02:10<01:37,  1.10s/it]Loss: 0.02604:  57%|█████▋    | 114/201 [02:11<01:35,  1.10s/it]Loss: 0.02592:  57%|█████▋    | 114/201 [02:11<01:35,  1.10s/it]Loss: 0.02592:  57%|█████▋    | 115/201 [02:12<01:34,  1.10s/it]Loss: 0.02551:  57%|█████▋    | 115/201 [02:12<01:34,  1.10s/it]Loss: 0.02551:  58%|█████▊    | 116/201 [02:13<01:33,  1.10s/it]Loss: 0.02544:  58%|█████▊    | 116/201 [02:13<01:33,  1.10s/it]Loss: 0.02544:  58%|█████▊    | 117/201 [02:14<01:32,  1.10s/it]Loss: 0.02522:  58%|█████▊    | 117/201 [02:14<01:32,  1.10s/it]Loss: 0.02522:  59%|█████▊    | 118/201 [02:15<01:31,  1.10s/it]Loss: 0.02486:  59%|█████▊    | 118/201 [02:15<01:31,  1.10s/it]Loss: 0.02486:  59%|█████▉    | 119/201 [02:16<01:29,  1.10s/it]Loss: 0.02455:  59%|█████▉    | 119/201 [02:16<01:29,  1.10s/it]Loss: 0.02455:  60%|█████▉    | 120/201 [02:17<01:28,  1.10s/it]Loss: 0.02439:  60%|█████▉    | 120/201 [02:17<01:28,  1.10s/it]Loss: 0.02439:  60%|██████    | 121/201 [02:19<01:31,  1.14s/it]Loss: 0.02445:  60%|██████    | 121/201 [02:19<01:31,  1.14s/it]Loss: 0.02445:  61%|██████    | 122/201 [02:20<01:28,  1.13s/it]Loss: 0.02391:  61%|██████    | 122/201 [02:20<01:28,  1.13s/it]Loss: 0.02391:  61%|██████    | 123/201 [02:21<01:27,  1.12s/it]Loss: 0.02381:  61%|██████    | 123/201 [02:21<01:27,  1.12s/it]Loss: 0.02381:  62%|██████▏   | 124/201 [02:22<01:25,  1.11s/it]Loss: 0.02369:  62%|██████▏   | 124/201 [02:22<01:25,  1.11s/it]Loss: 0.02369:  62%|██████▏   | 125/201 [02:23<01:24,  1.11s/it]Loss: 0.02361:  62%|██████▏   | 125/201 [02:23<01:24,  1.11s/it]Loss: 0.02361:  63%|██████▎   | 126/201 [02:24<01:22,  1.10s/it]Loss: 0.02329:  63%|██████▎   | 126/201 [02:24<01:22,  1.10s/it]Loss: 0.02329:  63%|██████▎   | 127/201 [02:25<01:21,  1.10s/it]Loss: 0.02346:  63%|██████▎   | 127/201 [02:25<01:21,  1.10s/it]Loss: 0.02346:  64%|██████▎   | 128/201 [02:26<01:20,  1.10s/it]Loss: 0.02339:  64%|██████▎   | 128/201 [02:26<01:20,  1.10s/it]Loss: 0.02339:  64%|██████▍   | 129/201 [02:27<01:19,  1.10s/it]Loss: 0.02292:  64%|██████▍   | 129/201 [02:27<01:19,  1.10s/it]Loss: 0.02292:  65%|██████▍   | 130/201 [02:28<01:17,  1.10s/it]Loss: 0.02309:  65%|██████▍   | 130/201 [02:28<01:17,  1.10s/it]Loss: 0.02309:  65%|██████▌   | 131/201 [02:30<01:16,  1.10s/it]Loss: 0.02299:  65%|██████▌   | 131/201 [02:30<01:16,  1.10s/it]Loss: 0.02299:  66%|██████▌   | 132/201 [02:31<01:15,  1.10s/it]Loss: 0.02276:  66%|██████▌   | 132/201 [02:31<01:15,  1.10s/it]Loss: 0.02276:  66%|██████▌   | 133/201 [02:32<01:14,  1.10s/it]Loss: 0.02268:  66%|██████▌   | 133/201 [02:32<01:14,  1.10s/it]Loss: 0.02268:  67%|██████▋   | 134/201 [02:33<01:13,  1.10s/it]Loss: 0.02227:  67%|██████▋   | 134/201 [02:33<01:13,  1.10s/it]Loss: 0.02227:  67%|██████▋   | 135/201 [02:34<01:12,  1.10s/it]Loss: 0.02264:  67%|██████▋   | 135/201 [02:34<01:12,  1.10s/it]Loss: 0.02264:  68%|██████▊   | 136/201 [02:35<01:11,  1.10s/it]Loss: 0.02242:  68%|██████▊   | 136/201 [02:35<01:11,  1.10s/it]Loss: 0.02242:  68%|██████▊   | 137/201 [02:36<01:10,  1.10s/it]Loss: 0.02243:  68%|██████▊   | 137/201 [02:36<01:10,  1.10s/it]Loss: 0.02243:  69%|██████▊   | 138/201 [02:37<01:09,  1.10s/it]Loss: 0.02236:  69%|██████▊   | 138/201 [02:37<01:09,  1.10s/it]Loss: 0.02236:  69%|██████▉   | 139/201 [02:38<01:07,  1.10s/it]Loss: 0.02230:  69%|██████▉   | 139/201 [02:38<01:07,  1.10s/it]Loss: 0.02230:  70%|██████▉   | 140/201 [02:39<01:06,  1.10s/it]Loss: 0.02208:  70%|██████▉   | 140/201 [02:39<01:06,  1.10s/it]Loss: 0.02208:  70%|███████   | 141/201 [02:41<01:08,  1.14s/it]Loss: 0.02183:  70%|███████   | 141/201 [02:41<01:08,  1.14s/it]Loss: 0.02183:  71%|███████   | 142/201 [02:42<01:06,  1.12s/it]Loss: 0.02174:  71%|███████   | 142/201 [02:42<01:06,  1.12s/it]Loss: 0.02174:  71%|███████   | 143/201 [02:43<01:04,  1.12s/it]Loss: 0.02190:  71%|███████   | 143/201 [02:43<01:04,  1.12s/it]Loss: 0.02190:  72%|███████▏  | 144/201 [02:44<01:03,  1.11s/it]Loss: 0.02166:  72%|███████▏  | 144/201 [02:44<01:03,  1.11s/it]Loss: 0.02166:  72%|███████▏  | 145/201 [02:45<01:01,  1.11s/it]Loss: 0.02144:  72%|███████▏  | 145/201 [02:45<01:01,  1.11s/it]Loss: 0.02144:  73%|███████▎  | 146/201 [02:46<01:00,  1.10s/it]Loss: 0.02138:  73%|███████▎  | 146/201 [02:46<01:00,  1.10s/it]Loss: 0.02138:  73%|███████▎  | 147/201 [02:47<00:59,  1.10s/it]Loss: 0.02117:  73%|███████▎  | 147/201 [02:47<00:59,  1.10s/it]Loss: 0.02117:  74%|███████▎  | 148/201 [02:48<00:58,  1.10s/it]Loss: 0.02120:  74%|███████▎  | 148/201 [02:48<00:58,  1.10s/it]Loss: 0.02120:  74%|███████▍  | 149/201 [02:49<00:57,  1.10s/it]Loss: 0.02110:  74%|███████▍  | 149/201 [02:49<00:57,  1.10s/it]Loss: 0.02110:  75%|███████▍  | 150/201 [02:50<00:55,  1.10s/it]Loss: 0.02128:  75%|███████▍  | 150/201 [02:50<00:55,  1.10s/it]Loss: 0.02128:  75%|███████▌  | 151/201 [02:52<00:54,  1.10s/it]Loss: 0.02116:  75%|███████▌  | 151/201 [02:52<00:54,  1.10s/it]Loss: 0.02116:  76%|███████▌  | 152/201 [02:53<00:53,  1.10s/it]Loss: 0.02085:  76%|███████▌  | 152/201 [02:53<00:53,  1.10s/it]max loss: 0.5564209222793579
Densities: min=0.0, max=1.0, mean=0.8441306948661804
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.63s/it][A1it [00:01,  1.63s/it]
Loss: 0.02085:  76%|███████▌  | 153/201 [02:55<01:16,  1.59s/it]Loss: 0.03194:  76%|███████▌  | 153/201 [02:55<01:16,  1.59s/it]Loss: 0.03194:  77%|███████▋  | 154/201 [02:57<01:07,  1.44s/it]Loss: 0.02892:  77%|███████▋  | 154/201 [02:57<01:07,  1.44s/it]Loss: 0.02892:  77%|███████▋  | 155/201 [02:58<01:01,  1.34s/it]Loss: 0.02740:  77%|███████▋  | 155/201 [02:58<01:01,  1.34s/it]Loss: 0.02740:  78%|███████▊  | 156/201 [02:59<00:56,  1.27s/it]Loss: 0.02644:  78%|███████▊  | 156/201 [02:59<00:56,  1.27s/it]Loss: 0.02644:  78%|███████▊  | 157/201 [03:00<00:53,  1.22s/it]Loss: 0.02579:  78%|███████▊  | 157/201 [03:00<00:53,  1.22s/it]Loss: 0.02579:  79%|███████▊  | 158/201 [03:01<00:50,  1.18s/it]Loss: 0.02525:  79%|███████▊  | 158/201 [03:01<00:50,  1.18s/it]Loss: 0.02525:  79%|███████▉  | 159/201 [03:02<00:48,  1.16s/it]Loss: 0.02486:  79%|███████▉  | 159/201 [03:02<00:48,  1.16s/it]Loss: 0.02486:  80%|███████▉  | 160/201 [03:03<00:46,  1.14s/it]Loss: 0.02443:  80%|███████▉  | 160/201 [03:03<00:46,  1.14s/it]Loss: 0.02443:  80%|████████  | 161/201 [03:04<00:47,  1.18s/it]Loss: 0.02424:  80%|████████  | 161/201 [03:04<00:47,  1.18s/it]Loss: 0.02424:  81%|████████  | 162/201 [03:05<00:44,  1.15s/it]Loss: 0.02395:  81%|████████  | 162/201 [03:05<00:44,  1.15s/it]Loss: 0.02395:  81%|████████  | 163/201 [03:07<00:43,  1.13s/it]Loss: 0.02358:  81%|████████  | 163/201 [03:07<00:43,  1.13s/it]Loss: 0.02358:  82%|████████▏ | 164/201 [03:08<00:41,  1.12s/it]Loss: 0.02347:  82%|████████▏ | 164/201 [03:08<00:41,  1.12s/it]Loss: 0.02347:  82%|████████▏ | 165/201 [03:09<00:40,  1.12s/it]Loss: 0.02321:  82%|████████▏ | 165/201 [03:09<00:40,  1.12s/it]Loss: 0.02321:  83%|████████▎ | 166/201 [03:10<00:38,  1.11s/it]Loss: 0.02307:  83%|████████▎ | 166/201 [03:10<00:38,  1.11s/it]Loss: 0.02307:  83%|████████▎ | 167/201 [03:11<00:37,  1.11s/it]Loss: 0.02314:  83%|████████▎ | 167/201 [03:11<00:37,  1.11s/it]Loss: 0.02314:  84%|████████▎ | 168/201 [03:12<00:36,  1.11s/it]Loss: 0.02296:  84%|████████▎ | 168/201 [03:12<00:36,  1.11s/it]Loss: 0.02296:  84%|████████▍ | 169/201 [03:13<00:35,  1.10s/it]Loss: 0.02296:  84%|████████▍ | 169/201 [03:13<00:35,  1.10s/it]Loss: 0.02296:  85%|████████▍ | 170/201 [03:14<00:34,  1.10s/it]Loss: 0.02289:  85%|████████▍ | 170/201 [03:14<00:34,  1.10s/it]Loss: 0.02289:  85%|████████▌ | 171/201 [03:15<00:33,  1.10s/it]Loss: 0.02243:  85%|████████▌ | 171/201 [03:15<00:33,  1.10s/it]Loss: 0.02243:  86%|████████▌ | 172/201 [03:16<00:31,  1.10s/it]Loss: 0.02230:  86%|████████▌ | 172/201 [03:16<00:31,  1.10s/it]Loss: 0.02230:  86%|████████▌ | 173/201 [03:18<00:30,  1.10s/it]Loss: 0.02223:  86%|████████▌ | 173/201 [03:18<00:30,  1.10s/it]Loss: 0.02223:  87%|████████▋ | 174/201 [03:19<00:29,  1.10s/it]Loss: 0.02209:  87%|████████▋ | 174/201 [03:19<00:29,  1.10s/it]Loss: 0.02209:  87%|████████▋ | 175/201 [03:20<00:28,  1.10s/it]Loss: 0.02192:  87%|████████▋ | 175/201 [03:20<00:28,  1.10s/it]Loss: 0.02192:  88%|████████▊ | 176/201 [03:21<00:27,  1.10s/it]Loss: 0.02212:  88%|████████▊ | 176/201 [03:21<00:27,  1.10s/it]Loss: 0.02212:  88%|████████▊ | 177/201 [03:22<00:26,  1.10s/it]Loss: 0.02202:  88%|████████▊ | 177/201 [03:22<00:26,  1.10s/it]Loss: 0.02202:  89%|████████▊ | 178/201 [03:23<00:25,  1.10s/it]Loss: 0.02150:  89%|████████▊ | 178/201 [03:23<00:25,  1.10s/it]Loss: 0.02150:  89%|████████▉ | 179/201 [03:24<00:24,  1.10s/it]Loss: 0.02158:  89%|████████▉ | 179/201 [03:24<00:24,  1.10s/it]Loss: 0.02158:  90%|████████▉ | 180/201 [03:25<00:23,  1.10s/it]Loss: 0.02137:  90%|████████▉ | 180/201 [03:25<00:23,  1.10s/it]Loss: 0.02137:  90%|█████████ | 181/201 [03:27<00:22,  1.15s/it]Loss: 0.02122:  90%|█████████ | 181/201 [03:27<00:22,  1.15s/it]Loss: 0.02122:  91%|█████████ | 182/201 [03:28<00:21,  1.13s/it]Loss: 0.02136:  91%|█████████ | 182/201 [03:28<00:21,  1.13s/it]Loss: 0.02136:  91%|█████████ | 183/201 [03:29<00:20,  1.12s/it]Loss: 0.02133:  91%|█████████ | 183/201 [03:29<00:20,  1.12s/it]Loss: 0.02133:  92%|█████████▏| 184/201 [03:30<00:18,  1.11s/it]Loss: 0.02116:  92%|█████████▏| 184/201 [03:30<00:18,  1.11s/it]Loss: 0.02116:  92%|█████████▏| 185/201 [03:31<00:17,  1.11s/it]Loss: 0.02084:  92%|█████████▏| 185/201 [03:31<00:17,  1.11s/it]Loss: 0.02084:  93%|█████████▎| 186/201 [03:32<00:16,  1.11s/it]Loss: 0.02064:  93%|█████████▎| 186/201 [03:32<00:16,  1.11s/it]Loss: 0.02064:  93%|█████████▎| 187/201 [03:33<00:15,  1.10s/it]Loss: 0.02076:  93%|█████████▎| 187/201 [03:33<00:15,  1.10s/it]Loss: 0.02076:  94%|█████████▎| 188/201 [03:34<00:14,  1.10s/it]Loss: 0.02056:  94%|█████████▎| 188/201 [03:34<00:14,  1.10s/it]Loss: 0.02056:  94%|█████████▍| 189/201 [03:35<00:13,  1.10s/it]Loss: 0.02055:  94%|█████████▍| 189/201 [03:35<00:13,  1.10s/it]Loss: 0.02055:  95%|█████████▍| 190/201 [03:36<00:12,  1.10s/it]Loss: 0.02059:  95%|█████████▍| 190/201 [03:36<00:12,  1.10s/it]Loss: 0.02059:  95%|█████████▌| 191/201 [03:37<00:11,  1.10s/it]Loss: 0.02011:  95%|█████████▌| 191/201 [03:37<00:11,  1.10s/it]Loss: 0.02011:  96%|█████████▌| 192/201 [03:39<00:09,  1.10s/it]Loss: 0.02008:  96%|█████████▌| 192/201 [03:39<00:09,  1.10s/it]Loss: 0.02008:  96%|█████████▌| 193/201 [03:40<00:08,  1.10s/it]Loss: 0.02014:  96%|█████████▌| 193/201 [03:40<00:08,  1.10s/it]Loss: 0.02014:  97%|█████████▋| 194/201 [03:41<00:07,  1.10s/it]Loss: 0.02011:  97%|█████████▋| 194/201 [03:41<00:07,  1.10s/it]Loss: 0.02011:  97%|█████████▋| 195/201 [03:42<00:06,  1.10s/it]Loss: 0.01991:  97%|█████████▋| 195/201 [03:42<00:06,  1.10s/it]Loss: 0.01991:  98%|█████████▊| 196/201 [03:43<00:05,  1.10s/it]Loss: 0.01989:  98%|█████████▊| 196/201 [03:43<00:05,  1.10s/it]Loss: 0.01989:  98%|█████████▊| 197/201 [03:44<00:04,  1.10s/it]Loss: 0.01986:  98%|█████████▊| 197/201 [03:44<00:04,  1.10s/it]Loss: 0.01986:  99%|█████████▊| 198/201 [03:45<00:03,  1.10s/it]Loss: 0.02011:  99%|█████████▊| 198/201 [03:45<00:03,  1.10s/it]Loss: 0.02011:  99%|█████████▉| 199/201 [03:46<00:02,  1.10s/it]Loss: 0.02035:  99%|█████████▉| 199/201 [03:46<00:02,  1.10s/it]Loss: 0.02035: 100%|█████████▉| 200/201 [03:47<00:01,  1.10s/it]Loss: 0.02016: 100%|█████████▉| 200/201 [03:47<00:01,  1.10s/it]Loss: 0.02016: 100%|██████████| 201/201 [03:49<00:00,  1.15s/it]Loss: 0.01847: 100%|██████████| 201/201 [03:49<00:00,  1.15s/it]Loss: 0.01847: 100%|██████████| 201/201 [03:49<00:00,  1.14s/it]Load volume "/media/storage0/qadwu/floats/10atm_heatrelease_1152x426x853_float32_raw_1152x426x853_float.cvol"
Loaded

max loss: 0.5484237670898438
Densities: min=0.0, max=1.0, mean=0.844953715801239
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 229.13406229019165 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_10atm.json
Latent space memory: 57.4MiB
Latent space memory: 57.4MiB
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/10atm_heatrelease_1152x426x853_float32_raw_1152x426x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_10atm.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 8, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 4, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 14996992
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.09it/s]1it [00:00,  4.09it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.9658717513084412
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:01,  1.67s/it]Render: : 1it [00:01,  1.67s/it]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/heatrelease_10atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 426, 853], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/10atmheatrelease-20220916180308-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 8, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 4}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<01:39,  2.02it/s]Loss: 0.50160:   0%|          | 1/201 [00:00<01:39,  2.02it/s]Loss: 0.50160:   1%|          | 2/201 [00:00<01:20,  2.49it/s]Loss: 0.10100:   1%|          | 2/201 [00:00<01:20,  2.49it/s]Loss: 0.10100:   1%|▏         | 3/201 [00:01<01:14,  2.68it/s]Loss: 0.04983:   1%|▏         | 3/201 [00:01<01:14,  2.68it/s]Loss: 0.04983:   2%|▏         | 4/201 [00:01<01:10,  2.78it/s]Loss: 0.03723:   2%|▏         | 4/201 [00:01<01:10,  2.78it/s]Loss: 0.03723:   2%|▏         | 5/201 [00:01<01:09,  2.83it/s]Loss: 0.03444:   2%|▏         | 5/201 [00:01<01:09,  2.83it/s]Loss: 0.03444:   3%|▎         | 6/201 [00:02<01:07,  2.87it/s]Loss: 0.09520:   3%|▎         | 6/201 [00:02<01:07,  2.87it/s]Loss: 0.09520:   3%|▎         | 7/201 [00:02<01:07,  2.89it/s]Loss: 0.03757:   3%|▎         | 7/201 [00:02<01:07,  2.89it/s]Loss: 0.03757:   4%|▍         | 8/201 [00:02<01:06,  2.91it/s]Loss: 0.04624:   4%|▍         | 8/201 [00:02<01:06,  2.91it/s]Loss: 0.04624:   4%|▍         | 9/201 [00:03<01:05,  2.92it/s]Loss: 0.03571:   4%|▍         | 9/201 [00:03<01:05,  2.92it/s]Loss: 0.03571:   5%|▍         | 10/201 [00:03<01:05,  2.93it/s]Loss: 0.03141:   5%|▍         | 10/201 [00:03<01:05,  2.93it/s]Loss: 0.03141:   5%|▌         | 11/201 [00:03<01:04,  2.93it/s]Loss: 0.03125:   5%|▌         | 11/201 [00:03<01:04,  2.93it/s]Loss: 0.03125:   6%|▌         | 12/201 [00:04<01:04,  2.93it/s]Loss: 0.06840:   6%|▌         | 12/201 [00:04<01:04,  2.93it/s]Loss: 0.06840:   6%|▋         | 13/201 [00:04<01:03,  2.94it/s]Loss: 0.06837:   6%|▋         | 13/201 [00:04<01:03,  2.94it/s]Loss: 0.06837:   7%|▋         | 14/201 [00:04<01:03,  2.94it/s]Loss: 0.05041:   7%|▋         | 14/201 [00:04<01:03,  2.94it/s]Loss: 0.05041:   7%|▋         | 15/201 [00:05<01:03,  2.94it/s]Loss: 0.03548:   7%|▋         | 15/201 [00:05<01:03,  2.94it/s]Loss: 0.03548:   8%|▊         | 16/201 [00:05<01:02,  2.94it/s]Loss: 0.02499:   8%|▊         | 16/201 [00:05<01:02,  2.94it/s]Loss: 0.02499:   8%|▊         | 17/201 [00:05<01:02,  2.94it/s]Loss: 0.02253:   8%|▊         | 17/201 [00:05<01:02,  2.94it/s]Loss: 0.02253:   9%|▉         | 18/201 [00:06<01:02,  2.94it/s]Loss: 0.03288:   9%|▉         | 18/201 [00:06<01:02,  2.94it/s]Loss: 0.03288:   9%|▉         | 19/201 [00:06<01:01,  2.94it/s]Loss: 0.05859:   9%|▉         | 19/201 [00:06<01:01,  2.94it/s]Loss: 0.05859:  10%|▉         | 20/201 [00:06<01:01,  2.94it/s]Loss: 0.02751:  10%|▉         | 20/201 [00:06<01:01,  2.94it/s]Loss: 0.02751:  10%|█         | 21/201 [00:07<01:11,  2.51it/s]Loss: 0.03334:  10%|█         | 21/201 [00:07<01:11,  2.51it/s]Loss: 0.03334:  11%|█         | 22/201 [00:07<01:08,  2.62it/s]Loss: 0.02181:  11%|█         | 22/201 [00:07<01:08,  2.62it/s]Loss: 0.02181:  11%|█▏        | 23/201 [00:08<01:05,  2.71it/s]Loss: 0.04031:  11%|█▏        | 23/201 [00:08<01:05,  2.71it/s]Loss: 0.04031:  12%|█▏        | 24/201 [00:08<01:03,  2.78it/s]Loss: 0.05045:  12%|█▏        | 24/201 [00:08<01:03,  2.78it/s]Loss: 0.05045:  12%|█▏        | 25/201 [00:08<01:02,  2.83it/s]Loss: 0.04148:  12%|█▏        | 25/201 [00:08<01:02,  2.83it/s]Loss: 0.04148:  13%|█▎        | 26/201 [00:09<01:01,  2.87it/s]Loss: 0.03441:  13%|█▎        | 26/201 [00:09<01:01,  2.87it/s]Loss: 0.03441:  13%|█▎        | 27/201 [00:09<01:00,  2.89it/s]Loss: 0.05824:  13%|█▎        | 27/201 [00:09<01:00,  2.89it/s]Loss: 0.05824:  14%|█▍        | 28/201 [00:09<00:59,  2.91it/s]Loss: 0.05348:  14%|█▍        | 28/201 [00:09<00:59,  2.91it/s]Loss: 0.05348:  14%|█▍        | 29/201 [00:10<00:58,  2.92it/s]Loss: 0.03168:  14%|█▍        | 29/201 [00:10<00:58,  2.92it/s]Loss: 0.03168:  15%|█▍        | 30/201 [00:10<00:58,  2.93it/s]Loss: 0.02072:  15%|█▍        | 30/201 [00:10<00:58,  2.93it/s]Loss: 0.02072:  15%|█▌        | 31/201 [00:10<00:57,  2.94it/s]Loss: 0.01720:  15%|█▌        | 31/201 [00:10<00:57,  2.94it/s]Loss: 0.01720:  16%|█▌        | 32/201 [00:11<00:57,  2.96it/s]Loss: 0.01733:  16%|█▌        | 32/201 [00:11<00:57,  2.96it/s]Loss: 0.01733:  16%|█▋        | 33/201 [00:11<00:56,  2.98it/s]Loss: 0.01694:  16%|█▋        | 33/201 [00:11<00:56,  2.98it/s]Loss: 0.01694:  17%|█▋        | 34/201 [00:11<00:55,  2.99it/s]Loss: 0.01764:  17%|█▋        | 34/201 [00:11<00:55,  2.99it/s]Loss: 0.01764:  17%|█▋        | 35/201 [00:12<00:55,  2.98it/s]Loss: 0.03093:  17%|█▋        | 35/201 [00:12<00:55,  2.98it/s]Loss: 0.03093:  18%|█▊        | 36/201 [00:12<00:55,  2.97it/s]Loss: 0.03027:  18%|█▊        | 36/201 [00:12<00:55,  2.97it/s]Loss: 0.03027:  18%|█▊        | 37/201 [00:12<00:55,  2.96it/s]Loss: 0.03104:  18%|█▊        | 37/201 [00:12<00:55,  2.96it/s]Loss: 0.03104:  19%|█▉        | 38/201 [00:13<00:55,  2.96it/s]Loss: 0.02789:  19%|█▉        | 38/201 [00:13<00:55,  2.96it/s]Loss: 0.02789:  19%|█▉        | 39/201 [00:13<00:54,  2.95it/s]Loss: 0.02429:  19%|█▉        | 39/201 [00:13<00:54,  2.95it/s]Loss: 0.02429:  20%|█▉        | 40/201 [00:13<00:54,  2.95it/s]Loss: 0.01567:  20%|█▉        | 40/201 [00:13<00:54,  2.95it/s]Loss: 0.01567:  20%|██        | 41/201 [00:14<01:01,  2.61it/s]Loss: 0.02563:  20%|██        | 41/201 [00:14<01:01,  2.61it/s]Loss: 0.02563:  21%|██        | 42/201 [00:14<00:58,  2.71it/s]Loss: 0.02810:  21%|██        | 42/201 [00:14<00:58,  2.71it/s]Loss: 0.02810:  21%|██▏       | 43/201 [00:15<00:56,  2.78it/s]Loss: 0.02734:  21%|██▏       | 43/201 [00:15<00:56,  2.78it/s]Loss: 0.02734:  22%|██▏       | 44/201 [00:15<00:55,  2.83it/s]Loss: 0.02259:  22%|██▏       | 44/201 [00:15<00:55,  2.83it/s]Loss: 0.02259:  22%|██▏       | 45/201 [00:15<00:54,  2.86it/s]Loss: 0.02743:  22%|██▏       | 45/201 [00:15<00:54,  2.86it/s]Loss: 0.02743:  23%|██▎       | 46/201 [00:16<00:53,  2.89it/s]Loss: 0.02793:  23%|██▎       | 46/201 [00:16<00:53,  2.89it/s]Loss: 0.02793:  23%|██▎       | 47/201 [00:16<00:53,  2.90it/s]Loss: 0.05241:  23%|██▎       | 47/201 [00:16<00:53,  2.90it/s]Loss: 0.05241:  24%|██▍       | 48/201 [00:16<00:52,  2.92it/s]Loss: 0.04273:  24%|██▍       | 48/201 [00:16<00:52,  2.92it/s]Loss: 0.04273:  24%|██▍       | 49/201 [00:17<00:51,  2.92it/s]Loss: 0.03491:  24%|██▍       | 49/201 [00:17<00:51,  2.92it/s]Loss: 0.03491:  25%|██▍       | 50/201 [00:17<00:51,  2.93it/s]Loss: 0.03182:  25%|██▍       | 50/201 [00:17<00:51,  2.93it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.12s/it][A1it [00:01,  1.12s/it]
Loss: 0.03182:  25%|██▌       | 51/201 [00:18<01:41,  1.47it/s]Loss: 0.09418:  25%|██▌       | 51/201 [00:18<01:41,  1.47it/s]Loss: 0.09418:  26%|██▌       | 52/201 [00:19<01:25,  1.74it/s]Loss: 0.07314:  26%|██▌       | 52/201 [00:19<01:25,  1.74it/s]Loss: 0.07314:  26%|██▋       | 53/201 [00:19<01:14,  1.98it/s]Loss: 0.06251:  26%|██▋       | 53/201 [00:19<01:14,  1.98it/s]Loss: 0.06251:  27%|██▋       | 54/201 [00:19<01:06,  2.20it/s]Loss: 0.05311:  27%|██▋       | 54/201 [00:19<01:06,  2.20it/s]Loss: 0.05311:  27%|██▋       | 55/201 [00:20<01:01,  2.39it/s]Loss: 0.04664:  27%|██▋       | 55/201 [00:20<01:01,  2.39it/s]Loss: 0.04664:  28%|██▊       | 56/201 [00:20<00:57,  2.53it/s]Loss: 0.04265:  28%|██▊       | 56/201 [00:20<00:57,  2.53it/s]Loss: 0.04265:  28%|██▊       | 57/201 [00:20<00:54,  2.64it/s]Loss: 0.03989:  28%|██▊       | 57/201 [00:20<00:54,  2.64it/s]Loss: 0.03989:  29%|██▉       | 58/201 [00:21<00:52,  2.73it/s]Loss: 0.03764:  29%|██▉       | 58/201 [00:21<00:52,  2.73it/s]Loss: 0.03764:  29%|██▉       | 59/201 [00:21<00:50,  2.80it/s]Loss: 0.03551:  29%|██▉       | 59/201 [00:21<00:50,  2.80it/s]Loss: 0.03551:  30%|██▉       | 60/201 [00:21<00:49,  2.85it/s]Loss: 0.03569:  30%|██▉       | 60/201 [00:21<00:49,  2.85it/s]Loss: 0.03569:  30%|███       | 61/201 [00:22<00:54,  2.55it/s]Loss: 0.03560:  30%|███       | 61/201 [00:22<00:54,  2.55it/s]Loss: 0.03560:  31%|███       | 62/201 [00:22<00:52,  2.66it/s]Loss: 0.03391:  31%|███       | 62/201 [00:22<00:52,  2.66it/s]Loss: 0.03391:  31%|███▏      | 63/201 [00:23<00:50,  2.75it/s]Loss: 0.03248:  31%|███▏      | 63/201 [00:23<00:50,  2.75it/s]Loss: 0.03248:  32%|███▏      | 64/201 [00:23<00:48,  2.81it/s]Loss: 0.03154:  32%|███▏      | 64/201 [00:23<00:48,  2.81it/s]Loss: 0.03154:  32%|███▏      | 65/201 [00:23<00:47,  2.85it/s]Loss: 0.03015:  32%|███▏      | 65/201 [00:23<00:47,  2.85it/s]Loss: 0.03015:  33%|███▎      | 66/201 [00:24<00:46,  2.89it/s]Loss: 0.03136:  33%|███▎      | 66/201 [00:24<00:46,  2.89it/s]Loss: 0.03136:  33%|███▎      | 67/201 [00:24<00:46,  2.91it/s]Loss: 0.03486:  33%|███▎      | 67/201 [00:24<00:46,  2.91it/s]Loss: 0.03486:  34%|███▍      | 68/201 [00:24<00:45,  2.93it/s]Loss: 0.03756:  34%|███▍      | 68/201 [00:24<00:45,  2.93it/s]Loss: 0.03756:  34%|███▍      | 69/201 [00:25<00:44,  2.94it/s]Loss: 0.03454:  34%|███▍      | 69/201 [00:25<00:44,  2.94it/s]Loss: 0.03454:  35%|███▍      | 70/201 [00:25<00:44,  2.95it/s]Loss: 0.03613:  35%|███▍      | 70/201 [00:25<00:44,  2.95it/s]Loss: 0.03613:  35%|███▌      | 71/201 [00:25<00:43,  2.96it/s]Loss: 0.03400:  35%|███▌      | 71/201 [00:25<00:43,  2.96it/s]Loss: 0.03400:  36%|███▌      | 72/201 [00:26<00:43,  2.96it/s]Loss: 0.03405:  36%|███▌      | 72/201 [00:26<00:43,  2.96it/s]Loss: 0.03405:  36%|███▋      | 73/201 [00:26<00:43,  2.96it/s]Loss: 0.03339:  36%|███▋      | 73/201 [00:26<00:43,  2.96it/s]Loss: 0.03339:  37%|███▋      | 74/201 [00:26<00:42,  2.96it/s]Loss: 0.02469:  37%|███▋      | 74/201 [00:26<00:42,  2.96it/s]Loss: 0.02469:  37%|███▋      | 75/201 [00:27<00:42,  2.96it/s]Loss: 0.02472:  37%|███▋      | 75/201 [00:27<00:42,  2.96it/s]Loss: 0.02472:  38%|███▊      | 76/201 [00:27<00:42,  2.97it/s]Loss: 0.03214:  38%|███▊      | 76/201 [00:27<00:42,  2.97it/s]Loss: 0.03214:  38%|███▊      | 77/201 [00:27<00:41,  2.96it/s]Loss: 0.03350:  38%|███▊      | 77/201 [00:27<00:41,  2.96it/s]Loss: 0.03350:  39%|███▉      | 78/201 [00:28<00:41,  2.97it/s]Loss: 0.03236:  39%|███▉      | 78/201 [00:28<00:41,  2.97it/s]Loss: 0.03236:  39%|███▉      | 79/201 [00:28<00:41,  2.97it/s]Loss: 0.03252:  39%|███▉      | 79/201 [00:28<00:41,  2.97it/s]Loss: 0.03252:  40%|███▉      | 80/201 [00:28<00:40,  2.97it/s]Loss: 0.03174:  40%|███▉      | 80/201 [00:28<00:40,  2.97it/s]Loss: 0.03174:  40%|████      | 81/201 [00:29<00:45,  2.63it/s]Loss: 0.03107:  40%|████      | 81/201 [00:29<00:45,  2.63it/s]Loss: 0.03107:  41%|████      | 82/201 [00:29<00:43,  2.73it/s]Loss: 0.03101:  41%|████      | 82/201 [00:29<00:43,  2.73it/s]Loss: 0.03101:  41%|████▏     | 83/201 [00:29<00:42,  2.80it/s]Loss: 0.02964:  41%|████▏     | 83/201 [00:29<00:42,  2.80it/s]Loss: 0.02964:  42%|████▏     | 84/201 [00:30<00:41,  2.85it/s]Loss: 0.02966:  42%|████▏     | 84/201 [00:30<00:41,  2.85it/s]Loss: 0.02966:  42%|████▏     | 85/201 [00:30<00:40,  2.89it/s]Loss: 0.02854:  42%|████▏     | 85/201 [00:30<00:40,  2.89it/s]Loss: 0.02854:  43%|████▎     | 86/201 [00:30<00:39,  2.91it/s]Loss: 0.02881:  43%|████▎     | 86/201 [00:30<00:39,  2.91it/s]Loss: 0.02881:  43%|████▎     | 87/201 [00:31<00:38,  2.93it/s]Loss: 0.02835:  43%|████▎     | 87/201 [00:31<00:38,  2.93it/s]Loss: 0.02835:  44%|████▍     | 88/201 [00:31<00:38,  2.94it/s]Loss: 0.02926:  44%|████▍     | 88/201 [00:31<00:38,  2.94it/s]Loss: 0.02926:  44%|████▍     | 89/201 [00:32<00:37,  2.95it/s]Loss: 0.02819:  44%|████▍     | 89/201 [00:32<00:37,  2.95it/s]Loss: 0.02819:  45%|████▍     | 90/201 [00:32<00:37,  2.96it/s]Loss: 0.02713:  45%|████▍     | 90/201 [00:32<00:37,  2.96it/s]Loss: 0.02713:  45%|████▌     | 91/201 [00:32<00:37,  2.96it/s]Loss: 0.02845:  45%|████▌     | 91/201 [00:32<00:37,  2.96it/s]Loss: 0.02845:  46%|████▌     | 92/201 [00:33<00:36,  2.96it/s]Loss: 0.02818:  46%|████▌     | 92/201 [00:33<00:36,  2.96it/s]Loss: 0.02818:  46%|████▋     | 93/201 [00:33<00:36,  2.95it/s]Loss: 0.02797:  46%|████▋     | 93/201 [00:33<00:36,  2.95it/s]Loss: 0.02797:  47%|████▋     | 94/201 [00:33<00:36,  2.96it/s]Loss: 0.02712:  47%|████▋     | 94/201 [00:33<00:36,  2.96it/s]Loss: 0.02712:  47%|████▋     | 95/201 [00:34<00:35,  2.96it/s]Loss: 0.02735:  47%|████▋     | 95/201 [00:34<00:35,  2.96it/s]Loss: 0.02735:  48%|████▊     | 96/201 [00:34<00:35,  2.96it/s]Loss: 0.02748:  48%|████▊     | 96/201 [00:34<00:35,  2.96it/s]Loss: 0.02748:  48%|████▊     | 97/201 [00:34<00:35,  2.97it/s]Loss: 0.02688:  48%|████▊     | 97/201 [00:34<00:35,  2.97it/s]Loss: 0.02688:  49%|████▉     | 98/201 [00:35<00:34,  2.97it/s]Loss: 0.02663:  49%|████▉     | 98/201 [00:35<00:34,  2.97it/s]Loss: 0.02663:  49%|████▉     | 99/201 [00:35<00:34,  2.97it/s]Loss: 0.02686:  49%|████▉     | 99/201 [00:35<00:34,  2.97it/s]Loss: 0.02686:  50%|████▉     | 100/201 [00:35<00:33,  2.97it/s]Loss: 0.02397:  50%|████▉     | 100/201 [00:35<00:33,  2.97it/s]Loss: 0.02397:  50%|█████     | 101/201 [00:36<00:38,  2.62it/s]Loss: 0.01753:  50%|█████     | 101/201 [00:36<00:38,  2.62it/s]max loss: 0.916062593460083
Densities: min=0.0, max=1.0, mean=0.8423016667366028
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.27s/it][A1it [00:01,  1.27s/it]
Loss: 0.01753:  51%|█████     | 102/201 [00:37<01:14,  1.33it/s]Loss: 0.05342:  51%|█████     | 102/201 [00:37<01:14,  1.33it/s]Loss: 0.05342:  51%|█████     | 103/201 [00:38<01:01,  1.59it/s]Loss: 0.04571:  51%|█████     | 103/201 [00:38<01:01,  1.59it/s]Loss: 0.04571:  52%|█████▏    | 104/201 [00:38<00:52,  1.85it/s]Loss: 0.04111:  52%|█████▏    | 104/201 [00:38<00:52,  1.85it/s]Loss: 0.04111:  52%|█████▏    | 105/201 [00:38<00:45,  2.09it/s]Loss: 0.03782:  52%|█████▏    | 105/201 [00:38<00:45,  2.09it/s]Loss: 0.03782:  53%|█████▎    | 106/201 [00:39<00:41,  2.29it/s]Loss: 0.03544:  53%|█████▎    | 106/201 [00:39<00:41,  2.29it/s]Loss: 0.03544:  53%|█████▎    | 107/201 [00:39<00:38,  2.46it/s]Loss: 0.03346:  53%|█████▎    | 107/201 [00:39<00:38,  2.46it/s]Loss: 0.03346:  54%|█████▎    | 108/201 [00:39<00:35,  2.59it/s]Loss: 0.03184:  54%|█████▎    | 108/201 [00:39<00:35,  2.59it/s]Loss: 0.03184:  54%|█████▍    | 109/201 [00:40<00:34,  2.70it/s]Loss: 0.03044:  54%|█████▍    | 109/201 [00:40<00:34,  2.70it/s]Loss: 0.03044:  55%|█████▍    | 110/201 [00:40<00:32,  2.77it/s]Loss: 0.02930:  55%|█████▍    | 110/201 [00:40<00:32,  2.77it/s]Loss: 0.02930:  55%|█████▌    | 111/201 [00:40<00:31,  2.83it/s]Loss: 0.02828:  55%|█████▌    | 111/201 [00:40<00:31,  2.83it/s]Loss: 0.02828:  56%|█████▌    | 112/201 [00:41<00:31,  2.87it/s]Loss: 0.02719:  56%|█████▌    | 112/201 [00:41<00:31,  2.87it/s]Loss: 0.02719:  56%|█████▌    | 113/201 [00:41<00:30,  2.90it/s]Loss: 0.02636:  56%|█████▌    | 113/201 [00:41<00:30,  2.90it/s]Loss: 0.02636:  57%|█████▋    | 114/201 [00:41<00:29,  2.92it/s]Loss: 0.02559:  57%|█████▋    | 114/201 [00:41<00:29,  2.92it/s]Loss: 0.02559:  57%|█████▋    | 115/201 [00:42<00:29,  2.93it/s]Loss: 0.02494:  57%|█████▋    | 115/201 [00:42<00:29,  2.93it/s]Loss: 0.02494:  58%|█████▊    | 116/201 [00:42<00:28,  2.95it/s]Loss: 0.02430:  58%|█████▊    | 116/201 [00:42<00:28,  2.95it/s]Loss: 0.02430:  58%|█████▊    | 117/201 [00:42<00:28,  2.95it/s]Loss: 0.02416:  58%|█████▊    | 117/201 [00:42<00:28,  2.95it/s]Loss: 0.02416:  59%|█████▊    | 118/201 [00:43<00:28,  2.96it/s]Loss: 0.02405:  59%|█████▊    | 118/201 [00:43<00:28,  2.96it/s]Loss: 0.02405:  59%|█████▉    | 119/201 [00:43<00:27,  2.96it/s]Loss: 0.02347:  59%|█████▉    | 119/201 [00:43<00:27,  2.96it/s]Loss: 0.02347:  60%|█████▉    | 120/201 [00:43<00:27,  2.97it/s]Loss: 0.02358:  60%|█████▉    | 120/201 [00:43<00:27,  2.97it/s]Loss: 0.02358:  60%|██████    | 121/201 [00:44<00:30,  2.63it/s]Loss: 0.02606:  60%|██████    | 121/201 [00:44<00:30,  2.63it/s]Loss: 0.02606:  61%|██████    | 122/201 [00:44<00:28,  2.73it/s]Loss: 0.02487:  61%|██████    | 122/201 [00:44<00:28,  2.73it/s]Loss: 0.02487:  61%|██████    | 123/201 [00:45<00:27,  2.80it/s]Loss: 0.02524:  61%|██████    | 123/201 [00:45<00:27,  2.80it/s]Loss: 0.02524:  62%|██████▏   | 124/201 [00:45<00:27,  2.84it/s]Loss: 0.02433:  62%|██████▏   | 124/201 [00:45<00:27,  2.84it/s]Loss: 0.02433:  62%|██████▏   | 125/201 [00:45<00:26,  2.88it/s]Loss: 0.02397:  62%|██████▏   | 125/201 [00:45<00:26,  2.88it/s]Loss: 0.02397:  63%|██████▎   | 126/201 [00:46<00:25,  2.90it/s]Loss: 0.02344:  63%|██████▎   | 126/201 [00:46<00:25,  2.90it/s]Loss: 0.02344:  63%|██████▎   | 127/201 [00:46<00:25,  2.92it/s]Loss: 0.02357:  63%|██████▎   | 127/201 [00:46<00:25,  2.92it/s]Loss: 0.02357:  64%|██████▎   | 128/201 [00:46<00:24,  2.93it/s]Loss: 0.02311:  64%|██████▎   | 128/201 [00:46<00:24,  2.93it/s]Loss: 0.02311:  64%|██████▍   | 129/201 [00:47<00:24,  2.95it/s]Loss: 0.02284:  64%|██████▍   | 129/201 [00:47<00:24,  2.95it/s]Loss: 0.02284:  65%|██████▍   | 130/201 [00:47<00:24,  2.95it/s]Loss: 0.02278:  65%|██████▍   | 130/201 [00:47<00:24,  2.95it/s]Loss: 0.02278:  65%|██████▌   | 131/201 [00:47<00:23,  2.96it/s]Loss: 0.02245:  65%|██████▌   | 131/201 [00:47<00:23,  2.96it/s]Loss: 0.02245:  66%|██████▌   | 132/201 [00:48<00:23,  2.96it/s]Loss: 0.02194:  66%|██████▌   | 132/201 [00:48<00:23,  2.96it/s]Loss: 0.02194:  66%|██████▌   | 133/201 [00:48<00:22,  2.96it/s]Loss: 0.02202:  66%|██████▌   | 133/201 [00:48<00:22,  2.96it/s]Loss: 0.02202:  67%|██████▋   | 134/201 [00:48<00:22,  2.96it/s]Loss: 0.02159:  67%|██████▋   | 134/201 [00:48<00:22,  2.96it/s]Loss: 0.02159:  67%|██████▋   | 135/201 [00:49<00:22,  2.97it/s]Loss: 0.02004:  67%|██████▋   | 135/201 [00:49<00:22,  2.97it/s]Loss: 0.02004:  68%|██████▊   | 136/201 [00:49<00:21,  2.97it/s]Loss: 0.01772:  68%|██████▊   | 136/201 [00:49<00:21,  2.97it/s]Loss: 0.01772:  68%|██████▊   | 137/201 [00:49<00:21,  2.97it/s]Loss: 0.01731:  68%|██████▊   | 137/201 [00:49<00:21,  2.97it/s]Loss: 0.01731:  69%|██████▊   | 138/201 [00:50<00:21,  2.97it/s]Loss: 0.01720:  69%|██████▊   | 138/201 [00:50<00:21,  2.97it/s]Loss: 0.01720:  69%|██████▉   | 139/201 [00:50<00:20,  2.97it/s]Loss: 0.01706:  69%|██████▉   | 139/201 [00:50<00:20,  2.97it/s]Loss: 0.01706:  70%|██████▉   | 140/201 [00:50<00:20,  2.97it/s]Loss: 0.01682:  70%|██████▉   | 140/201 [00:50<00:20,  2.97it/s]Loss: 0.01682:  70%|███████   | 141/201 [00:51<00:22,  2.63it/s]Loss: 0.01663:  70%|███████   | 141/201 [00:51<00:22,  2.63it/s]Loss: 0.01663:  71%|███████   | 142/201 [00:51<00:21,  2.73it/s]Loss: 0.01662:  71%|███████   | 142/201 [00:51<00:21,  2.73it/s]Loss: 0.01662:  71%|███████   | 143/201 [00:51<00:20,  2.79it/s]Loss: 0.01637:  71%|███████   | 143/201 [00:51<00:20,  2.79it/s]Loss: 0.01637:  72%|███████▏  | 144/201 [00:52<00:20,  2.84it/s]Loss: 0.01622:  72%|███████▏  | 144/201 [00:52<00:20,  2.84it/s]Loss: 0.01622:  72%|███████▏  | 145/201 [00:52<00:19,  2.88it/s]Loss: 0.01624:  72%|███████▏  | 145/201 [00:52<00:19,  2.88it/s]Loss: 0.01624:  73%|███████▎  | 146/201 [00:52<00:18,  2.90it/s]Loss: 0.01610:  73%|███████▎  | 146/201 [00:52<00:18,  2.90it/s]Loss: 0.01610:  73%|███████▎  | 147/201 [00:53<00:18,  2.92it/s]Loss: 0.01599:  73%|███████▎  | 147/201 [00:53<00:18,  2.92it/s]Loss: 0.01599:  74%|███████▎  | 148/201 [00:53<00:18,  2.93it/s]Loss: 0.01582:  74%|███████▎  | 148/201 [00:53<00:18,  2.93it/s]Loss: 0.01582:  74%|███████▍  | 149/201 [00:53<00:17,  2.94it/s]Loss: 0.01582:  74%|███████▍  | 149/201 [00:53<00:17,  2.94it/s]Loss: 0.01582:  75%|███████▍  | 150/201 [00:54<00:17,  2.95it/s]Loss: 0.01644:  75%|███████▍  | 150/201 [00:54<00:17,  2.95it/s]Loss: 0.01644:  75%|███████▌  | 151/201 [00:54<00:16,  2.96it/s]Loss: 0.02287:  75%|███████▌  | 151/201 [00:54<00:16,  2.96it/s]Loss: 0.02287:  76%|███████▌  | 152/201 [00:54<00:16,  2.96it/s]Loss: 0.02164:  76%|███████▌  | 152/201 [00:54<00:16,  2.96it/s]max loss: 0.7139920592308044
Densities: min=0.0, max=1.0, mean=0.8504669666290283
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.25s/it][A1it [00:01,  1.25s/it]
Loss: 0.02164:  76%|███████▌  | 153/201 [00:56<00:34,  1.39it/s]Loss: 0.03987:  76%|███████▌  | 153/201 [00:56<00:34,  1.39it/s]Loss: 0.03987:  77%|███████▋  | 154/201 [00:56<00:28,  1.66it/s]Loss: 0.03341:  77%|███████▋  | 154/201 [00:56<00:28,  1.66it/s]Loss: 0.03341:  77%|███████▋  | 155/201 [00:57<00:24,  1.91it/s]Loss: 0.03221:  77%|███████▋  | 155/201 [00:57<00:24,  1.91it/s]Loss: 0.03221:  78%|███████▊  | 156/201 [00:57<00:21,  2.14it/s]Loss: 0.03025:  78%|███████▊  | 156/201 [00:57<00:21,  2.14it/s]Loss: 0.03025:  78%|███████▊  | 157/201 [00:57<00:18,  2.33it/s]Loss: 0.02834:  78%|███████▊  | 157/201 [00:57<00:18,  2.33it/s]Loss: 0.02834:  79%|███████▊  | 158/201 [00:58<00:17,  2.49it/s]Loss: 0.02749:  79%|███████▊  | 158/201 [00:58<00:17,  2.49it/s]Loss: 0.02749:  79%|███████▉  | 159/201 [00:58<00:16,  2.59it/s]Loss: 0.02627:  79%|███████▉  | 159/201 [00:58<00:16,  2.59it/s]Loss: 0.02627:  80%|███████▉  | 160/201 [00:58<00:15,  2.69it/s]Loss: 0.02562:  80%|███████▉  | 160/201 [00:58<00:15,  2.69it/s]Loss: 0.02562:  80%|████████  | 161/201 [00:59<00:16,  2.46it/s]Loss: 0.02442:  80%|████████  | 161/201 [00:59<00:16,  2.46it/s]Loss: 0.02442:  81%|████████  | 162/201 [00:59<00:15,  2.60it/s]Loss: 0.02418:  81%|████████  | 162/201 [00:59<00:15,  2.60it/s]Loss: 0.02418:  81%|████████  | 163/201 [01:00<00:14,  2.70it/s]Loss: 0.02362:  81%|████████  | 163/201 [01:00<00:14,  2.70it/s]Loss: 0.02362:  82%|████████▏ | 164/201 [01:00<00:13,  2.77it/s]Loss: 0.02309:  82%|████████▏ | 164/201 [01:00<00:13,  2.77it/s]Loss: 0.02309:  82%|████████▏ | 165/201 [01:00<00:12,  2.82it/s]Loss: 0.02232:  82%|████████▏ | 165/201 [01:00<00:12,  2.82it/s]Loss: 0.02232:  83%|████████▎ | 166/201 [01:01<00:12,  2.86it/s]Loss: 0.02201:  83%|████████▎ | 166/201 [01:01<00:12,  2.86it/s]Loss: 0.02201:  83%|████████▎ | 167/201 [01:01<00:11,  2.89it/s]Loss: 0.02177:  83%|████████▎ | 167/201 [01:01<00:11,  2.89it/s]Loss: 0.02177:  84%|████████▎ | 168/201 [01:01<00:11,  2.91it/s]Loss: 0.02137:  84%|████████▎ | 168/201 [01:01<00:11,  2.91it/s]Loss: 0.02137:  84%|████████▍ | 169/201 [01:02<00:10,  2.92it/s]Loss: 0.02105:  84%|████████▍ | 169/201 [01:02<00:10,  2.92it/s]Loss: 0.02105:  85%|████████▍ | 170/201 [01:02<00:10,  2.93it/s]Loss: 0.02076:  85%|████████▍ | 170/201 [01:02<00:10,  2.93it/s]Loss: 0.02076:  85%|████████▌ | 171/201 [01:02<00:10,  2.94it/s]Loss: 0.02011:  85%|████████▌ | 171/201 [01:02<00:10,  2.94it/s]Loss: 0.02011:  86%|████████▌ | 172/201 [01:03<00:09,  2.94it/s]Loss: 0.01996:  86%|████████▌ | 172/201 [01:03<00:09,  2.94it/s]Loss: 0.01996:  86%|████████▌ | 173/201 [01:03<00:09,  2.95it/s]Loss: 0.01984:  86%|████████▌ | 173/201 [01:03<00:09,  2.95it/s]Loss: 0.01984:  87%|████████▋ | 174/201 [01:03<00:09,  2.95it/s]Loss: 0.01942:  87%|████████▋ | 174/201 [01:03<00:09,  2.95it/s]Loss: 0.01942:  87%|████████▋ | 175/201 [01:04<00:08,  2.95it/s]Loss: 0.01908:  87%|████████▋ | 175/201 [01:04<00:08,  2.95it/s]Loss: 0.01908:  88%|████████▊ | 176/201 [01:04<00:08,  2.95it/s]Loss: 0.01900:  88%|████████▊ | 176/201 [01:04<00:08,  2.95it/s]Loss: 0.01900:  88%|████████▊ | 177/201 [01:04<00:08,  2.95it/s]Loss: 0.01875:  88%|████████▊ | 177/201 [01:04<00:08,  2.95it/s]Loss: 0.01875:  89%|████████▊ | 178/201 [01:05<00:07,  2.95it/s]Loss: 0.01879:  89%|████████▊ | 178/201 [01:05<00:07,  2.95it/s]Loss: 0.01879:  89%|████████▉ | 179/201 [01:05<00:07,  2.95it/s]Loss: 0.01856:  89%|████████▉ | 179/201 [01:05<00:07,  2.95it/s]Loss: 0.01856:  90%|████████▉ | 180/201 [01:05<00:07,  2.95it/s]Loss: 0.01841:  90%|████████▉ | 180/201 [01:05<00:07,  2.95it/s]Loss: 0.01841:  90%|█████████ | 181/201 [01:06<00:07,  2.61it/s]Loss: 0.01825:  90%|█████████ | 181/201 [01:06<00:07,  2.61it/s]Loss: 0.01825:  91%|█████████ | 182/201 [01:06<00:07,  2.71it/s]Loss: 0.01813:  91%|█████████ | 182/201 [01:06<00:07,  2.71it/s]Loss: 0.01813:  91%|█████████ | 183/201 [01:07<00:06,  2.78it/s]Loss: 0.01789:  91%|█████████ | 183/201 [01:07<00:06,  2.78it/s]Loss: 0.01789:  92%|█████████▏| 184/201 [01:07<00:06,  2.83it/s]Loss: 0.01775:  92%|█████████▏| 184/201 [01:07<00:06,  2.83it/s]Loss: 0.01775:  92%|█████████▏| 185/201 [01:07<00:05,  2.87it/s]Loss: 0.01720:  92%|█████████▏| 185/201 [01:07<00:05,  2.87it/s]Loss: 0.01720:  93%|█████████▎| 186/201 [01:08<00:05,  2.89it/s]Loss: 0.01724:  93%|█████████▎| 186/201 [01:08<00:05,  2.89it/s]Loss: 0.01724:  93%|█████████▎| 187/201 [01:08<00:04,  2.91it/s]Loss: 0.01685:  93%|█████████▎| 187/201 [01:08<00:04,  2.91it/s]Loss: 0.01685:  94%|█████████▎| 188/201 [01:08<00:04,  2.92it/s]Loss: 0.01730:  94%|█████████▎| 188/201 [01:08<00:04,  2.92it/s]Loss: 0.01730:  94%|█████████▍| 189/201 [01:09<00:04,  2.93it/s]Loss: 0.01691:  94%|█████████▍| 189/201 [01:09<00:04,  2.93it/s]Loss: 0.01691:  95%|█████████▍| 190/201 [01:09<00:03,  2.94it/s]Loss: 0.01701:  95%|█████████▍| 190/201 [01:09<00:03,  2.94it/s]Loss: 0.01701:  95%|█████████▌| 191/201 [01:09<00:03,  2.94it/s]Loss: 0.01693:  95%|█████████▌| 191/201 [01:09<00:03,  2.94it/s]Loss: 0.01693:  96%|█████████▌| 192/201 [01:10<00:03,  2.95it/s]Loss: 0.01680:  96%|█████████▌| 192/201 [01:10<00:03,  2.95it/s]Loss: 0.01680:  96%|█████████▌| 193/201 [01:10<00:02,  2.95it/s]Loss: 0.01626:  96%|█████████▌| 193/201 [01:10<00:02,  2.95it/s]Loss: 0.01626:  97%|█████████▋| 194/201 [01:10<00:02,  2.95it/s]Loss: 0.01644:  97%|█████████▋| 194/201 [01:10<00:02,  2.95it/s]Loss: 0.01644:  97%|█████████▋| 195/201 [01:11<00:02,  2.96it/s]Loss: 0.01613:  97%|█████████▋| 195/201 [01:11<00:02,  2.96it/s]Loss: 0.01613:  98%|█████████▊| 196/201 [01:11<00:01,  2.96it/s]Loss: 0.01622:  98%|█████████▊| 196/201 [01:11<00:01,  2.96it/s]Loss: 0.01622:  98%|█████████▊| 197/201 [01:11<00:01,  2.96it/s]Loss: 0.01604:  98%|█████████▊| 197/201 [01:11<00:01,  2.96it/s]Loss: 0.01604:  99%|█████████▊| 198/201 [01:12<00:01,  2.96it/s]Loss: 0.01586:  99%|█████████▊| 198/201 [01:12<00:01,  2.96it/s]Loss: 0.01586:  99%|█████████▉| 199/201 [01:12<00:00,  2.95it/s]Loss: 0.01481:  99%|█████████▉| 199/201 [01:12<00:00,  2.95it/s]Loss: 0.01481: 100%|█████████▉| 200/201 [01:12<00:00,  2.96it/s]Loss: 0.01609: 100%|█████████▉| 200/201 [01:12<00:00,  2.96it/s]Loss: 0.01609: 100%|██████████| 201/201 [01:13<00:00,  2.62it/s]Loss: 0.01152: 100%|██████████| 201/201 [01:13<00:00,  2.62it/s]Loss: 0.01152: 100%|██████████| 201/201 [01:13<00:00,  2.74it/s]
max loss: 0.47590211033821106
Densities: min=0.0, max=1.0, mean=0.8840450644493103
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/heatrelease_10atm_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 73.2375419139862 seconds
-1.0 2.319336
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/1atm_temp_1152x320x853_float32_raw_1152x320x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_1atm.json
Initialize network
Latent space memory: 90.4MiB
# of network parameters: 23718209
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.13it/s]1it [00:00,  4.12it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0006044767214916646, max=0.9899277687072754, mean=0.7636135816574097
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  3.19it/s]Render: : 1it [00:00,  3.19it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_1atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 114, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 320, 853], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:02<06:41,  2.01s/it]Loss: 0.16787:   0%|          | 1/201 [00:02<06:41,  2.01s/it]Loss: 0.16787:   1%|          | 2/201 [00:03<04:47,  1.45s/it]Loss: 0.06069:   1%|          | 2/201 [00:03<04:47,  1.45s/it]Loss: 0.06069:   1%|▏         | 3/201 [00:04<04:12,  1.27s/it]Loss: 0.03426:   1%|▏         | 3/201 [00:04<04:12,  1.27s/it]Loss: 0.03426:   2%|▏         | 4/201 [00:05<03:54,  1.19s/it]Loss: 0.02848:   2%|▏         | 4/201 [00:05<03:54,  1.19s/it]Loss: 0.02848:   2%|▏         | 5/201 [00:06<03:44,  1.15s/it]Loss: 0.02630:   2%|▏         | 5/201 [00:06<03:44,  1.15s/it]Loss: 0.02630:   3%|▎         | 6/201 [00:07<03:38,  1.12s/it]Loss: 0.02386:   3%|▎         | 6/201 [00:07<03:38,  1.12s/it]Loss: 0.02386:   3%|▎         | 7/201 [00:08<03:33,  1.10s/it]Loss: 0.02298:   3%|▎         | 7/201 [00:08<03:33,  1.10s/it]Loss: 0.02298:   4%|▍         | 8/201 [00:09<03:30,  1.09s/it]Loss: 0.02553:   4%|▍         | 8/201 [00:09<03:30,  1.09s/it]Loss: 0.02553:   4%|▍         | 9/201 [00:10<03:27,  1.08s/it]Loss: 0.02328:   4%|▍         | 9/201 [00:10<03:27,  1.08s/it]Loss: 0.02328:   5%|▍         | 10/201 [00:11<03:25,  1.08s/it]Loss: 0.02046:   5%|▍         | 10/201 [00:11<03:25,  1.08s/it]Loss: 0.02046:   5%|▌         | 11/201 [00:12<03:23,  1.07s/it]Loss: 0.01766:   5%|▌         | 11/201 [00:12<03:23,  1.07s/it]Loss: 0.01766:   6%|▌         | 12/201 [00:13<03:22,  1.07s/it]Loss: 0.01649:   6%|▌         | 12/201 [00:13<03:22,  1.07s/it]Loss: 0.01649:   6%|▋         | 13/201 [00:14<03:21,  1.07s/it]Loss: 0.01622:   6%|▋         | 13/201 [00:14<03:21,  1.07s/it]Loss: 0.01622:   7%|▋         | 14/201 [00:15<03:19,  1.07s/it]Loss: 0.01515:   7%|▋         | 14/201 [00:15<03:19,  1.07s/it]Loss: 0.01515:   7%|▋         | 15/201 [00:16<03:18,  1.07s/it]Loss: 0.01461:   7%|▋         | 15/201 [00:16<03:18,  1.07s/it]Loss: 0.01461:   8%|▊         | 16/201 [00:17<03:17,  1.07s/it]Loss: 0.01378:   8%|▊         | 16/201 [00:17<03:17,  1.07s/it]Loss: 0.01378:   8%|▊         | 17/201 [00:19<03:16,  1.07s/it]Loss: 0.01345:   8%|▊         | 17/201 [00:19<03:16,  1.07s/it]Loss: 0.01345:   9%|▉         | 18/201 [00:20<03:15,  1.07s/it]Loss: 0.01264:   9%|▉         | 18/201 [00:20<03:15,  1.07s/it]Loss: 0.01264:   9%|▉         | 19/201 [00:21<03:13,  1.07s/it]Loss: 0.01253:   9%|▉         | 19/201 [00:21<03:13,  1.07s/it]Loss: 0.01253:  10%|▉         | 20/201 [00:22<03:12,  1.07s/it]Loss: 0.01185:  10%|▉         | 20/201 [00:22<03:12,  1.07s/it]Loss: 0.01185:  10%|█         | 21/201 [00:23<03:24,  1.14s/it]Loss: 0.01148:  10%|█         | 21/201 [00:23<03:24,  1.14s/it]Loss: 0.01148:  11%|█         | 22/201 [00:24<03:19,  1.11s/it]Loss: 0.01117:  11%|█         | 22/201 [00:24<03:19,  1.11s/it]Loss: 0.01117:  11%|█▏        | 23/201 [00:25<03:15,  1.10s/it]Loss: 0.01100:  11%|█▏        | 23/201 [00:25<03:15,  1.10s/it]Loss: 0.01100:  12%|█▏        | 24/201 [00:26<03:12,  1.09s/it]Loss: 0.01100:  12%|█▏        | 24/201 [00:26<03:12,  1.09s/it]Loss: 0.01100:  12%|█▏        | 25/201 [00:27<03:10,  1.08s/it]Loss: 0.01057:  12%|█▏        | 25/201 [00:27<03:10,  1.08s/it]Loss: 0.01057:  13%|█▎        | 26/201 [00:28<03:08,  1.08s/it]Loss: 0.01010:  13%|█▎        | 26/201 [00:28<03:08,  1.08s/it]Loss: 0.01010:  13%|█▎        | 27/201 [00:29<03:06,  1.07s/it]Loss: 0.00986:  13%|█▎        | 27/201 [00:29<03:06,  1.07s/it]Loss: 0.00986:  14%|█▍        | 28/201 [00:30<03:05,  1.07s/it]Loss: 0.01040:  14%|█▍        | 28/201 [00:30<03:05,  1.07s/it]Loss: 0.01040:  14%|█▍        | 29/201 [00:32<03:03,  1.07s/it]Loss: 0.00952:  14%|█▍        | 29/201 [00:32<03:03,  1.07s/it]Loss: 0.00952:  15%|█▍        | 30/201 [00:33<03:02,  1.07s/it]Loss: 0.00899:  15%|█▍        | 30/201 [00:33<03:02,  1.07s/it]Loss: 0.00899:  15%|█▌        | 31/201 [00:34<03:01,  1.07s/it]Loss: 0.00947:  15%|█▌        | 31/201 [00:34<03:01,  1.07s/it]Loss: 0.00947:  16%|█▌        | 32/201 [00:35<03:00,  1.07s/it]Loss: 0.01009:  16%|█▌        | 32/201 [00:35<03:00,  1.07s/it]Loss: 0.01009:  16%|█▋        | 33/201 [00:36<02:59,  1.07s/it]Loss: 0.01132:  16%|█▋        | 33/201 [00:36<02:59,  1.07s/it]Loss: 0.01132:  17%|█▋        | 34/201 [00:37<02:57,  1.07s/it]Loss: 0.00847:  17%|█▋        | 34/201 [00:37<02:57,  1.07s/it]Loss: 0.00847:  17%|█▋        | 35/201 [00:38<02:56,  1.07s/it]Loss: 0.00804:  17%|█▋        | 35/201 [00:38<02:56,  1.07s/it]Loss: 0.00804:  18%|█▊        | 36/201 [00:39<02:55,  1.07s/it]Loss: 0.00990:  18%|█▊        | 36/201 [00:39<02:55,  1.07s/it]Loss: 0.00990:  18%|█▊        | 37/201 [00:40<02:54,  1.07s/it]Loss: 0.00866:  18%|█▊        | 37/201 [00:40<02:54,  1.07s/it]Loss: 0.00866:  19%|█▉        | 38/201 [00:41<02:53,  1.07s/it]Loss: 0.00874:  19%|█▉        | 38/201 [00:41<02:53,  1.07s/it]Loss: 0.00874:  19%|█▉        | 39/201 [00:42<02:52,  1.07s/it]Loss: 0.00855:  19%|█▉        | 39/201 [00:42<02:52,  1.07s/it]Loss: 0.00855:  20%|█▉        | 40/201 [00:43<02:51,  1.07s/it]Loss: 0.00841:  20%|█▉        | 40/201 [00:43<02:51,  1.07s/it]Loss: 0.00841:  20%|██        | 41/201 [00:45<03:01,  1.14s/it]Loss: 0.00770:  20%|██        | 41/201 [00:45<03:01,  1.14s/it]Loss: 0.00770:  21%|██        | 42/201 [00:46<02:56,  1.11s/it]Loss: 0.00646:  21%|██        | 42/201 [00:46<02:56,  1.11s/it]Loss: 0.00646:  21%|██▏       | 43/201 [00:47<02:53,  1.10s/it]Loss: 0.00646:  21%|██▏       | 43/201 [00:47<02:53,  1.10s/it]Loss: 0.00646:  22%|██▏       | 44/201 [00:48<02:50,  1.09s/it]Loss: 0.00848:  22%|██▏       | 44/201 [00:48<02:50,  1.09s/it]Loss: 0.00848:  22%|██▏       | 45/201 [00:49<02:48,  1.08s/it]Loss: 0.00844:  22%|██▏       | 45/201 [00:49<02:48,  1.08s/it]Loss: 0.00844:  23%|██▎       | 46/201 [00:50<02:46,  1.08s/it]Loss: 0.00795:  23%|██▎       | 46/201 [00:50<02:46,  1.08s/it]Loss: 0.00795:  23%|██▎       | 47/201 [00:51<02:45,  1.07s/it]Loss: 0.00787:  23%|██▎       | 47/201 [00:51<02:45,  1.07s/it]Loss: 0.00787:  24%|██▍       | 48/201 [00:52<02:43,  1.07s/it]Loss: 0.00769:  24%|██▍       | 48/201 [00:52<02:43,  1.07s/it]Loss: 0.00769:  24%|██▍       | 49/201 [00:53<02:42,  1.07s/it]Loss: 0.00735:  24%|██▍       | 49/201 [00:53<02:42,  1.07s/it]Loss: 0.00735:  25%|██▍       | 50/201 [00:54<02:41,  1.07s/it]Loss: 0.00601:  25%|██▍       | 50/201 [00:54<02:41,  1.07s/it]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.44s/it][A1it [00:01,  1.44s/it]
Loss: 0.00601:  25%|██▌       | 51/201 [00:57<03:45,  1.50s/it]Loss: 0.08359:  25%|██▌       | 51/201 [00:57<03:45,  1.50s/it]Loss: 0.08359:  26%|██▌       | 52/201 [00:58<03:24,  1.37s/it]Loss: 0.03821:  26%|██▌       | 52/201 [00:58<03:24,  1.37s/it]Loss: 0.03821:  26%|██▋       | 53/201 [00:59<03:10,  1.29s/it]Loss: 0.02405:  26%|██▋       | 53/201 [00:59<03:10,  1.29s/it]Loss: 0.02405:  27%|██▋       | 54/201 [01:00<02:59,  1.22s/it]Loss: 0.01890:  27%|██▋       | 54/201 [01:00<02:59,  1.22s/it]Loss: 0.01890:  27%|██▋       | 55/201 [01:01<02:52,  1.18s/it]Loss: 0.01492:  27%|██▋       | 55/201 [01:01<02:52,  1.18s/it]Loss: 0.01492:  28%|██▊       | 56/201 [01:02<02:46,  1.15s/it]Loss: 0.01332:  28%|██▊       | 56/201 [01:02<02:46,  1.15s/it]Loss: 0.01332:  28%|██▊       | 57/201 [01:03<02:42,  1.13s/it]Loss: 0.01243:  28%|██▊       | 57/201 [01:03<02:42,  1.13s/it]Loss: 0.01243:  29%|██▉       | 58/201 [01:04<02:39,  1.11s/it]Loss: 0.01157:  29%|██▉       | 58/201 [01:04<02:39,  1.11s/it]Loss: 0.01157:  29%|██▉       | 59/201 [01:05<02:36,  1.10s/it]Loss: 0.01118:  29%|██▉       | 59/201 [01:05<02:36,  1.10s/it]Loss: 0.01118:  30%|██▉       | 60/201 [01:06<02:34,  1.09s/it]Loss: 0.01079:  30%|██▉       | 60/201 [01:06<02:34,  1.09s/it]Loss: 0.01079:  30%|███       | 61/201 [01:08<02:42,  1.16s/it]Loss: 0.01015:  30%|███       | 61/201 [01:08<02:42,  1.16s/it]Loss: 0.01015:  31%|███       | 62/201 [01:09<02:37,  1.13s/it]Loss: 0.00983:  31%|███       | 62/201 [01:09<02:37,  1.13s/it]Loss: 0.00983:  31%|███▏      | 63/201 [01:10<02:33,  1.12s/it]Loss: 0.00960:  31%|███▏      | 63/201 [01:10<02:33,  1.12s/it]Loss: 0.00960:  32%|███▏      | 64/201 [01:11<02:31,  1.10s/it]Loss: 0.00913:  32%|███▏      | 64/201 [01:11<02:31,  1.10s/it]Loss: 0.00913:  32%|███▏      | 65/201 [01:12<02:29,  1.10s/it]Loss: 0.00933:  32%|███▏      | 65/201 [01:12<02:29,  1.10s/it]Loss: 0.00933:  33%|███▎      | 66/201 [01:13<02:27,  1.09s/it]Loss: 0.00884:  33%|███▎      | 66/201 [01:13<02:27,  1.09s/it]Loss: 0.00884:  33%|███▎      | 67/201 [01:14<02:25,  1.09s/it]Loss: 0.00846:  33%|███▎      | 67/201 [01:14<02:25,  1.09s/it]Loss: 0.00846:  34%|███▍      | 68/201 [01:15<02:24,  1.08s/it]Loss: 0.00860:  34%|███▍      | 68/201 [01:15<02:24,  1.08s/it]Loss: 0.00860:  34%|███▍      | 69/201 [01:16<02:22,  1.08s/it]Loss: 0.00812:  34%|███▍      | 69/201 [01:16<02:22,  1.08s/it]Loss: 0.00812:  35%|███▍      | 70/201 [01:17<02:21,  1.08s/it]Loss: 0.00827:  35%|███▍      | 70/201 [01:17<02:21,  1.08s/it]Loss: 0.00827:  35%|███▌      | 71/201 [01:18<02:20,  1.08s/it]Loss: 0.00777:  35%|███▌      | 71/201 [01:18<02:20,  1.08s/it]Loss: 0.00777:  36%|███▌      | 72/201 [01:20<02:19,  1.08s/it]Loss: 0.00775:  36%|███▌      | 72/201 [01:20<02:19,  1.08s/it]Loss: 0.00775:  36%|███▋      | 73/201 [01:21<02:17,  1.08s/it]Loss: 0.00783:  36%|███▋      | 73/201 [01:21<02:17,  1.08s/it]Loss: 0.00783:  37%|███▋      | 74/201 [01:22<02:16,  1.08s/it]Loss: 0.00729:  37%|███▋      | 74/201 [01:22<02:16,  1.08s/it]Loss: 0.00729:  37%|███▋      | 75/201 [01:23<02:15,  1.08s/it]Loss: 0.00761:  37%|███▋      | 75/201 [01:23<02:15,  1.08s/it]Loss: 0.00761:  38%|███▊      | 76/201 [01:24<02:14,  1.08s/it]Loss: 0.00736:  38%|███▊      | 76/201 [01:24<02:14,  1.08s/it]Loss: 0.00736:  38%|███▊      | 77/201 [01:25<02:13,  1.08s/it]Loss: 0.00699:  38%|███▊      | 77/201 [01:25<02:13,  1.08s/it]Loss: 0.00699:  39%|███▉      | 78/201 [01:26<02:12,  1.08s/it]Loss: 0.00734:  39%|███▉      | 78/201 [01:26<02:12,  1.08s/it]Loss: 0.00734:  39%|███▉      | 79/201 [01:27<02:11,  1.08s/it]Loss: 0.00681:  39%|███▉      | 79/201 [01:27<02:11,  1.08s/it]Loss: 0.00681:  40%|███▉      | 80/201 [01:28<02:10,  1.08s/it]Loss: 0.00667:  40%|███▉      | 80/201 [01:28<02:10,  1.08s/it]Loss: 0.00667:  40%|████      | 81/201 [01:29<02:17,  1.15s/it]Loss: 0.00670:  40%|████      | 81/201 [01:29<02:17,  1.15s/it]Loss: 0.00670:  41%|████      | 82/201 [01:30<02:13,  1.12s/it]Loss: 0.00658:  41%|████      | 82/201 [01:30<02:13,  1.12s/it]Loss: 0.00658:  41%|████▏     | 83/201 [01:32<02:10,  1.11s/it]Loss: 0.00662:  41%|████▏     | 83/201 [01:32<02:10,  1.11s/it]Loss: 0.00662:  42%|████▏     | 84/201 [01:33<02:08,  1.10s/it]Loss: 0.00635:  42%|████▏     | 84/201 [01:33<02:08,  1.10s/it]Loss: 0.00635:  42%|████▏     | 85/201 [01:34<02:06,  1.09s/it]Loss: 0.00604:  42%|████▏     | 85/201 [01:34<02:06,  1.09s/it]Loss: 0.00604:  43%|████▎     | 86/201 [01:35<02:05,  1.09s/it]Loss: 0.00634:  43%|████▎     | 86/201 [01:35<02:05,  1.09s/it]Loss: 0.00634:  43%|████▎     | 87/201 [01:36<02:03,  1.08s/it]Loss: 0.00657:  43%|████▎     | 87/201 [01:36<02:03,  1.08s/it]Loss: 0.00657:  44%|████▍     | 88/201 [01:37<02:02,  1.08s/it]Loss: 0.00597:  44%|████▍     | 88/201 [01:37<02:02,  1.08s/it]Loss: 0.00597:  44%|████▍     | 89/201 [01:38<02:01,  1.08s/it]Loss: 0.00642:  44%|████▍     | 89/201 [01:38<02:01,  1.08s/it]Loss: 0.00642:  45%|████▍     | 90/201 [01:39<01:59,  1.08s/it]Loss: 0.00631:  45%|████▍     | 90/201 [01:39<01:59,  1.08s/it]Loss: 0.00631:  45%|████▌     | 91/201 [01:40<01:58,  1.08s/it]Loss: 0.00600:  45%|████▌     | 91/201 [01:40<01:58,  1.08s/it]Loss: 0.00600:  46%|████▌     | 92/201 [01:41<01:57,  1.08s/it]Loss: 0.00581:  46%|████▌     | 92/201 [01:41<01:57,  1.08s/it]Loss: 0.00581:  46%|████▋     | 93/201 [01:42<01:56,  1.08s/it]Loss: 0.00608:  46%|████▋     | 93/201 [01:42<01:56,  1.08s/it]Loss: 0.00608:  47%|████▋     | 94/201 [01:43<01:55,  1.08s/it]Loss: 0.00573:  47%|████▋     | 94/201 [01:43<01:55,  1.08s/it]Loss: 0.00573:  47%|████▋     | 95/201 [01:44<01:54,  1.08s/it]Loss: 0.00594:  47%|████▋     | 95/201 [01:44<01:54,  1.08s/it]Loss: 0.00594:  48%|████▊     | 96/201 [01:46<01:53,  1.08s/it]Loss: 0.00561:  48%|████▊     | 96/201 [01:46<01:53,  1.08s/it]Loss: 0.00561:  48%|████▊     | 97/201 [01:47<01:52,  1.08s/it]Loss: 0.00578:  48%|████▊     | 97/201 [01:47<01:52,  1.08s/it]Loss: 0.00578:  49%|████▉     | 98/201 [01:48<01:51,  1.08s/it]Loss: 0.00542:  49%|████▉     | 98/201 [01:48<01:51,  1.08s/it]Loss: 0.00542:  49%|████▉     | 99/201 [01:49<01:49,  1.08s/it]Loss: 0.00526:  49%|████▉     | 99/201 [01:49<01:49,  1.08s/it]Loss: 0.00526:  50%|████▉     | 100/201 [01:50<01:48,  1.08s/it]Loss: 0.00553:  50%|████▉     | 100/201 [01:50<01:48,  1.08s/it]Loss: 0.00553:  50%|█████     | 101/201 [01:51<01:54,  1.15s/it]Loss: 0.00424:  50%|█████     | 101/201 [01:51<01:54,  1.15s/it]max loss: 0.8423929214477539
Densities: min=4.7720572183607146e-05, max=0.9906202554702759, mean=0.16593605279922485
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.49s/it][A1it [00:01,  1.49s/it]
Loss: 0.00424:  51%|█████     | 102/201 [01:54<02:35,  1.57s/it]Loss: 0.02172:  51%|█████     | 102/201 [01:54<02:35,  1.57s/it]Loss: 0.02172:  51%|█████     | 103/201 [01:55<02:19,  1.43s/it]Loss: 0.01792:  51%|█████     | 103/201 [01:55<02:19,  1.43s/it]Loss: 0.01792:  52%|█████▏    | 104/201 [01:56<02:08,  1.32s/it]Loss: 0.01615:  52%|█████▏    | 104/201 [01:56<02:08,  1.32s/it]Loss: 0.01615:  52%|█████▏    | 105/201 [01:57<02:00,  1.25s/it]Loss: 0.01513:  52%|█████▏    | 105/201 [01:57<02:00,  1.25s/it]Loss: 0.01513:  53%|█████▎    | 106/201 [01:58<01:53,  1.20s/it]Loss: 0.01441:  53%|█████▎    | 106/201 [01:58<01:53,  1.20s/it]Loss: 0.01441:  53%|█████▎    | 107/201 [01:59<01:49,  1.16s/it]Loss: 0.01378:  53%|█████▎    | 107/201 [01:59<01:49,  1.16s/it]Loss: 0.01378:  54%|█████▎    | 108/201 [02:00<01:45,  1.14s/it]Loss: 0.01331:  54%|█████▎    | 108/201 [02:00<01:45,  1.14s/it]Loss: 0.01331:  54%|█████▍    | 109/201 [02:01<01:43,  1.12s/it]Loss: 0.01293:  54%|█████▍    | 109/201 [02:01<01:43,  1.12s/it]Loss: 0.01293:  55%|█████▍    | 110/201 [02:02<01:40,  1.11s/it]Loss: 0.01257:  55%|█████▍    | 110/201 [02:02<01:40,  1.11s/it]Loss: 0.01257:  55%|█████▌    | 111/201 [02:03<01:39,  1.10s/it]Loss: 0.01228:  55%|█████▌    | 111/201 [02:03<01:39,  1.10s/it]Loss: 0.01228:  56%|█████▌    | 112/201 [02:05<01:37,  1.09s/it]Loss: 0.01205:  56%|█████▌    | 112/201 [02:05<01:37,  1.09s/it]Loss: 0.01205:  56%|█████▌    | 113/201 [02:06<01:35,  1.09s/it]Loss: 0.01176:  56%|█████▌    | 113/201 [02:06<01:35,  1.09s/it]Loss: 0.01176:  57%|█████▋    | 114/201 [02:07<01:34,  1.09s/it]Loss: 0.01154:  57%|█████▋    | 114/201 [02:07<01:34,  1.09s/it]Loss: 0.01154:  57%|█████▋    | 115/201 [02:08<01:33,  1.08s/it]Loss: 0.01132:  57%|█████▋    | 115/201 [02:08<01:33,  1.08s/it]Loss: 0.01132:  58%|█████▊    | 116/201 [02:09<01:32,  1.08s/it]Loss: 0.01122:  58%|█████▊    | 116/201 [02:09<01:32,  1.08s/it]Loss: 0.01122:  58%|█████▊    | 117/201 [02:10<01:30,  1.08s/it]Loss: 0.01101:  58%|█████▊    | 117/201 [02:10<01:30,  1.08s/it]Loss: 0.01101:  59%|█████▊    | 118/201 [02:11<01:29,  1.08s/it]Loss: 0.01100:  59%|█████▊    | 118/201 [02:11<01:29,  1.08s/it]Loss: 0.01100:  59%|█████▉    | 119/201 [02:12<01:28,  1.08s/it]Loss: 0.01082:  59%|█████▉    | 119/201 [02:12<01:28,  1.08s/it]Loss: 0.01082:  60%|█████▉    | 120/201 [02:13<01:27,  1.08s/it]Loss: 0.01059:  60%|█████▉    | 120/201 [02:13<01:27,  1.08s/it]Loss: 0.01059:  60%|██████    | 121/201 [02:15<01:32,  1.15s/it]Loss: 0.01040:  60%|██████    | 121/201 [02:15<01:32,  1.15s/it]Loss: 0.01040:  61%|██████    | 122/201 [02:16<01:28,  1.13s/it]Loss: 0.01039:  61%|██████    | 122/201 [02:16<01:28,  1.13s/it]Loss: 0.01039:  61%|██████    | 123/201 [02:17<01:26,  1.11s/it]Loss: 0.01022:  61%|██████    | 123/201 [02:17<01:26,  1.11s/it]Loss: 0.01022:  62%|██████▏   | 124/201 [02:18<01:24,  1.10s/it]Loss: 0.01012:  62%|██████▏   | 124/201 [02:18<01:24,  1.10s/it]Loss: 0.01012:  62%|██████▏   | 125/201 [02:19<01:23,  1.10s/it]Loss: 0.00997:  62%|██████▏   | 125/201 [02:19<01:23,  1.10s/it]Loss: 0.00997:  63%|██████▎   | 126/201 [02:20<01:21,  1.09s/it]Loss: 0.00995:  63%|██████▎   | 126/201 [02:20<01:21,  1.09s/it]Loss: 0.00995:  63%|██████▎   | 127/201 [02:21<01:20,  1.09s/it]Loss: 0.00981:  63%|██████▎   | 127/201 [02:21<01:20,  1.09s/it]Loss: 0.00981:  64%|██████▎   | 128/201 [02:22<01:19,  1.09s/it]Loss: 0.00969:  64%|██████▎   | 128/201 [02:22<01:19,  1.09s/it]Loss: 0.00969:  64%|██████▍   | 129/201 [02:23<01:18,  1.08s/it]Loss: 0.00985:  64%|██████▍   | 129/201 [02:23<01:18,  1.08s/it]Loss: 0.00985:  65%|██████▍   | 130/201 [02:24<01:16,  1.08s/it]Loss: 0.00953:  65%|██████▍   | 130/201 [02:24<01:16,  1.08s/it]Loss: 0.00953:  65%|██████▌   | 131/201 [02:25<01:15,  1.08s/it]Loss: 0.00945:  65%|██████▌   | 131/201 [02:25<01:15,  1.08s/it]Loss: 0.00945:  66%|██████▌   | 132/201 [02:26<01:14,  1.08s/it]Loss: 0.00936:  66%|██████▌   | 132/201 [02:26<01:14,  1.08s/it]Loss: 0.00936:  66%|██████▌   | 133/201 [02:27<01:13,  1.08s/it]Loss: 0.00933:  66%|██████▌   | 133/201 [02:27<01:13,  1.08s/it]Loss: 0.00933:  67%|██████▋   | 134/201 [02:29<01:12,  1.08s/it]Loss: 0.00923:  67%|██████▋   | 134/201 [02:29<01:12,  1.08s/it]Loss: 0.00923:  67%|██████▋   | 135/201 [02:30<01:11,  1.08s/it]Loss: 0.00910:  67%|██████▋   | 135/201 [02:30<01:11,  1.08s/it]Loss: 0.00910:  68%|██████▊   | 136/201 [02:31<01:10,  1.08s/it]Loss: 0.00934:  68%|██████▊   | 136/201 [02:31<01:10,  1.08s/it]Loss: 0.00934:  68%|██████▊   | 137/201 [02:32<01:09,  1.08s/it]Loss: 0.00911:  68%|██████▊   | 137/201 [02:32<01:09,  1.08s/it]Loss: 0.00911:  69%|██████▊   | 138/201 [02:33<01:08,  1.08s/it]Loss: 0.00928:  69%|██████▊   | 138/201 [02:33<01:08,  1.08s/it]Loss: 0.00928:  69%|██████▉   | 139/201 [02:34<01:06,  1.08s/it]Loss: 0.00903:  69%|██████▉   | 139/201 [02:34<01:06,  1.08s/it]Loss: 0.00903:  70%|██████▉   | 140/201 [02:35<01:05,  1.08s/it]Loss: 0.00896:  70%|██████▉   | 140/201 [02:35<01:05,  1.08s/it]Loss: 0.00896:  70%|███████   | 141/201 [02:36<01:08,  1.15s/it]Loss: 0.00895:  70%|███████   | 141/201 [02:36<01:08,  1.15s/it]Loss: 0.00895:  71%|███████   | 142/201 [02:37<01:06,  1.13s/it]Loss: 0.00880:  71%|███████   | 142/201 [02:37<01:06,  1.13s/it]Loss: 0.00880:  71%|███████   | 143/201 [02:39<01:04,  1.11s/it]Loss: 0.00853:  71%|███████   | 143/201 [02:39<01:04,  1.11s/it]Loss: 0.00853:  72%|███████▏  | 144/201 [02:40<01:02,  1.10s/it]Loss: 0.00864:  72%|███████▏  | 144/201 [02:40<01:02,  1.10s/it]Loss: 0.00864:  72%|███████▏  | 145/201 [02:41<01:01,  1.10s/it]Loss: 0.00860:  72%|███████▏  | 145/201 [02:41<01:01,  1.10s/it]Loss: 0.00860:  73%|███████▎  | 146/201 [02:42<01:00,  1.09s/it]Loss: 0.00879:  73%|███████▎  | 146/201 [02:42<01:00,  1.09s/it]Loss: 0.00879:  73%|███████▎  | 147/201 [02:43<00:58,  1.09s/it]Loss: 0.00851:  73%|███████▎  | 147/201 [02:43<00:58,  1.09s/it]Loss: 0.00851:  74%|███████▎  | 148/201 [02:44<00:57,  1.08s/it]Loss: 0.00832:  74%|███████▎  | 148/201 [02:44<00:57,  1.08s/it]Loss: 0.00832:  74%|███████▍  | 149/201 [02:45<00:56,  1.08s/it]Loss: 0.00834:  74%|███████▍  | 149/201 [02:45<00:56,  1.08s/it]Loss: 0.00834:  75%|███████▍  | 150/201 [02:46<00:55,  1.08s/it]Loss: 0.00826:  75%|███████▍  | 150/201 [02:46<00:55,  1.08s/it]Loss: 0.00826:  75%|███████▌  | 151/201 [02:47<00:54,  1.08s/it]Loss: 0.00822:  75%|███████▌  | 151/201 [02:47<00:54,  1.08s/it]Loss: 0.00822:  76%|███████▌  | 152/201 [02:48<00:52,  1.08s/it]Loss: 0.00814:  76%|███████▌  | 152/201 [02:48<00:52,  1.08s/it]max loss: 0.26085275411605835
Densities: min=0.00025848750374279916, max=0.9909875392913818, mean=0.4097881615161896
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.60s/it][A1it [00:01,  1.60s/it]
Loss: 0.00814:  76%|███████▌  | 153/201 [02:51<01:15,  1.56s/it]Loss: 0.01374:  76%|███████▌  | 153/201 [02:51<01:15,  1.56s/it]Loss: 0.01374:  77%|███████▋  | 154/201 [02:52<01:06,  1.42s/it]Loss: 0.01208:  77%|███████▋  | 154/201 [02:52<01:06,  1.42s/it]Loss: 0.01208:  77%|███████▋  | 155/201 [02:53<01:00,  1.32s/it]Loss: 0.01131:  77%|███████▋  | 155/201 [02:53<01:00,  1.32s/it]Loss: 0.01131:  78%|███████▊  | 156/201 [02:54<00:56,  1.25s/it]Loss: 0.01079:  78%|███████▊  | 156/201 [02:54<00:56,  1.25s/it]Loss: 0.01079:  78%|███████▊  | 157/201 [02:55<00:52,  1.20s/it]Loss: 0.01042:  78%|███████▊  | 157/201 [02:55<00:52,  1.20s/it]Loss: 0.01042:  79%|███████▊  | 158/201 [02:56<00:50,  1.17s/it]Loss: 0.01014:  79%|███████▊  | 158/201 [02:56<00:50,  1.17s/it]Loss: 0.01014:  79%|███████▉  | 159/201 [02:57<00:48,  1.14s/it]Loss: 0.00989:  79%|███████▉  | 159/201 [02:57<00:48,  1.14s/it]Loss: 0.00989:  80%|███████▉  | 160/201 [02:59<00:46,  1.13s/it]Loss: 0.00976:  80%|███████▉  | 160/201 [02:59<00:46,  1.13s/it]Loss: 0.00976:  80%|████████  | 161/201 [03:00<00:47,  1.19s/it]Loss: 0.00959:  80%|████████  | 161/201 [03:00<00:47,  1.19s/it]Loss: 0.00959:  81%|████████  | 162/201 [03:01<00:44,  1.15s/it]Loss: 0.00950:  81%|████████  | 162/201 [03:01<00:44,  1.15s/it]Loss: 0.00950:  81%|████████  | 163/201 [03:02<00:43,  1.13s/it]Loss: 0.00942:  81%|████████  | 163/201 [03:02<00:43,  1.13s/it]Loss: 0.00942:  82%|████████▏ | 164/201 [03:03<00:41,  1.12s/it]Loss: 0.00922:  82%|████████▏ | 164/201 [03:03<00:41,  1.12s/it]Loss: 0.00922:  82%|████████▏ | 165/201 [03:04<00:39,  1.11s/it]Loss: 0.00902:  82%|████████▏ | 165/201 [03:04<00:39,  1.11s/it]Loss: 0.00902:  83%|████████▎ | 166/201 [03:05<00:38,  1.10s/it]Loss: 0.00890:  83%|████████▎ | 166/201 [03:05<00:38,  1.10s/it]Loss: 0.00890:  83%|████████▎ | 167/201 [03:06<00:37,  1.10s/it]Loss: 0.00889:  83%|████████▎ | 167/201 [03:06<00:37,  1.10s/it]Loss: 0.00889:  84%|████████▎ | 168/201 [03:07<00:36,  1.09s/it]Loss: 0.00888:  84%|████████▎ | 168/201 [03:07<00:36,  1.09s/it]Loss: 0.00888:  84%|████████▍ | 169/201 [03:09<00:34,  1.09s/it]Loss: 0.00881:  84%|████████▍ | 169/201 [03:09<00:34,  1.09s/it]Loss: 0.00881:  85%|████████▍ | 170/201 [03:10<00:33,  1.09s/it]Loss: 0.00878:  85%|████████▍ | 170/201 [03:10<00:33,  1.09s/it]Loss: 0.00878:  85%|████████▌ | 171/201 [03:11<00:32,  1.09s/it]Loss: 0.00866:  85%|████████▌ | 171/201 [03:11<00:32,  1.09s/it]Loss: 0.00866:  86%|████████▌ | 172/201 [03:12<00:31,  1.09s/it]Loss: 0.00863:  86%|████████▌ | 172/201 [03:12<00:31,  1.09s/it]Loss: 0.00863:  86%|████████▌ | 173/201 [03:13<00:30,  1.09s/it]Loss: 0.00853:  86%|████████▌ | 173/201 [03:13<00:30,  1.09s/it]Loss: 0.00853:  87%|████████▋ | 174/201 [03:14<00:29,  1.09s/it]Loss: 0.00852:  87%|████████▋ | 174/201 [03:14<00:29,  1.09s/it]Loss: 0.00852:  87%|████████▋ | 175/201 [03:15<00:28,  1.09s/it]Loss: 0.00878:  87%|████████▋ | 175/201 [03:15<00:28,  1.09s/it]Loss: 0.00878:  88%|████████▊ | 176/201 [03:16<00:27,  1.09s/it]Loss: 0.00831:  88%|████████▊ | 176/201 [03:16<00:27,  1.09s/it]Loss: 0.00831:  88%|████████▊ | 177/201 [03:17<00:26,  1.09s/it]Loss: 0.00826:  88%|████████▊ | 177/201 [03:17<00:26,  1.09s/it]Loss: 0.00826:  89%|████████▊ | 178/201 [03:18<00:25,  1.09s/it]Loss: 0.00829:  89%|████████▊ | 178/201 [03:18<00:25,  1.09s/it]Loss: 0.00829:  89%|████████▉ | 179/201 [03:19<00:23,  1.09s/it]Loss: 0.00826:  89%|████████▉ | 179/201 [03:19<00:23,  1.09s/it]Loss: 0.00826:  90%|████████▉ | 180/201 [03:20<00:22,  1.09s/it]Loss: 0.00810:  90%|████████▉ | 180/201 [03:20<00:22,  1.09s/it]Loss: 0.00810:  90%|█████████ | 181/201 [03:22<00:23,  1.16s/it]Loss: 0.00804:  90%|█████████ | 181/201 [03:22<00:23,  1.16s/it]Loss: 0.00804:  91%|█████████ | 182/201 [03:23<00:21,  1.13s/it]Loss: 0.00792:  91%|█████████ | 182/201 [03:23<00:21,  1.13s/it]Loss: 0.00792:  91%|█████████ | 183/201 [03:24<00:20,  1.12s/it]Loss: 0.00799:  91%|█████████ | 183/201 [03:24<00:20,  1.12s/it]Loss: 0.00799:  92%|█████████▏| 184/201 [03:25<00:18,  1.11s/it]Loss: 0.00785:  92%|█████████▏| 184/201 [03:25<00:18,  1.11s/it]Loss: 0.00785:  92%|█████████▏| 185/201 [03:26<00:17,  1.10s/it]Loss: 0.00794:  92%|█████████▏| 185/201 [03:26<00:17,  1.10s/it]Loss: 0.00794:  93%|█████████▎| 186/201 [03:27<00:16,  1.10s/it]Loss: 0.00803:  93%|█████████▎| 186/201 [03:27<00:16,  1.10s/it]Loss: 0.00803:  93%|█████████▎| 187/201 [03:28<00:15,  1.10s/it]Loss: 0.00773:  93%|█████████▎| 187/201 [03:28<00:15,  1.10s/it]Loss: 0.00773:  94%|█████████▎| 188/201 [03:29<00:14,  1.09s/it]Loss: 0.00782:  94%|█████████▎| 188/201 [03:29<00:14,  1.09s/it]Loss: 0.00782:  94%|█████████▍| 189/201 [03:31<00:13,  1.09s/it]Loss: 0.00783:  94%|█████████▍| 189/201 [03:31<00:13,  1.09s/it]Loss: 0.00783:  95%|█████████▍| 190/201 [03:32<00:12,  1.09s/it]Loss: 0.00774:  95%|█████████▍| 190/201 [03:32<00:12,  1.09s/it]Loss: 0.00774:  95%|█████████▌| 191/201 [03:33<00:10,  1.09s/it]Loss: 0.00779:  95%|█████████▌| 191/201 [03:33<00:10,  1.09s/it]Loss: 0.00779:  96%|█████████▌| 192/201 [03:34<00:09,  1.09s/it]Loss: 0.00791:  96%|█████████▌| 192/201 [03:34<00:09,  1.09s/it]Loss: 0.00791:  96%|█████████▌| 193/201 [03:35<00:08,  1.09s/it]Loss: 0.00771:  96%|█████████▌| 193/201 [03:35<00:08,  1.09s/it]Loss: 0.00771:  97%|█████████▋| 194/201 [03:36<00:07,  1.09s/it]Loss: 0.00751:  97%|█████████▋| 194/201 [03:36<00:07,  1.09s/it]Loss: 0.00751:  97%|█████████▋| 195/201 [03:37<00:06,  1.09s/it]Loss: 0.00745:  97%|█████████▋| 195/201 [03:37<00:06,  1.09s/it]Loss: 0.00745:  98%|█████████▊| 196/201 [03:38<00:05,  1.09s/it]Loss: 0.00742:  98%|█████████▊| 196/201 [03:38<00:05,  1.09s/it]Loss: 0.00742:  98%|█████████▊| 197/201 [03:39<00:04,  1.09s/it]Loss: 0.00749:  98%|█████████▊| 197/201 [03:39<00:04,  1.09s/it]Loss: 0.00749:  99%|█████████▊| 198/201 [03:40<00:03,  1.09s/it]Loss: 0.00728:  99%|█████████▊| 198/201 [03:40<00:03,  1.09s/it]Loss: 0.00728:  99%|█████████▉| 199/201 [03:41<00:02,  1.09s/it]Loss: 0.00737:  99%|█████████▉| 199/201 [03:41<00:02,  1.09s/it]Loss: 0.00737: 100%|█████████▉| 200/201 [03:42<00:01,  1.09s/it]Loss: 0.00742: 100%|█████████▉| 200/201 [03:42<00:01,  1.09s/it]Loss: 0.00742: 100%|██████████| 201/201 [03:44<00:00,  1.16s/it]Loss: 0.00684: 100%|██████████| 201/201 [03:44<00:00,  1.16s/it]Loss: 0.00684: 100%|██████████| 201/201 [03:44<00:00,  1.12s/it]Load volume "/media/storage0/qadwu/floats/1atm_temp_1152x320x853_float32_raw_1152x320x853_float.cvol"
Loaded

max loss: 0.20302550494670868
Densities: min=0.00012462426093406975, max=0.9900373220443726, mean=0.38346561789512634
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 224.28168106079102 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_1atm.json
Latent space memory: 90.4MiB
Latent space memory: 90.4MiB
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/1atm_temp_1152x320x853_float32_raw_1152x320x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_1atm.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 10, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 3, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 23382528
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.08it/s]1it [00:00,  4.08it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0006044767214916646, max=0.9899277687072754, mean=0.76361083984375
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  3.18it/s]Render: : 1it [00:00,  3.18it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_1atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 320, 853], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/1atmtemp-20220916180933-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 10, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 3}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<02:06,  1.58it/s]Loss: 0.24100:   0%|          | 1/201 [00:00<02:06,  1.58it/s]Loss: 0.24100:   1%|          | 2/201 [00:01<01:38,  2.03it/s]Loss: 0.05583:   1%|          | 2/201 [00:01<01:38,  2.03it/s]Loss: 0.05583:   1%|▏         | 3/201 [00:01<01:29,  2.22it/s]Loss: 0.04828:   1%|▏         | 3/201 [00:01<01:29,  2.22it/s]Loss: 0.04828:   2%|▏         | 4/201 [00:01<01:24,  2.32it/s]Loss: 0.04377:   2%|▏         | 4/201 [00:01<01:24,  2.32it/s]Loss: 0.04377:   2%|▏         | 5/201 [00:02<01:22,  2.38it/s]Loss: 0.04144:   2%|▏         | 5/201 [00:02<01:22,  2.38it/s]Loss: 0.04144:   3%|▎         | 6/201 [00:02<01:20,  2.42it/s]Loss: 0.02994:   3%|▎         | 6/201 [00:02<01:20,  2.42it/s]Loss: 0.02994:   3%|▎         | 7/201 [00:03<01:19,  2.45it/s]Loss: 0.02398:   3%|▎         | 7/201 [00:03<01:19,  2.45it/s]Loss: 0.02398:   4%|▍         | 8/201 [00:03<01:18,  2.46it/s]Loss: 0.02267:   4%|▍         | 8/201 [00:03<01:18,  2.46it/s]Loss: 0.02267:   4%|▍         | 9/201 [00:03<01:17,  2.47it/s]Loss: 0.02404:   4%|▍         | 9/201 [00:03<01:17,  2.47it/s]Loss: 0.02404:   5%|▍         | 10/201 [00:04<01:16,  2.48it/s]Loss: 0.03158:   5%|▍         | 10/201 [00:04<01:16,  2.48it/s]Loss: 0.03158:   5%|▌         | 11/201 [00:04<01:16,  2.49it/s]Loss: 0.02240:   5%|▌         | 11/201 [00:04<01:16,  2.49it/s]Loss: 0.02240:   6%|▌         | 12/201 [00:05<01:15,  2.49it/s]Loss: 0.02082:   6%|▌         | 12/201 [00:05<01:15,  2.49it/s]Loss: 0.02082:   6%|▋         | 13/201 [00:05<01:15,  2.50it/s]Loss: 0.02069:   6%|▋         | 13/201 [00:05<01:15,  2.50it/s]Loss: 0.02069:   7%|▋         | 14/201 [00:05<01:14,  2.50it/s]Loss: 0.02106:   7%|▋         | 14/201 [00:05<01:14,  2.50it/s]Loss: 0.02106:   7%|▋         | 15/201 [00:06<01:14,  2.50it/s]Loss: 0.01956:   7%|▋         | 15/201 [00:06<01:14,  2.50it/s]Loss: 0.01956:   8%|▊         | 16/201 [00:06<01:14,  2.50it/s]Loss: 0.02180:   8%|▊         | 16/201 [00:06<01:14,  2.50it/s]Loss: 0.02180:   8%|▊         | 17/201 [00:07<01:13,  2.50it/s]Loss: 0.03599:   8%|▊         | 17/201 [00:07<01:13,  2.50it/s]Loss: 0.03599:   9%|▉         | 18/201 [00:07<01:13,  2.50it/s]Loss: 0.03088:   9%|▉         | 18/201 [00:07<01:13,  2.50it/s]Loss: 0.03088:   9%|▉         | 19/201 [00:07<01:12,  2.50it/s]Loss: 0.03218:   9%|▉         | 19/201 [00:07<01:12,  2.50it/s]Loss: 0.03218:  10%|▉         | 20/201 [00:08<01:12,  2.50it/s]Loss: 0.03031:  10%|▉         | 20/201 [00:08<01:12,  2.50it/s]Loss: 0.03031:  10%|█         | 21/201 [00:08<01:23,  2.14it/s]Loss: 0.02927:  10%|█         | 21/201 [00:08<01:23,  2.14it/s]Loss: 0.02927:  11%|█         | 22/201 [00:09<01:19,  2.25it/s]Loss: 0.03019:  11%|█         | 22/201 [00:09<01:19,  2.25it/s]Loss: 0.03019:  11%|█▏        | 23/201 [00:09<01:16,  2.32it/s]Loss: 0.01594:  11%|█▏        | 23/201 [00:09<01:16,  2.32it/s]Loss: 0.01594:  12%|█▏        | 24/201 [00:10<01:14,  2.37it/s]Loss: 0.03385:  12%|█▏        | 24/201 [00:10<01:14,  2.37it/s]Loss: 0.03385:  12%|█▏        | 25/201 [00:10<01:13,  2.41it/s]Loss: 0.02451:  12%|█▏        | 25/201 [00:10<01:13,  2.41it/s]Loss: 0.02451:  13%|█▎        | 26/201 [00:10<01:11,  2.43it/s]Loss: 0.01618:  13%|█▎        | 26/201 [00:10<01:11,  2.43it/s]Loss: 0.01618:  13%|█▎        | 27/201 [00:11<01:10,  2.45it/s]Loss: 0.01484:  13%|█▎        | 27/201 [00:11<01:10,  2.45it/s]Loss: 0.01484:  14%|█▍        | 28/201 [00:11<01:10,  2.47it/s]Loss: 0.01550:  14%|█▍        | 28/201 [00:11<01:10,  2.47it/s]Loss: 0.01550:  14%|█▍        | 29/201 [00:12<01:09,  2.47it/s]Loss: 0.01448:  14%|█▍        | 29/201 [00:12<01:09,  2.47it/s]Loss: 0.01448:  15%|█▍        | 30/201 [00:12<01:08,  2.48it/s]Loss: 0.02059:  15%|█▍        | 30/201 [00:12<01:08,  2.48it/s]Loss: 0.02059:  15%|█▌        | 31/201 [00:12<01:08,  2.49it/s]Loss: 0.02766:  15%|█▌        | 31/201 [00:12<01:08,  2.49it/s]Loss: 0.02766:  16%|█▌        | 32/201 [00:13<01:07,  2.49it/s]Loss: 0.02470:  16%|█▌        | 32/201 [00:13<01:07,  2.49it/s]Loss: 0.02470:  16%|█▋        | 33/201 [00:13<01:07,  2.49it/s]Loss: 0.01439:  16%|█▋        | 33/201 [00:13<01:07,  2.49it/s]Loss: 0.01439:  17%|█▋        | 34/201 [00:14<01:06,  2.49it/s]Loss: 0.01312:  17%|█▋        | 34/201 [00:14<01:06,  2.49it/s]Loss: 0.01312:  17%|█▋        | 35/201 [00:14<01:06,  2.50it/s]Loss: 0.01887:  17%|█▋        | 35/201 [00:14<01:06,  2.50it/s]Loss: 0.01887:  18%|█▊        | 36/201 [00:14<01:06,  2.50it/s]Loss: 0.01981:  18%|█▊        | 36/201 [00:14<01:06,  2.50it/s]Loss: 0.01981:  18%|█▊        | 37/201 [00:15<01:05,  2.50it/s]Loss: 0.02537:  18%|█▊        | 37/201 [00:15<01:05,  2.50it/s]Loss: 0.02537:  19%|█▉        | 38/201 [00:15<01:05,  2.50it/s]Loss: 0.02594:  19%|█▉        | 38/201 [00:15<01:05,  2.50it/s]Loss: 0.02594:  19%|█▉        | 39/201 [00:16<01:04,  2.50it/s]Loss: 0.02333:  19%|█▉        | 39/201 [00:16<01:04,  2.50it/s]Loss: 0.02333:  20%|█▉        | 40/201 [00:16<01:04,  2.50it/s]Loss: 0.02638:  20%|█▉        | 40/201 [00:16<01:04,  2.50it/s]Loss: 0.02638:  20%|██        | 41/201 [00:17<01:14,  2.14it/s]Loss: 0.02410:  20%|██        | 41/201 [00:17<01:14,  2.14it/s]Loss: 0.02410:  21%|██        | 42/201 [00:17<01:10,  2.24it/s]Loss: 0.02323:  21%|██        | 42/201 [00:17<01:10,  2.24it/s]Loss: 0.02323:  21%|██▏       | 43/201 [00:17<01:08,  2.31it/s]Loss: 0.02250:  21%|██▏       | 43/201 [00:17<01:08,  2.31it/s]Loss: 0.02250:  22%|██▏       | 44/201 [00:18<01:06,  2.37it/s]Loss: 0.01778:  22%|██▏       | 44/201 [00:18<01:06,  2.37it/s]Loss: 0.01778:  22%|██▏       | 45/201 [00:18<01:04,  2.40it/s]Loss: 0.01407:  22%|██▏       | 45/201 [00:18<01:04,  2.40it/s]Loss: 0.01407:  23%|██▎       | 46/201 [00:19<01:03,  2.43it/s]Loss: 0.02250:  23%|██▎       | 46/201 [00:19<01:03,  2.43it/s]Loss: 0.02250:  23%|██▎       | 47/201 [00:19<01:02,  2.45it/s]Loss: 0.02169:  23%|██▎       | 47/201 [00:19<01:02,  2.45it/s]Loss: 0.02169:  24%|██▍       | 48/201 [00:19<01:02,  2.46it/s]Loss: 0.02119:  24%|██▍       | 48/201 [00:19<01:02,  2.46it/s]Loss: 0.02119:  24%|██▍       | 49/201 [00:20<01:01,  2.47it/s]Loss: 0.01451:  24%|██▍       | 49/201 [00:20<01:01,  2.47it/s]Loss: 0.01451:  25%|██▍       | 50/201 [00:20<01:00,  2.48it/s]Loss: 0.01767:  25%|██▍       | 50/201 [00:20<01:00,  2.48it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.14s/it][A1it [00:01,  1.14s/it]
Loss: 0.01767:  25%|██▌       | 51/201 [00:22<01:51,  1.34it/s]Loss: 0.03776:  25%|██▌       | 51/201 [00:22<01:51,  1.34it/s]Loss: 0.03776:  26%|██▌       | 52/201 [00:22<01:35,  1.56it/s]Loss: 0.02641:  26%|██▌       | 52/201 [00:22<01:35,  1.56it/s]Loss: 0.02641:  26%|██▋       | 53/201 [00:23<01:24,  1.75it/s]Loss: 0.02175:  26%|██▋       | 53/201 [00:23<01:24,  1.75it/s]Loss: 0.02175:  27%|██▋       | 54/201 [00:23<01:16,  1.92it/s]Loss: 0.01911:  27%|██▋       | 54/201 [00:23<01:16,  1.92it/s]Loss: 0.01911:  27%|██▋       | 55/201 [00:23<01:10,  2.06it/s]Loss: 0.01732:  27%|██▋       | 55/201 [00:23<01:10,  2.06it/s]Loss: 0.01732:  28%|██▊       | 56/201 [00:24<01:06,  2.18it/s]Loss: 0.01594:  28%|██▊       | 56/201 [00:24<01:06,  2.18it/s]Loss: 0.01594:  28%|██▊       | 57/201 [00:24<01:03,  2.26it/s]Loss: 0.01482:  28%|██▊       | 57/201 [00:24<01:03,  2.26it/s]Loss: 0.01482:  29%|██▉       | 58/201 [00:25<01:01,  2.33it/s]Loss: 0.01400:  29%|██▉       | 58/201 [00:25<01:01,  2.33it/s]Loss: 0.01400:  29%|██▉       | 59/201 [00:25<00:59,  2.37it/s]Loss: 0.01341:  29%|██▉       | 59/201 [00:25<00:59,  2.37it/s]Loss: 0.01341:  30%|██▉       | 60/201 [00:25<00:58,  2.41it/s]Loss: 0.01292:  30%|██▉       | 60/201 [00:25<00:58,  2.41it/s]Loss: 0.01292:  30%|███       | 61/201 [00:26<01:06,  2.09it/s]Loss: 0.01266:  30%|███       | 61/201 [00:26<01:06,  2.09it/s]Loss: 0.01266:  31%|███       | 62/201 [00:26<01:03,  2.20it/s]Loss: 0.01252:  31%|███       | 62/201 [00:26<01:03,  2.20it/s]Loss: 0.01252:  31%|███▏      | 63/201 [00:27<01:00,  2.28it/s]Loss: 0.01354:  31%|███▏      | 63/201 [00:27<01:00,  2.28it/s]Loss: 0.01354:  32%|███▏      | 64/201 [00:27<00:58,  2.34it/s]Loss: 0.01409:  32%|███▏      | 64/201 [00:27<00:58,  2.34it/s]Loss: 0.01409:  32%|███▏      | 65/201 [00:28<00:57,  2.38it/s]Loss: 0.01370:  32%|███▏      | 65/201 [00:28<00:57,  2.38it/s]Loss: 0.01370:  33%|███▎      | 66/201 [00:28<00:55,  2.42it/s]Loss: 0.01610:  33%|███▎      | 66/201 [00:28<00:55,  2.42it/s]Loss: 0.01610:  33%|███▎      | 67/201 [00:28<00:54,  2.44it/s]Loss: 0.01622:  33%|███▎      | 67/201 [00:28<00:54,  2.44it/s]Loss: 0.01622:  34%|███▍      | 68/201 [00:29<00:54,  2.45it/s]Loss: 0.01529:  34%|███▍      | 68/201 [00:29<00:54,  2.45it/s]Loss: 0.01529:  34%|███▍      | 69/201 [00:29<00:53,  2.46it/s]Loss: 0.01470:  34%|███▍      | 69/201 [00:29<00:53,  2.46it/s]Loss: 0.01470:  35%|███▍      | 70/201 [00:30<00:52,  2.47it/s]Loss: 0.01368:  35%|███▍      | 70/201 [00:30<00:52,  2.47it/s]Loss: 0.01368:  35%|███▌      | 71/201 [00:30<00:52,  2.48it/s]Loss: 0.01394:  35%|███▌      | 71/201 [00:30<00:52,  2.48it/s]Loss: 0.01394:  36%|███▌      | 72/201 [00:30<00:51,  2.48it/s]Loss: 0.01064:  36%|███▌      | 72/201 [00:30<00:51,  2.48it/s]Loss: 0.01064:  36%|███▋      | 73/201 [00:31<00:51,  2.48it/s]Loss: 0.01024:  36%|███▋      | 73/201 [00:31<00:51,  2.48it/s]Loss: 0.01024:  37%|███▋      | 74/201 [00:31<00:51,  2.49it/s]Loss: 0.01522:  37%|███▋      | 74/201 [00:31<00:51,  2.49it/s]Loss: 0.01522:  37%|███▋      | 75/201 [00:32<00:50,  2.49it/s]Loss: 0.01454:  37%|███▋      | 75/201 [00:32<00:50,  2.49it/s]Loss: 0.01454:  38%|███▊      | 76/201 [00:32<00:50,  2.49it/s]Loss: 0.01440:  38%|███▊      | 76/201 [00:32<00:50,  2.49it/s]Loss: 0.01440:  38%|███▊      | 77/201 [00:32<00:49,  2.49it/s]Loss: 0.01396:  38%|███▊      | 77/201 [00:32<00:49,  2.49it/s]Loss: 0.01396:  39%|███▉      | 78/201 [00:33<00:49,  2.49it/s]Loss: 0.01434:  39%|███▉      | 78/201 [00:33<00:49,  2.49it/s]Loss: 0.01434:  39%|███▉      | 79/201 [00:33<00:49,  2.49it/s]Loss: 0.01344:  39%|███▉      | 79/201 [00:33<00:49,  2.49it/s]Loss: 0.01344:  40%|███▉      | 80/201 [00:34<00:48,  2.49it/s]Loss: 0.00976:  40%|███▉      | 80/201 [00:34<00:48,  2.49it/s]Loss: 0.00976:  40%|████      | 81/201 [00:34<00:56,  2.13it/s]Loss: 0.00852:  40%|████      | 81/201 [00:34<00:56,  2.13it/s]Loss: 0.00852:  41%|████      | 82/201 [00:35<00:53,  2.23it/s]Loss: 0.00873:  41%|████      | 82/201 [00:35<00:53,  2.23it/s]Loss: 0.00873:  41%|████▏     | 83/201 [00:35<00:51,  2.30it/s]Loss: 0.01382:  41%|████▏     | 83/201 [00:35<00:51,  2.30it/s]Loss: 0.01382:  42%|████▏     | 84/201 [00:35<00:49,  2.35it/s]Loss: 0.01417:  42%|████▏     | 84/201 [00:35<00:49,  2.35it/s]Loss: 0.01417:  42%|████▏     | 85/201 [00:36<00:48,  2.39it/s]Loss: 0.01321:  42%|████▏     | 85/201 [00:36<00:48,  2.39it/s]Loss: 0.01321:  43%|████▎     | 86/201 [00:36<00:47,  2.41it/s]Loss: 0.01245:  43%|████▎     | 86/201 [00:36<00:47,  2.41it/s]Loss: 0.01245:  43%|████▎     | 87/201 [00:37<00:46,  2.43it/s]Loss: 0.01050:  43%|████▎     | 87/201 [00:37<00:46,  2.43it/s]Loss: 0.01050:  44%|████▍     | 88/201 [00:37<00:46,  2.45it/s]Loss: 0.01483:  44%|████▍     | 88/201 [00:37<00:46,  2.45it/s]Loss: 0.01483:  44%|████▍     | 89/201 [00:37<00:45,  2.46it/s]Loss: 0.01301:  44%|████▍     | 89/201 [00:37<00:45,  2.46it/s]Loss: 0.01301:  45%|████▍     | 90/201 [00:38<00:44,  2.47it/s]Loss: 0.01186:  45%|████▍     | 90/201 [00:38<00:44,  2.47it/s]Loss: 0.01186:  45%|████▌     | 91/201 [00:38<00:44,  2.47it/s]Loss: 0.01364:  45%|████▌     | 91/201 [00:38<00:44,  2.47it/s]Loss: 0.01364:  46%|████▌     | 92/201 [00:39<00:43,  2.48it/s]Loss: 0.01337:  46%|████▌     | 92/201 [00:39<00:43,  2.48it/s]Loss: 0.01337:  46%|████▋     | 93/201 [00:39<00:43,  2.48it/s]Loss: 0.01204:  46%|████▋     | 93/201 [00:39<00:43,  2.48it/s]Loss: 0.01204:  47%|████▋     | 94/201 [00:39<00:43,  2.48it/s]Loss: 0.01313:  47%|████▋     | 94/201 [00:39<00:43,  2.48it/s]Loss: 0.01313:  47%|████▋     | 95/201 [00:40<00:42,  2.48it/s]Loss: 0.01261:  47%|████▋     | 95/201 [00:40<00:42,  2.48it/s]Loss: 0.01261:  48%|████▊     | 96/201 [00:40<00:42,  2.49it/s]Loss: 0.01300:  48%|████▊     | 96/201 [00:40<00:42,  2.49it/s]Loss: 0.01300:  48%|████▊     | 97/201 [00:41<00:41,  2.49it/s]Loss: 0.01233:  48%|████▊     | 97/201 [00:41<00:41,  2.49it/s]Loss: 0.01233:  49%|████▉     | 98/201 [00:41<00:41,  2.49it/s]Loss: 0.01250:  49%|████▉     | 98/201 [00:41<00:41,  2.49it/s]Loss: 0.01250:  49%|████▉     | 99/201 [00:41<00:41,  2.48it/s]Loss: 0.01162:  49%|████▉     | 99/201 [00:41<00:41,  2.48it/s]Loss: 0.01162:  50%|████▉     | 100/201 [00:42<00:40,  2.49it/s]Loss: 0.00956:  50%|████▉     | 100/201 [00:42<00:40,  2.49it/s]Loss: 0.00956:  50%|█████     | 101/201 [00:42<00:47,  2.13it/s]Loss: 0.00743:  50%|█████     | 101/201 [00:42<00:47,  2.13it/s]max loss: 0.6018253564834595
Densities: min=2.986548497574404e-05, max=0.9906202554702759, mean=0.4758318066596985
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.25s/it][A1it [00:01,  1.25s/it]
Loss: 0.00743:  51%|█████     | 102/201 [00:44<01:21,  1.21it/s]Loss: 0.02956:  51%|█████     | 102/201 [00:44<01:21,  1.21it/s]Loss: 0.02956:  51%|█████     | 103/201 [00:45<01:08,  1.43it/s]Loss: 0.02527:  51%|█████     | 103/201 [00:45<01:08,  1.43it/s]Loss: 0.02527:  52%|█████▏    | 104/201 [00:45<00:59,  1.64it/s]Loss: 0.02276:  52%|█████▏    | 104/201 [00:45<00:59,  1.64it/s]Loss: 0.02276:  52%|█████▏    | 105/201 [00:45<00:52,  1.83it/s]Loss: 0.02102:  52%|█████▏    | 105/201 [00:45<00:52,  1.83it/s]Loss: 0.02102:  53%|█████▎    | 106/201 [00:46<00:47,  1.99it/s]Loss: 0.01967:  53%|█████▎    | 106/201 [00:46<00:47,  1.99it/s]Loss: 0.01967:  53%|█████▎    | 107/201 [00:46<00:44,  2.12it/s]Loss: 0.01857:  53%|█████▎    | 107/201 [00:46<00:44,  2.12it/s]Loss: 0.01857:  54%|█████▎    | 108/201 [00:47<00:41,  2.22it/s]Loss: 0.01764:  54%|█████▎    | 108/201 [00:47<00:41,  2.22it/s]Loss: 0.01764:  54%|█████▍    | 109/201 [00:47<00:40,  2.30it/s]Loss: 0.01682:  54%|█████▍    | 109/201 [00:47<00:40,  2.30it/s]Loss: 0.01682:  55%|█████▍    | 110/201 [00:47<00:38,  2.35it/s]Loss: 0.01612:  55%|█████▍    | 110/201 [00:47<00:38,  2.35it/s]Loss: 0.01612:  55%|█████▌    | 111/201 [00:48<00:37,  2.39it/s]Loss: 0.01547:  55%|█████▌    | 111/201 [00:48<00:37,  2.39it/s]Loss: 0.01547:  56%|█████▌    | 112/201 [00:48<00:36,  2.42it/s]Loss: 0.01491:  56%|█████▌    | 112/201 [00:48<00:36,  2.42it/s]Loss: 0.01491:  56%|█████▌    | 113/201 [00:49<00:36,  2.44it/s]Loss: 0.01437:  56%|█████▌    | 113/201 [00:49<00:36,  2.44it/s]Loss: 0.01437:  57%|█████▋    | 114/201 [00:49<00:35,  2.46it/s]Loss: 0.01387:  57%|█████▋    | 114/201 [00:49<00:35,  2.46it/s]Loss: 0.01387:  57%|█████▋    | 115/201 [00:49<00:34,  2.47it/s]Loss: 0.01342:  57%|█████▋    | 115/201 [00:49<00:34,  2.47it/s]Loss: 0.01342:  58%|█████▊    | 116/201 [00:50<00:34,  2.48it/s]Loss: 0.01303:  58%|█████▊    | 116/201 [00:50<00:34,  2.48it/s]Loss: 0.01303:  58%|█████▊    | 117/201 [00:50<00:33,  2.48it/s]Loss: 0.01267:  58%|█████▊    | 117/201 [00:50<00:33,  2.48it/s]Loss: 0.01267:  59%|█████▊    | 118/201 [00:51<00:33,  2.49it/s]Loss: 0.01229:  59%|█████▊    | 118/201 [00:51<00:33,  2.49it/s]Loss: 0.01229:  59%|█████▉    | 119/201 [00:51<00:32,  2.49it/s]Loss: 0.01194:  59%|█████▉    | 119/201 [00:51<00:32,  2.49it/s]Loss: 0.01194:  60%|█████▉    | 120/201 [00:51<00:32,  2.49it/s]Loss: 0.01161:  60%|█████▉    | 120/201 [00:51<00:32,  2.49it/s]Loss: 0.01161:  60%|██████    | 121/201 [00:52<00:37,  2.14it/s]Loss: 0.01133:  60%|██████    | 121/201 [00:52<00:37,  2.14it/s]Loss: 0.01133:  61%|██████    | 122/201 [00:52<00:35,  2.24it/s]Loss: 0.01116:  61%|██████    | 122/201 [00:52<00:35,  2.24it/s]Loss: 0.01116:  61%|██████    | 123/201 [00:53<00:33,  2.31it/s]Loss: 0.01085:  61%|██████    | 123/201 [00:53<00:33,  2.31it/s]Loss: 0.01085:  62%|██████▏   | 124/201 [00:53<00:32,  2.36it/s]Loss: 0.01067:  62%|██████▏   | 124/201 [00:53<00:32,  2.36it/s]Loss: 0.01067:  62%|██████▏   | 125/201 [00:54<00:31,  2.40it/s]Loss: 0.01047:  62%|██████▏   | 125/201 [00:54<00:31,  2.40it/s]Loss: 0.01047:  63%|██████▎   | 126/201 [00:54<00:30,  2.43it/s]Loss: 0.01047:  63%|██████▎   | 126/201 [00:54<00:30,  2.43it/s]Loss: 0.01047:  63%|██████▎   | 127/201 [00:54<00:30,  2.45it/s]Loss: 0.01003:  63%|██████▎   | 127/201 [00:54<00:30,  2.45it/s]Loss: 0.01003:  64%|██████▎   | 128/201 [00:55<00:29,  2.46it/s]Loss: 0.00980:  64%|██████▎   | 128/201 [00:55<00:29,  2.46it/s]Loss: 0.00980:  64%|██████▍   | 129/201 [00:55<00:29,  2.47it/s]Loss: 0.00976:  64%|██████▍   | 129/201 [00:55<00:29,  2.47it/s]Loss: 0.00976:  65%|██████▍   | 130/201 [00:56<00:28,  2.48it/s]Loss: 0.00975:  65%|██████▍   | 130/201 [00:56<00:28,  2.48it/s]Loss: 0.00975:  65%|██████▌   | 131/201 [00:56<00:28,  2.48it/s]Loss: 0.00962:  65%|██████▌   | 131/201 [00:56<00:28,  2.48it/s]Loss: 0.00962:  66%|██████▌   | 132/201 [00:56<00:27,  2.49it/s]Loss: 0.00938:  66%|██████▌   | 132/201 [00:56<00:27,  2.49it/s]Loss: 0.00938:  66%|██████▌   | 133/201 [00:57<00:27,  2.49it/s]Loss: 0.00922:  66%|██████▌   | 133/201 [00:57<00:27,  2.49it/s]Loss: 0.00922:  67%|██████▋   | 134/201 [00:57<00:26,  2.49it/s]Loss: 0.00929:  67%|██████▋   | 134/201 [00:57<00:26,  2.49it/s]Loss: 0.00929:  67%|██████▋   | 135/201 [00:58<00:26,  2.49it/s]Loss: 0.00917:  67%|██████▋   | 135/201 [00:58<00:26,  2.49it/s]Loss: 0.00917:  68%|██████▊   | 136/201 [00:58<00:26,  2.49it/s]Loss: 0.00913:  68%|██████▊   | 136/201 [00:58<00:26,  2.49it/s]Loss: 0.00913:  68%|██████▊   | 137/201 [00:58<00:25,  2.49it/s]Loss: 0.00918:  68%|██████▊   | 137/201 [00:58<00:25,  2.49it/s]Loss: 0.00918:  69%|██████▊   | 138/201 [00:59<00:25,  2.49it/s]Loss: 0.00908:  69%|██████▊   | 138/201 [00:59<00:25,  2.49it/s]Loss: 0.00908:  69%|██████▉   | 139/201 [00:59<00:24,  2.49it/s]Loss: 0.00866:  69%|██████▉   | 139/201 [00:59<00:24,  2.49it/s]Loss: 0.00866:  70%|██████▉   | 140/201 [01:00<00:24,  2.49it/s]Loss: 0.00871:  70%|██████▉   | 140/201 [01:00<00:24,  2.49it/s]Loss: 0.00871:  70%|███████   | 141/201 [01:00<00:28,  2.13it/s]Loss: 0.00884:  70%|███████   | 141/201 [01:00<00:28,  2.13it/s]Loss: 0.00884:  71%|███████   | 142/201 [01:01<00:26,  2.23it/s]Loss: 0.00838:  71%|███████   | 142/201 [01:01<00:26,  2.23it/s]Loss: 0.00838:  71%|███████   | 143/201 [01:01<00:25,  2.30it/s]Loss: 0.00827:  71%|███████   | 143/201 [01:01<00:25,  2.30it/s]Loss: 0.00827:  72%|███████▏  | 144/201 [01:01<00:24,  2.36it/s]Loss: 0.00782:  72%|███████▏  | 144/201 [01:01<00:24,  2.36it/s]Loss: 0.00782:  72%|███████▏  | 145/201 [01:02<00:23,  2.40it/s]Loss: 0.00808:  72%|███████▏  | 145/201 [01:02<00:23,  2.40it/s]Loss: 0.00808:  73%|███████▎  | 146/201 [01:02<00:22,  2.42it/s]Loss: 0.00789:  73%|███████▎  | 146/201 [01:02<00:22,  2.42it/s]Loss: 0.00789:  73%|███████▎  | 147/201 [01:03<00:22,  2.44it/s]Loss: 0.00837:  73%|███████▎  | 147/201 [01:03<00:22,  2.44it/s]Loss: 0.00837:  74%|███████▎  | 148/201 [01:03<00:21,  2.46it/s]Loss: 0.00788:  74%|███████▎  | 148/201 [01:03<00:21,  2.46it/s]Loss: 0.00788:  74%|███████▍  | 149/201 [01:03<00:21,  2.47it/s]Loss: 0.00876:  74%|███████▍  | 149/201 [01:03<00:21,  2.47it/s]Loss: 0.00876:  75%|███████▍  | 150/201 [01:04<00:20,  2.47it/s]Loss: 0.00828:  75%|███████▍  | 150/201 [01:04<00:20,  2.47it/s]Loss: 0.00828:  75%|███████▌  | 151/201 [01:04<00:20,  2.48it/s]Loss: 0.00856:  75%|███████▌  | 151/201 [01:04<00:20,  2.48it/s]Loss: 0.00856:  76%|███████▌  | 152/201 [01:05<00:19,  2.48it/s]Loss: 0.00769:  76%|███████▌  | 152/201 [01:05<00:19,  2.48it/s]max loss: 0.23948349058628082
Densities: min=0.00023388622503262013, max=0.9905702471733093, mean=0.43646204471588135
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.28s/it][A1it [00:01,  1.28s/it]
Loss: 0.00769:  76%|███████▌  | 153/201 [01:06<00:37,  1.27it/s]Loss: 0.02371:  76%|███████▌  | 153/201 [01:06<00:37,  1.27it/s]Loss: 0.02371:  77%|███████▋  | 154/201 [01:07<00:31,  1.49it/s]Loss: 0.02058:  77%|███████▋  | 154/201 [01:07<00:31,  1.49it/s]Loss: 0.02058:  77%|███████▋  | 155/201 [01:07<00:27,  1.69it/s]Loss: 0.01884:  77%|███████▋  | 155/201 [01:07<00:27,  1.69it/s]Loss: 0.01884:  78%|███████▊  | 156/201 [01:08<00:24,  1.87it/s]Loss: 0.01720:  78%|███████▊  | 156/201 [01:08<00:24,  1.87it/s]Loss: 0.01720:  78%|███████▊  | 157/201 [01:08<00:21,  2.02it/s]Loss: 0.01617:  78%|███████▊  | 157/201 [01:08<00:21,  2.02it/s]Loss: 0.01617:  79%|███████▊  | 158/201 [01:08<00:20,  2.15it/s]Loss: 0.01528:  79%|███████▊  | 158/201 [01:08<00:20,  2.15it/s]Loss: 0.01528:  79%|███████▉  | 159/201 [01:09<00:18,  2.24it/s]Loss: 0.01451:  79%|███████▉  | 159/201 [01:09<00:18,  2.24it/s]Loss: 0.01451:  80%|███████▉  | 160/201 [01:09<00:17,  2.32it/s]Loss: 0.01395:  80%|███████▉  | 160/201 [01:09<00:17,  2.32it/s]Loss: 0.01395:  80%|████████  | 161/201 [01:10<00:19,  2.06it/s]Loss: 0.01346:  80%|████████  | 161/201 [01:10<00:19,  2.06it/s]Loss: 0.01346:  81%|████████  | 162/201 [01:10<00:17,  2.19it/s]Loss: 0.01304:  81%|████████  | 162/201 [01:10<00:17,  2.19it/s]Loss: 0.01304:  81%|████████  | 163/201 [01:11<00:16,  2.29it/s]Loss: 0.01263:  81%|████████  | 163/201 [01:11<00:16,  2.29it/s]Loss: 0.01263:  82%|████████▏ | 164/201 [01:11<00:15,  2.36it/s]Loss: 0.01226:  82%|████████▏ | 164/201 [01:11<00:15,  2.36it/s]Loss: 0.01226:  82%|████████▏ | 165/201 [01:11<00:14,  2.41it/s]Loss: 0.01194:  82%|████████▏ | 165/201 [01:11<00:14,  2.41it/s]Loss: 0.01194:  83%|████████▎ | 166/201 [01:12<00:14,  2.45it/s]Loss: 0.01169:  83%|████████▎ | 166/201 [01:12<00:14,  2.45it/s]Loss: 0.01169:  83%|████████▎ | 167/201 [01:12<00:13,  2.48it/s]Loss: 0.01139:  83%|████████▎ | 167/201 [01:12<00:13,  2.48it/s]Loss: 0.01139:  84%|████████▎ | 168/201 [01:12<00:13,  2.50it/s]Loss: 0.01118:  84%|████████▎ | 168/201 [01:12<00:13,  2.50it/s]Loss: 0.01118:  84%|████████▍ | 169/201 [01:13<00:12,  2.52it/s]Loss: 0.01098:  84%|████████▍ | 169/201 [01:13<00:12,  2.52it/s]Loss: 0.01098:  85%|████████▍ | 170/201 [01:13<00:12,  2.53it/s]Loss: 0.01083:  85%|████████▍ | 170/201 [01:13<00:12,  2.53it/s]Loss: 0.01083:  85%|████████▌ | 171/201 [01:14<00:11,  2.53it/s]Loss: 0.01067:  85%|████████▌ | 171/201 [01:14<00:11,  2.53it/s]Loss: 0.01067:  86%|████████▌ | 172/201 [01:14<00:11,  2.54it/s]Loss: 0.01060:  86%|████████▌ | 172/201 [01:14<00:11,  2.54it/s]Loss: 0.01060:  86%|████████▌ | 173/201 [01:14<00:11,  2.54it/s]Loss: 0.01149:  86%|████████▌ | 173/201 [01:14<00:11,  2.54it/s]Loss: 0.01149:  87%|████████▋ | 174/201 [01:15<00:10,  2.53it/s]Loss: 0.01410:  87%|████████▋ | 174/201 [01:15<00:10,  2.53it/s]Loss: 0.01410:  87%|████████▋ | 175/201 [01:15<00:10,  2.52it/s]Loss: 0.01412:  87%|████████▋ | 175/201 [01:15<00:10,  2.52it/s]Loss: 0.01412:  88%|████████▊ | 176/201 [01:16<00:09,  2.51it/s]Loss: 0.01400:  88%|████████▊ | 176/201 [01:16<00:09,  2.51it/s]Loss: 0.01400:  88%|████████▊ | 177/201 [01:16<00:09,  2.51it/s]Loss: 0.01363:  88%|████████▊ | 177/201 [01:16<00:09,  2.51it/s]Loss: 0.01363:  89%|████████▊ | 178/201 [01:16<00:09,  2.50it/s]Loss: 0.01166:  89%|████████▊ | 178/201 [01:16<00:09,  2.50it/s]Loss: 0.01166:  89%|████████▉ | 179/201 [01:17<00:08,  2.50it/s]Loss: 0.00989:  89%|████████▉ | 179/201 [01:17<00:08,  2.50it/s]Loss: 0.00989:  90%|████████▉ | 180/201 [01:17<00:08,  2.50it/s]Loss: 0.00925:  90%|████████▉ | 180/201 [01:17<00:08,  2.50it/s]Loss: 0.00925:  90%|█████████ | 181/201 [01:18<00:09,  2.13it/s]Loss: 0.00901:  90%|█████████ | 181/201 [01:18<00:09,  2.13it/s]Loss: 0.00901:  91%|█████████ | 182/201 [01:18<00:08,  2.24it/s]Loss: 0.00912:  91%|█████████ | 182/201 [01:18<00:08,  2.24it/s]Loss: 0.00912:  91%|█████████ | 183/201 [01:19<00:07,  2.31it/s]Loss: 0.00883:  91%|█████████ | 183/201 [01:19<00:07,  2.31it/s]Loss: 0.00883:  92%|█████████▏| 184/201 [01:19<00:07,  2.36it/s]Loss: 0.00867:  92%|█████████▏| 184/201 [01:19<00:07,  2.36it/s]Loss: 0.00867:  92%|█████████▏| 185/201 [01:19<00:06,  2.40it/s]Loss: 0.00854:  92%|█████████▏| 185/201 [01:19<00:06,  2.40it/s]Loss: 0.00854:  93%|█████████▎| 186/201 [01:20<00:06,  2.43it/s]Loss: 0.00860:  93%|█████████▎| 186/201 [01:20<00:06,  2.43it/s]Loss: 0.00860:  93%|█████████▎| 187/201 [01:20<00:05,  2.45it/s]Loss: 0.00832:  93%|█████████▎| 187/201 [01:20<00:05,  2.45it/s]Loss: 0.00832:  94%|█████████▎| 188/201 [01:21<00:05,  2.46it/s]Loss: 0.00830:  94%|█████████▎| 188/201 [01:21<00:05,  2.46it/s]Loss: 0.00830:  94%|█████████▍| 189/201 [01:21<00:04,  2.47it/s]Loss: 0.00829:  94%|█████████▍| 189/201 [01:21<00:04,  2.47it/s]Loss: 0.00829:  95%|█████████▍| 190/201 [01:21<00:04,  2.47it/s]Loss: 0.00823:  95%|█████████▍| 190/201 [01:21<00:04,  2.47it/s]Loss: 0.00823:  95%|█████████▌| 191/201 [01:22<00:04,  2.48it/s]Loss: 0.00822:  95%|█████████▌| 191/201 [01:22<00:04,  2.48it/s]Loss: 0.00822:  96%|█████████▌| 192/201 [01:22<00:03,  2.48it/s]Loss: 0.00927:  96%|█████████▌| 192/201 [01:22<00:03,  2.48it/s]Loss: 0.00927:  96%|█████████▌| 193/201 [01:23<00:03,  2.48it/s]Loss: 0.01012:  96%|█████████▌| 193/201 [01:23<00:03,  2.48it/s]Loss: 0.01012:  97%|█████████▋| 194/201 [01:23<00:02,  2.48it/s]Loss: 0.00998:  97%|█████████▋| 194/201 [01:23<00:02,  2.48it/s]Loss: 0.00998:  97%|█████████▋| 195/201 [01:23<00:02,  2.49it/s]Loss: 0.01185:  97%|█████████▋| 195/201 [01:23<00:02,  2.49it/s]Loss: 0.01185:  98%|█████████▊| 196/201 [01:24<00:02,  2.49it/s]Loss: 0.01115:  98%|█████████▊| 196/201 [01:24<00:02,  2.49it/s]Loss: 0.01115:  98%|█████████▊| 197/201 [01:24<00:01,  2.49it/s]Loss: 0.00823:  98%|█████████▊| 197/201 [01:24<00:01,  2.49it/s]Loss: 0.00823:  99%|█████████▊| 198/201 [01:25<00:01,  2.49it/s]Loss: 0.00915:  99%|█████████▊| 198/201 [01:25<00:01,  2.49it/s]Loss: 0.00915:  99%|█████████▉| 199/201 [01:25<00:00,  2.49it/s]Loss: 0.00918:  99%|█████████▉| 199/201 [01:25<00:00,  2.49it/s]Loss: 0.00918: 100%|█████████▉| 200/201 [01:25<00:00,  2.49it/s]Loss: 0.00780: 100%|█████████▉| 200/201 [01:25<00:00,  2.49it/s]Loss: 0.00780: 100%|██████████| 201/201 [01:26<00:00,  2.14it/s]Loss: 0.00670: 100%|██████████| 201/201 [01:26<00:00,  2.14it/s]Loss: 0.00670: 100%|██████████| 201/201 [01:26<00:00,  2.32it/s]
max loss: 0.24648669362068176
Densities: min=0.00018419402476865798, max=0.9897909760475159, mean=0.4468236565589905
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_1atm_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 86.60808420181274 seconds
-1.0 2.0947266
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/10atm_temp_1152x426x853_float32_raw_1152x426x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_10atm.json
Initialize network
Latent space memory: 90.4MiB
# of network parameters: 23722369
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.88it/s]1it [00:00,  3.88it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0005486201262101531, max=0.9919331073760986, mean=0.6802817583084106
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  1.56it/s]Render: : 1it [00:00,  1.56it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_10atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 114, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 426, 853], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:02<07:15,  2.18s/it]Loss: 0.15292:   0%|          | 1/201 [00:02<07:15,  2.18s/it]Loss: 0.15292:   1%|          | 2/201 [00:03<05:21,  1.62s/it]Loss: 0.06198:   1%|          | 2/201 [00:03<05:21,  1.62s/it]Loss: 0.06198:   1%|▏         | 3/201 [00:04<04:45,  1.44s/it]Loss: 0.03808:   1%|▏         | 3/201 [00:04<04:45,  1.44s/it]Loss: 0.03808:   2%|▏         | 4/201 [00:05<04:28,  1.36s/it]Loss: 0.03201:   2%|▏         | 4/201 [00:05<04:28,  1.36s/it]Loss: 0.03201:   2%|▏         | 5/201 [00:07<04:18,  1.32s/it]Loss: 0.02918:   2%|▏         | 5/201 [00:07<04:18,  1.32s/it]Loss: 0.02918:   3%|▎         | 6/201 [00:08<04:11,  1.29s/it]Loss: 0.02758:   3%|▎         | 6/201 [00:08<04:11,  1.29s/it]Loss: 0.02758:   3%|▎         | 7/201 [00:09<04:07,  1.27s/it]Loss: 0.02638:   3%|▎         | 7/201 [00:09<04:07,  1.27s/it]Loss: 0.02638:   4%|▍         | 8/201 [00:10<04:03,  1.26s/it]Loss: 0.02573:   4%|▍         | 8/201 [00:10<04:03,  1.26s/it]Loss: 0.02573:   4%|▍         | 9/201 [00:12<04:00,  1.25s/it]Loss: 0.02471:   4%|▍         | 9/201 [00:12<04:00,  1.25s/it]Loss: 0.02471:   5%|▍         | 10/201 [00:13<03:58,  1.25s/it]Loss: 0.02412:   5%|▍         | 10/201 [00:13<03:58,  1.25s/it]Loss: 0.02412:   5%|▌         | 11/201 [00:14<03:56,  1.25s/it]Loss: 0.02317:   5%|▌         | 11/201 [00:14<03:56,  1.25s/it]Loss: 0.02317:   6%|▌         | 12/201 [00:15<03:55,  1.24s/it]Loss: 0.02215:   6%|▌         | 12/201 [00:15<03:55,  1.24s/it]Loss: 0.02215:   6%|▋         | 13/201 [00:17<03:53,  1.24s/it]Loss: 0.02173:   6%|▋         | 13/201 [00:17<03:53,  1.24s/it]Loss: 0.02173:   7%|▋         | 14/201 [00:18<03:52,  1.24s/it]Loss: 0.02077:   7%|▋         | 14/201 [00:18<03:52,  1.24s/it]Loss: 0.02077:   7%|▋         | 15/201 [00:19<03:50,  1.24s/it]Loss: 0.02003:   7%|▋         | 15/201 [00:19<03:50,  1.24s/it]Loss: 0.02003:   8%|▊         | 16/201 [00:20<03:49,  1.24s/it]Loss: 0.01952:   8%|▊         | 16/201 [00:20<03:49,  1.24s/it]Loss: 0.01952:   8%|▊         | 17/201 [00:21<03:48,  1.24s/it]Loss: 0.01888:   8%|▊         | 17/201 [00:21<03:48,  1.24s/it]Loss: 0.01888:   9%|▉         | 18/201 [00:23<03:46,  1.24s/it]Loss: 0.01831:   9%|▉         | 18/201 [00:23<03:46,  1.24s/it]Loss: 0.01831:   9%|▉         | 19/201 [00:24<03:45,  1.24s/it]Loss: 0.01773:   9%|▉         | 19/201 [00:24<03:45,  1.24s/it]Loss: 0.01773:  10%|▉         | 20/201 [00:25<03:44,  1.24s/it]Loss: 0.01683:  10%|▉         | 20/201 [00:25<03:44,  1.24s/it]Loss: 0.01683:  10%|█         | 21/201 [00:27<03:55,  1.31s/it]Loss: 0.01639:  10%|█         | 21/201 [00:27<03:55,  1.31s/it]Loss: 0.01639:  11%|█         | 22/201 [00:28<03:49,  1.28s/it]Loss: 0.01583:  11%|█         | 22/201 [00:28<03:49,  1.28s/it]Loss: 0.01583:  11%|█▏        | 23/201 [00:29<03:46,  1.27s/it]Loss: 0.01554:  11%|█▏        | 23/201 [00:29<03:46,  1.27s/it]Loss: 0.01554:  12%|█▏        | 24/201 [00:30<03:42,  1.26s/it]Loss: 0.01506:  12%|█▏        | 24/201 [00:30<03:42,  1.26s/it]Loss: 0.01506:  12%|█▏        | 25/201 [00:32<03:40,  1.25s/it]Loss: 0.01450:  12%|█▏        | 25/201 [00:32<03:40,  1.25s/it]Loss: 0.01450:  13%|█▎        | 26/201 [00:33<03:38,  1.25s/it]Loss: 0.01444:  13%|█▎        | 26/201 [00:33<03:38,  1.25s/it]Loss: 0.01444:  13%|█▎        | 27/201 [00:34<03:36,  1.25s/it]Loss: 0.01378:  13%|█▎        | 27/201 [00:34<03:36,  1.25s/it]Loss: 0.01378:  14%|█▍        | 28/201 [00:35<03:35,  1.24s/it]Loss: 0.01312:  14%|█▍        | 28/201 [00:35<03:35,  1.24s/it]Loss: 0.01312:  14%|█▍        | 29/201 [00:37<03:33,  1.24s/it]Loss: 0.01300:  14%|█▍        | 29/201 [00:37<03:33,  1.24s/it]Loss: 0.01300:  15%|█▍        | 30/201 [00:38<03:32,  1.24s/it]Loss: 0.01260:  15%|█▍        | 30/201 [00:38<03:32,  1.24s/it]Loss: 0.01260:  15%|█▌        | 31/201 [00:39<03:30,  1.24s/it]Loss: 0.01255:  15%|█▌        | 31/201 [00:39<03:30,  1.24s/it]Loss: 0.01255:  16%|█▌        | 32/201 [00:40<03:29,  1.24s/it]Loss: 0.01244:  16%|█▌        | 32/201 [00:40<03:29,  1.24s/it]Loss: 0.01244:  16%|█▋        | 33/201 [00:42<03:28,  1.24s/it]Loss: 0.01257:  16%|█▋        | 33/201 [00:42<03:28,  1.24s/it]Loss: 0.01257:  17%|█▋        | 34/201 [00:43<03:26,  1.24s/it]Loss: 0.01172:  17%|█▋        | 34/201 [00:43<03:26,  1.24s/it]Loss: 0.01172:  17%|█▋        | 35/201 [00:44<03:25,  1.24s/it]Loss: 0.01153:  17%|█▋        | 35/201 [00:44<03:25,  1.24s/it]Loss: 0.01153:  18%|█▊        | 36/201 [00:45<03:24,  1.24s/it]Loss: 0.01137:  18%|█▊        | 36/201 [00:45<03:24,  1.24s/it]Loss: 0.01137:  18%|█▊        | 37/201 [00:46<03:23,  1.24s/it]Loss: 0.01095:  18%|█▊        | 37/201 [00:46<03:23,  1.24s/it]Loss: 0.01095:  19%|█▉        | 38/201 [00:48<03:21,  1.24s/it]Loss: 0.01117:  19%|█▉        | 38/201 [00:48<03:21,  1.24s/it]Loss: 0.01117:  19%|█▉        | 39/201 [00:49<03:20,  1.24s/it]Loss: 0.01098:  19%|█▉        | 39/201 [00:49<03:20,  1.24s/it]Loss: 0.01098:  20%|█▉        | 40/201 [00:50<03:19,  1.24s/it]Loss: 0.01060:  20%|█▉        | 40/201 [00:50<03:19,  1.24s/it]Loss: 0.01060:  20%|██        | 41/201 [00:52<03:29,  1.31s/it]Loss: 0.01034:  20%|██        | 41/201 [00:52<03:29,  1.31s/it]Loss: 0.01034:  21%|██        | 42/201 [00:53<03:24,  1.29s/it]Loss: 0.01017:  21%|██        | 42/201 [00:53<03:24,  1.29s/it]Loss: 0.01017:  21%|██▏       | 43/201 [00:54<03:20,  1.27s/it]Loss: 0.01027:  21%|██▏       | 43/201 [00:54<03:20,  1.27s/it]Loss: 0.01027:  22%|██▏       | 44/201 [00:55<03:18,  1.26s/it]Loss: 0.00971:  22%|██▏       | 44/201 [00:55<03:18,  1.26s/it]Loss: 0.00971:  22%|██▏       | 45/201 [00:57<03:15,  1.25s/it]Loss: 0.00973:  22%|██▏       | 45/201 [00:57<03:15,  1.25s/it]Loss: 0.00973:  23%|██▎       | 46/201 [00:58<03:13,  1.25s/it]Loss: 0.00935:  23%|██▎       | 46/201 [00:58<03:13,  1.25s/it]Loss: 0.00935:  23%|██▎       | 47/201 [00:59<03:11,  1.25s/it]Loss: 0.00943:  23%|██▎       | 47/201 [00:59<03:11,  1.25s/it]Loss: 0.00943:  24%|██▍       | 48/201 [01:00<03:10,  1.24s/it]Loss: 0.00937:  24%|██▍       | 48/201 [01:00<03:10,  1.24s/it]Loss: 0.00937:  24%|██▍       | 49/201 [01:02<03:08,  1.24s/it]Loss: 0.00937:  24%|██▍       | 49/201 [01:02<03:08,  1.24s/it]Loss: 0.00937:  25%|██▍       | 50/201 [01:03<03:07,  1.24s/it]Loss: 0.00883:  25%|██▍       | 50/201 [01:03<03:07,  1.24s/it]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.59s/it][A1it [00:01,  1.59s/it]
Loss: 0.00883:  25%|██▌       | 51/201 [01:06<04:16,  1.71s/it]Loss: 0.29644:  25%|██▌       | 51/201 [01:06<04:16,  1.71s/it]Loss: 0.29644:  26%|██▌       | 52/201 [01:07<03:52,  1.56s/it]Loss: 0.08220:  26%|██▌       | 52/201 [01:07<03:52,  1.56s/it]Loss: 0.08220:  26%|██▋       | 53/201 [01:08<03:35,  1.46s/it]Loss: 0.05171:  26%|██▋       | 53/201 [01:08<03:35,  1.46s/it]Loss: 0.05171:  27%|██▋       | 54/201 [01:09<03:23,  1.39s/it]Loss: 0.04298:  27%|██▋       | 54/201 [01:09<03:23,  1.39s/it]Loss: 0.04298:  27%|██▋       | 55/201 [01:10<03:14,  1.33s/it]Loss: 0.03704:  27%|██▋       | 55/201 [01:10<03:14,  1.33s/it]Loss: 0.03704:  28%|██▊       | 56/201 [01:12<03:08,  1.30s/it]Loss: 0.03156:  28%|██▊       | 56/201 [01:12<03:08,  1.30s/it]Loss: 0.03156:  28%|██▊       | 57/201 [01:13<03:03,  1.27s/it]Loss: 0.02826:  28%|██▊       | 57/201 [01:13<03:03,  1.27s/it]Loss: 0.02826:  29%|██▉       | 58/201 [01:14<02:59,  1.26s/it]Loss: 0.02676:  29%|██▉       | 58/201 [01:14<02:59,  1.26s/it]Loss: 0.02676:  29%|██▉       | 59/201 [01:15<02:56,  1.24s/it]Loss: 0.02441:  29%|██▉       | 59/201 [01:15<02:56,  1.24s/it]Loss: 0.02441:  30%|██▉       | 60/201 [01:17<02:54,  1.24s/it]Loss: 0.02259:  30%|██▉       | 60/201 [01:17<02:54,  1.24s/it]Loss: 0.02259:  30%|███       | 61/201 [01:18<03:01,  1.30s/it]Loss: 0.02132:  30%|███       | 61/201 [01:18<03:01,  1.30s/it]Loss: 0.02132:  31%|███       | 62/201 [01:19<02:56,  1.27s/it]Loss: 0.02075:  31%|███       | 62/201 [01:19<02:56,  1.27s/it]Loss: 0.02075:  31%|███▏      | 63/201 [01:20<02:52,  1.25s/it]Loss: 0.01981:  31%|███▏      | 63/201 [01:20<02:52,  1.25s/it]Loss: 0.01981:  32%|███▏      | 64/201 [01:22<02:50,  1.24s/it]Loss: 0.01916:  32%|███▏      | 64/201 [01:22<02:50,  1.24s/it]Loss: 0.01916:  32%|███▏      | 65/201 [01:23<02:47,  1.23s/it]Loss: 0.01825:  32%|███▏      | 65/201 [01:23<02:47,  1.23s/it]Loss: 0.01825:  33%|███▎      | 66/201 [01:24<02:45,  1.23s/it]Loss: 0.01779:  33%|███▎      | 66/201 [01:24<02:45,  1.23s/it]Loss: 0.01779:  33%|███▎      | 67/201 [01:25<02:44,  1.22s/it]Loss: 0.01689:  33%|███▎      | 67/201 [01:25<02:44,  1.22s/it]Loss: 0.01689:  34%|███▍      | 68/201 [01:26<02:42,  1.22s/it]Loss: 0.01630:  34%|███▍      | 68/201 [01:26<02:42,  1.22s/it]Loss: 0.01630:  34%|███▍      | 69/201 [01:28<02:40,  1.22s/it]Loss: 0.01608:  34%|███▍      | 69/201 [01:28<02:40,  1.22s/it]Loss: 0.01608:  35%|███▍      | 70/201 [01:29<02:39,  1.22s/it]Loss: 0.01548:  35%|███▍      | 70/201 [01:29<02:39,  1.22s/it]Loss: 0.01548:  35%|███▌      | 71/201 [01:30<02:38,  1.22s/it]Loss: 0.01541:  35%|███▌      | 71/201 [01:30<02:38,  1.22s/it]Loss: 0.01541:  36%|███▌      | 72/201 [01:31<02:36,  1.22s/it]Loss: 0.01494:  36%|███▌      | 72/201 [01:31<02:36,  1.22s/it]Loss: 0.01494:  36%|███▋      | 73/201 [01:33<02:35,  1.22s/it]Loss: 0.01474:  36%|███▋      | 73/201 [01:33<02:35,  1.22s/it]Loss: 0.01474:  37%|███▋      | 74/201 [01:34<02:34,  1.22s/it]Loss: 0.01408:  37%|███▋      | 74/201 [01:34<02:34,  1.22s/it]Loss: 0.01408:  37%|███▋      | 75/201 [01:35<02:33,  1.21s/it]Loss: 0.01400:  37%|███▋      | 75/201 [01:35<02:33,  1.21s/it]Loss: 0.01400:  38%|███▊      | 76/201 [01:36<02:31,  1.21s/it]Loss: 0.01425:  38%|███▊      | 76/201 [01:36<02:31,  1.21s/it]Loss: 0.01425:  38%|███▊      | 77/201 [01:37<02:30,  1.21s/it]Loss: 0.01406:  38%|███▊      | 77/201 [01:37<02:30,  1.21s/it]Loss: 0.01406:  39%|███▉      | 78/201 [01:39<02:29,  1.21s/it]Loss: 0.01341:  39%|███▉      | 78/201 [01:39<02:29,  1.21s/it]Loss: 0.01341:  39%|███▉      | 79/201 [01:40<02:28,  1.21s/it]Loss: 0.01322:  39%|███▉      | 79/201 [01:40<02:28,  1.21s/it]Loss: 0.01322:  40%|███▉      | 80/201 [01:41<02:26,  1.21s/it]Loss: 0.01287:  40%|███▉      | 80/201 [01:41<02:26,  1.21s/it]Loss: 0.01287:  40%|████      | 81/201 [01:42<02:34,  1.28s/it]Loss: 0.01268:  40%|████      | 81/201 [01:42<02:34,  1.28s/it]Loss: 0.01268:  41%|████      | 82/201 [01:44<02:29,  1.26s/it]Loss: 0.01255:  41%|████      | 82/201 [01:44<02:29,  1.26s/it]Loss: 0.01255:  41%|████▏     | 83/201 [01:45<02:27,  1.25s/it]Loss: 0.01246:  41%|████▏     | 83/201 [01:45<02:27,  1.25s/it]Loss: 0.01246:  42%|████▏     | 84/201 [01:46<02:24,  1.24s/it]Loss: 0.01212:  42%|████▏     | 84/201 [01:46<02:24,  1.24s/it]Loss: 0.01212:  42%|████▏     | 85/201 [01:47<02:22,  1.23s/it]Loss: 0.01234:  42%|████▏     | 85/201 [01:47<02:22,  1.23s/it]Loss: 0.01234:  43%|████▎     | 86/201 [01:49<02:20,  1.23s/it]Loss: 0.01177:  43%|████▎     | 86/201 [01:49<02:20,  1.23s/it]Loss: 0.01177:  43%|████▎     | 87/201 [01:50<02:19,  1.22s/it]Loss: 0.01207:  43%|████▎     | 87/201 [01:50<02:19,  1.22s/it]Loss: 0.01207:  44%|████▍     | 88/201 [01:51<02:17,  1.22s/it]Loss: 0.01162:  44%|████▍     | 88/201 [01:51<02:17,  1.22s/it]Loss: 0.01162:  44%|████▍     | 89/201 [01:52<02:16,  1.22s/it]Loss: 0.01152:  44%|████▍     | 89/201 [01:52<02:16,  1.22s/it]Loss: 0.01152:  45%|████▍     | 90/201 [01:53<02:15,  1.22s/it]Loss: 0.01142:  45%|████▍     | 90/201 [01:53<02:15,  1.22s/it]Loss: 0.01142:  45%|████▌     | 91/201 [01:55<02:13,  1.22s/it]Loss: 0.01117:  45%|████▌     | 91/201 [01:55<02:13,  1.22s/it]Loss: 0.01117:  46%|████▌     | 92/201 [01:56<02:12,  1.22s/it]Loss: 0.01129:  46%|████▌     | 92/201 [01:56<02:12,  1.22s/it]Loss: 0.01129:  46%|████▋     | 93/201 [01:57<02:11,  1.21s/it]Loss: 0.01109:  46%|████▋     | 93/201 [01:57<02:11,  1.21s/it]Loss: 0.01109:  47%|████▋     | 94/201 [01:58<02:09,  1.21s/it]Loss: 0.01118:  47%|████▋     | 94/201 [01:58<02:09,  1.21s/it]Loss: 0.01118:  47%|████▋     | 95/201 [01:59<02:08,  1.21s/it]Loss: 0.01084:  47%|████▋     | 95/201 [01:59<02:08,  1.21s/it]Loss: 0.01084:  48%|████▊     | 96/201 [02:01<02:07,  1.21s/it]Loss: 0.01072:  48%|████▊     | 96/201 [02:01<02:07,  1.21s/it]Loss: 0.01072:  48%|████▊     | 97/201 [02:02<02:06,  1.21s/it]Loss: 0.01085:  48%|████▊     | 97/201 [02:02<02:06,  1.21s/it]Loss: 0.01085:  49%|████▉     | 98/201 [02:03<02:05,  1.21s/it]Loss: 0.01052:  49%|████▉     | 98/201 [02:03<02:05,  1.21s/it]Loss: 0.01052:  49%|████▉     | 99/201 [02:04<02:03,  1.21s/it]Loss: 0.01130:  49%|████▉     | 99/201 [02:04<02:03,  1.21s/it]Loss: 0.01130:  50%|████▉     | 100/201 [02:06<02:02,  1.21s/it]Loss: 0.01114:  50%|████▉     | 100/201 [02:06<02:02,  1.21s/it]Loss: 0.01114:  50%|█████     | 101/201 [02:07<02:08,  1.29s/it]Loss: 0.00913:  50%|█████     | 101/201 [02:07<02:08,  1.29s/it]max loss: 0.8057111501693726
Densities: min=0.00044278151472099125, max=0.9958315491676331, mean=0.22418826818466187
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.65s/it][A1it [00:01,  1.65s/it]
Loss: 0.00913:  51%|█████     | 102/201 [02:10<02:54,  1.76s/it]Loss: 0.03364:  51%|█████     | 102/201 [02:10<02:54,  1.76s/it]Loss: 0.03364:  51%|█████     | 103/201 [02:11<02:36,  1.60s/it]Loss: 0.02834:  51%|█████     | 103/201 [02:11<02:36,  1.60s/it]Loss: 0.02834:  52%|█████▏    | 104/201 [02:12<02:24,  1.49s/it]Loss: 0.02577:  52%|█████▏    | 104/201 [02:12<02:24,  1.49s/it]Loss: 0.02577:  52%|█████▏    | 105/201 [02:14<02:15,  1.41s/it]Loss: 0.02414:  52%|█████▏    | 105/201 [02:14<02:15,  1.41s/it]Loss: 0.02414:  53%|█████▎    | 106/201 [02:15<02:08,  1.35s/it]Loss: 0.02300:  53%|█████▎    | 106/201 [02:15<02:08,  1.35s/it]Loss: 0.02300:  53%|█████▎    | 107/201 [02:16<02:03,  1.32s/it]Loss: 0.02208:  53%|█████▎    | 107/201 [02:16<02:03,  1.32s/it]Loss: 0.02208:  54%|█████▎    | 108/201 [02:17<01:59,  1.29s/it]Loss: 0.02142:  54%|█████▎    | 108/201 [02:17<01:59,  1.29s/it]Loss: 0.02142:  54%|█████▍    | 109/201 [02:18<01:56,  1.27s/it]Loss: 0.02073:  54%|█████▍    | 109/201 [02:18<01:56,  1.27s/it]Loss: 0.02073:  55%|█████▍    | 110/201 [02:20<01:54,  1.26s/it]Loss: 0.02022:  55%|█████▍    | 110/201 [02:20<01:54,  1.26s/it]Loss: 0.02022:  55%|█████▌    | 111/201 [02:21<01:52,  1.25s/it]Loss: 0.01988:  55%|█████▌    | 111/201 [02:21<01:52,  1.25s/it]Loss: 0.01988:  56%|█████▌    | 112/201 [02:22<01:50,  1.24s/it]Loss: 0.01947:  56%|█████▌    | 112/201 [02:22<01:50,  1.24s/it]Loss: 0.01947:  56%|█████▌    | 113/201 [02:23<01:48,  1.24s/it]Loss: 0.01932:  56%|█████▌    | 113/201 [02:23<01:48,  1.24s/it]Loss: 0.01932:  57%|█████▋    | 114/201 [02:25<01:47,  1.23s/it]Loss: 0.01893:  57%|█████▋    | 114/201 [02:25<01:47,  1.23s/it]Loss: 0.01893:  57%|█████▋    | 115/201 [02:26<01:45,  1.23s/it]Loss: 0.01843:  57%|█████▋    | 115/201 [02:26<01:45,  1.23s/it]Loss: 0.01843:  58%|█████▊    | 116/201 [02:27<01:44,  1.23s/it]Loss: 0.01790:  58%|█████▊    | 116/201 [02:27<01:44,  1.23s/it]Loss: 0.01790:  58%|█████▊    | 117/201 [02:28<01:43,  1.23s/it]Loss: 0.01771:  58%|█████▊    | 117/201 [02:28<01:43,  1.23s/it]Loss: 0.01771:  59%|█████▊    | 118/201 [02:29<01:41,  1.23s/it]Loss: 0.01765:  59%|█████▊    | 118/201 [02:29<01:41,  1.23s/it]Loss: 0.01765:  59%|█████▉    | 119/201 [02:31<01:40,  1.23s/it]Loss: 0.01718:  59%|█████▉    | 119/201 [02:31<01:40,  1.23s/it]Loss: 0.01718:  60%|█████▉    | 120/201 [02:32<01:39,  1.23s/it]Loss: 0.01673:  60%|█████▉    | 120/201 [02:32<01:39,  1.23s/it]Loss: 0.01673:  60%|██████    | 121/201 [02:33<01:43,  1.30s/it]Loss: 0.01647:  60%|██████    | 121/201 [02:33<01:43,  1.30s/it]Loss: 0.01647:  61%|██████    | 122/201 [02:35<01:40,  1.27s/it]Loss: 0.01630:  61%|██████    | 122/201 [02:35<01:40,  1.27s/it]Loss: 0.01630:  61%|██████    | 123/201 [02:36<01:37,  1.26s/it]Loss: 0.01621:  61%|██████    | 123/201 [02:36<01:37,  1.26s/it]Loss: 0.01621:  62%|██████▏   | 124/201 [02:37<01:36,  1.25s/it]Loss: 0.01615:  62%|██████▏   | 124/201 [02:37<01:36,  1.25s/it]Loss: 0.01615:  62%|██████▏   | 125/201 [02:38<01:34,  1.24s/it]Loss: 0.01619:  62%|██████▏   | 125/201 [02:38<01:34,  1.24s/it]Loss: 0.01619:  63%|██████▎   | 126/201 [02:39<01:32,  1.24s/it]Loss: 0.01587:  63%|██████▎   | 126/201 [02:39<01:32,  1.24s/it]Loss: 0.01587:  63%|██████▎   | 127/201 [02:41<01:31,  1.23s/it]Loss: 0.01553:  63%|██████▎   | 127/201 [02:41<01:31,  1.23s/it]Loss: 0.01553:  64%|██████▎   | 128/201 [02:42<01:29,  1.23s/it]Loss: 0.01527:  64%|██████▎   | 128/201 [02:42<01:29,  1.23s/it]Loss: 0.01527:  64%|██████▍   | 129/201 [02:43<01:28,  1.23s/it]Loss: 0.01511:  64%|██████▍   | 129/201 [02:43<01:28,  1.23s/it]Loss: 0.01511:  65%|██████▍   | 130/201 [02:44<01:27,  1.23s/it]Loss: 0.01513:  65%|██████▍   | 130/201 [02:44<01:27,  1.23s/it]Loss: 0.01513:  65%|██████▌   | 131/201 [02:46<01:25,  1.23s/it]Loss: 0.01482:  65%|██████▌   | 131/201 [02:46<01:25,  1.23s/it]Loss: 0.01482:  66%|██████▌   | 132/201 [02:47<01:24,  1.23s/it]Loss: 0.01460:  66%|██████▌   | 132/201 [02:47<01:24,  1.23s/it]Loss: 0.01460:  66%|██████▌   | 133/201 [02:48<01:23,  1.23s/it]Loss: 0.01464:  66%|██████▌   | 133/201 [02:48<01:23,  1.23s/it]Loss: 0.01464:  67%|██████▋   | 134/201 [02:49<01:22,  1.22s/it]Loss: 0.01439:  67%|██████▋   | 134/201 [02:49<01:22,  1.22s/it]Loss: 0.01439:  67%|██████▋   | 135/201 [02:51<01:20,  1.22s/it]Loss: 0.01460:  67%|██████▋   | 135/201 [02:51<01:20,  1.22s/it]Loss: 0.01460:  68%|██████▊   | 136/201 [02:52<01:19,  1.22s/it]Loss: 0.01443:  68%|██████▊   | 136/201 [02:52<01:19,  1.22s/it]Loss: 0.01443:  68%|██████▊   | 137/201 [02:53<01:18,  1.22s/it]Loss: 0.01452:  68%|██████▊   | 137/201 [02:53<01:18,  1.22s/it]Loss: 0.01452:  69%|██████▊   | 138/201 [02:54<01:17,  1.22s/it]Loss: 0.01429:  69%|██████▊   | 138/201 [02:54<01:17,  1.22s/it]Loss: 0.01429:  69%|██████▉   | 139/201 [02:55<01:15,  1.22s/it]Loss: 0.01396:  69%|██████▉   | 139/201 [02:55<01:15,  1.22s/it]Loss: 0.01396:  70%|██████▉   | 140/201 [02:57<01:14,  1.23s/it]Loss: 0.01398:  70%|██████▉   | 140/201 [02:57<01:14,  1.23s/it]Loss: 0.01398:  70%|███████   | 141/201 [02:58<01:17,  1.30s/it]Loss: 0.01394:  70%|███████   | 141/201 [02:58<01:17,  1.30s/it]Loss: 0.01394:  71%|███████   | 142/201 [02:59<01:14,  1.27s/it]Loss: 0.01370:  71%|███████   | 142/201 [02:59<01:14,  1.27s/it]Loss: 0.01370:  71%|███████   | 143/201 [03:01<01:12,  1.26s/it]Loss: 0.01354:  71%|███████   | 143/201 [03:01<01:12,  1.26s/it]Loss: 0.01354:  72%|███████▏  | 144/201 [03:02<01:11,  1.25s/it]Loss: 0.01367:  72%|███████▏  | 144/201 [03:02<01:11,  1.25s/it]Loss: 0.01367:  72%|███████▏  | 145/201 [03:03<01:09,  1.24s/it]Loss: 0.01357:  72%|███████▏  | 145/201 [03:03<01:09,  1.24s/it]Loss: 0.01357:  73%|███████▎  | 146/201 [03:04<01:08,  1.24s/it]Loss: 0.01359:  73%|███████▎  | 146/201 [03:04<01:08,  1.24s/it]Loss: 0.01359:  73%|███████▎  | 147/201 [03:05<01:06,  1.23s/it]Loss: 0.01329:  73%|███████▎  | 147/201 [03:05<01:06,  1.23s/it]Loss: 0.01329:  74%|███████▎  | 148/201 [03:07<01:05,  1.23s/it]Loss: 0.01303:  74%|███████▎  | 148/201 [03:07<01:05,  1.23s/it]Loss: 0.01303:  74%|███████▍  | 149/201 [03:08<01:03,  1.23s/it]Loss: 0.01300:  74%|███████▍  | 149/201 [03:08<01:03,  1.23s/it]Loss: 0.01300:  75%|███████▍  | 150/201 [03:09<01:02,  1.23s/it]Loss: 0.01288:  75%|███████▍  | 150/201 [03:09<01:02,  1.23s/it]Loss: 0.01288:  75%|███████▌  | 151/201 [03:10<01:01,  1.23s/it]Loss: 0.01293:  75%|███████▌  | 151/201 [03:10<01:01,  1.23s/it]Loss: 0.01293:  76%|███████▌  | 152/201 [03:12<01:00,  1.23s/it]Loss: 0.01270:  76%|███████▌  | 152/201 [03:12<01:00,  1.23s/it]max loss: 0.3546184301376343
Densities: min=0.0005465073045343161, max=0.9934895634651184, mean=0.47843456268310547
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.67s/it][A1it [00:01,  1.67s/it]
Loss: 0.01270:  76%|███████▌  | 153/201 [03:14<01:22,  1.72s/it]Loss: 0.02481:  76%|███████▌  | 153/201 [03:14<01:22,  1.72s/it]Loss: 0.02481:  77%|███████▋  | 154/201 [03:16<01:13,  1.57s/it]Loss: 0.02187:  77%|███████▋  | 154/201 [03:16<01:13,  1.57s/it]Loss: 0.02187:  77%|███████▋  | 155/201 [03:17<01:07,  1.47s/it]Loss: 0.02037:  77%|███████▋  | 155/201 [03:17<01:07,  1.47s/it]Loss: 0.02037:  78%|███████▊  | 156/201 [03:18<01:02,  1.39s/it]Loss: 0.01943:  78%|███████▊  | 156/201 [03:18<01:02,  1.39s/it]Loss: 0.01943:  78%|███████▊  | 157/201 [03:19<00:59,  1.34s/it]Loss: 0.01875:  78%|███████▊  | 157/201 [03:19<00:59,  1.34s/it]Loss: 0.01875:  79%|███████▊  | 158/201 [03:21<00:56,  1.31s/it]Loss: 0.01820:  79%|███████▊  | 158/201 [03:21<00:56,  1.31s/it]Loss: 0.01820:  79%|███████▉  | 159/201 [03:22<00:53,  1.28s/it]Loss: 0.01775:  79%|███████▉  | 159/201 [03:22<00:53,  1.28s/it]Loss: 0.01775:  80%|███████▉  | 160/201 [03:23<00:51,  1.26s/it]Loss: 0.01738:  80%|███████▉  | 160/201 [03:23<00:51,  1.26s/it]Loss: 0.01738:  80%|████████  | 161/201 [03:24<00:52,  1.32s/it]Loss: 0.01704:  80%|████████  | 161/201 [03:24<00:52,  1.32s/it]Loss: 0.01704:  81%|████████  | 162/201 [03:26<00:50,  1.29s/it]Loss: 0.01673:  81%|████████  | 162/201 [03:26<00:50,  1.29s/it]Loss: 0.01673:  81%|████████  | 163/201 [03:27<00:48,  1.27s/it]Loss: 0.01651:  81%|████████  | 163/201 [03:27<00:48,  1.27s/it]Loss: 0.01651:  82%|████████▏ | 164/201 [03:28<00:46,  1.25s/it]Loss: 0.01636:  82%|████████▏ | 164/201 [03:28<00:46,  1.25s/it]Loss: 0.01636:  82%|████████▏ | 165/201 [03:29<00:44,  1.24s/it]Loss: 0.01607:  82%|████████▏ | 165/201 [03:29<00:44,  1.24s/it]Loss: 0.01607:  83%|████████▎ | 166/201 [03:31<00:43,  1.24s/it]Loss: 0.01577:  83%|████████▎ | 166/201 [03:31<00:43,  1.24s/it]Loss: 0.01577:  83%|████████▎ | 167/201 [03:32<00:41,  1.23s/it]Loss: 0.01559:  83%|████████▎ | 167/201 [03:32<00:41,  1.23s/it]Loss: 0.01559:  84%|████████▎ | 168/201 [03:33<00:40,  1.23s/it]Loss: 0.01567:  84%|████████▎ | 168/201 [03:33<00:40,  1.23s/it]Loss: 0.01567:  84%|████████▍ | 169/201 [03:34<00:39,  1.23s/it]Loss: 0.01528:  84%|████████▍ | 169/201 [03:34<00:39,  1.23s/it]Loss: 0.01528:  85%|████████▍ | 170/201 [03:35<00:37,  1.22s/it]Loss: 0.01533:  85%|████████▍ | 170/201 [03:35<00:37,  1.22s/it]Loss: 0.01533:  85%|████████▌ | 171/201 [03:37<00:36,  1.22s/it]Loss: 0.01517:  85%|████████▌ | 171/201 [03:37<00:36,  1.22s/it]Loss: 0.01517:  86%|████████▌ | 172/201 [03:38<00:35,  1.22s/it]Loss: 0.01500:  86%|████████▌ | 172/201 [03:38<00:35,  1.22s/it]Loss: 0.01500:  86%|████████▌ | 173/201 [03:39<00:34,  1.22s/it]Loss: 0.01491:  86%|████████▌ | 173/201 [03:39<00:34,  1.22s/it]Loss: 0.01491:  87%|████████▋ | 174/201 [03:40<00:32,  1.22s/it]Loss: 0.01462:  87%|████████▋ | 174/201 [03:40<00:32,  1.22s/it]Loss: 0.01462:  87%|████████▋ | 175/201 [03:42<00:31,  1.22s/it]Loss: 0.01484:  87%|████████▋ | 175/201 [03:42<00:31,  1.22s/it]Loss: 0.01484:  88%|████████▊ | 176/201 [03:43<00:30,  1.22s/it]Loss: 0.01469:  88%|████████▊ | 176/201 [03:43<00:30,  1.22s/it]Loss: 0.01469:  88%|████████▊ | 177/201 [03:44<00:29,  1.22s/it]Loss: 0.01470:  88%|████████▊ | 177/201 [03:44<00:29,  1.22s/it]Loss: 0.01470:  89%|████████▊ | 178/201 [03:45<00:28,  1.22s/it]Loss: 0.01475:  89%|████████▊ | 178/201 [03:45<00:28,  1.22s/it]Loss: 0.01475:  89%|████████▉ | 179/201 [03:46<00:26,  1.22s/it]Loss: 0.01479:  89%|████████▉ | 179/201 [03:46<00:26,  1.22s/it]Loss: 0.01479:  90%|████████▉ | 180/201 [03:48<00:25,  1.22s/it]Loss: 0.01407:  90%|████████▉ | 180/201 [03:48<00:25,  1.22s/it]Loss: 0.01407:  90%|█████████ | 181/201 [03:49<00:25,  1.29s/it]Loss: 0.01394:  90%|█████████ | 181/201 [03:49<00:25,  1.29s/it]Loss: 0.01394:  91%|█████████ | 182/201 [03:50<00:24,  1.27s/it]Loss: 0.01405:  91%|█████████ | 182/201 [03:50<00:24,  1.27s/it]Loss: 0.01405:  91%|█████████ | 183/201 [03:52<00:22,  1.25s/it]Loss: 0.01410:  91%|█████████ | 183/201 [03:52<00:22,  1.25s/it]Loss: 0.01410:  92%|█████████▏| 184/201 [03:53<00:21,  1.24s/it]Loss: 0.01363:  92%|█████████▏| 184/201 [03:53<00:21,  1.24s/it]Loss: 0.01363:  92%|█████████▏| 185/201 [03:54<00:19,  1.24s/it]Loss: 0.01351:  92%|█████████▏| 185/201 [03:54<00:19,  1.24s/it]Loss: 0.01351:  93%|█████████▎| 186/201 [03:55<00:18,  1.23s/it]Loss: 0.01369:  93%|█████████▎| 186/201 [03:55<00:18,  1.23s/it]Loss: 0.01369:  93%|█████████▎| 187/201 [03:56<00:17,  1.23s/it]Loss: 0.01331:  93%|█████████▎| 187/201 [03:56<00:17,  1.23s/it]Loss: 0.01331:  94%|█████████▎| 188/201 [03:58<00:15,  1.23s/it]Loss: 0.01321:  94%|█████████▎| 188/201 [03:58<00:15,  1.23s/it]Loss: 0.01321:  94%|█████████▍| 189/201 [03:59<00:14,  1.22s/it]Loss: 0.01325:  94%|█████████▍| 189/201 [03:59<00:14,  1.22s/it]Loss: 0.01325:  95%|█████████▍| 190/201 [04:00<00:13,  1.22s/it]Loss: 0.01320:  95%|█████████▍| 190/201 [04:00<00:13,  1.22s/it]Loss: 0.01320:  95%|█████████▌| 191/201 [04:01<00:12,  1.22s/it]Loss: 0.01314:  95%|█████████▌| 191/201 [04:01<00:12,  1.22s/it]Loss: 0.01314:  96%|█████████▌| 192/201 [04:02<00:10,  1.22s/it]Loss: 0.01312:  96%|█████████▌| 192/201 [04:02<00:10,  1.22s/it]Loss: 0.01312:  96%|█████████▌| 193/201 [04:04<00:09,  1.22s/it]Loss: 0.01307:  96%|█████████▌| 193/201 [04:04<00:09,  1.22s/it]Loss: 0.01307:  97%|█████████▋| 194/201 [04:05<00:08,  1.22s/it]Loss: 0.01296:  97%|█████████▋| 194/201 [04:05<00:08,  1.22s/it]Loss: 0.01296:  97%|█████████▋| 195/201 [04:06<00:07,  1.22s/it]Loss: 0.01271:  97%|█████████▋| 195/201 [04:06<00:07,  1.22s/it]Loss: 0.01271:  98%|█████████▊| 196/201 [04:07<00:06,  1.22s/it]Loss: 0.01285:  98%|█████████▊| 196/201 [04:07<00:06,  1.22s/it]Loss: 0.01285:  98%|█████████▊| 197/201 [04:09<00:04,  1.22s/it]Loss: 0.01307:  98%|█████████▊| 197/201 [04:09<00:04,  1.22s/it]Loss: 0.01307:  99%|█████████▊| 198/201 [04:10<00:03,  1.22s/it]Loss: 0.01314:  99%|█████████▊| 198/201 [04:10<00:03,  1.22s/it]Loss: 0.01314:  99%|█████████▉| 199/201 [04:11<00:02,  1.22s/it]Loss: 0.01254:  99%|█████████▉| 199/201 [04:11<00:02,  1.22s/it]Loss: 0.01254: 100%|█████████▉| 200/201 [04:12<00:01,  1.22s/it]Loss: 0.01253: 100%|█████████▉| 200/201 [04:12<00:01,  1.22s/it]Loss: 0.01253: 100%|██████████| 201/201 [04:14<00:00,  1.29s/it]Loss: 0.01161: 100%|██████████| 201/201 [04:14<00:00,  1.29s/it]Loss: 0.01161: 100%|██████████| 201/201 [04:14<00:00,  1.26s/it]Load volume "/media/storage0/qadwu/floats/10atm_temp_1152x426x853_float32_raw_1152x426x853_float.cvol"
Loaded

max loss: 0.24261151254177094
Densities: min=0.0005488618626259267, max=0.9953552484512329, mean=0.451739639043808
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 254.2085464000702 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_10atm.json
Latent space memory: 90.4MiB
Latent space memory: 90.4MiB
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/10atm_temp_1152x426x853_float32_raw_1152x426x853_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_10atm.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 10, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 4, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 23386624
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  4.22it/s]1it [00:00,  4.22it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0005486201262101531, max=0.9919331073760986, mean=0.680279552936554
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  1.55it/s]Render: : 1it [00:00,  1.55it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/temp_10atm.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 100, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1152, 426, 853], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/10atmtemp-20220916181605-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 10, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 4}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<02:07,  1.57it/s]Loss: 0.27159:   0%|          | 1/201 [00:00<02:07,  1.57it/s]Loss: 0.27159:   1%|          | 2/201 [00:01<01:39,  1.99it/s]Loss: 0.06662:   1%|          | 2/201 [00:01<01:39,  1.99it/s]Loss: 0.06662:   1%|▏         | 3/201 [00:01<01:30,  2.18it/s]Loss: 0.05196:   1%|▏         | 3/201 [00:01<01:30,  2.18it/s]Loss: 0.05196:   2%|▏         | 4/201 [00:01<01:26,  2.29it/s]Loss: 0.04800:   2%|▏         | 4/201 [00:01<01:26,  2.29it/s]Loss: 0.04800:   2%|▏         | 5/201 [00:02<01:23,  2.35it/s]Loss: 0.04654:   2%|▏         | 5/201 [00:02<01:23,  2.35it/s]Loss: 0.04654:   3%|▎         | 6/201 [00:02<01:22,  2.37it/s]Loss: 0.04281:   3%|▎         | 6/201 [00:02<01:22,  2.37it/s]Loss: 0.04281:   3%|▎         | 7/201 [00:03<01:21,  2.39it/s]Loss: 0.04176:   3%|▎         | 7/201 [00:03<01:21,  2.39it/s]Loss: 0.04176:   4%|▍         | 8/201 [00:03<01:20,  2.40it/s]Loss: 0.03967:   4%|▍         | 8/201 [00:03<01:20,  2.40it/s]Loss: 0.03967:   4%|▍         | 9/201 [00:03<01:19,  2.40it/s]Loss: 0.03810:   4%|▍         | 9/201 [00:03<01:19,  2.40it/s]Loss: 0.03810:   5%|▍         | 10/201 [00:04<01:19,  2.41it/s]Loss: 0.03649:   5%|▍         | 10/201 [00:04<01:19,  2.41it/s]Loss: 0.03649:   5%|▌         | 11/201 [00:04<01:18,  2.41it/s]Loss: 0.02907:   5%|▌         | 11/201 [00:04<01:18,  2.41it/s]Loss: 0.02907:   6%|▌         | 12/201 [00:05<01:18,  2.41it/s]Loss: 0.02555:   6%|▌         | 12/201 [00:05<01:18,  2.41it/s]Loss: 0.02555:   6%|▋         | 13/201 [00:05<01:17,  2.41it/s]Loss: 0.03656:   6%|▋         | 13/201 [00:05<01:17,  2.41it/s]Loss: 0.03656:   7%|▋         | 14/201 [00:05<01:17,  2.42it/s]Loss: 0.03478:   7%|▋         | 14/201 [00:05<01:17,  2.42it/s]Loss: 0.03478:   7%|▋         | 15/201 [00:06<01:16,  2.42it/s]Loss: 0.03499:   7%|▋         | 15/201 [00:06<01:16,  2.42it/s]Loss: 0.03499:   8%|▊         | 16/201 [00:06<01:16,  2.42it/s]Loss: 0.03424:   8%|▊         | 16/201 [00:06<01:16,  2.42it/s]Loss: 0.03424:   8%|▊         | 17/201 [00:07<01:16,  2.42it/s]Loss: 0.04126:   8%|▊         | 17/201 [00:07<01:16,  2.42it/s]Loss: 0.04126:   9%|▉         | 18/201 [00:07<01:15,  2.42it/s]Loss: 0.05043:   9%|▉         | 18/201 [00:07<01:15,  2.42it/s]Loss: 0.05043:   9%|▉         | 19/201 [00:08<01:15,  2.42it/s]Loss: 0.03000:   9%|▉         | 19/201 [00:08<01:15,  2.42it/s]Loss: 0.03000:  10%|▉         | 20/201 [00:08<01:14,  2.41it/s]Loss: 0.02686:  10%|▉         | 20/201 [00:08<01:14,  2.41it/s]Loss: 0.02686:  10%|█         | 21/201 [00:09<01:26,  2.08it/s]Loss: 0.02624:  10%|█         | 21/201 [00:09<01:26,  2.08it/s]Loss: 0.02624:  11%|█         | 22/201 [00:09<01:22,  2.18it/s]Loss: 0.02574:  11%|█         | 22/201 [00:09<01:22,  2.18it/s]Loss: 0.02574:  11%|█▏        | 23/201 [00:09<01:19,  2.24it/s]Loss: 0.02498:  11%|█▏        | 23/201 [00:09<01:19,  2.24it/s]Loss: 0.02498:  12%|█▏        | 24/201 [00:10<01:17,  2.29it/s]Loss: 0.02797:  12%|█▏        | 24/201 [00:10<01:17,  2.29it/s]Loss: 0.02797:  12%|█▏        | 25/201 [00:10<01:15,  2.33it/s]Loss: 0.03209:  12%|█▏        | 25/201 [00:10<01:15,  2.33it/s]Loss: 0.03209:  13%|█▎        | 26/201 [00:11<01:14,  2.35it/s]Loss: 0.02326:  13%|█▎        | 26/201 [00:11<01:14,  2.35it/s]Loss: 0.02326:  13%|█▎        | 27/201 [00:11<01:13,  2.37it/s]Loss: 0.01522:  13%|█▎        | 27/201 [00:11<01:13,  2.37it/s]Loss: 0.01522:  14%|█▍        | 28/201 [00:11<01:12,  2.39it/s]Loss: 0.01621:  14%|█▍        | 28/201 [00:11<01:12,  2.39it/s]Loss: 0.01621:  14%|█▍        | 29/201 [00:12<01:11,  2.40it/s]Loss: 0.02586:  14%|█▍        | 29/201 [00:12<01:11,  2.40it/s]Loss: 0.02586:  15%|█▍        | 30/201 [00:12<01:11,  2.40it/s]Loss: 0.02382:  15%|█▍        | 30/201 [00:12<01:11,  2.40it/s]Loss: 0.02382:  15%|█▌        | 31/201 [00:13<01:10,  2.41it/s]Loss: 0.01849:  15%|█▌        | 31/201 [00:13<01:10,  2.41it/s]Loss: 0.01849:  16%|█▌        | 32/201 [00:13<01:10,  2.41it/s]Loss: 0.02131:  16%|█▌        | 32/201 [00:13<01:10,  2.41it/s]Loss: 0.02131:  16%|█▋        | 33/201 [00:14<01:09,  2.41it/s]Loss: 0.02471:  16%|█▋        | 33/201 [00:14<01:09,  2.41it/s]Loss: 0.02471:  17%|█▋        | 34/201 [00:14<01:09,  2.41it/s]Loss: 0.02416:  17%|█▋        | 34/201 [00:14<01:09,  2.41it/s]Loss: 0.02416:  17%|█▋        | 35/201 [00:14<01:08,  2.41it/s]Loss: 0.02352:  17%|█▋        | 35/201 [00:14<01:08,  2.41it/s]Loss: 0.02352:  18%|█▊        | 36/201 [00:15<01:08,  2.41it/s]Loss: 0.02233:  18%|█▊        | 36/201 [00:15<01:08,  2.41it/s]Loss: 0.02233:  18%|█▊        | 37/201 [00:15<01:07,  2.41it/s]Loss: 0.02149:  18%|█▊        | 37/201 [00:15<01:07,  2.41it/s]Loss: 0.02149:  19%|█▉        | 38/201 [00:16<01:07,  2.42it/s]Loss: 0.02286:  19%|█▉        | 38/201 [00:16<01:07,  2.42it/s]Loss: 0.02286:  19%|█▉        | 39/201 [00:16<01:07,  2.42it/s]Loss: 0.02234:  19%|█▉        | 39/201 [00:16<01:07,  2.42it/s]Loss: 0.02234:  20%|█▉        | 40/201 [00:16<01:06,  2.42it/s]Loss: 0.01376:  20%|█▉        | 40/201 [00:16<01:06,  2.42it/s]Loss: 0.01376:  20%|██        | 41/201 [00:17<01:16,  2.08it/s]Loss: 0.01180:  20%|██        | 41/201 [00:17<01:16,  2.08it/s]Loss: 0.01180:  21%|██        | 42/201 [00:18<01:12,  2.18it/s]Loss: 0.01196:  21%|██        | 42/201 [00:18<01:12,  2.18it/s]Loss: 0.01196:  21%|██▏       | 43/201 [00:18<01:10,  2.25it/s]Loss: 0.02262:  21%|██▏       | 43/201 [00:18<01:10,  2.25it/s]Loss: 0.02262:  22%|██▏       | 44/201 [00:18<01:08,  2.30it/s]Loss: 0.02210:  22%|██▏       | 44/201 [00:18<01:08,  2.30it/s]Loss: 0.02210:  22%|██▏       | 45/201 [00:19<01:06,  2.33it/s]Loss: 0.02220:  22%|██▏       | 45/201 [00:19<01:06,  2.33it/s]Loss: 0.02220:  23%|██▎       | 46/201 [00:19<01:05,  2.36it/s]Loss: 0.02197:  23%|██▎       | 46/201 [00:19<01:05,  2.36it/s]Loss: 0.02197:  23%|██▎       | 47/201 [00:20<01:04,  2.38it/s]Loss: 0.02191:  23%|██▎       | 47/201 [00:20<01:04,  2.38it/s]Loss: 0.02191:  24%|██▍       | 48/201 [00:20<01:04,  2.39it/s]Loss: 0.02075:  24%|██▍       | 48/201 [00:20<01:04,  2.39it/s]Loss: 0.02075:  24%|██▍       | 49/201 [00:20<01:03,  2.40it/s]Loss: 0.02065:  24%|██▍       | 49/201 [00:20<01:03,  2.40it/s]Loss: 0.02065:  25%|██▍       | 50/201 [00:21<01:02,  2.40it/s]Loss: 0.02106:  25%|██▍       | 50/201 [00:21<01:02,  2.40it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.13s/it][A1it [00:01,  1.13s/it]
Loss: 0.02106:  25%|██▌       | 51/201 [00:22<01:53,  1.32it/s]Loss: 0.06698:  25%|██▌       | 51/201 [00:22<01:53,  1.32it/s]Loss: 0.06698:  26%|██▌       | 52/201 [00:23<01:37,  1.53it/s]Loss: 0.04450:  26%|██▌       | 52/201 [00:23<01:37,  1.53it/s]Loss: 0.04450:  26%|██▋       | 53/201 [00:23<01:26,  1.72it/s]Loss: 0.03600:  26%|██▋       | 53/201 [00:23<01:26,  1.72it/s]Loss: 0.03600:  27%|██▋       | 54/201 [00:24<01:18,  1.88it/s]Loss: 0.03094:  27%|██▋       | 54/201 [00:24<01:18,  1.88it/s]Loss: 0.03094:  27%|██▋       | 55/201 [00:24<01:12,  2.02it/s]Loss: 0.02750:  27%|██▋       | 55/201 [00:24<01:12,  2.02it/s]Loss: 0.02750:  28%|██▊       | 56/201 [00:24<01:08,  2.12it/s]Loss: 0.02499:  28%|██▊       | 56/201 [00:24<01:08,  2.12it/s]Loss: 0.02499:  28%|██▊       | 57/201 [00:25<01:05,  2.20it/s]Loss: 0.02308:  28%|██▊       | 57/201 [00:25<01:05,  2.20it/s]Loss: 0.02308:  29%|██▉       | 58/201 [00:25<01:03,  2.26it/s]Loss: 0.02138:  29%|██▉       | 58/201 [00:25<01:03,  2.26it/s]Loss: 0.02138:  29%|██▉       | 59/201 [00:26<01:01,  2.31it/s]Loss: 0.02008:  29%|██▉       | 59/201 [00:26<01:01,  2.31it/s]Loss: 0.02008:  30%|██▉       | 60/201 [00:26<01:00,  2.34it/s]Loss: 0.01901:  30%|██▉       | 60/201 [00:26<01:00,  2.34it/s]Loss: 0.01901:  30%|███       | 61/201 [00:27<01:08,  2.04it/s]Loss: 0.01806:  30%|███       | 61/201 [00:27<01:08,  2.04it/s]Loss: 0.01806:  31%|███       | 62/201 [00:27<01:04,  2.15it/s]Loss: 0.01747:  31%|███       | 62/201 [00:27<01:04,  2.15it/s]Loss: 0.01747:  31%|███▏      | 63/201 [00:28<01:02,  2.22it/s]Loss: 0.01703:  31%|███▏      | 63/201 [00:28<01:02,  2.22it/s]Loss: 0.01703:  32%|███▏      | 64/201 [00:28<01:00,  2.28it/s]Loss: 0.01635:  32%|███▏      | 64/201 [00:28<01:00,  2.28it/s]Loss: 0.01635:  32%|███▏      | 65/201 [00:28<00:58,  2.32it/s]Loss: 0.01656:  32%|███▏      | 65/201 [00:28<00:58,  2.32it/s]Loss: 0.01656:  33%|███▎      | 66/201 [00:29<00:57,  2.35it/s]Loss: 0.01678:  33%|███▎      | 66/201 [00:29<00:57,  2.35it/s]Loss: 0.01678:  33%|███▎      | 67/201 [00:29<00:56,  2.37it/s]Loss: 0.01558:  33%|███▎      | 67/201 [00:29<00:56,  2.37it/s]Loss: 0.01558:  34%|███▍      | 68/201 [00:30<00:56,  2.37it/s]Loss: 0.01542:  34%|███▍      | 68/201 [00:30<00:56,  2.37it/s]Loss: 0.01542:  34%|███▍      | 69/201 [00:30<00:55,  2.39it/s]Loss: 0.01654:  34%|███▍      | 69/201 [00:30<00:55,  2.39it/s]Loss: 0.01654:  35%|███▍      | 70/201 [00:30<00:54,  2.39it/s]Loss: 0.01679:  35%|███▍      | 70/201 [00:30<00:54,  2.39it/s]Loss: 0.01679:  35%|███▌      | 71/201 [00:31<00:54,  2.40it/s]Loss: 0.01471:  35%|███▌      | 71/201 [00:31<00:54,  2.40it/s]Loss: 0.01471:  36%|███▌      | 72/201 [00:31<00:53,  2.41it/s]Loss: 0.01556:  36%|███▌      | 72/201 [00:31<00:53,  2.41it/s]Loss: 0.01556:  36%|███▋      | 73/201 [00:32<00:53,  2.41it/s]Loss: 0.01542:  36%|███▋      | 73/201 [00:32<00:53,  2.41it/s]Loss: 0.01542:  37%|███▋      | 74/201 [00:32<00:52,  2.41it/s]Loss: 0.01454:  37%|███▋      | 74/201 [00:32<00:52,  2.41it/s]Loss: 0.01454:  37%|███▋      | 75/201 [00:33<00:52,  2.41it/s]Loss: 0.01335:  37%|███▋      | 75/201 [00:33<00:52,  2.41it/s]Loss: 0.01335:  38%|███▊      | 76/201 [00:33<00:51,  2.41it/s]Loss: 0.01411:  38%|███▊      | 76/201 [00:33<00:51,  2.41it/s]Loss: 0.01411:  38%|███▊      | 77/201 [00:33<00:51,  2.41it/s]Loss: 0.01393:  38%|███▊      | 77/201 [00:33<00:51,  2.41it/s]Loss: 0.01393:  39%|███▉      | 78/201 [00:34<00:50,  2.41it/s]Loss: 0.01323:  39%|███▉      | 78/201 [00:34<00:50,  2.41it/s]Loss: 0.01323:  39%|███▉      | 79/201 [00:34<00:50,  2.41it/s]Loss: 0.01194:  39%|███▉      | 79/201 [00:34<00:50,  2.41it/s]Loss: 0.01194:  40%|███▉      | 80/201 [00:35<00:50,  2.41it/s]Loss: 0.01448:  40%|███▉      | 80/201 [00:35<00:50,  2.41it/s]Loss: 0.01448:  40%|████      | 81/201 [00:35<00:57,  2.08it/s]Loss: 0.01287:  40%|████      | 81/201 [00:35<00:57,  2.08it/s]Loss: 0.01287:  41%|████      | 82/201 [00:36<00:54,  2.17it/s]Loss: 0.01266:  41%|████      | 82/201 [00:36<00:54,  2.17it/s]Loss: 0.01266:  41%|████▏     | 83/201 [00:36<00:52,  2.24it/s]Loss: 0.01151:  41%|████▏     | 83/201 [00:36<00:52,  2.24it/s]Loss: 0.01151:  42%|████▏     | 84/201 [00:36<00:51,  2.29it/s]Loss: 0.01370:  42%|████▏     | 84/201 [00:36<00:51,  2.29it/s]Loss: 0.01370:  42%|████▏     | 85/201 [00:37<00:50,  2.32it/s]Loss: 0.01617:  42%|████▏     | 85/201 [00:37<00:50,  2.32it/s]Loss: 0.01617:  43%|████▎     | 86/201 [00:37<00:48,  2.35it/s]Loss: 0.01478:  43%|████▎     | 86/201 [00:37<00:48,  2.35it/s]Loss: 0.01478:  43%|████▎     | 87/201 [00:38<00:48,  2.37it/s]Loss: 0.01828:  43%|████▎     | 87/201 [00:38<00:48,  2.37it/s]Loss: 0.01828:  44%|████▍     | 88/201 [00:38<00:47,  2.38it/s]Loss: 0.01673:  44%|████▍     | 88/201 [00:38<00:47,  2.38it/s]Loss: 0.01673:  44%|████▍     | 89/201 [00:39<00:46,  2.39it/s]Loss: 0.01510:  44%|████▍     | 89/201 [00:39<00:46,  2.39it/s]Loss: 0.01510:  45%|████▍     | 90/201 [00:39<00:46,  2.40it/s]Loss: 0.01716:  45%|████▍     | 90/201 [00:39<00:46,  2.40it/s]Loss: 0.01716:  45%|████▌     | 91/201 [00:39<00:45,  2.40it/s]Loss: 0.01519:  45%|████▌     | 91/201 [00:39<00:45,  2.40it/s]Loss: 0.01519:  46%|████▌     | 92/201 [00:40<00:45,  2.41it/s]Loss: 0.01576:  46%|████▌     | 92/201 [00:40<00:45,  2.41it/s]Loss: 0.01576:  46%|████▋     | 93/201 [00:40<00:44,  2.41it/s]Loss: 0.01671:  46%|████▋     | 93/201 [00:40<00:44,  2.41it/s]Loss: 0.01671:  47%|████▋     | 94/201 [00:41<00:44,  2.41it/s]Loss: 0.01618:  47%|████▋     | 94/201 [00:41<00:44,  2.41it/s]Loss: 0.01618:  47%|████▋     | 95/201 [00:41<00:43,  2.41it/s]Loss: 0.01420:  47%|████▋     | 95/201 [00:41<00:43,  2.41it/s]Loss: 0.01420:  48%|████▊     | 96/201 [00:41<00:43,  2.41it/s]Loss: 0.01189:  48%|████▊     | 96/201 [00:41<00:43,  2.41it/s]Loss: 0.01189:  48%|████▊     | 97/201 [00:42<00:43,  2.42it/s]Loss: 0.01546:  48%|████▊     | 97/201 [00:42<00:43,  2.42it/s]Loss: 0.01546:  49%|████▉     | 98/201 [00:42<00:42,  2.41it/s]Loss: 0.01433:  49%|████▉     | 98/201 [00:42<00:42,  2.41it/s]Loss: 0.01433:  49%|████▉     | 99/201 [00:43<00:42,  2.42it/s]Loss: 0.01517:  49%|████▉     | 99/201 [00:43<00:42,  2.42it/s]Loss: 0.01517:  50%|████▉     | 100/201 [00:43<00:41,  2.41it/s]Loss: 0.01409:  50%|████▉     | 100/201 [00:43<00:41,  2.41it/s]Loss: 0.01409:  50%|█████     | 101/201 [00:44<00:48,  2.08it/s]Loss: 0.01036:  50%|█████     | 101/201 [00:44<00:48,  2.08it/s]max loss: 0.8059275150299072
Densities: min=0.0005454906495288014, max=0.9958315491676331, mean=0.434710830450058
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.26s/it][A1it [00:01,  1.26s/it]
Loss: 0.01036:  51%|█████     | 102/201 [00:45<01:23,  1.19it/s]Loss: 0.04095:  51%|█████     | 102/201 [00:45<01:23,  1.19it/s]Loss: 0.04095:  51%|█████     | 103/201 [00:46<01:09,  1.40it/s]Loss: 0.03472:  51%|█████     | 103/201 [00:46<01:09,  1.40it/s]Loss: 0.03472:  52%|█████▏    | 104/201 [00:46<01:00,  1.61it/s]Loss: 0.03121:  52%|█████▏    | 104/201 [00:46<01:00,  1.61it/s]Loss: 0.03121:  52%|█████▏    | 105/201 [00:47<00:53,  1.79it/s]Loss: 0.02879:  52%|█████▏    | 105/201 [00:47<00:53,  1.79it/s]Loss: 0.02879:  53%|█████▎    | 106/201 [00:47<00:48,  1.94it/s]Loss: 0.02689:  53%|█████▎    | 106/201 [00:47<00:48,  1.94it/s]Loss: 0.02689:  53%|█████▎    | 107/201 [00:47<00:45,  2.06it/s]Loss: 0.02536:  53%|█████▎    | 107/201 [00:47<00:45,  2.06it/s]Loss: 0.02536:  54%|█████▎    | 108/201 [00:48<00:43,  2.16it/s]Loss: 0.02406:  54%|█████▎    | 108/201 [00:48<00:43,  2.16it/s]Loss: 0.02406:  54%|█████▍    | 109/201 [00:48<00:41,  2.23it/s]Loss: 0.02290:  54%|█████▍    | 109/201 [00:48<00:41,  2.23it/s]Loss: 0.02290:  55%|█████▍    | 110/201 [00:49<00:39,  2.29it/s]Loss: 0.02193:  55%|█████▍    | 110/201 [00:49<00:39,  2.29it/s]Loss: 0.02193:  55%|█████▌    | 111/201 [00:49<00:38,  2.33it/s]Loss: 0.02102:  55%|█████▌    | 111/201 [00:49<00:38,  2.33it/s]Loss: 0.02102:  56%|█████▌    | 112/201 [00:50<00:37,  2.35it/s]Loss: 0.02021:  56%|█████▌    | 112/201 [00:50<00:37,  2.35it/s]Loss: 0.02021:  56%|█████▌    | 113/201 [00:50<00:37,  2.37it/s]Loss: 0.01948:  56%|█████▌    | 113/201 [00:50<00:37,  2.37it/s]Loss: 0.01948:  57%|█████▋    | 114/201 [00:50<00:36,  2.39it/s]Loss: 0.01878:  57%|█████▋    | 114/201 [00:50<00:36,  2.39it/s]Loss: 0.01878:  57%|█████▋    | 115/201 [00:51<00:35,  2.40it/s]Loss: 0.01813:  57%|█████▋    | 115/201 [00:51<00:35,  2.40it/s]Loss: 0.01813:  58%|█████▊    | 116/201 [00:51<00:35,  2.41it/s]Loss: 0.01759:  58%|█████▊    | 116/201 [00:51<00:35,  2.41it/s]Loss: 0.01759:  58%|█████▊    | 117/201 [00:52<00:34,  2.41it/s]Loss: 0.01705:  58%|█████▊    | 117/201 [00:52<00:34,  2.41it/s]Loss: 0.01705:  59%|█████▊    | 118/201 [00:52<00:34,  2.42it/s]Loss: 0.01655:  59%|█████▊    | 118/201 [00:52<00:34,  2.42it/s]Loss: 0.01655:  59%|█████▉    | 119/201 [00:52<00:33,  2.42it/s]Loss: 0.01611:  59%|█████▉    | 119/201 [00:52<00:33,  2.42it/s]Loss: 0.01611:  60%|█████▉    | 120/201 [00:53<00:33,  2.42it/s]Loss: 0.01563:  60%|█████▉    | 120/201 [00:53<00:33,  2.42it/s]Loss: 0.01563:  60%|██████    | 121/201 [00:53<00:38,  2.08it/s]Loss: 0.01528:  60%|██████    | 121/201 [00:53<00:38,  2.08it/s]Loss: 0.01528:  61%|██████    | 122/201 [00:54<00:36,  2.18it/s]Loss: 0.01502:  61%|██████    | 122/201 [00:54<00:36,  2.18it/s]Loss: 0.01502:  61%|██████    | 123/201 [00:54<00:34,  2.25it/s]Loss: 0.01464:  61%|██████    | 123/201 [00:54<00:34,  2.25it/s]Loss: 0.01464:  62%|██████▏   | 124/201 [00:55<00:33,  2.30it/s]Loss: 0.01428:  62%|██████▏   | 124/201 [00:55<00:33,  2.30it/s]Loss: 0.01428:  62%|██████▏   | 125/201 [00:55<00:32,  2.33it/s]Loss: 0.01395:  62%|██████▏   | 125/201 [00:55<00:32,  2.33it/s]Loss: 0.01395:  63%|██████▎   | 126/201 [00:56<00:31,  2.36it/s]Loss: 0.01363:  63%|██████▎   | 126/201 [00:56<00:31,  2.36it/s]Loss: 0.01363:  63%|██████▎   | 127/201 [00:56<00:31,  2.38it/s]Loss: 0.01335:  63%|██████▎   | 127/201 [00:56<00:31,  2.38it/s]Loss: 0.01335:  64%|██████▎   | 128/201 [00:56<00:30,  2.39it/s]Loss: 0.01333:  64%|██████▎   | 128/201 [00:56<00:30,  2.39it/s]Loss: 0.01333:  64%|██████▍   | 129/201 [00:57<00:29,  2.40it/s]Loss: 0.01393:  64%|██████▍   | 129/201 [00:57<00:29,  2.40it/s]Loss: 0.01393:  65%|██████▍   | 130/201 [00:57<00:29,  2.41it/s]Loss: 0.01459:  65%|██████▍   | 130/201 [00:57<00:29,  2.41it/s]Loss: 0.01459:  65%|██████▌   | 131/201 [00:58<00:29,  2.41it/s]Loss: 0.01626:  65%|██████▌   | 131/201 [00:58<00:29,  2.41it/s]Loss: 0.01626:  66%|██████▌   | 132/201 [00:58<00:28,  2.42it/s]Loss: 0.01646:  66%|██████▌   | 132/201 [00:58<00:28,  2.42it/s]Loss: 0.01646:  66%|██████▌   | 133/201 [00:58<00:28,  2.42it/s]Loss: 0.01646:  66%|██████▌   | 133/201 [00:58<00:28,  2.42it/s]Loss: 0.01646:  67%|██████▋   | 134/201 [00:59<00:27,  2.42it/s]Loss: 0.01599:  67%|██████▋   | 134/201 [00:59<00:27,  2.42it/s]Loss: 0.01599:  67%|██████▋   | 135/201 [00:59<00:27,  2.42it/s]Loss: 0.01477:  67%|██████▋   | 135/201 [00:59<00:27,  2.42it/s]Loss: 0.01477:  68%|██████▊   | 136/201 [01:00<00:26,  2.42it/s]Loss: 0.01286:  68%|██████▊   | 136/201 [01:00<00:26,  2.42it/s]Loss: 0.01286:  68%|██████▊   | 137/201 [01:00<00:26,  2.42it/s]Loss: 0.01317:  68%|██████▊   | 137/201 [01:00<00:26,  2.42it/s]Loss: 0.01317:  69%|██████▊   | 138/201 [01:00<00:25,  2.42it/s]Loss: 0.01228:  69%|██████▊   | 138/201 [01:00<00:25,  2.42it/s]Loss: 0.01228:  69%|██████▉   | 139/201 [01:01<00:25,  2.42it/s]Loss: 0.01214:  69%|██████▉   | 139/201 [01:01<00:25,  2.42it/s]Loss: 0.01214:  70%|██████▉   | 140/201 [01:01<00:25,  2.42it/s]Loss: 0.01168:  70%|██████▉   | 140/201 [01:01<00:25,  2.42it/s]Loss: 0.01168:  70%|███████   | 141/201 [01:02<00:28,  2.09it/s]Loss: 0.01099:  70%|███████   | 141/201 [01:02<00:28,  2.09it/s]Loss: 0.01099:  71%|███████   | 142/201 [01:02<00:26,  2.19it/s]Loss: 0.01091:  71%|███████   | 142/201 [01:02<00:26,  2.19it/s]Loss: 0.01091:  71%|███████   | 143/201 [01:03<00:25,  2.25it/s]Loss: 0.01087:  71%|███████   | 143/201 [01:03<00:25,  2.25it/s]Loss: 0.01087:  72%|███████▏  | 144/201 [01:03<00:24,  2.29it/s]Loss: 0.01047:  72%|███████▏  | 144/201 [01:03<00:24,  2.29it/s]Loss: 0.01047:  72%|███████▏  | 145/201 [01:04<00:24,  2.33it/s]Loss: 0.01046:  72%|███████▏  | 145/201 [01:04<00:24,  2.33it/s]Loss: 0.01046:  73%|███████▎  | 146/201 [01:04<00:23,  2.36it/s]Loss: 0.00999:  73%|███████▎  | 146/201 [01:04<00:23,  2.36it/s]Loss: 0.00999:  73%|███████▎  | 147/201 [01:04<00:22,  2.38it/s]Loss: 0.01138:  73%|███████▎  | 147/201 [01:04<00:22,  2.38it/s]Loss: 0.01138:  74%|███████▎  | 148/201 [01:05<00:22,  2.39it/s]Loss: 0.01152:  74%|███████▎  | 148/201 [01:05<00:22,  2.39it/s]Loss: 0.01152:  74%|███████▍  | 149/201 [01:05<00:21,  2.40it/s]Loss: 0.01234:  74%|███████▍  | 149/201 [01:05<00:21,  2.40it/s]Loss: 0.01234:  75%|███████▍  | 150/201 [01:06<00:21,  2.41it/s]Loss: 0.01206:  75%|███████▍  | 150/201 [01:06<00:21,  2.41it/s]Loss: 0.01206:  75%|███████▌  | 151/201 [01:06<00:20,  2.41it/s]Loss: 0.01112:  75%|███████▌  | 151/201 [01:06<00:20,  2.41it/s]Loss: 0.01112:  76%|███████▌  | 152/201 [01:06<00:20,  2.41it/s]Loss: 0.01057:  76%|███████▌  | 152/201 [01:06<00:20,  2.41it/s]max loss: 0.36423736810684204
Densities: min=0.0005459814565256238, max=0.9955859184265137, mean=0.4970959424972534
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.26s/it][A1it [00:01,  1.26s/it]
Loss: 0.01057:  76%|███████▌  | 153/201 [01:08<00:38,  1.26it/s]Loss: 0.03348:  76%|███████▌  | 153/201 [01:08<00:38,  1.26it/s]Loss: 0.03348:  77%|███████▋  | 154/201 [01:09<00:31,  1.47it/s]Loss: 0.02863:  77%|███████▋  | 154/201 [01:09<00:31,  1.47it/s]Loss: 0.02863:  77%|███████▋  | 155/201 [01:09<00:27,  1.67it/s]Loss: 0.02603:  77%|███████▋  | 155/201 [01:09<00:27,  1.67it/s]Loss: 0.02603:  78%|███████▊  | 156/201 [01:09<00:24,  1.84it/s]Loss: 0.02452:  78%|███████▊  | 156/201 [01:09<00:24,  1.84it/s]Loss: 0.02452:  78%|███████▊  | 157/201 [01:10<00:22,  1.98it/s]Loss: 0.02318:  78%|███████▊  | 157/201 [01:10<00:22,  1.98it/s]Loss: 0.02318:  79%|███████▊  | 158/201 [01:10<00:20,  2.10it/s]Loss: 0.02255:  79%|███████▊  | 158/201 [01:10<00:20,  2.10it/s]Loss: 0.02255:  79%|███████▉  | 159/201 [01:11<00:19,  2.18it/s]Loss: 0.02142:  79%|███████▉  | 159/201 [01:11<00:19,  2.18it/s]Loss: 0.02142:  80%|███████▉  | 160/201 [01:11<00:18,  2.25it/s]Loss: 0.02098:  80%|███████▉  | 160/201 [01:11<00:18,  2.25it/s]Loss: 0.02098:  80%|████████  | 161/201 [01:12<00:20,  2.00it/s]Loss: 0.02002:  80%|████████  | 161/201 [01:12<00:20,  2.00it/s]Loss: 0.02002:  81%|████████  | 162/201 [01:12<00:18,  2.11it/s]Loss: 0.01844:  81%|████████  | 162/201 [01:12<00:18,  2.11it/s]Loss: 0.01844:  81%|████████  | 163/201 [01:13<00:17,  2.20it/s]Loss: 0.01964:  81%|████████  | 163/201 [01:13<00:17,  2.20it/s]Loss: 0.01964:  82%|████████▏ | 164/201 [01:13<00:16,  2.26it/s]Loss: 0.01931:  82%|████████▏ | 164/201 [01:13<00:16,  2.26it/s]Loss: 0.01931:  82%|████████▏ | 165/201 [01:13<00:15,  2.31it/s]Loss: 0.01879:  82%|████████▏ | 165/201 [01:13<00:15,  2.31it/s]Loss: 0.01879:  83%|████████▎ | 166/201 [01:14<00:14,  2.34it/s]Loss: 0.01663:  83%|████████▎ | 166/201 [01:14<00:14,  2.34it/s]Loss: 0.01663:  83%|████████▎ | 167/201 [01:14<00:14,  2.36it/s]Loss: 0.01681:  83%|████████▎ | 167/201 [01:14<00:14,  2.36it/s]Loss: 0.01681:  84%|████████▎ | 168/201 [01:15<00:13,  2.38it/s]Loss: 0.01833:  84%|████████▎ | 168/201 [01:15<00:13,  2.38it/s]Loss: 0.01833:  84%|████████▍ | 169/201 [01:15<00:13,  2.39it/s]Loss: 0.01753:  84%|████████▍ | 169/201 [01:15<00:13,  2.39it/s]Loss: 0.01753:  85%|████████▍ | 170/201 [01:15<00:12,  2.40it/s]Loss: 0.01744:  85%|████████▍ | 170/201 [01:15<00:12,  2.40it/s]Loss: 0.01744:  85%|████████▌ | 171/201 [01:16<00:12,  2.41it/s]Loss: 0.01667:  85%|████████▌ | 171/201 [01:16<00:12,  2.41it/s]Loss: 0.01667:  86%|████████▌ | 172/201 [01:16<00:12,  2.41it/s]Loss: 0.01670:  86%|████████▌ | 172/201 [01:16<00:12,  2.41it/s]Loss: 0.01670:  86%|████████▌ | 173/201 [01:17<00:11,  2.41it/s]Loss: 0.01445:  86%|████████▌ | 173/201 [01:17<00:11,  2.41it/s]Loss: 0.01445:  87%|████████▋ | 174/201 [01:17<00:11,  2.42it/s]Loss: 0.01375:  87%|████████▋ | 174/201 [01:17<00:11,  2.42it/s]Loss: 0.01375:  87%|████████▋ | 175/201 [01:17<00:10,  2.42it/s]Loss: 0.01363:  87%|████████▋ | 175/201 [01:17<00:10,  2.42it/s]Loss: 0.01363:  88%|████████▊ | 176/201 [01:18<00:10,  2.42it/s]Loss: 0.01323:  88%|████████▊ | 176/201 [01:18<00:10,  2.42it/s]Loss: 0.01323:  88%|████████▊ | 177/201 [01:18<00:09,  2.42it/s]Loss: 0.01328:  88%|████████▊ | 177/201 [01:18<00:09,  2.42it/s]Loss: 0.01328:  89%|████████▊ | 178/201 [01:19<00:09,  2.42it/s]Loss: 0.01236:  89%|████████▊ | 178/201 [01:19<00:09,  2.42it/s]Loss: 0.01236:  89%|████████▉ | 179/201 [01:19<00:09,  2.42it/s]Loss: 0.01198:  89%|████████▉ | 179/201 [01:19<00:09,  2.42it/s]Loss: 0.01198:  90%|████████▉ | 180/201 [01:20<00:08,  2.42it/s]Loss: 0.01163:  90%|████████▉ | 180/201 [01:20<00:08,  2.42it/s]Loss: 0.01163:  90%|█████████ | 181/201 [01:20<00:09,  2.08it/s]Loss: 0.01134:  90%|█████████ | 181/201 [01:20<00:09,  2.08it/s]Loss: 0.01134:  91%|█████████ | 182/201 [01:21<00:08,  2.18it/s]Loss: 0.01173:  91%|█████████ | 182/201 [01:21<00:08,  2.18it/s]Loss: 0.01173:  91%|█████████ | 183/201 [01:21<00:08,  2.25it/s]Loss: 0.01497:  91%|█████████ | 183/201 [01:21<00:08,  2.25it/s]Loss: 0.01497:  92%|█████████▏| 184/201 [01:21<00:07,  2.29it/s]Loss: 0.01640:  92%|█████████▏| 184/201 [01:21<00:07,  2.29it/s]Loss: 0.01640:  92%|█████████▏| 185/201 [01:22<00:06,  2.33it/s]Loss: 0.01573:  92%|█████████▏| 185/201 [01:22<00:06,  2.33it/s]Loss: 0.01573:  93%|█████████▎| 186/201 [01:22<00:06,  2.36it/s]Loss: 0.01516:  93%|█████████▎| 186/201 [01:22<00:06,  2.36it/s]Loss: 0.01516:  93%|█████████▎| 187/201 [01:23<00:05,  2.37it/s]Loss: 0.01491:  93%|█████████▎| 187/201 [01:23<00:05,  2.37it/s]Loss: 0.01491:  94%|█████████▎| 188/201 [01:23<00:05,  2.39it/s]Loss: 0.01422:  94%|█████████▎| 188/201 [01:23<00:05,  2.39it/s]Loss: 0.01422:  94%|█████████▍| 189/201 [01:23<00:05,  2.40it/s]Loss: 0.01247:  94%|█████████▍| 189/201 [01:23<00:05,  2.40it/s]Loss: 0.01247:  95%|█████████▍| 190/201 [01:24<00:04,  2.40it/s]Loss: 0.01233:  95%|█████████▍| 190/201 [01:24<00:04,  2.40it/s]Loss: 0.01233:  95%|█████████▌| 191/201 [01:24<00:04,  2.41it/s]Loss: 0.01468:  95%|█████████▌| 191/201 [01:24<00:04,  2.41it/s]Loss: 0.01468:  96%|█████████▌| 192/201 [01:25<00:03,  2.41it/s]Loss: 0.01323:  96%|█████████▌| 192/201 [01:25<00:03,  2.41it/s]Loss: 0.01323:  96%|█████████▌| 193/201 [01:25<00:03,  2.41it/s]Loss: 0.01406:  96%|█████████▌| 193/201 [01:25<00:03,  2.41it/s]Loss: 0.01406:  97%|█████████▋| 194/201 [01:26<00:02,  2.42it/s]Loss: 0.01362:  97%|█████████▋| 194/201 [01:26<00:02,  2.42it/s]Loss: 0.01362:  97%|█████████▋| 195/201 [01:26<00:02,  2.42it/s]Loss: 0.01139:  97%|█████████▋| 195/201 [01:26<00:02,  2.42it/s]Loss: 0.01139:  98%|█████████▊| 196/201 [01:26<00:02,  2.42it/s]Loss: 0.00981:  98%|█████████▊| 196/201 [01:26<00:02,  2.42it/s]Loss: 0.00981:  98%|█████████▊| 197/201 [01:27<00:01,  2.42it/s]Loss: 0.00964:  98%|█████████▊| 197/201 [01:27<00:01,  2.42it/s]Loss: 0.00964:  99%|█████████▊| 198/201 [01:27<00:01,  2.42it/s]Loss: 0.00930:  99%|█████████▊| 198/201 [01:27<00:01,  2.42it/s]Loss: 0.00930:  99%|█████████▉| 199/201 [01:28<00:00,  2.42it/s]Loss: 0.00905:  99%|█████████▉| 199/201 [01:28<00:00,  2.42it/s]Loss: 0.00905: 100%|█████████▉| 200/201 [01:28<00:00,  2.42it/s]Loss: 0.00918: 100%|█████████▉| 200/201 [01:28<00:00,  2.42it/s]Loss: 0.00918: 100%|██████████| 201/201 [01:29<00:00,  2.08it/s]Loss: 0.00859: 100%|██████████| 201/201 [01:29<00:00,  2.08it/s]Loss: 0.00859: 100%|██████████| 201/201 [01:29<00:00,  2.25it/s]
max loss: 0.24655622243881226
Densities: min=0.0005486315931193531, max=0.9959372878074646, mean=0.5105395913124084
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run01/temp_10atm_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 89.15319299697876 seconds
-1.0 2.2529297
