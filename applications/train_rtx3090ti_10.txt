16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/mechhand_640x220x229_float32_raw_640x220x229_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json
Initialize network
Latent space memory: 13.2MiB
# of network parameters: 3473665
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.03it/s]1it [00:00,  3.03it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=0.999988317489624, mean=0.39814692735671997
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.53it/s]Render: : 1it [00:00,  2.53it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 120, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 60, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [640, 220, 229], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<05:20,  1.60s/it]Loss: 0.18852:   0%|          | 1/201 [00:01<05:20,  1.60s/it]Loss: 0.18852:   1%|          | 2/201 [00:02<03:52,  1.17s/it]Loss: 0.08565:   1%|          | 2/201 [00:02<03:52,  1.17s/it]Loss: 0.08565:   1%|▏         | 3/201 [00:03<03:23,  1.03s/it]Loss: 0.07297:   1%|▏         | 3/201 [00:03<03:23,  1.03s/it]Loss: 0.07297:   2%|▏         | 4/201 [00:04<03:09,  1.04it/s]Loss: 0.06204:   2%|▏         | 4/201 [00:04<03:09,  1.04it/s]Loss: 0.06204:   2%|▏         | 5/201 [00:05<03:02,  1.08it/s]Loss: 0.05650:   2%|▏         | 5/201 [00:05<03:02,  1.08it/s]Loss: 0.05650:   3%|▎         | 6/201 [00:05<02:56,  1.10it/s]Loss: 0.05246:   3%|▎         | 6/201 [00:05<02:56,  1.10it/s]Loss: 0.05246:   3%|▎         | 7/201 [00:06<02:53,  1.12it/s]Loss: 0.04825:   3%|▎         | 7/201 [00:06<02:53,  1.12it/s]Loss: 0.04825:   4%|▍         | 8/201 [00:07<02:50,  1.13it/s]Loss: 0.04502:   4%|▍         | 8/201 [00:07<02:50,  1.13it/s]Loss: 0.04502:   4%|▍         | 9/201 [00:08<02:48,  1.14it/s]Loss: 0.04213:   4%|▍         | 9/201 [00:08<02:48,  1.14it/s]Loss: 0.04213:   5%|▍         | 10/201 [00:09<02:46,  1.14it/s]Loss: 0.03769:   5%|▍         | 10/201 [00:09<02:46,  1.14it/s]Loss: 0.03769:   5%|▌         | 11/201 [00:10<02:45,  1.15it/s]Loss: 0.03481:   5%|▌         | 11/201 [00:10<02:45,  1.15it/s]Loss: 0.03481:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.03304:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.03304:   6%|▋         | 13/201 [00:11<02:43,  1.15it/s]Loss: 0.03097:   6%|▋         | 13/201 [00:11<02:43,  1.15it/s]Loss: 0.03097:   7%|▋         | 14/201 [00:12<02:42,  1.15it/s]Loss: 0.02904:   7%|▋         | 14/201 [00:12<02:42,  1.15it/s]Loss: 0.02904:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.02765:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.02765:   8%|▊         | 16/201 [00:14<02:40,  1.16it/s]Loss: 0.02593:   8%|▊         | 16/201 [00:14<02:40,  1.16it/s]Loss: 0.02593:   8%|▊         | 17/201 [00:15<02:39,  1.16it/s]Loss: 0.02471:   8%|▊         | 17/201 [00:15<02:39,  1.16it/s]Loss: 0.02471:   9%|▉         | 18/201 [00:16<02:38,  1.16it/s]Loss: 0.02433:   9%|▉         | 18/201 [00:16<02:38,  1.16it/s]Loss: 0.02433:   9%|▉         | 19/201 [00:17<02:37,  1.16it/s]Loss: 0.02312:   9%|▉         | 19/201 [00:17<02:37,  1.16it/s]Loss: 0.02312:  10%|▉         | 20/201 [00:18<02:36,  1.16it/s]Loss: 0.02210:  10%|▉         | 20/201 [00:18<02:36,  1.16it/s]Loss: 0.02210:  10%|█         | 21/201 [00:18<02:37,  1.14it/s]Loss: 0.02151:  10%|█         | 21/201 [00:18<02:37,  1.14it/s]Loss: 0.02151:  11%|█         | 22/201 [00:19<02:35,  1.15it/s]Loss: 0.02233:  11%|█         | 22/201 [00:19<02:35,  1.15it/s]Loss: 0.02233:  11%|█▏        | 23/201 [00:20<02:34,  1.15it/s]Loss: 0.02101:  11%|█▏        | 23/201 [00:20<02:34,  1.15it/s]Loss: 0.02101:  12%|█▏        | 24/201 [00:21<02:33,  1.15it/s]Loss: 0.02016:  12%|█▏        | 24/201 [00:21<02:33,  1.15it/s]Loss: 0.02016:  12%|█▏        | 25/201 [00:22<02:32,  1.15it/s]Loss: 0.01963:  12%|█▏        | 25/201 [00:22<02:32,  1.15it/s]Loss: 0.01963:  13%|█▎        | 26/201 [00:23<02:31,  1.15it/s]Loss: 0.01959:  13%|█▎        | 26/201 [00:23<02:31,  1.15it/s]Loss: 0.01959:  13%|█▎        | 27/201 [00:24<02:30,  1.15it/s]Loss: 0.01909:  13%|█▎        | 27/201 [00:24<02:30,  1.15it/s]Loss: 0.01909:  14%|█▍        | 28/201 [00:24<02:29,  1.16it/s]Loss: 0.01874:  14%|█▍        | 28/201 [00:24<02:29,  1.16it/s]Loss: 0.01874:  14%|█▍        | 29/201 [00:25<02:28,  1.16it/s]Loss: 0.01826:  14%|█▍        | 29/201 [00:25<02:28,  1.16it/s]Loss: 0.01826:  15%|█▍        | 30/201 [00:26<02:28,  1.16it/s]Loss: 0.01823:  15%|█▍        | 30/201 [00:26<02:28,  1.16it/s]Loss: 0.01823:  15%|█▌        | 31/201 [00:27<02:27,  1.16it/s]Loss: 0.01778:  15%|█▌        | 31/201 [00:27<02:27,  1.16it/s]Loss: 0.01778:  16%|█▌        | 32/201 [00:28<02:26,  1.16it/s]Loss: 0.01762:  16%|█▌        | 32/201 [00:28<02:26,  1.16it/s]Loss: 0.01762:  16%|█▋        | 33/201 [00:29<02:25,  1.16it/s]Loss: 0.01713:  16%|█▋        | 33/201 [00:29<02:25,  1.16it/s]Loss: 0.01713:  17%|█▋        | 34/201 [00:30<02:24,  1.16it/s]Loss: 0.01766:  17%|█▋        | 34/201 [00:30<02:24,  1.16it/s]Loss: 0.01766:  17%|█▋        | 35/201 [00:31<02:23,  1.16it/s]Loss: 0.01734:  17%|█▋        | 35/201 [00:31<02:23,  1.16it/s]Loss: 0.01734:  18%|█▊        | 36/201 [00:31<02:22,  1.16it/s]Loss: 0.01690:  18%|█▊        | 36/201 [00:31<02:22,  1.16it/s]Loss: 0.01690:  18%|█▊        | 37/201 [00:32<02:22,  1.15it/s]Loss: 0.01665:  18%|█▊        | 37/201 [00:32<02:22,  1.15it/s]Loss: 0.01665:  19%|█▉        | 38/201 [00:33<02:21,  1.15it/s]Loss: 0.01636:  19%|█▉        | 38/201 [00:33<02:21,  1.15it/s]Loss: 0.01636:  19%|█▉        | 39/201 [00:34<02:20,  1.15it/s]Loss: 0.01620:  19%|█▉        | 39/201 [00:34<02:20,  1.15it/s]Loss: 0.01620:  20%|█▉        | 40/201 [00:35<02:19,  1.15it/s]Loss: 0.01606:  20%|█▉        | 40/201 [00:35<02:19,  1.15it/s]Loss: 0.01606:  20%|██        | 41/201 [00:36<02:19,  1.14it/s]Loss: 0.01593:  20%|██        | 41/201 [00:36<02:19,  1.14it/s]Loss: 0.01593:  21%|██        | 42/201 [00:37<02:18,  1.15it/s]Loss: 0.01566:  21%|██        | 42/201 [00:37<02:18,  1.15it/s]Loss: 0.01566:  21%|██▏       | 43/201 [00:37<02:17,  1.15it/s]Loss: 0.01582:  21%|██▏       | 43/201 [00:37<02:17,  1.15it/s]Loss: 0.01582:  22%|██▏       | 44/201 [00:38<02:16,  1.15it/s]Loss: 0.01548:  22%|██▏       | 44/201 [00:38<02:16,  1.15it/s]Loss: 0.01548:  22%|██▏       | 45/201 [00:39<02:15,  1.15it/s]Loss: 0.01565:  22%|██▏       | 45/201 [00:39<02:15,  1.15it/s]Loss: 0.01565:  23%|██▎       | 46/201 [00:40<02:14,  1.15it/s]Loss: 0.01524:  23%|██▎       | 46/201 [00:40<02:14,  1.15it/s]Loss: 0.01524:  23%|██▎       | 47/201 [00:41<02:13,  1.15it/s]Loss: 0.01509:  23%|██▎       | 47/201 [00:41<02:13,  1.15it/s]Loss: 0.01509:  24%|██▍       | 48/201 [00:42<02:12,  1.15it/s]Loss: 0.01490:  24%|██▍       | 48/201 [00:42<02:12,  1.15it/s]Loss: 0.01490:  24%|██▍       | 49/201 [00:43<02:11,  1.16it/s]Loss: 0.01537:  24%|██▍       | 49/201 [00:43<02:11,  1.16it/s]Loss: 0.01537:  25%|██▍       | 50/201 [00:44<02:10,  1.16it/s]Loss: 0.01478:  25%|██▍       | 50/201 [00:44<02:10,  1.16it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.55s/it][A1it [00:01,  1.55s/it]
Loss: 0.01478:  25%|██▌       | 51/201 [00:46<03:19,  1.33s/it]Loss: 0.21645:  25%|██▌       | 51/201 [00:46<03:19,  1.33s/it]Loss: 0.21645:  26%|██▌       | 52/201 [00:47<02:57,  1.19s/it]Loss: 0.05786:  26%|██▌       | 52/201 [00:47<02:57,  1.19s/it]Loss: 0.05786:  26%|██▋       | 53/201 [00:48<02:41,  1.09s/it]Loss: 0.02169:  26%|██▋       | 53/201 [00:48<02:41,  1.09s/it]Loss: 0.02169:  27%|██▋       | 54/201 [00:49<02:30,  1.02s/it]Loss: 0.01523:  27%|██▋       | 54/201 [00:49<02:30,  1.02s/it]Loss: 0.01523:  27%|██▋       | 55/201 [00:49<02:22,  1.02it/s]Loss: 0.01287:  27%|██▋       | 55/201 [00:49<02:22,  1.02it/s]Loss: 0.01287:  28%|██▊       | 56/201 [00:50<02:16,  1.06it/s]Loss: 0.01163:  28%|██▊       | 56/201 [00:50<02:16,  1.06it/s]Loss: 0.01163:  28%|██▊       | 57/201 [00:51<02:12,  1.09it/s]Loss: 0.01079:  28%|██▊       | 57/201 [00:51<02:12,  1.09it/s]Loss: 0.01079:  29%|██▉       | 58/201 [00:52<02:09,  1.11it/s]Loss: 0.01015:  29%|██▉       | 58/201 [00:52<02:09,  1.11it/s]Loss: 0.01015:  29%|██▉       | 59/201 [00:53<02:06,  1.12it/s]Loss: 0.00960:  29%|██▉       | 59/201 [00:53<02:06,  1.12it/s]Loss: 0.00960:  30%|██▉       | 60/201 [00:54<02:04,  1.13it/s]Loss: 0.00945:  30%|██▉       | 60/201 [00:54<02:04,  1.13it/s]Loss: 0.00945:  30%|███       | 61/201 [00:55<02:04,  1.13it/s]Loss: 0.00904:  30%|███       | 61/201 [00:55<02:04,  1.13it/s]Loss: 0.00904:  31%|███       | 62/201 [00:55<02:01,  1.14it/s]Loss: 0.00877:  31%|███       | 62/201 [00:55<02:01,  1.14it/s]Loss: 0.00877:  31%|███▏      | 63/201 [00:56<02:00,  1.14it/s]Loss: 0.00857:  31%|███▏      | 63/201 [00:56<02:00,  1.14it/s]Loss: 0.00857:  32%|███▏      | 64/201 [00:57<01:59,  1.15it/s]Loss: 0.00835:  32%|███▏      | 64/201 [00:57<01:59,  1.15it/s]Loss: 0.00835:  32%|███▏      | 65/201 [00:58<01:58,  1.15it/s]Loss: 0.00820:  32%|███▏      | 65/201 [00:58<01:58,  1.15it/s]Loss: 0.00820:  33%|███▎      | 66/201 [00:59<01:57,  1.15it/s]Loss: 0.00808:  33%|███▎      | 66/201 [00:59<01:57,  1.15it/s]Loss: 0.00808:  33%|███▎      | 67/201 [01:00<01:56,  1.15it/s]Loss: 0.00795:  33%|███▎      | 67/201 [01:00<01:56,  1.15it/s]Loss: 0.00795:  34%|███▍      | 68/201 [01:01<01:55,  1.15it/s]Loss: 0.00775:  34%|███▍      | 68/201 [01:01<01:55,  1.15it/s]Loss: 0.00775:  34%|███▍      | 69/201 [01:02<01:54,  1.16it/s]Loss: 0.00776:  34%|███▍      | 69/201 [01:02<01:54,  1.16it/s]Loss: 0.00776:  35%|███▍      | 70/201 [01:02<01:53,  1.16it/s]Loss: 0.00772:  35%|███▍      | 70/201 [01:02<01:53,  1.16it/s]Loss: 0.00772:  35%|███▌      | 71/201 [01:03<01:52,  1.15it/s]Loss: 0.00754:  35%|███▌      | 71/201 [01:03<01:52,  1.15it/s]Loss: 0.00754:  36%|███▌      | 72/201 [01:04<01:51,  1.15it/s]Loss: 0.00742:  36%|███▌      | 72/201 [01:04<01:51,  1.15it/s]Loss: 0.00742:  36%|███▋      | 73/201 [01:05<01:51,  1.15it/s]Loss: 0.00726:  36%|███▋      | 73/201 [01:05<01:51,  1.15it/s]Loss: 0.00726:  37%|███▋      | 74/201 [01:06<01:50,  1.15it/s]Loss: 0.00734:  37%|███▋      | 74/201 [01:06<01:50,  1.15it/s]Loss: 0.00734:  37%|███▋      | 75/201 [01:07<01:49,  1.15it/s]Loss: 0.00724:  37%|███▋      | 75/201 [01:07<01:49,  1.15it/s]Loss: 0.00724:  38%|███▊      | 76/201 [01:08<01:48,  1.15it/s]Loss: 0.00717:  38%|███▊      | 76/201 [01:08<01:48,  1.15it/s]Loss: 0.00717:  38%|███▊      | 77/201 [01:08<01:47,  1.15it/s]Loss: 0.00717:  38%|███▊      | 77/201 [01:08<01:47,  1.15it/s]Loss: 0.00717:  39%|███▉      | 78/201 [01:09<01:47,  1.15it/s]Loss: 0.00706:  39%|███▉      | 78/201 [01:09<01:47,  1.15it/s]Loss: 0.00706:  39%|███▉      | 79/201 [01:10<01:46,  1.15it/s]Loss: 0.00702:  39%|███▉      | 79/201 [01:10<01:46,  1.15it/s]Loss: 0.00702:  40%|███▉      | 80/201 [01:11<01:45,  1.15it/s]Loss: 0.00695:  40%|███▉      | 80/201 [01:11<01:45,  1.15it/s]Loss: 0.00695:  40%|████      | 81/201 [01:12<01:45,  1.14it/s]Loss: 0.00689:  40%|████      | 81/201 [01:12<01:45,  1.14it/s]Loss: 0.00689:  41%|████      | 82/201 [01:13<01:44,  1.14it/s]Loss: 0.00685:  41%|████      | 82/201 [01:13<01:44,  1.14it/s]Loss: 0.00685:  41%|████▏     | 83/201 [01:14<01:43,  1.15it/s]Loss: 0.00762:  41%|████▏     | 83/201 [01:14<01:43,  1.15it/s]Loss: 0.00762:  42%|████▏     | 84/201 [01:15<01:42,  1.15it/s]Loss: 0.00700:  42%|████▏     | 84/201 [01:15<01:42,  1.15it/s]Loss: 0.00700:  42%|████▏     | 85/201 [01:15<01:41,  1.15it/s]Loss: 0.00742:  42%|████▏     | 85/201 [01:15<01:41,  1.15it/s]Loss: 0.00742:  43%|████▎     | 86/201 [01:16<01:40,  1.15it/s]Loss: 0.00724:  43%|████▎     | 86/201 [01:16<01:40,  1.15it/s]Loss: 0.00724:  43%|████▎     | 87/201 [01:17<01:39,  1.15it/s]Loss: 0.00748:  43%|████▎     | 87/201 [01:17<01:39,  1.15it/s]Loss: 0.00748:  44%|████▍     | 88/201 [01:18<01:38,  1.15it/s]Loss: 0.00732:  44%|████▍     | 88/201 [01:18<01:38,  1.15it/s]Loss: 0.00732:  44%|████▍     | 89/201 [01:19<01:37,  1.15it/s]Loss: 0.00717:  44%|████▍     | 89/201 [01:19<01:37,  1.15it/s]Loss: 0.00717:  45%|████▍     | 90/201 [01:20<01:36,  1.15it/s]Loss: 0.00723:  45%|████▍     | 90/201 [01:20<01:36,  1.15it/s]Loss: 0.00723:  45%|████▌     | 91/201 [01:21<01:35,  1.15it/s]Loss: 0.00715:  45%|████▌     | 91/201 [01:21<01:35,  1.15it/s]Loss: 0.00715:  46%|████▌     | 92/201 [01:22<01:34,  1.15it/s]Loss: 0.00711:  46%|████▌     | 92/201 [01:22<01:34,  1.15it/s]Loss: 0.00711:  46%|████▋     | 93/201 [01:22<01:34,  1.15it/s]Loss: 0.00705:  46%|████▋     | 93/201 [01:22<01:34,  1.15it/s]Loss: 0.00705:  47%|████▋     | 94/201 [01:23<01:33,  1.15it/s]Loss: 0.00702:  47%|████▋     | 94/201 [01:23<01:33,  1.15it/s]Loss: 0.00702:  47%|████▋     | 95/201 [01:24<01:32,  1.15it/s]Loss: 0.00700:  47%|████▋     | 95/201 [01:24<01:32,  1.15it/s]Loss: 0.00700:  48%|████▊     | 96/201 [01:25<01:31,  1.15it/s]Loss: 0.00704:  48%|████▊     | 96/201 [01:25<01:31,  1.15it/s]Loss: 0.00704:  48%|████▊     | 97/201 [01:26<01:30,  1.15it/s]Loss: 0.00683:  48%|████▊     | 97/201 [01:26<01:30,  1.15it/s]Loss: 0.00683:  49%|████▉     | 98/201 [01:27<01:29,  1.15it/s]Loss: 0.00673:  49%|████▉     | 98/201 [01:27<01:29,  1.15it/s]Loss: 0.00673:  49%|████▉     | 99/201 [01:28<01:28,  1.15it/s]Loss: 0.00678:  49%|████▉     | 99/201 [01:28<01:28,  1.15it/s]Loss: 0.00678:  50%|████▉     | 100/201 [01:29<01:27,  1.15it/s]Loss: 0.00688:  50%|████▉     | 100/201 [01:29<01:27,  1.15it/s]Loss: 0.00688:  50%|█████     | 101/201 [01:29<01:27,  1.14it/s]Loss: 0.00680:  50%|█████     | 101/201 [01:29<01:27,  1.14it/s]max loss: 0.5882943868637085
Densities: min=0.0, max=0.9998617768287659, mean=0.08041762560606003
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.63s/it][A1it [00:01,  1.63s/it]
Loss: 0.00680:  51%|█████     | 102/201 [01:32<02:15,  1.37s/it]Loss: 0.01609:  51%|█████     | 102/201 [01:32<02:15,  1.37s/it]Loss: 0.01609:  51%|█████     | 103/201 [01:33<01:59,  1.22s/it]Loss: 0.01203:  51%|█████     | 103/201 [01:33<01:59,  1.22s/it]Loss: 0.01203:  52%|█████▏    | 104/201 [01:34<01:47,  1.11s/it]Loss: 0.01088:  52%|█████▏    | 104/201 [01:34<01:47,  1.11s/it]Loss: 0.01088:  52%|█████▏    | 105/201 [01:35<01:39,  1.04s/it]Loss: 0.01077:  52%|█████▏    | 105/201 [01:35<01:39,  1.04s/it]Loss: 0.01077:  53%|█████▎    | 106/201 [01:35<01:33,  1.01it/s]Loss: 0.01025:  53%|█████▎    | 106/201 [01:35<01:33,  1.01it/s]Loss: 0.01025:  53%|█████▎    | 107/201 [01:36<01:29,  1.05it/s]Loss: 0.01006:  53%|█████▎    | 107/201 [01:36<01:29,  1.05it/s]Loss: 0.01006:  54%|█████▎    | 108/201 [01:37<01:26,  1.08it/s]Loss: 0.00986:  54%|█████▎    | 108/201 [01:37<01:26,  1.08it/s]Loss: 0.00986:  54%|█████▍    | 109/201 [01:38<01:23,  1.10it/s]Loss: 0.00966:  54%|█████▍    | 109/201 [01:38<01:23,  1.10it/s]Loss: 0.00966:  55%|█████▍    | 110/201 [01:39<01:21,  1.11it/s]Loss: 0.00960:  55%|█████▍    | 110/201 [01:39<01:21,  1.11it/s]Loss: 0.00960:  55%|█████▌    | 111/201 [01:40<01:20,  1.12it/s]Loss: 0.00962:  55%|█████▌    | 111/201 [01:40<01:20,  1.12it/s]Loss: 0.00962:  56%|█████▌    | 112/201 [01:41<01:18,  1.13it/s]Loss: 0.00962:  56%|█████▌    | 112/201 [01:41<01:18,  1.13it/s]Loss: 0.00962:  56%|█████▌    | 113/201 [01:42<01:17,  1.14it/s]Loss: 0.00934:  56%|█████▌    | 113/201 [01:42<01:17,  1.14it/s]Loss: 0.00934:  57%|█████▋    | 114/201 [01:42<01:16,  1.14it/s]Loss: 0.00942:  57%|█████▋    | 114/201 [01:42<01:16,  1.14it/s]Loss: 0.00942:  57%|█████▋    | 115/201 [01:43<01:15,  1.14it/s]Loss: 0.00943:  57%|█████▋    | 115/201 [01:43<01:15,  1.14it/s]Loss: 0.00943:  58%|█████▊    | 116/201 [01:44<01:14,  1.15it/s]Loss: 0.00921:  58%|█████▊    | 116/201 [01:44<01:14,  1.15it/s]Loss: 0.00921:  58%|█████▊    | 117/201 [01:45<01:13,  1.15it/s]Loss: 0.00919:  58%|█████▊    | 117/201 [01:45<01:13,  1.15it/s]Loss: 0.00919:  59%|█████▊    | 118/201 [01:46<01:12,  1.15it/s]Loss: 0.00921:  59%|█████▊    | 118/201 [01:46<01:12,  1.15it/s]Loss: 0.00921:  59%|█████▉    | 119/201 [01:47<01:11,  1.15it/s]Loss: 0.00916:  59%|█████▉    | 119/201 [01:47<01:11,  1.15it/s]Loss: 0.00916:  60%|█████▉    | 120/201 [01:48<01:10,  1.15it/s]Loss: 0.00896:  60%|█████▉    | 120/201 [01:48<01:10,  1.15it/s]Loss: 0.00896:  60%|██████    | 121/201 [01:48<01:10,  1.14it/s]Loss: 0.00802:  60%|██████    | 121/201 [01:48<01:10,  1.14it/s]Loss: 0.00802:  61%|██████    | 122/201 [01:49<01:08,  1.15it/s]Loss: 0.00762:  61%|██████    | 122/201 [01:49<01:08,  1.15it/s]Loss: 0.00762:  61%|██████    | 123/201 [01:50<01:08,  1.15it/s]Loss: 0.00753:  61%|██████    | 123/201 [01:50<01:08,  1.15it/s]Loss: 0.00753:  62%|██████▏   | 124/201 [01:51<01:07,  1.15it/s]Loss: 0.00746:  62%|██████▏   | 124/201 [01:51<01:07,  1.15it/s]Loss: 0.00746:  62%|██████▏   | 125/201 [01:52<01:06,  1.15it/s]Loss: 0.00745:  62%|██████▏   | 125/201 [01:52<01:06,  1.15it/s]Loss: 0.00745:  63%|██████▎   | 126/201 [01:53<01:05,  1.15it/s]Loss: 0.00743:  63%|██████▎   | 126/201 [01:53<01:05,  1.15it/s]Loss: 0.00743:  63%|██████▎   | 127/201 [01:54<01:04,  1.15it/s]Loss: 0.00742:  63%|██████▎   | 127/201 [01:54<01:04,  1.15it/s]Loss: 0.00742:  64%|██████▎   | 128/201 [01:55<01:03,  1.15it/s]Loss: 0.00740:  64%|██████▎   | 128/201 [01:55<01:03,  1.15it/s]Loss: 0.00740:  64%|██████▍   | 129/201 [01:55<01:02,  1.15it/s]Loss: 0.00739:  64%|██████▍   | 129/201 [01:55<01:02,  1.15it/s]Loss: 0.00739:  65%|██████▍   | 130/201 [01:56<01:01,  1.15it/s]Loss: 0.00738:  65%|██████▍   | 130/201 [01:56<01:01,  1.15it/s]Loss: 0.00738:  65%|██████▌   | 131/201 [01:57<01:00,  1.15it/s]Loss: 0.00736:  65%|██████▌   | 131/201 [01:57<01:00,  1.15it/s]Loss: 0.00736:  66%|██████▌   | 132/201 [01:58<01:00,  1.15it/s]Loss: 0.00734:  66%|██████▌   | 132/201 [01:58<01:00,  1.15it/s]Loss: 0.00734:  66%|██████▌   | 133/201 [01:59<00:59,  1.15it/s]Loss: 0.00734:  66%|██████▌   | 133/201 [01:59<00:59,  1.15it/s]Loss: 0.00734:  67%|██████▋   | 134/201 [02:00<00:58,  1.15it/s]Loss: 0.00735:  67%|██████▋   | 134/201 [02:00<00:58,  1.15it/s]Loss: 0.00735:  67%|██████▋   | 135/201 [02:01<00:57,  1.15it/s]Loss: 0.00734:  67%|██████▋   | 135/201 [02:01<00:57,  1.15it/s]Loss: 0.00734:  68%|██████▊   | 136/201 [02:02<00:56,  1.15it/s]Loss: 0.00732:  68%|██████▊   | 136/201 [02:02<00:56,  1.15it/s]Loss: 0.00732:  68%|██████▊   | 137/201 [02:02<00:55,  1.15it/s]Loss: 0.00732:  68%|██████▊   | 137/201 [02:02<00:55,  1.15it/s]Loss: 0.00732:  69%|██████▊   | 138/201 [02:03<00:54,  1.15it/s]Loss: 0.00731:  69%|██████▊   | 138/201 [02:03<00:54,  1.15it/s]Loss: 0.00731:  69%|██████▉   | 139/201 [02:04<00:53,  1.15it/s]Loss: 0.00732:  69%|██████▉   | 139/201 [02:04<00:53,  1.15it/s]Loss: 0.00732:  70%|██████▉   | 140/201 [02:05<00:53,  1.15it/s]Loss: 0.00733:  70%|██████▉   | 140/201 [02:05<00:53,  1.15it/s]Loss: 0.00733:  70%|███████   | 141/201 [02:06<00:52,  1.14it/s]Loss: 0.00730:  70%|███████   | 141/201 [02:06<00:52,  1.14it/s]Loss: 0.00730:  71%|███████   | 142/201 [02:07<00:51,  1.14it/s]Loss: 0.00734:  71%|███████   | 142/201 [02:07<00:51,  1.14it/s]Loss: 0.00734:  71%|███████   | 143/201 [02:08<00:50,  1.15it/s]Loss: 0.00729:  71%|███████   | 143/201 [02:08<00:50,  1.15it/s]Loss: 0.00729:  72%|███████▏  | 144/201 [02:08<00:49,  1.15it/s]Loss: 0.00729:  72%|███████▏  | 144/201 [02:08<00:49,  1.15it/s]Loss: 0.00729:  72%|███████▏  | 145/201 [02:09<00:48,  1.15it/s]Loss: 0.00743:  72%|███████▏  | 145/201 [02:09<00:48,  1.15it/s]Loss: 0.00743:  73%|███████▎  | 146/201 [02:10<00:47,  1.15it/s]Loss: 0.00751:  73%|███████▎  | 146/201 [02:10<00:47,  1.15it/s]Loss: 0.00751:  73%|███████▎  | 147/201 [02:11<00:46,  1.15it/s]Loss: 0.00760:  73%|███████▎  | 147/201 [02:11<00:46,  1.15it/s]Loss: 0.00760:  74%|███████▎  | 148/201 [02:12<00:45,  1.15it/s]Loss: 0.00752:  74%|███████▎  | 148/201 [02:12<00:45,  1.15it/s]Loss: 0.00752:  74%|███████▍  | 149/201 [02:13<00:45,  1.16it/s]Loss: 0.00748:  74%|███████▍  | 149/201 [02:13<00:45,  1.16it/s]Loss: 0.00748:  75%|███████▍  | 150/201 [02:14<00:44,  1.16it/s]Loss: 0.00751:  75%|███████▍  | 150/201 [02:14<00:44,  1.16it/s]Loss: 0.00751:  75%|███████▌  | 151/201 [02:15<00:43,  1.16it/s]Loss: 0.00749:  75%|███████▌  | 151/201 [02:15<00:43,  1.16it/s]Loss: 0.00749:  76%|███████▌  | 152/201 [02:15<00:42,  1.15it/s]Loss: 0.00752:  76%|███████▌  | 152/201 [02:15<00:42,  1.15it/s]max loss: 0.2735735774040222
Densities: min=0.0, max=0.9999801516532898, mean=0.13976606726646423
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.61s/it][A1it [00:01,  1.61s/it]
Loss: 0.00752:  76%|███████▌  | 153/201 [02:18<01:04,  1.35s/it]Loss: 0.00965:  76%|███████▌  | 153/201 [02:18<01:04,  1.35s/it]Loss: 0.00965:  77%|███████▋  | 154/201 [02:19<00:56,  1.21s/it]Loss: 0.00958:  77%|███████▋  | 154/201 [02:19<00:56,  1.21s/it]Loss: 0.00958:  77%|███████▋  | 155/201 [02:20<00:50,  1.11s/it]Loss: 0.00947:  77%|███████▋  | 155/201 [02:20<00:50,  1.11s/it]Loss: 0.00947:  78%|███████▊  | 156/201 [02:21<00:46,  1.03s/it]Loss: 0.00937:  78%|███████▊  | 156/201 [02:21<00:46,  1.03s/it]Loss: 0.00937:  78%|███████▊  | 157/201 [02:21<00:43,  1.02it/s]Loss: 0.00932:  78%|███████▊  | 157/201 [02:21<00:43,  1.02it/s]Loss: 0.00932:  79%|███████▊  | 158/201 [02:22<00:40,  1.05it/s]Loss: 0.00924:  79%|███████▊  | 158/201 [02:22<00:40,  1.05it/s]Loss: 0.00924:  79%|███████▉  | 159/201 [02:23<00:38,  1.08it/s]Loss: 0.00926:  79%|███████▉  | 159/201 [02:23<00:38,  1.08it/s]Loss: 0.00926:  80%|███████▉  | 160/201 [02:24<00:37,  1.10it/s]Loss: 0.00920:  80%|███████▉  | 160/201 [02:24<00:37,  1.10it/s]Loss: 0.00920:  80%|████████  | 161/201 [02:25<00:36,  1.11it/s]Loss: 0.00923:  80%|████████  | 161/201 [02:25<00:36,  1.11it/s]Loss: 0.00923:  81%|████████  | 162/201 [02:26<00:34,  1.12it/s]Loss: 0.00912:  81%|████████  | 162/201 [02:26<00:34,  1.12it/s]Loss: 0.00912:  81%|████████  | 163/201 [02:27<00:33,  1.13it/s]Loss: 0.00919:  81%|████████  | 163/201 [02:27<00:33,  1.13it/s]Loss: 0.00919:  82%|████████▏ | 164/201 [02:27<00:32,  1.14it/s]Loss: 0.00918:  82%|████████▏ | 164/201 [02:27<00:32,  1.14it/s]Loss: 0.00918:  82%|████████▏ | 165/201 [02:28<00:31,  1.14it/s]Loss: 0.00904:  82%|████████▏ | 165/201 [02:28<00:31,  1.14it/s]Loss: 0.00904:  83%|████████▎ | 166/201 [02:29<00:30,  1.14it/s]Loss: 0.00905:  83%|████████▎ | 166/201 [02:29<00:30,  1.14it/s]Loss: 0.00905:  83%|████████▎ | 167/201 [02:30<00:29,  1.15it/s]Loss: 0.00912:  83%|████████▎ | 167/201 [02:30<00:29,  1.15it/s]Loss: 0.00912:  84%|████████▎ | 168/201 [02:31<00:28,  1.15it/s]Loss: 0.00901:  84%|████████▎ | 168/201 [02:31<00:28,  1.15it/s]Loss: 0.00901:  84%|████████▍ | 169/201 [02:32<00:27,  1.15it/s]Loss: 0.00900:  84%|████████▍ | 169/201 [02:32<00:27,  1.15it/s]Loss: 0.00900:  85%|████████▍ | 170/201 [02:33<00:26,  1.15it/s]Loss: 0.00908:  85%|████████▍ | 170/201 [02:33<00:26,  1.15it/s]Loss: 0.00908:  85%|████████▌ | 171/201 [02:34<00:26,  1.15it/s]Loss: 0.00900:  85%|████████▌ | 171/201 [02:34<00:26,  1.15it/s]Loss: 0.00900:  86%|████████▌ | 172/201 [02:34<00:25,  1.15it/s]Loss: 0.00899:  86%|████████▌ | 172/201 [02:34<00:25,  1.15it/s]Loss: 0.00899:  86%|████████▌ | 173/201 [02:35<00:24,  1.15it/s]Loss: 0.00897:  86%|████████▌ | 173/201 [02:35<00:24,  1.15it/s]Loss: 0.00897:  87%|████████▋ | 174/201 [02:36<00:23,  1.15it/s]Loss: 0.00890:  87%|████████▋ | 174/201 [02:36<00:23,  1.15it/s]Loss: 0.00890:  87%|████████▋ | 175/201 [02:37<00:22,  1.15it/s]Loss: 0.00905:  87%|████████▋ | 175/201 [02:37<00:22,  1.15it/s]Loss: 0.00905:  88%|████████▊ | 176/201 [02:38<00:21,  1.15it/s]Loss: 0.00892:  88%|████████▊ | 176/201 [02:38<00:21,  1.15it/s]Loss: 0.00892:  88%|████████▊ | 177/201 [02:39<00:20,  1.15it/s]Loss: 0.00883:  88%|████████▊ | 177/201 [02:39<00:20,  1.15it/s]Loss: 0.00883:  89%|████████▊ | 178/201 [02:40<00:19,  1.15it/s]Loss: 0.00882:  89%|████████▊ | 178/201 [02:40<00:19,  1.15it/s]Loss: 0.00882:  89%|████████▉ | 179/201 [02:41<00:19,  1.15it/s]Loss: 0.00894:  89%|████████▉ | 179/201 [02:41<00:19,  1.15it/s]Loss: 0.00894:  90%|████████▉ | 180/201 [02:41<00:18,  1.15it/s]Loss: 0.00889:  90%|████████▉ | 180/201 [02:41<00:18,  1.15it/s]Loss: 0.00889:  90%|█████████ | 181/201 [02:42<00:17,  1.14it/s]Loss: 0.00878:  90%|█████████ | 181/201 [02:42<00:17,  1.14it/s]Loss: 0.00878:  91%|█████████ | 182/201 [02:43<00:16,  1.15it/s]Loss: 0.00880:  91%|█████████ | 182/201 [02:43<00:16,  1.15it/s]Loss: 0.00880:  91%|█████████ | 183/201 [02:44<00:15,  1.15it/s]Loss: 0.00879:  91%|█████████ | 183/201 [02:44<00:15,  1.15it/s]Loss: 0.00879:  92%|█████████▏| 184/201 [02:45<00:14,  1.15it/s]Loss: 0.00876:  92%|█████████▏| 184/201 [02:45<00:14,  1.15it/s]Loss: 0.00876:  92%|█████████▏| 185/201 [02:46<00:13,  1.15it/s]Loss: 0.00881:  92%|█████████▏| 185/201 [02:46<00:13,  1.15it/s]Loss: 0.00881:  93%|█████████▎| 186/201 [02:47<00:13,  1.15it/s]Loss: 0.00876:  93%|█████████▎| 186/201 [02:47<00:13,  1.15it/s]Loss: 0.00876:  93%|█████████▎| 187/201 [02:47<00:12,  1.15it/s]Loss: 0.00884:  93%|█████████▎| 187/201 [02:47<00:12,  1.15it/s]Loss: 0.00884:  94%|█████████▎| 188/201 [02:48<00:11,  1.15it/s]Loss: 0.00882:  94%|█████████▎| 188/201 [02:48<00:11,  1.15it/s]Loss: 0.00882:  94%|█████████▍| 189/201 [02:49<00:10,  1.15it/s]Loss: 0.00869:  94%|█████████▍| 189/201 [02:49<00:10,  1.15it/s]Loss: 0.00869:  95%|█████████▍| 190/201 [02:50<00:09,  1.15it/s]Loss: 0.00867:  95%|█████████▍| 190/201 [02:50<00:09,  1.15it/s]Loss: 0.00867:  95%|█████████▌| 191/201 [02:51<00:08,  1.15it/s]Loss: 0.00875:  95%|█████████▌| 191/201 [02:51<00:08,  1.15it/s]Loss: 0.00875:  96%|█████████▌| 192/201 [02:52<00:07,  1.15it/s]Loss: 0.00862:  96%|█████████▌| 192/201 [02:52<00:07,  1.15it/s]Loss: 0.00862:  96%|█████████▌| 193/201 [02:53<00:06,  1.15it/s]Loss: 0.00871:  96%|█████████▌| 193/201 [02:53<00:06,  1.15it/s]Loss: 0.00871:  97%|█████████▋| 194/201 [02:54<00:06,  1.15it/s]Loss: 0.00872:  97%|█████████▋| 194/201 [02:54<00:06,  1.15it/s]Loss: 0.00872:  97%|█████████▋| 195/201 [02:54<00:05,  1.15it/s]Loss: 0.00866:  97%|█████████▋| 195/201 [02:54<00:05,  1.15it/s]Loss: 0.00866:  98%|█████████▊| 196/201 [02:55<00:04,  1.15it/s]Loss: 0.00857:  98%|█████████▊| 196/201 [02:55<00:04,  1.15it/s]Loss: 0.00857:  98%|█████████▊| 197/201 [02:56<00:03,  1.15it/s]Loss: 0.00863:  98%|█████████▊| 197/201 [02:56<00:03,  1.15it/s]Loss: 0.00863:  99%|█████████▊| 198/201 [02:57<00:02,  1.15it/s]Loss: 0.00859:  99%|█████████▊| 198/201 [02:57<00:02,  1.15it/s]Loss: 0.00859:  99%|█████████▉| 199/201 [02:58<00:01,  1.15it/s]Loss: 0.00851:  99%|█████████▉| 199/201 [02:58<00:01,  1.15it/s]Loss: 0.00851: 100%|█████████▉| 200/201 [02:59<00:00,  1.15it/s]Loss: 0.00844: 100%|█████████▉| 200/201 [02:59<00:00,  1.15it/s]Loss: 0.00844: 100%|██████████| 201/201 [03:00<00:00,  1.14it/s]Loss: 0.00849: 100%|██████████| 201/201 [03:00<00:00,  1.14it/s]Loss: 0.00849: 100%|██████████| 201/201 [03:00<00:00,  1.12it/s]Load volume "/media/storage0/qadwu/floats/mechhand_640x220x229_float32_raw_640x220x229_float.cvol"
Loaded

max loss: 0.15932218730449677
Densities: min=0.0, max=0.9998326301574707, mean=0.16149526834487915
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 180.18775510787964 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json
Latent space memory: 13.2MiB
Latent space memory: 13.2MiB
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Warps shared: 3 , warps mixed: 3
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/mechhand_640x220x229_float32_raw_640x220x229_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 17, 'n_features_per_level': 8, 'n_levels': 7, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 4, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 3462656
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.02it/s]1it [00:00,  3.02it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=0.999988317489624, mean=0.39815282821655273
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.46it/s]Render: : 1it [00:00,  2.46it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/mechhand.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.005, 'epochs': 200, 'lr_gamma': 0.8, 'lr_step': 10, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [640, 220, 229], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/mechhand-20220926010852-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 7, 'n_features_per_level': 8, 'log2_hashmap_size': 17, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 4}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<00:57,  3.49it/s]Loss: 0.18851:   0%|          | 1/201 [00:00<00:57,  3.49it/s]Loss: 0.18851:   1%|          | 2/201 [00:00<00:52,  3.82it/s]Loss: 0.06393:   1%|          | 2/201 [00:00<00:52,  3.82it/s]Loss: 0.06393:   1%|▏         | 3/201 [00:00<00:50,  3.93it/s]Loss: 0.04413:   1%|▏         | 3/201 [00:00<00:50,  3.93it/s]Loss: 0.04413:   2%|▏         | 4/201 [00:01<00:49,  3.98it/s]Loss: 0.03443:   2%|▏         | 4/201 [00:01<00:49,  3.98it/s]Loss: 0.03443:   2%|▏         | 5/201 [00:01<00:48,  4.01it/s]Loss: 0.02850:   2%|▏         | 5/201 [00:01<00:48,  4.01it/s]Loss: 0.02850:   3%|▎         | 6/201 [00:01<00:48,  4.03it/s]Loss: 0.02452:   3%|▎         | 6/201 [00:01<00:48,  4.03it/s]Loss: 0.02452:   3%|▎         | 7/201 [00:01<00:47,  4.05it/s]Loss: 0.02306:   3%|▎         | 7/201 [00:01<00:47,  4.05it/s]Loss: 0.02306:   4%|▍         | 8/201 [00:02<00:47,  4.05it/s]Loss: 0.02115:   4%|▍         | 8/201 [00:02<00:47,  4.05it/s]Loss: 0.02115:   4%|▍         | 9/201 [00:02<00:47,  4.06it/s]Loss: 0.01941:   4%|▍         | 9/201 [00:02<00:47,  4.06it/s]Loss: 0.01941:   5%|▍         | 10/201 [00:02<00:47,  4.06it/s]Loss: 0.01931:   5%|▍         | 10/201 [00:02<00:47,  4.06it/s]Loss: 0.01931:   5%|▌         | 11/201 [00:02<00:46,  4.07it/s]Loss: 0.01718:   5%|▌         | 11/201 [00:02<00:46,  4.07it/s]Loss: 0.01718:   6%|▌         | 12/201 [00:02<00:46,  4.07it/s]Loss: 0.01583:   6%|▌         | 12/201 [00:02<00:46,  4.07it/s]Loss: 0.01583:   6%|▋         | 13/201 [00:03<00:46,  4.07it/s]Loss: 0.01568:   6%|▋         | 13/201 [00:03<00:46,  4.07it/s]Loss: 0.01568:   7%|▋         | 14/201 [00:03<00:46,  4.06it/s]Loss: 0.01576:   7%|▋         | 14/201 [00:03<00:46,  4.06it/s]Loss: 0.01576:   7%|▋         | 15/201 [00:03<00:45,  4.05it/s]Loss: 0.01508:   7%|▋         | 15/201 [00:03<00:45,  4.05it/s]Loss: 0.01508:   8%|▊         | 16/201 [00:03<00:45,  4.06it/s]Loss: 0.01533:   8%|▊         | 16/201 [00:03<00:45,  4.06it/s]Loss: 0.01533:   8%|▊         | 17/201 [00:04<00:45,  4.06it/s]Loss: 0.01493:   8%|▊         | 17/201 [00:04<00:45,  4.06it/s]Loss: 0.01493:   9%|▉         | 18/201 [00:04<00:45,  4.06it/s]Loss: 0.01454:   9%|▉         | 18/201 [00:04<00:45,  4.06it/s]Loss: 0.01454:   9%|▉         | 19/201 [00:04<00:44,  4.06it/s]Loss: 0.01442:   9%|▉         | 19/201 [00:04<00:44,  4.06it/s]Loss: 0.01442:  10%|▉         | 20/201 [00:04<00:44,  4.06it/s]Loss: 0.01420:  10%|▉         | 20/201 [00:04<00:44,  4.06it/s]Loss: 0.01420:  10%|█         | 21/201 [00:05<00:45,  3.95it/s]Loss: 0.01311:  10%|█         | 21/201 [00:05<00:45,  3.95it/s]Loss: 0.01311:  11%|█         | 22/201 [00:05<00:44,  3.98it/s]Loss: 0.01250:  11%|█         | 22/201 [00:05<00:44,  3.98it/s]Loss: 0.01250:  11%|█▏        | 23/201 [00:05<00:44,  4.01it/s]Loss: 0.01250:  11%|█▏        | 23/201 [00:05<00:44,  4.01it/s]Loss: 0.01250:  12%|█▏        | 24/201 [00:05<00:43,  4.03it/s]Loss: 0.01224:  12%|█▏        | 24/201 [00:05<00:43,  4.03it/s]Loss: 0.01224:  12%|█▏        | 25/201 [00:06<00:43,  4.02it/s]Loss: 0.01259:  12%|█▏        | 25/201 [00:06<00:43,  4.02it/s]Loss: 0.01259:  13%|█▎        | 26/201 [00:06<00:43,  4.03it/s]Loss: 0.01260:  13%|█▎        | 26/201 [00:06<00:43,  4.03it/s]Loss: 0.01260:  13%|█▎        | 27/201 [00:06<00:43,  4.04it/s]Loss: 0.01232:  13%|█▎        | 27/201 [00:06<00:43,  4.04it/s]Loss: 0.01232:  14%|█▍        | 28/201 [00:06<00:42,  4.05it/s]Loss: 0.01218:  14%|█▍        | 28/201 [00:06<00:42,  4.05it/s]Loss: 0.01218:  14%|█▍        | 29/201 [00:07<00:42,  4.06it/s]Loss: 0.01239:  14%|█▍        | 29/201 [00:07<00:42,  4.06it/s]Loss: 0.01239:  15%|█▍        | 30/201 [00:07<00:42,  4.06it/s]Loss: 0.01204:  15%|█▍        | 30/201 [00:07<00:42,  4.06it/s]Loss: 0.01204:  15%|█▌        | 31/201 [00:07<00:41,  4.06it/s]Loss: 0.01151:  15%|█▌        | 31/201 [00:07<00:41,  4.06it/s]Loss: 0.01151:  16%|█▌        | 32/201 [00:07<00:41,  4.07it/s]Loss: 0.01098:  16%|█▌        | 32/201 [00:07<00:41,  4.07it/s]Loss: 0.01098:  16%|█▋        | 33/201 [00:08<00:41,  4.07it/s]Loss: 0.01095:  16%|█▋        | 33/201 [00:08<00:41,  4.07it/s]Loss: 0.01095:  17%|█▋        | 34/201 [00:08<00:41,  4.07it/s]Loss: 0.01100:  17%|█▋        | 34/201 [00:08<00:41,  4.07it/s]Loss: 0.01100:  17%|█▋        | 35/201 [00:08<00:40,  4.07it/s]Loss: 0.01101:  17%|█▋        | 35/201 [00:08<00:40,  4.07it/s]Loss: 0.01101:  18%|█▊        | 36/201 [00:08<00:40,  4.07it/s]Loss: 0.01102:  18%|█▊        | 36/201 [00:08<00:40,  4.07it/s]Loss: 0.01102:  18%|█▊        | 37/201 [00:09<00:40,  4.07it/s]Loss: 0.01100:  18%|█▊        | 37/201 [00:09<00:40,  4.07it/s]Loss: 0.01100:  19%|█▉        | 38/201 [00:09<00:40,  4.07it/s]Loss: 0.01096:  19%|█▉        | 38/201 [00:09<00:40,  4.07it/s]Loss: 0.01096:  19%|█▉        | 39/201 [00:09<00:39,  4.07it/s]Loss: 0.01081:  19%|█▉        | 39/201 [00:09<00:39,  4.07it/s]Loss: 0.01081:  20%|█▉        | 40/201 [00:09<00:39,  4.07it/s]Loss: 0.01086:  20%|█▉        | 40/201 [00:09<00:39,  4.07it/s]Loss: 0.01086:  20%|██        | 41/201 [00:10<00:40,  3.97it/s]Loss: 0.01023:  20%|██        | 41/201 [00:10<00:40,  3.97it/s]Loss: 0.01023:  21%|██        | 42/201 [00:10<00:39,  4.00it/s]Loss: 0.01007:  21%|██        | 42/201 [00:10<00:39,  4.00it/s]Loss: 0.01007:  21%|██▏       | 43/201 [00:10<00:39,  4.02it/s]Loss: 0.00997:  21%|██▏       | 43/201 [00:10<00:39,  4.02it/s]Loss: 0.00997:  22%|██▏       | 44/201 [00:10<00:38,  4.04it/s]Loss: 0.01001:  22%|██▏       | 44/201 [00:10<00:38,  4.04it/s]Loss: 0.01001:  22%|██▏       | 45/201 [00:11<00:38,  4.05it/s]Loss: 0.01005:  22%|██▏       | 45/201 [00:11<00:38,  4.05it/s]Loss: 0.01005:  23%|██▎       | 46/201 [00:11<00:38,  4.06it/s]Loss: 0.01016:  23%|██▎       | 46/201 [00:11<00:38,  4.06it/s]Loss: 0.01016:  23%|██▎       | 47/201 [00:11<00:37,  4.06it/s]Loss: 0.01002:  23%|██▎       | 47/201 [00:11<00:37,  4.06it/s]Loss: 0.01002:  24%|██▍       | 48/201 [00:11<00:37,  4.06it/s]Loss: 0.01018:  24%|██▍       | 48/201 [00:11<00:37,  4.06it/s]Loss: 0.01018:  24%|██▍       | 49/201 [00:12<00:37,  4.07it/s]Loss: 0.00994:  24%|██▍       | 49/201 [00:12<00:37,  4.07it/s]Loss: 0.00994:  25%|██▍       | 50/201 [00:12<00:37,  4.07it/s]Loss: 0.01016:  25%|██▍       | 50/201 [00:12<00:37,  4.07it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.25s/it][A1it [00:01,  1.25s/it]
Loss: 0.01016:  25%|██▌       | 51/201 [00:13<01:33,  1.60it/s]Loss: 0.00633:  25%|██▌       | 51/201 [00:13<01:33,  1.60it/s]Loss: 0.00633:  26%|██▌       | 52/201 [00:14<01:16,  1.96it/s]Loss: 0.00511:  26%|██▌       | 52/201 [00:14<01:16,  1.96it/s]Loss: 0.00511:  26%|██▋       | 53/201 [00:14<01:03,  2.32it/s]Loss: 0.00466:  26%|██▋       | 53/201 [00:14<01:03,  2.32it/s]Loss: 0.00466:  27%|██▋       | 54/201 [00:14<00:55,  2.66it/s]Loss: 0.00439:  27%|██▋       | 54/201 [00:14<00:55,  2.66it/s]Loss: 0.00439:  27%|██▋       | 55/201 [00:14<00:49,  2.97it/s]Loss: 0.00421:  27%|██▋       | 55/201 [00:14<00:49,  2.97it/s]Loss: 0.00421:  28%|██▊       | 56/201 [00:15<00:44,  3.23it/s]Loss: 0.00406:  28%|██▊       | 56/201 [00:15<00:44,  3.23it/s]Loss: 0.00406:  28%|██▊       | 57/201 [00:15<00:41,  3.44it/s]Loss: 0.00394:  28%|██▊       | 57/201 [00:15<00:41,  3.44it/s]Loss: 0.00394:  29%|██▉       | 58/201 [00:15<00:39,  3.61it/s]Loss: 0.00383:  29%|██▉       | 58/201 [00:15<00:39,  3.61it/s]Loss: 0.00383:  29%|██▉       | 59/201 [00:15<00:38,  3.73it/s]Loss: 0.00374:  29%|██▉       | 59/201 [00:15<00:38,  3.73it/s]Loss: 0.00374:  30%|██▉       | 60/201 [00:16<00:36,  3.83it/s]Loss: 0.00367:  30%|██▉       | 60/201 [00:16<00:36,  3.83it/s]Loss: 0.00367:  30%|███       | 61/201 [00:16<00:36,  3.80it/s]Loss: 0.00356:  30%|███       | 61/201 [00:16<00:36,  3.80it/s]Loss: 0.00356:  31%|███       | 62/201 [00:16<00:35,  3.88it/s]Loss: 0.00348:  31%|███       | 62/201 [00:16<00:35,  3.88it/s]Loss: 0.00348:  31%|███▏      | 63/201 [00:16<00:35,  3.93it/s]Loss: 0.00343:  31%|███▏      | 63/201 [00:16<00:35,  3.93it/s]Loss: 0.00343:  32%|███▏      | 64/201 [00:17<00:34,  3.97it/s]Loss: 0.00338:  32%|███▏      | 64/201 [00:17<00:34,  3.97it/s]Loss: 0.00338:  32%|███▏      | 65/201 [00:17<00:34,  4.00it/s]Loss: 0.00334:  32%|███▏      | 65/201 [00:17<00:34,  4.00it/s]Loss: 0.00334:  33%|███▎      | 66/201 [00:17<00:33,  4.02it/s]Loss: 0.00330:  33%|███▎      | 66/201 [00:17<00:33,  4.02it/s]Loss: 0.00330:  33%|███▎      | 67/201 [00:17<00:33,  4.04it/s]Loss: 0.00326:  33%|███▎      | 67/201 [00:17<00:33,  4.04it/s]Loss: 0.00326:  34%|███▍      | 68/201 [00:18<00:32,  4.05it/s]Loss: 0.00322:  34%|███▍      | 68/201 [00:18<00:32,  4.05it/s]Loss: 0.00322:  34%|███▍      | 69/201 [00:18<00:32,  4.05it/s]Loss: 0.00319:  34%|███▍      | 69/201 [00:18<00:32,  4.05it/s]Loss: 0.00319:  35%|███▍      | 70/201 [00:18<00:32,  4.06it/s]Loss: 0.00316:  35%|███▍      | 70/201 [00:18<00:32,  4.06it/s]Loss: 0.00316:  35%|███▌      | 71/201 [00:18<00:32,  4.06it/s]Loss: 0.00309:  35%|███▌      | 71/201 [00:18<00:32,  4.06it/s]Loss: 0.00309:  36%|███▌      | 72/201 [00:19<00:31,  4.06it/s]Loss: 0.00305:  36%|███▌      | 72/201 [00:19<00:31,  4.06it/s]Loss: 0.00305:  36%|███▋      | 73/201 [00:19<00:31,  4.07it/s]Loss: 0.00302:  36%|███▋      | 73/201 [00:19<00:31,  4.07it/s]Loss: 0.00302:  37%|███▋      | 74/201 [00:19<00:31,  4.07it/s]Loss: 0.00300:  37%|███▋      | 74/201 [00:19<00:31,  4.07it/s]Loss: 0.00300:  37%|███▋      | 75/201 [00:19<00:30,  4.07it/s]Loss: 0.00297:  37%|███▋      | 75/201 [00:19<00:30,  4.07it/s]Loss: 0.00297:  38%|███▊      | 76/201 [00:20<00:30,  4.07it/s]Loss: 0.00296:  38%|███▊      | 76/201 [00:20<00:30,  4.07it/s]Loss: 0.00296:  38%|███▊      | 77/201 [00:20<00:30,  4.07it/s]Loss: 0.00293:  38%|███▊      | 77/201 [00:20<00:30,  4.07it/s]Loss: 0.00293:  39%|███▉      | 78/201 [00:20<00:30,  4.07it/s]Loss: 0.00291:  39%|███▉      | 78/201 [00:20<00:30,  4.07it/s]Loss: 0.00291:  39%|███▉      | 79/201 [00:20<00:30,  4.07it/s]Loss: 0.00290:  39%|███▉      | 79/201 [00:20<00:30,  4.07it/s]Loss: 0.00290:  40%|███▉      | 80/201 [00:21<00:29,  4.07it/s]Loss: 0.00287:  40%|███▉      | 80/201 [00:21<00:29,  4.07it/s]Loss: 0.00287:  40%|████      | 81/201 [00:21<00:30,  3.97it/s]Loss: 0.00283:  40%|████      | 81/201 [00:21<00:30,  3.97it/s]Loss: 0.00283:  41%|████      | 82/201 [00:21<00:29,  4.00it/s]Loss: 0.00280:  41%|████      | 82/201 [00:21<00:29,  4.00it/s]Loss: 0.00280:  41%|████▏     | 83/201 [00:21<00:29,  4.02it/s]Loss: 0.00278:  41%|████▏     | 83/201 [00:21<00:29,  4.02it/s]Loss: 0.00278:  42%|████▏     | 84/201 [00:22<00:29,  4.03it/s]Loss: 0.00276:  42%|████▏     | 84/201 [00:22<00:29,  4.03it/s]Loss: 0.00276:  42%|████▏     | 85/201 [00:22<00:28,  4.05it/s]Loss: 0.00275:  42%|████▏     | 85/201 [00:22<00:28,  4.05it/s]Loss: 0.00275:  43%|████▎     | 86/201 [00:22<00:28,  4.05it/s]Loss: 0.00274:  43%|████▎     | 86/201 [00:22<00:28,  4.05it/s]Loss: 0.00274:  43%|████▎     | 87/201 [00:22<00:28,  4.06it/s]Loss: 0.00273:  43%|████▎     | 87/201 [00:22<00:28,  4.06it/s]Loss: 0.00273:  44%|████▍     | 88/201 [00:23<00:27,  4.07it/s]Loss: 0.00271:  44%|████▍     | 88/201 [00:23<00:27,  4.07it/s]Loss: 0.00271:  44%|████▍     | 89/201 [00:23<00:27,  4.07it/s]Loss: 0.00270:  44%|████▍     | 89/201 [00:23<00:27,  4.07it/s]Loss: 0.00270:  45%|████▍     | 90/201 [00:23<00:27,  4.07it/s]Loss: 0.00269:  45%|████▍     | 90/201 [00:23<00:27,  4.07it/s]Loss: 0.00269:  45%|████▌     | 91/201 [00:23<00:26,  4.07it/s]Loss: 0.00265:  45%|████▌     | 91/201 [00:23<00:26,  4.07it/s]Loss: 0.00265:  46%|████▌     | 92/201 [00:24<00:26,  4.07it/s]Loss: 0.00263:  46%|████▌     | 92/201 [00:24<00:26,  4.07it/s]Loss: 0.00263:  46%|████▋     | 93/201 [00:24<00:26,  4.07it/s]Loss: 0.00261:  46%|████▋     | 93/201 [00:24<00:26,  4.07it/s]Loss: 0.00261:  47%|████▋     | 94/201 [00:24<00:26,  4.07it/s]Loss: 0.00260:  47%|████▋     | 94/201 [00:24<00:26,  4.07it/s]Loss: 0.00260:  47%|████▋     | 95/201 [00:24<00:26,  4.07it/s]Loss: 0.00259:  47%|████▋     | 95/201 [00:24<00:26,  4.07it/s]Loss: 0.00259:  48%|████▊     | 96/201 [00:24<00:25,  4.08it/s]Loss: 0.00259:  48%|████▊     | 96/201 [00:24<00:25,  4.08it/s]Loss: 0.00259:  48%|████▊     | 97/201 [00:25<00:25,  4.08it/s]Loss: 0.00257:  48%|████▊     | 97/201 [00:25<00:25,  4.08it/s]Loss: 0.00257:  49%|████▉     | 98/201 [00:25<00:25,  4.08it/s]Loss: 0.00257:  49%|████▉     | 98/201 [00:25<00:25,  4.08it/s]Loss: 0.00257:  49%|████▉     | 99/201 [00:25<00:25,  4.08it/s]Loss: 0.00256:  49%|████▉     | 99/201 [00:25<00:25,  4.08it/s]Loss: 0.00256:  50%|████▉     | 100/201 [00:25<00:24,  4.08it/s]Loss: 0.00255:  50%|████▉     | 100/201 [00:25<00:24,  4.08it/s]Loss: 0.00255:  50%|█████     | 101/201 [00:26<00:25,  3.96it/s]Loss: 0.00252:  50%|█████     | 101/201 [00:26<00:25,  3.96it/s]max loss: 0.5805240869522095
Densities: min=0.0, max=0.9999546408653259, mean=0.0708240196108818
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.30s/it][A1it [00:01,  1.30s/it]
Loss: 0.00252:  51%|█████     | 102/201 [00:27<01:03,  1.55it/s]Loss: 0.00969:  51%|█████     | 102/201 [00:27<01:03,  1.55it/s]Loss: 0.00969:  51%|█████     | 103/201 [00:28<00:51,  1.91it/s]Loss: 0.00898:  51%|█████     | 103/201 [00:28<00:51,  1.91it/s]Loss: 0.00898:  52%|█████▏    | 104/201 [00:28<00:42,  2.28it/s]Loss: 0.00857:  52%|█████▏    | 104/201 [00:28<00:42,  2.28it/s]Loss: 0.00857:  52%|█████▏    | 105/201 [00:28<00:36,  2.63it/s]Loss: 0.00829:  52%|█████▏    | 105/201 [00:28<00:36,  2.63it/s]Loss: 0.00829:  53%|█████▎    | 106/201 [00:28<00:32,  2.95it/s]Loss: 0.00808:  53%|█████▎    | 106/201 [00:28<00:32,  2.95it/s]Loss: 0.00808:  53%|█████▎    | 107/201 [00:29<00:29,  3.20it/s]Loss: 0.00791:  53%|█████▎    | 107/201 [00:29<00:29,  3.20it/s]Loss: 0.00791:  54%|█████▎    | 108/201 [00:29<00:27,  3.41it/s]Loss: 0.00777:  54%|█████▎    | 108/201 [00:29<00:27,  3.41it/s]Loss: 0.00777:  54%|█████▍    | 109/201 [00:29<00:25,  3.59it/s]Loss: 0.00765:  54%|█████▍    | 109/201 [00:29<00:25,  3.59it/s]Loss: 0.00765:  55%|█████▍    | 110/201 [00:29<00:24,  3.73it/s]Loss: 0.00754:  55%|█████▍    | 110/201 [00:29<00:24,  3.73it/s]Loss: 0.00754:  55%|█████▌    | 111/201 [00:29<00:23,  3.84it/s]Loss: 0.00741:  55%|█████▌    | 111/201 [00:29<00:23,  3.84it/s]Loss: 0.00741:  56%|█████▌    | 112/201 [00:30<00:22,  3.92it/s]Loss: 0.00733:  56%|█████▌    | 112/201 [00:30<00:22,  3.92it/s]Loss: 0.00733:  56%|█████▌    | 113/201 [00:30<00:22,  3.97it/s]Loss: 0.00726:  56%|█████▌    | 113/201 [00:30<00:22,  3.97it/s]Loss: 0.00726:  57%|█████▋    | 114/201 [00:30<00:21,  4.01it/s]Loss: 0.00720:  57%|█████▋    | 114/201 [00:30<00:21,  4.01it/s]Loss: 0.00720:  57%|█████▋    | 115/201 [00:30<00:21,  4.04it/s]Loss: 0.00714:  57%|█████▋    | 115/201 [00:30<00:21,  4.04it/s]Loss: 0.00714:  58%|█████▊    | 116/201 [00:31<00:20,  4.06it/s]Loss: 0.00709:  58%|█████▊    | 116/201 [00:31<00:20,  4.06it/s]Loss: 0.00709:  58%|█████▊    | 117/201 [00:31<00:20,  4.08it/s]Loss: 0.00705:  58%|█████▊    | 117/201 [00:31<00:20,  4.08it/s]Loss: 0.00705:  59%|█████▊    | 118/201 [00:31<00:20,  4.09it/s]Loss: 0.00700:  59%|█████▊    | 118/201 [00:31<00:20,  4.09it/s]Loss: 0.00700:  59%|█████▉    | 119/201 [00:31<00:20,  4.09it/s]Loss: 0.00696:  59%|█████▉    | 119/201 [00:31<00:20,  4.09it/s]Loss: 0.00696:  60%|█████▉    | 120/201 [00:32<00:19,  4.10it/s]Loss: 0.00691:  60%|█████▉    | 120/201 [00:32<00:19,  4.10it/s]Loss: 0.00691:  60%|██████    | 121/201 [00:32<00:20,  4.00it/s]Loss: 0.00684:  60%|██████    | 121/201 [00:32<00:20,  4.00it/s]Loss: 0.00684:  61%|██████    | 122/201 [00:32<00:19,  4.01it/s]Loss: 0.00680:  61%|██████    | 122/201 [00:32<00:19,  4.01it/s]Loss: 0.00680:  61%|██████    | 123/201 [00:32<00:19,  4.03it/s]Loss: 0.00677:  61%|██████    | 123/201 [00:32<00:19,  4.03it/s]Loss: 0.00677:  62%|██████▏   | 124/201 [00:33<00:18,  4.06it/s]Loss: 0.00674:  62%|██████▏   | 124/201 [00:33<00:18,  4.06it/s]Loss: 0.00674:  62%|██████▏   | 125/201 [00:33<00:18,  4.04it/s]Loss: 0.00671:  62%|██████▏   | 125/201 [00:33<00:18,  4.04it/s]Loss: 0.00671:  63%|██████▎   | 126/201 [00:33<00:18,  4.06it/s]Loss: 0.00668:  63%|██████▎   | 126/201 [00:33<00:18,  4.06it/s]Loss: 0.00668:  63%|██████▎   | 127/201 [00:33<00:18,  4.08it/s]Loss: 0.00666:  63%|██████▎   | 127/201 [00:33<00:18,  4.08it/s]Loss: 0.00666:  64%|██████▎   | 128/201 [00:34<00:17,  4.08it/s]Loss: 0.00663:  64%|██████▎   | 128/201 [00:34<00:17,  4.08it/s]Loss: 0.00663:  64%|██████▍   | 129/201 [00:34<00:17,  4.09it/s]Loss: 0.00661:  64%|██████▍   | 129/201 [00:34<00:17,  4.09it/s]Loss: 0.00661:  65%|██████▍   | 130/201 [00:34<00:17,  4.09it/s]Loss: 0.00658:  65%|██████▍   | 130/201 [00:34<00:17,  4.09it/s]Loss: 0.00658:  65%|██████▌   | 131/201 [00:34<00:17,  4.10it/s]Loss: 0.00654:  65%|██████▌   | 131/201 [00:34<00:17,  4.10it/s]Loss: 0.00654:  66%|██████▌   | 132/201 [00:35<00:16,  4.10it/s]Loss: 0.00651:  66%|██████▌   | 132/201 [00:35<00:16,  4.10it/s]Loss: 0.00651:  66%|██████▌   | 133/201 [00:35<00:16,  4.10it/s]Loss: 0.00649:  66%|██████▌   | 133/201 [00:35<00:16,  4.10it/s]Loss: 0.00649:  67%|██████▋   | 134/201 [00:35<00:16,  4.10it/s]Loss: 0.00647:  67%|██████▋   | 134/201 [00:35<00:16,  4.10it/s]Loss: 0.00647:  67%|██████▋   | 135/201 [00:35<00:16,  4.10it/s]Loss: 0.00645:  67%|██████▋   | 135/201 [00:35<00:16,  4.10it/s]Loss: 0.00645:  68%|██████▊   | 136/201 [00:36<00:15,  4.10it/s]Loss: 0.00644:  68%|██████▊   | 136/201 [00:36<00:15,  4.10it/s]Loss: 0.00644:  68%|██████▊   | 137/201 [00:36<00:15,  4.10it/s]Loss: 0.00642:  68%|██████▊   | 137/201 [00:36<00:15,  4.10it/s]Loss: 0.00642:  69%|██████▊   | 138/201 [00:36<00:15,  4.11it/s]Loss: 0.00640:  69%|██████▊   | 138/201 [00:36<00:15,  4.11it/s]Loss: 0.00640:  69%|██████▉   | 139/201 [00:36<00:15,  4.11it/s]Loss: 0.00639:  69%|██████▉   | 139/201 [00:36<00:15,  4.11it/s]Loss: 0.00639:  70%|██████▉   | 140/201 [00:37<00:14,  4.11it/s]Loss: 0.00637:  70%|██████▉   | 140/201 [00:37<00:14,  4.11it/s]Loss: 0.00637:  70%|███████   | 141/201 [00:37<00:14,  4.00it/s]Loss: 0.00634:  70%|███████   | 141/201 [00:37<00:14,  4.00it/s]Loss: 0.00634:  71%|███████   | 142/201 [00:37<00:14,  4.03it/s]Loss: 0.00632:  71%|███████   | 142/201 [00:37<00:14,  4.03it/s]Loss: 0.00632:  71%|███████   | 143/201 [00:37<00:14,  4.06it/s]Loss: 0.00630:  71%|███████   | 143/201 [00:37<00:14,  4.06it/s]Loss: 0.00630:  72%|███████▏  | 144/201 [00:38<00:14,  4.07it/s]Loss: 0.00629:  72%|███████▏  | 144/201 [00:38<00:14,  4.07it/s]Loss: 0.00629:  72%|███████▏  | 145/201 [00:38<00:13,  4.08it/s]Loss: 0.00628:  72%|███████▏  | 145/201 [00:38<00:13,  4.08it/s]Loss: 0.00628:  73%|███████▎  | 146/201 [00:38<00:13,  4.09it/s]Loss: 0.00627:  73%|███████▎  | 146/201 [00:38<00:13,  4.09it/s]Loss: 0.00627:  73%|███████▎  | 147/201 [00:38<00:13,  4.09it/s]Loss: 0.00626:  73%|███████▎  | 147/201 [00:38<00:13,  4.09it/s]Loss: 0.00626:  74%|███████▎  | 148/201 [00:39<00:12,  4.10it/s]Loss: 0.00625:  74%|███████▎  | 148/201 [00:39<00:12,  4.10it/s]Loss: 0.00625:  74%|███████▍  | 149/201 [00:39<00:12,  4.10it/s]Loss: 0.00624:  74%|███████▍  | 149/201 [00:39<00:12,  4.10it/s]Loss: 0.00624:  75%|███████▍  | 150/201 [00:39<00:12,  4.10it/s]Loss: 0.00622:  75%|███████▍  | 150/201 [00:39<00:12,  4.10it/s]Loss: 0.00622:  75%|███████▌  | 151/201 [00:39<00:12,  4.10it/s]Loss: 0.00620:  75%|███████▌  | 151/201 [00:39<00:12,  4.10it/s]Loss: 0.00620:  76%|███████▌  | 152/201 [00:40<00:11,  4.10it/s]Loss: 0.00619:  76%|███████▌  | 152/201 [00:40<00:11,  4.10it/s]max loss: 0.13711810111999512
Densities: min=0.0, max=0.9999451041221619, mean=0.17589974403381348
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.31s/it][A1it [00:01,  1.31s/it]
Loss: 0.00619:  76%|███████▌  | 153/201 [00:41<00:30,  1.56it/s]Loss: 0.00808:  76%|███████▌  | 153/201 [00:41<00:30,  1.56it/s]Loss: 0.00808:  77%|███████▋  | 154/201 [00:41<00:24,  1.92it/s]Loss: 0.00785:  77%|███████▋  | 154/201 [00:41<00:24,  1.92it/s]Loss: 0.00785:  77%|███████▋  | 155/201 [00:42<00:20,  2.28it/s]Loss: 0.00769:  77%|███████▋  | 155/201 [00:42<00:20,  2.28it/s]Loss: 0.00769:  78%|███████▊  | 156/201 [00:42<00:17,  2.63it/s]Loss: 0.00756:  78%|███████▊  | 156/201 [00:42<00:17,  2.63it/s]Loss: 0.00756:  78%|███████▊  | 157/201 [00:42<00:14,  2.95it/s]Loss: 0.00746:  78%|███████▊  | 157/201 [00:42<00:14,  2.95it/s]Loss: 0.00746:  79%|███████▊  | 158/201 [00:42<00:13,  3.22it/s]Loss: 0.00738:  79%|███████▊  | 158/201 [00:42<00:13,  3.22it/s]Loss: 0.00738:  79%|███████▉  | 159/201 [00:43<00:12,  3.45it/s]Loss: 0.00730:  79%|███████▉  | 159/201 [00:43<00:12,  3.45it/s]Loss: 0.00730:  80%|███████▉  | 160/201 [00:43<00:11,  3.62it/s]Loss: 0.00723:  80%|███████▉  | 160/201 [00:43<00:11,  3.62it/s]Loss: 0.00723:  80%|████████  | 161/201 [00:43<00:10,  3.67it/s]Loss: 0.00716:  80%|████████  | 161/201 [00:43<00:10,  3.67it/s]Loss: 0.00716:  81%|████████  | 162/201 [00:43<00:10,  3.79it/s]Loss: 0.00711:  81%|████████  | 162/201 [00:43<00:10,  3.79it/s]Loss: 0.00711:  81%|████████  | 163/201 [00:44<00:09,  3.88it/s]Loss: 0.00707:  81%|████████  | 163/201 [00:44<00:09,  3.88it/s]Loss: 0.00707:  82%|████████▏ | 164/201 [00:44<00:09,  3.94it/s]Loss: 0.00703:  82%|████████▏ | 164/201 [00:44<00:09,  3.94it/s]Loss: 0.00703:  82%|████████▏ | 165/201 [00:44<00:09,  3.99it/s]Loss: 0.00699:  82%|████████▏ | 165/201 [00:44<00:09,  3.99it/s]Loss: 0.00699:  83%|████████▎ | 166/201 [00:44<00:08,  4.02it/s]Loss: 0.00695:  83%|████████▎ | 166/201 [00:44<00:08,  4.02it/s]Loss: 0.00695:  83%|████████▎ | 167/201 [00:45<00:08,  4.05it/s]Loss: 0.00692:  83%|████████▎ | 167/201 [00:45<00:08,  4.05it/s]Loss: 0.00692:  84%|████████▎ | 168/201 [00:45<00:08,  4.07it/s]Loss: 0.00689:  84%|████████▎ | 168/201 [00:45<00:08,  4.07it/s]Loss: 0.00689:  84%|████████▍ | 169/201 [00:45<00:07,  4.08it/s]Loss: 0.00685:  84%|████████▍ | 169/201 [00:45<00:07,  4.08it/s]Loss: 0.00685:  85%|████████▍ | 170/201 [00:45<00:07,  3.90it/s]Loss: 0.00683:  85%|████████▍ | 170/201 [00:45<00:07,  3.90it/s]Loss: 0.00683:  85%|████████▌ | 171/201 [00:46<00:07,  3.94it/s]Loss: 0.00679:  85%|████████▌ | 171/201 [00:46<00:07,  3.94it/s]Loss: 0.00679:  86%|████████▌ | 172/201 [00:46<00:07,  3.99it/s]Loss: 0.00676:  86%|████████▌ | 172/201 [00:46<00:07,  3.99it/s]Loss: 0.00676:  86%|████████▌ | 173/201 [00:46<00:06,  4.02it/s]Loss: 0.00674:  86%|████████▌ | 173/201 [00:46<00:06,  4.02it/s]Loss: 0.00674:  87%|████████▋ | 174/201 [00:46<00:06,  4.05it/s]Loss: 0.00672:  87%|████████▋ | 174/201 [00:46<00:06,  4.05it/s]Loss: 0.00672:  87%|████████▋ | 175/201 [00:47<00:06,  4.06it/s]Loss: 0.00670:  87%|████████▋ | 175/201 [00:47<00:06,  4.06it/s]Loss: 0.00670:  88%|████████▊ | 176/201 [00:47<00:06,  4.08it/s]Loss: 0.00668:  88%|████████▊ | 176/201 [00:47<00:06,  4.08it/s]Loss: 0.00668:  88%|████████▊ | 177/201 [00:47<00:05,  4.09it/s]Loss: 0.00666:  88%|████████▊ | 177/201 [00:47<00:05,  4.09it/s]Loss: 0.00666:  89%|████████▊ | 178/201 [00:47<00:05,  4.09it/s]Loss: 0.00664:  89%|████████▊ | 178/201 [00:47<00:05,  4.09it/s]Loss: 0.00664:  89%|████████▉ | 179/201 [00:47<00:05,  4.09it/s]Loss: 0.00662:  89%|████████▉ | 179/201 [00:47<00:05,  4.09it/s]Loss: 0.00662:  90%|████████▉ | 180/201 [00:48<00:05,  4.10it/s]Loss: 0.00661:  90%|████████▉ | 180/201 [00:48<00:05,  4.10it/s]Loss: 0.00661:  90%|█████████ | 181/201 [00:48<00:05,  4.00it/s]Loss: 0.00658:  90%|█████████ | 181/201 [00:48<00:05,  4.00it/s]Loss: 0.00658:  91%|█████████ | 182/201 [00:48<00:04,  4.03it/s]Loss: 0.00657:  91%|█████████ | 182/201 [00:48<00:04,  4.03it/s]Loss: 0.00657:  91%|█████████ | 183/201 [00:48<00:04,  4.05it/s]Loss: 0.00655:  91%|█████████ | 183/201 [00:48<00:04,  4.05it/s]Loss: 0.00655:  92%|█████████▏| 184/201 [00:49<00:04,  4.05it/s]Loss: 0.00654:  92%|█████████▏| 184/201 [00:49<00:04,  4.05it/s]Loss: 0.00654:  92%|█████████▏| 185/201 [00:49<00:03,  4.06it/s]Loss: 0.00653:  92%|█████████▏| 185/201 [00:49<00:03,  4.06it/s]Loss: 0.00653:  93%|█████████▎| 186/201 [00:49<00:03,  4.07it/s]Loss: 0.00651:  93%|█████████▎| 186/201 [00:49<00:03,  4.07it/s]Loss: 0.00651:  93%|█████████▎| 187/201 [00:49<00:03,  4.08it/s]Loss: 0.00650:  93%|█████████▎| 187/201 [00:49<00:03,  4.08it/s]Loss: 0.00650:  94%|█████████▎| 188/201 [00:50<00:03,  4.09it/s]Loss: 0.00649:  94%|█████████▎| 188/201 [00:50<00:03,  4.09it/s]Loss: 0.00649:  94%|█████████▍| 189/201 [00:50<00:02,  4.10it/s]Loss: 0.00648:  94%|█████████▍| 189/201 [00:50<00:02,  4.10it/s]Loss: 0.00648:  95%|█████████▍| 190/201 [00:50<00:02,  4.10it/s]Loss: 0.00647:  95%|█████████▍| 190/201 [00:50<00:02,  4.10it/s]Loss: 0.00647:  95%|█████████▌| 191/201 [00:50<00:02,  4.10it/s]Loss: 0.00645:  95%|█████████▌| 191/201 [00:50<00:02,  4.10it/s]Loss: 0.00645:  96%|█████████▌| 192/201 [00:51<00:02,  4.11it/s]Loss: 0.00643:  96%|█████████▌| 192/201 [00:51<00:02,  4.11it/s]Loss: 0.00643:  96%|█████████▌| 193/201 [00:51<00:01,  4.11it/s]Loss: 0.00643:  96%|█████████▌| 193/201 [00:51<00:01,  4.11it/s]Loss: 0.00643:  97%|█████████▋| 194/201 [00:51<00:01,  4.11it/s]Loss: 0.00642:  97%|█████████▋| 194/201 [00:51<00:01,  4.11it/s]Loss: 0.00642:  97%|█████████▋| 195/201 [00:51<00:01,  4.10it/s]Loss: 0.00641:  97%|█████████▋| 195/201 [00:51<00:01,  4.10it/s]Loss: 0.00641:  98%|█████████▊| 196/201 [00:52<00:01,  4.10it/s]Loss: 0.00640:  98%|█████████▊| 196/201 [00:52<00:01,  4.10it/s]Loss: 0.00640:  98%|█████████▊| 197/201 [00:52<00:00,  4.10it/s]Loss: 0.00639:  98%|█████████▊| 197/201 [00:52<00:00,  4.10it/s]Loss: 0.00639:  99%|█████████▊| 198/201 [00:52<00:00,  4.10it/s]Loss: 0.00638:  99%|█████████▊| 198/201 [00:52<00:00,  4.10it/s]Loss: 0.00638:  99%|█████████▉| 199/201 [00:52<00:00,  4.10it/s]Loss: 0.00637:  99%|█████████▉| 199/201 [00:52<00:00,  4.10it/s]Loss: 0.00637: 100%|█████████▉| 200/201 [00:53<00:00,  4.10it/s]Loss: 0.00637: 100%|█████████▉| 200/201 [00:53<00:00,  4.10it/s]Loss: 0.00637: 100%|██████████| 201/201 [00:53<00:00,  4.00it/s]Loss: 0.00635: 100%|██████████| 201/201 [00:53<00:00,  4.00it/s]Loss: 0.00635: 100%|██████████| 201/201 [00:53<00:00,  3.76it/s]
max loss: 0.126156747341156
Densities: min=0.0, max=0.9998326301574707, mean=0.16883428394794464
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/mechhand_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 53.39927434921265 seconds
-1.0 2.0332031
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/chameleon_1024x1024x1080_float32_raw_1024x1024x1080_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json
Initialize network
Latent space memory: 57.4MiB
# of network parameters: 15072577
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.15it/s]1it [00:00,  3.15it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.3309548795223236
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.73it/s]Render: : 1it [00:00,  2.73it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 120, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 98, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1024, 1024, 1080], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<05:41,  1.71s/it]Loss: 0.10982:   0%|          | 1/201 [00:01<05:41,  1.71s/it]Loss: 0.10982:   1%|          | 2/201 [00:02<04:00,  1.21s/it]Loss: 0.02848:   1%|          | 2/201 [00:02<04:00,  1.21s/it]Loss: 0.02848:   1%|▏         | 3/201 [00:03<03:28,  1.05s/it]Loss: 0.02029:   1%|▏         | 3/201 [00:03<03:28,  1.05s/it]Loss: 0.02029:   2%|▏         | 4/201 [00:04<03:12,  1.02it/s]Loss: 0.01900:   2%|▏         | 4/201 [00:04<03:12,  1.02it/s]Loss: 0.01900:   2%|▏         | 5/201 [00:05<03:03,  1.07it/s]Loss: 0.01607:   2%|▏         | 5/201 [00:05<03:03,  1.07it/s]Loss: 0.01607:   3%|▎         | 6/201 [00:06<02:57,  1.10it/s]Loss: 0.01466:   3%|▎         | 6/201 [00:06<02:57,  1.10it/s]Loss: 0.01466:   3%|▎         | 7/201 [00:06<02:53,  1.12it/s]Loss: 0.01426:   3%|▎         | 7/201 [00:06<02:53,  1.12it/s]Loss: 0.01426:   4%|▍         | 8/201 [00:07<02:51,  1.13it/s]Loss: 0.01375:   4%|▍         | 8/201 [00:07<02:51,  1.13it/s]Loss: 0.01375:   4%|▍         | 9/201 [00:08<02:48,  1.14it/s]Loss: 0.01338:   4%|▍         | 9/201 [00:08<02:48,  1.14it/s]Loss: 0.01338:   5%|▍         | 10/201 [00:09<02:47,  1.14it/s]Loss: 0.01268:   5%|▍         | 10/201 [00:09<02:47,  1.14it/s]Loss: 0.01268:   5%|▌         | 11/201 [00:10<02:45,  1.15it/s]Loss: 0.01210:   5%|▌         | 11/201 [00:10<02:45,  1.15it/s]Loss: 0.01210:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.01210:   6%|▌         | 12/201 [00:11<02:44,  1.15it/s]Loss: 0.01210:   6%|▋         | 13/201 [00:12<02:43,  1.15it/s]Loss: 0.01187:   6%|▋         | 13/201 [00:12<02:43,  1.15it/s]Loss: 0.01187:   7%|▋         | 14/201 [00:12<02:42,  1.15it/s]Loss: 0.01170:   7%|▋         | 14/201 [00:12<02:42,  1.15it/s]Loss: 0.01170:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.01128:   7%|▋         | 15/201 [00:13<02:41,  1.15it/s]Loss: 0.01128:   8%|▊         | 16/201 [00:14<02:40,  1.15it/s]Loss: 0.01122:   8%|▊         | 16/201 [00:14<02:40,  1.15it/s]Loss: 0.01122:   8%|▊         | 17/201 [00:15<02:39,  1.16it/s]Loss: 0.01106:   8%|▊         | 17/201 [00:15<02:39,  1.16it/s]Loss: 0.01106:   9%|▉         | 18/201 [00:16<02:38,  1.16it/s]Loss: 0.01065:   9%|▉         | 18/201 [00:16<02:38,  1.16it/s]Loss: 0.01065:   9%|▉         | 19/201 [00:17<02:37,  1.16it/s]Loss: 0.01046:   9%|▉         | 19/201 [00:17<02:37,  1.16it/s]Loss: 0.01046:  10%|▉         | 20/201 [00:18<02:36,  1.16it/s]Loss: 0.01037:  10%|▉         | 20/201 [00:18<02:36,  1.16it/s]Loss: 0.01037:  10%|█         | 21/201 [00:19<02:43,  1.10it/s]Loss: 0.01048:  10%|█         | 21/201 [00:19<02:43,  1.10it/s]Loss: 0.01048:  11%|█         | 22/201 [00:20<02:40,  1.12it/s]Loss: 0.00999:  11%|█         | 22/201 [00:20<02:40,  1.12it/s]Loss: 0.00999:  11%|█▏        | 23/201 [00:20<02:37,  1.13it/s]Loss: 0.00985:  11%|█▏        | 23/201 [00:20<02:37,  1.13it/s]Loss: 0.00985:  12%|█▏        | 24/201 [00:21<02:35,  1.14it/s]Loss: 0.00966:  12%|█▏        | 24/201 [00:21<02:35,  1.14it/s]Loss: 0.00966:  12%|█▏        | 25/201 [00:22<02:33,  1.14it/s]Loss: 0.00973:  12%|█▏        | 25/201 [00:22<02:33,  1.14it/s]Loss: 0.00973:  13%|█▎        | 26/201 [00:23<02:32,  1.15it/s]Loss: 0.00952:  13%|█▎        | 26/201 [00:23<02:32,  1.15it/s]Loss: 0.00952:  13%|█▎        | 27/201 [00:24<02:31,  1.15it/s]Loss: 0.00939:  13%|█▎        | 27/201 [00:24<02:31,  1.15it/s]Loss: 0.00939:  14%|█▍        | 28/201 [00:25<02:30,  1.15it/s]Loss: 0.00949:  14%|█▍        | 28/201 [00:25<02:30,  1.15it/s]Loss: 0.00949:  14%|█▍        | 29/201 [00:26<02:29,  1.15it/s]Loss: 0.00951:  14%|█▍        | 29/201 [00:26<02:29,  1.15it/s]Loss: 0.00951:  15%|█▍        | 30/201 [00:26<02:28,  1.15it/s]Loss: 0.00910:  15%|█▍        | 30/201 [00:26<02:28,  1.15it/s]Loss: 0.00910:  15%|█▌        | 31/201 [00:27<02:27,  1.16it/s]Loss: 0.00921:  15%|█▌        | 31/201 [00:27<02:27,  1.16it/s]Loss: 0.00921:  16%|█▌        | 32/201 [00:28<02:26,  1.16it/s]Loss: 0.00875:  16%|█▌        | 32/201 [00:28<02:26,  1.16it/s]Loss: 0.00875:  16%|█▋        | 33/201 [00:29<02:25,  1.16it/s]Loss: 0.00870:  16%|█▋        | 33/201 [00:29<02:25,  1.16it/s]Loss: 0.00870:  17%|█▋        | 34/201 [00:30<02:24,  1.16it/s]Loss: 0.00852:  17%|█▋        | 34/201 [00:30<02:24,  1.16it/s]Loss: 0.00852:  17%|█▋        | 35/201 [00:31<02:23,  1.16it/s]Loss: 0.00833:  17%|█▋        | 35/201 [00:31<02:23,  1.16it/s]Loss: 0.00833:  18%|█▊        | 36/201 [00:32<02:22,  1.16it/s]Loss: 0.00843:  18%|█▊        | 36/201 [00:32<02:22,  1.16it/s]Loss: 0.00843:  18%|█▊        | 37/201 [00:32<02:21,  1.16it/s]Loss: 0.00848:  18%|█▊        | 37/201 [00:32<02:21,  1.16it/s]Loss: 0.00848:  19%|█▉        | 38/201 [00:33<02:20,  1.16it/s]Loss: 0.00828:  19%|█▉        | 38/201 [00:33<02:20,  1.16it/s]Loss: 0.00828:  19%|█▉        | 39/201 [00:34<02:20,  1.16it/s]Loss: 0.00822:  19%|█▉        | 39/201 [00:34<02:20,  1.16it/s]Loss: 0.00822:  20%|█▉        | 40/201 [00:35<02:19,  1.16it/s]Loss: 0.00797:  20%|█▉        | 40/201 [00:35<02:19,  1.16it/s]Loss: 0.00797:  20%|██        | 41/201 [00:36<02:25,  1.10it/s]Loss: 0.00798:  20%|██        | 41/201 [00:36<02:25,  1.10it/s]Loss: 0.00798:  21%|██        | 42/201 [00:37<02:22,  1.12it/s]Loss: 0.00799:  21%|██        | 42/201 [00:37<02:22,  1.12it/s]Loss: 0.00799:  21%|██▏       | 43/201 [00:38<02:19,  1.13it/s]Loss: 0.00806:  21%|██▏       | 43/201 [00:38<02:19,  1.13it/s]Loss: 0.00806:  22%|██▏       | 44/201 [00:39<02:18,  1.14it/s]Loss: 0.00802:  22%|██▏       | 44/201 [00:39<02:18,  1.14it/s]Loss: 0.00802:  22%|██▏       | 45/201 [00:40<02:16,  1.14it/s]Loss: 0.00794:  22%|██▏       | 45/201 [00:40<02:16,  1.14it/s]Loss: 0.00794:  23%|██▎       | 46/201 [00:40<02:15,  1.15it/s]Loss: 0.00778:  23%|██▎       | 46/201 [00:40<02:15,  1.15it/s]Loss: 0.00778:  23%|██▎       | 47/201 [00:41<02:14,  1.15it/s]Loss: 0.00769:  23%|██▎       | 47/201 [00:41<02:14,  1.15it/s]Loss: 0.00769:  24%|██▍       | 48/201 [00:42<02:12,  1.15it/s]Loss: 0.00781:  24%|██▍       | 48/201 [00:42<02:12,  1.15it/s]Loss: 0.00781:  24%|██▍       | 49/201 [00:43<02:12,  1.15it/s]Loss: 0.00778:  24%|██▍       | 49/201 [00:43<02:12,  1.15it/s]Loss: 0.00778:  25%|██▍       | 50/201 [00:44<02:11,  1.15it/s]Loss: 0.00777:  25%|██▍       | 50/201 [00:44<02:11,  1.15it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.52s/it][A1it [00:01,  1.52s/it]
Loss: 0.00777:  25%|██▌       | 51/201 [00:46<03:23,  1.36s/it]Loss: 0.02773:  25%|██▌       | 51/201 [00:46<03:23,  1.36s/it]Loss: 0.02773:  26%|██▌       | 52/201 [00:47<03:05,  1.25s/it]Loss: 0.00984:  26%|██▌       | 52/201 [00:47<03:05,  1.25s/it]Loss: 0.00984:  26%|██▋       | 53/201 [00:48<02:53,  1.17s/it]Loss: 0.00654:  26%|██▋       | 53/201 [00:48<02:53,  1.17s/it]Loss: 0.00654:  27%|██▋       | 54/201 [00:49<02:43,  1.11s/it]Loss: 0.00573:  27%|██▋       | 54/201 [00:49<02:43,  1.11s/it]Loss: 0.00573:  27%|██▋       | 55/201 [00:50<02:37,  1.08s/it]Loss: 0.00513:  27%|██▋       | 55/201 [00:50<02:37,  1.08s/it]Loss: 0.00513:  28%|██▊       | 56/201 [00:51<02:32,  1.05s/it]Loss: 0.00551:  28%|██▊       | 56/201 [00:51<02:32,  1.05s/it]Loss: 0.00551:  28%|██▊       | 57/201 [00:52<02:28,  1.03s/it]Loss: 0.00503:  28%|██▊       | 57/201 [00:52<02:28,  1.03s/it]Loss: 0.00503:  29%|██▉       | 58/201 [00:53<02:25,  1.02s/it]Loss: 0.00462:  29%|██▉       | 58/201 [00:53<02:25,  1.02s/it]Loss: 0.00462:  29%|██▉       | 59/201 [00:54<02:23,  1.01s/it]Loss: 0.00439:  29%|██▉       | 59/201 [00:54<02:23,  1.01s/it]Loss: 0.00439:  30%|██▉       | 60/201 [00:55<02:21,  1.00s/it]Loss: 0.00425:  30%|██▉       | 60/201 [00:55<02:21,  1.00s/it]Loss: 0.00425:  30%|███       | 61/201 [00:56<02:26,  1.04s/it]Loss: 0.00413:  30%|███       | 61/201 [00:56<02:26,  1.04s/it]Loss: 0.00413:  31%|███       | 62/201 [00:57<02:22,  1.02s/it]Loss: 0.00416:  31%|███       | 62/201 [00:57<02:22,  1.02s/it]Loss: 0.00416:  31%|███▏      | 63/201 [00:58<02:19,  1.01s/it]Loss: 0.00400:  31%|███▏      | 63/201 [00:58<02:19,  1.01s/it]Loss: 0.00400:  32%|███▏      | 64/201 [00:59<02:17,  1.00s/it]Loss: 0.00312:  32%|███▏      | 64/201 [00:59<02:17,  1.00s/it]Loss: 0.00312:  32%|███▏      | 65/201 [01:00<02:15,  1.00it/s]Loss: 0.00303:  32%|███▏      | 65/201 [01:00<02:15,  1.00it/s]Loss: 0.00303:  33%|███▎      | 66/201 [01:01<02:14,  1.00it/s]Loss: 0.00298:  33%|███▎      | 66/201 [01:01<02:14,  1.00it/s]Loss: 0.00298:  33%|███▎      | 67/201 [01:02<02:13,  1.01it/s]Loss: 0.00294:  33%|███▎      | 67/201 [01:02<02:13,  1.01it/s]Loss: 0.00294:  34%|███▍      | 68/201 [01:03<02:11,  1.01it/s]Loss: 0.00291:  34%|███▍      | 68/201 [01:03<02:11,  1.01it/s]Loss: 0.00291:  34%|███▍      | 69/201 [01:04<02:10,  1.01it/s]Loss: 0.00287:  34%|███▍      | 69/201 [01:04<02:10,  1.01it/s]Loss: 0.00287:  35%|███▍      | 70/201 [01:05<02:09,  1.01it/s]Loss: 0.00284:  35%|███▍      | 70/201 [01:05<02:09,  1.01it/s]Loss: 0.00284:  35%|███▌      | 71/201 [01:06<02:08,  1.01it/s]Loss: 0.00281:  35%|███▌      | 71/201 [01:06<02:08,  1.01it/s]Loss: 0.00281:  36%|███▌      | 72/201 [01:07<02:07,  1.01it/s]Loss: 0.00279:  36%|███▌      | 72/201 [01:07<02:07,  1.01it/s]Loss: 0.00279:  36%|███▋      | 73/201 [01:08<02:06,  1.01it/s]Loss: 0.00277:  36%|███▋      | 73/201 [01:08<02:06,  1.01it/s]Loss: 0.00277:  37%|███▋      | 74/201 [01:09<02:05,  1.01it/s]Loss: 0.00274:  37%|███▋      | 74/201 [01:09<02:05,  1.01it/s]Loss: 0.00274:  37%|███▋      | 75/201 [01:10<02:04,  1.01it/s]Loss: 0.00272:  37%|███▋      | 75/201 [01:10<02:04,  1.01it/s]Loss: 0.00272:  38%|███▊      | 76/201 [01:11<02:03,  1.01it/s]Loss: 0.00272:  38%|███▊      | 76/201 [01:11<02:03,  1.01it/s]Loss: 0.00272:  38%|███▊      | 77/201 [01:12<02:02,  1.01it/s]Loss: 0.00269:  38%|███▊      | 77/201 [01:12<02:02,  1.01it/s]Loss: 0.00269:  39%|███▉      | 78/201 [01:13<02:01,  1.01it/s]Loss: 0.00268:  39%|███▉      | 78/201 [01:13<02:01,  1.01it/s]Loss: 0.00268:  39%|███▉      | 79/201 [01:14<02:00,  1.01it/s]Loss: 0.00266:  39%|███▉      | 79/201 [01:14<02:00,  1.01it/s]Loss: 0.00266:  40%|███▉      | 80/201 [01:15<01:59,  1.01it/s]Loss: 0.00264:  40%|███▉      | 80/201 [01:15<01:59,  1.01it/s]Loss: 0.00264:  40%|████      | 81/201 [01:16<02:04,  1.03s/it]Loss: 0.00262:  40%|████      | 81/201 [01:16<02:04,  1.03s/it]Loss: 0.00262:  41%|████      | 82/201 [01:17<02:01,  1.02s/it]Loss: 0.00276:  41%|████      | 82/201 [01:17<02:01,  1.02s/it]Loss: 0.00276:  41%|████▏     | 83/201 [01:18<01:58,  1.01s/it]Loss: 0.00339:  41%|████▏     | 83/201 [01:18<01:58,  1.01s/it]Loss: 0.00339:  42%|████▏     | 84/201 [01:19<01:57,  1.00s/it]Loss: 0.00374:  42%|████▏     | 84/201 [01:19<01:57,  1.00s/it]Loss: 0.00374:  42%|████▏     | 85/201 [01:20<01:55,  1.00it/s]Loss: 0.00403:  42%|████▏     | 85/201 [01:20<01:55,  1.00it/s]Loss: 0.00403:  43%|████▎     | 86/201 [01:21<01:54,  1.01it/s]Loss: 0.00442:  43%|████▎     | 86/201 [01:21<01:54,  1.01it/s]Loss: 0.00442:  43%|████▎     | 87/201 [01:22<01:53,  1.01it/s]Loss: 0.00359:  43%|████▎     | 87/201 [01:22<01:53,  1.01it/s]Loss: 0.00359:  44%|████▍     | 88/201 [01:23<01:51,  1.01it/s]Loss: 0.00358:  44%|████▍     | 88/201 [01:23<01:51,  1.01it/s]Loss: 0.00358:  44%|████▍     | 89/201 [01:24<01:50,  1.01it/s]Loss: 0.00353:  44%|████▍     | 89/201 [01:24<01:50,  1.01it/s]Loss: 0.00353:  45%|████▍     | 90/201 [01:25<01:49,  1.01it/s]Loss: 0.00341:  45%|████▍     | 90/201 [01:25<01:49,  1.01it/s]Loss: 0.00341:  45%|████▌     | 91/201 [01:26<01:48,  1.01it/s]Loss: 0.00335:  45%|████▌     | 91/201 [01:26<01:48,  1.01it/s]Loss: 0.00335:  46%|████▌     | 92/201 [01:27<01:47,  1.01it/s]Loss: 0.00330:  46%|████▌     | 92/201 [01:27<01:47,  1.01it/s]Loss: 0.00330:  46%|████▋     | 93/201 [01:28<01:46,  1.01it/s]Loss: 0.00330:  46%|████▋     | 93/201 [01:28<01:46,  1.01it/s]Loss: 0.00330:  47%|████▋     | 94/201 [01:29<01:45,  1.01it/s]Loss: 0.00328:  47%|████▋     | 94/201 [01:29<01:45,  1.01it/s]Loss: 0.00328:  47%|████▋     | 95/201 [01:30<01:44,  1.01it/s]Loss: 0.00367:  47%|████▋     | 95/201 [01:30<01:44,  1.01it/s]Loss: 0.00367:  48%|████▊     | 96/201 [01:31<01:43,  1.01it/s]Loss: 0.00314:  48%|████▊     | 96/201 [01:31<01:43,  1.01it/s]Loss: 0.00314:  48%|████▊     | 97/201 [01:32<01:42,  1.01it/s]Loss: 0.00318:  48%|████▊     | 97/201 [01:32<01:42,  1.01it/s]Loss: 0.00318:  49%|████▉     | 98/201 [01:33<01:41,  1.01it/s]Loss: 0.00274:  49%|████▉     | 98/201 [01:33<01:41,  1.01it/s]Loss: 0.00274:  49%|████▉     | 99/201 [01:34<01:40,  1.01it/s]Loss: 0.00307:  49%|████▉     | 99/201 [01:34<01:40,  1.01it/s]Loss: 0.00307:  50%|████▉     | 100/201 [01:35<01:39,  1.01it/s]Loss: 0.00342:  50%|████▉     | 100/201 [01:35<01:39,  1.01it/s]Loss: 0.00342:  50%|█████     | 101/201 [01:36<01:43,  1.03s/it]Loss: 0.00386:  50%|█████     | 101/201 [01:36<01:43,  1.03s/it]max loss: 0.43031075596809387
Densities: min=0.0, max=1.0, mean=0.06622195988893509
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.48s/it][A1it [00:01,  1.48s/it]
Loss: 0.00386:  51%|█████     | 102/201 [01:39<02:24,  1.46s/it]Loss: 0.00470:  51%|█████     | 102/201 [01:39<02:24,  1.46s/it]Loss: 0.00470:  51%|█████     | 103/201 [01:40<02:09,  1.32s/it]Loss: 0.00456:  51%|█████     | 103/201 [01:40<02:09,  1.32s/it]Loss: 0.00456:  52%|█████▏    | 104/201 [01:41<01:58,  1.22s/it]Loss: 0.00424:  52%|█████▏    | 104/201 [01:41<01:58,  1.22s/it]Loss: 0.00424:  52%|█████▏    | 105/201 [01:42<01:50,  1.15s/it]Loss: 0.00397:  52%|█████▏    | 105/201 [01:42<01:50,  1.15s/it]Loss: 0.00397:  53%|█████▎    | 106/201 [01:43<01:44,  1.10s/it]Loss: 0.00407:  53%|█████▎    | 106/201 [01:43<01:44,  1.10s/it]Loss: 0.00407:  53%|█████▎    | 107/201 [01:44<01:39,  1.06s/it]Loss: 0.00406:  53%|█████▎    | 107/201 [01:44<01:39,  1.06s/it]Loss: 0.00406:  54%|█████▎    | 108/201 [01:45<01:36,  1.04s/it]Loss: 0.00396:  54%|█████▎    | 108/201 [01:45<01:36,  1.04s/it]Loss: 0.00396:  54%|█████▍    | 109/201 [01:46<01:33,  1.02s/it]Loss: 0.00389:  54%|█████▍    | 109/201 [01:46<01:33,  1.02s/it]Loss: 0.00389:  55%|█████▍    | 110/201 [01:46<01:31,  1.01s/it]Loss: 0.00387:  55%|█████▍    | 110/201 [01:46<01:31,  1.01s/it]Loss: 0.00387:  55%|█████▌    | 111/201 [01:47<01:30,  1.00s/it]Loss: 0.00391:  55%|█████▌    | 111/201 [01:47<01:30,  1.00s/it]Loss: 0.00391:  56%|█████▌    | 112/201 [01:48<01:28,  1.00it/s]Loss: 0.00379:  56%|█████▌    | 112/201 [01:48<01:28,  1.00it/s]Loss: 0.00379:  56%|█████▌    | 113/201 [01:49<01:27,  1.01it/s]Loss: 0.00371:  56%|█████▌    | 113/201 [01:49<01:27,  1.01it/s]Loss: 0.00371:  57%|█████▋    | 114/201 [01:50<01:26,  1.01it/s]Loss: 0.00369:  57%|█████▋    | 114/201 [01:50<01:26,  1.01it/s]Loss: 0.00369:  57%|█████▋    | 115/201 [01:51<01:24,  1.01it/s]Loss: 0.00379:  57%|█████▋    | 115/201 [01:51<01:24,  1.01it/s]Loss: 0.00379:  58%|█████▊    | 116/201 [01:52<01:23,  1.01it/s]Loss: 0.00377:  58%|█████▊    | 116/201 [01:52<01:23,  1.01it/s]Loss: 0.00377:  58%|█████▊    | 117/201 [01:53<01:22,  1.02it/s]Loss: 0.00360:  58%|█████▊    | 117/201 [01:53<01:22,  1.02it/s]Loss: 0.00360:  59%|█████▊    | 118/201 [01:54<01:21,  1.02it/s]Loss: 0.00365:  59%|█████▊    | 118/201 [01:54<01:21,  1.02it/s]Loss: 0.00365:  59%|█████▉    | 119/201 [01:55<01:20,  1.02it/s]Loss: 0.00365:  59%|█████▉    | 119/201 [01:55<01:20,  1.02it/s]Loss: 0.00365:  60%|█████▉    | 120/201 [01:56<01:19,  1.02it/s]Loss: 0.00360:  60%|█████▉    | 120/201 [01:56<01:19,  1.02it/s]Loss: 0.00360:  60%|██████    | 121/201 [01:57<01:22,  1.03s/it]Loss: 0.00265:  60%|██████    | 121/201 [01:57<01:22,  1.03s/it]Loss: 0.00265:  61%|██████    | 122/201 [01:58<01:19,  1.01s/it]Loss: 0.00259:  61%|██████    | 122/201 [01:58<01:19,  1.01s/it]Loss: 0.00259:  61%|██████    | 123/201 [01:59<01:18,  1.00s/it]Loss: 0.00257:  61%|██████    | 123/201 [01:59<01:18,  1.00s/it]Loss: 0.00257:  62%|██████▏   | 124/201 [02:00<01:16,  1.00it/s]Loss: 0.00254:  62%|██████▏   | 124/201 [02:00<01:16,  1.00it/s]Loss: 0.00254:  62%|██████▏   | 125/201 [02:01<01:15,  1.01it/s]Loss: 0.00254:  62%|██████▏   | 125/201 [02:01<01:15,  1.01it/s]Loss: 0.00254:  63%|██████▎   | 126/201 [02:02<01:14,  1.01it/s]Loss: 0.00252:  63%|██████▎   | 126/201 [02:02<01:14,  1.01it/s]Loss: 0.00252:  63%|██████▎   | 127/201 [02:03<01:12,  1.01it/s]Loss: 0.00251:  63%|██████▎   | 127/201 [02:03<01:12,  1.01it/s]Loss: 0.00251:  64%|██████▎   | 128/201 [02:04<01:11,  1.02it/s]Loss: 0.00250:  64%|██████▎   | 128/201 [02:04<01:11,  1.02it/s]Loss: 0.00250:  64%|██████▍   | 129/201 [02:05<01:10,  1.02it/s]Loss: 0.00250:  64%|██████▍   | 129/201 [02:05<01:10,  1.02it/s]Loss: 0.00250:  65%|██████▍   | 130/201 [02:06<01:09,  1.02it/s]Loss: 0.00249:  65%|██████▍   | 130/201 [02:06<01:09,  1.02it/s]Loss: 0.00249:  65%|██████▌   | 131/201 [02:07<01:08,  1.02it/s]Loss: 0.00249:  65%|██████▌   | 131/201 [02:07<01:08,  1.02it/s]Loss: 0.00249:  66%|██████▌   | 132/201 [02:08<01:07,  1.02it/s]Loss: 0.00251:  66%|██████▌   | 132/201 [02:08<01:07,  1.02it/s]Loss: 0.00251:  66%|██████▌   | 133/201 [02:09<01:06,  1.02it/s]Loss: 0.00252:  66%|██████▌   | 133/201 [02:09<01:06,  1.02it/s]Loss: 0.00252:  67%|██████▋   | 134/201 [02:10<01:05,  1.02it/s]Loss: 0.00249:  67%|██████▋   | 134/201 [02:10<01:05,  1.02it/s]Loss: 0.00249:  67%|██████▋   | 135/201 [02:11<01:04,  1.02it/s]Loss: 0.00248:  67%|██████▋   | 135/201 [02:11<01:04,  1.02it/s]Loss: 0.00248:  68%|██████▊   | 136/201 [02:12<01:03,  1.02it/s]Loss: 0.00247:  68%|██████▊   | 136/201 [02:12<01:03,  1.02it/s]Loss: 0.00247:  68%|██████▊   | 137/201 [02:13<01:02,  1.02it/s]Loss: 0.00248:  68%|██████▊   | 137/201 [02:13<01:02,  1.02it/s]Loss: 0.00248:  69%|██████▊   | 138/201 [02:14<01:01,  1.02it/s]Loss: 0.00246:  69%|██████▊   | 138/201 [02:14<01:01,  1.02it/s]Loss: 0.00246:  69%|██████▉   | 139/201 [02:15<01:00,  1.02it/s]Loss: 0.00247:  69%|██████▉   | 139/201 [02:15<01:00,  1.02it/s]Loss: 0.00247:  70%|██████▉   | 140/201 [02:16<00:59,  1.02it/s]Loss: 0.00245:  70%|██████▉   | 140/201 [02:16<00:59,  1.02it/s]Loss: 0.00245:  70%|███████   | 141/201 [02:17<01:01,  1.03s/it]Loss: 0.00247:  70%|███████   | 141/201 [02:17<01:01,  1.03s/it]Loss: 0.00247:  71%|███████   | 142/201 [02:18<00:59,  1.01s/it]Loss: 0.00244:  71%|███████   | 142/201 [02:18<00:59,  1.01s/it]Loss: 0.00244:  71%|███████   | 143/201 [02:19<00:58,  1.00s/it]Loss: 0.00245:  71%|███████   | 143/201 [02:19<00:58,  1.00s/it]Loss: 0.00245:  72%|███████▏  | 144/201 [02:20<00:56,  1.00it/s]Loss: 0.00244:  72%|███████▏  | 144/201 [02:20<00:56,  1.00it/s]Loss: 0.00244:  72%|███████▏  | 145/201 [02:21<00:55,  1.01it/s]Loss: 0.00245:  72%|███████▏  | 145/201 [02:21<00:55,  1.01it/s]Loss: 0.00245:  73%|███████▎  | 146/201 [02:22<00:54,  1.01it/s]Loss: 0.00242:  73%|███████▎  | 146/201 [02:22<00:54,  1.01it/s]Loss: 0.00242:  73%|███████▎  | 147/201 [02:23<00:53,  1.01it/s]Loss: 0.00246:  73%|███████▎  | 147/201 [02:23<00:53,  1.01it/s]Loss: 0.00246:  74%|███████▎  | 148/201 [02:24<00:52,  1.01it/s]Loss: 0.00245:  74%|███████▎  | 148/201 [02:24<00:52,  1.01it/s]Loss: 0.00245:  74%|███████▍  | 149/201 [02:25<00:51,  1.02it/s]Loss: 0.00241:  74%|███████▍  | 149/201 [02:25<00:51,  1.02it/s]Loss: 0.00241:  75%|███████▍  | 150/201 [02:26<00:50,  1.02it/s]Loss: 0.00245:  75%|███████▍  | 150/201 [02:26<00:50,  1.02it/s]Loss: 0.00245:  75%|███████▌  | 151/201 [02:27<00:49,  1.02it/s]Loss: 0.00243:  75%|███████▌  | 151/201 [02:27<00:49,  1.02it/s]Loss: 0.00243:  76%|███████▌  | 152/201 [02:28<00:48,  1.02it/s]Loss: 0.00244:  76%|███████▌  | 152/201 [02:28<00:48,  1.02it/s]max loss: 0.0920952558517456
Densities: min=0.0, max=1.0, mean=0.09015056490898132
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.57s/it][A1it [00:01,  1.57s/it]
Loss: 0.00244:  76%|███████▌  | 153/201 [02:31<01:09,  1.44s/it]Loss: 0.00532:  76%|███████▌  | 153/201 [02:31<01:09,  1.44s/it]Loss: 0.00532:  77%|███████▋  | 154/201 [02:31<01:00,  1.29s/it]Loss: 0.00499:  77%|███████▋  | 154/201 [02:31<01:00,  1.29s/it]Loss: 0.00499:  77%|███████▋  | 155/201 [02:32<00:54,  1.18s/it]Loss: 0.00487:  77%|███████▋  | 155/201 [02:32<00:54,  1.18s/it]Loss: 0.00487:  78%|███████▊  | 156/201 [02:33<00:49,  1.11s/it]Loss: 0.00480:  78%|███████▊  | 156/201 [02:33<00:49,  1.11s/it]Loss: 0.00480:  78%|███████▊  | 157/201 [02:34<00:46,  1.06s/it]Loss: 0.00475:  78%|███████▊  | 157/201 [02:34<00:46,  1.06s/it]Loss: 0.00475:  79%|███████▊  | 158/201 [02:35<00:43,  1.02s/it]Loss: 0.00472:  79%|███████▊  | 158/201 [02:35<00:43,  1.02s/it]Loss: 0.00472:  79%|███████▉  | 159/201 [02:36<00:41,  1.01it/s]Loss: 0.00468:  79%|███████▉  | 159/201 [02:36<00:41,  1.01it/s]Loss: 0.00468:  80%|███████▉  | 160/201 [02:37<00:40,  1.02it/s]Loss: 0.00463:  80%|███████▉  | 160/201 [02:37<00:40,  1.02it/s]Loss: 0.00463:  80%|████████  | 161/201 [02:38<00:40,  1.01s/it]Loss: 0.00462:  80%|████████  | 161/201 [02:38<00:40,  1.01s/it]Loss: 0.00462:  81%|████████  | 162/201 [02:39<00:38,  1.01it/s]Loss: 0.00461:  81%|████████  | 162/201 [02:39<00:38,  1.01it/s]Loss: 0.00461:  81%|████████  | 163/201 [02:40<00:36,  1.03it/s]Loss: 0.00459:  81%|████████  | 163/201 [02:40<00:36,  1.03it/s]Loss: 0.00459:  82%|████████▏ | 164/201 [02:41<00:35,  1.04it/s]Loss: 0.00458:  82%|████████▏ | 164/201 [02:41<00:35,  1.04it/s]Loss: 0.00458:  82%|████████▏ | 165/201 [02:42<00:34,  1.05it/s]Loss: 0.00456:  82%|████████▏ | 165/201 [02:42<00:34,  1.05it/s]Loss: 0.00456:  83%|████████▎ | 166/201 [02:43<00:33,  1.06it/s]Loss: 0.00458:  83%|████████▎ | 166/201 [02:43<00:33,  1.06it/s]Loss: 0.00458:  83%|████████▎ | 167/201 [02:44<00:32,  1.06it/s]Loss: 0.00459:  83%|████████▎ | 167/201 [02:44<00:32,  1.06it/s]Loss: 0.00459:  84%|████████▎ | 168/201 [02:45<00:31,  1.06it/s]Loss: 0.00453:  84%|████████▎ | 168/201 [02:45<00:31,  1.06it/s]Loss: 0.00453:  84%|████████▍ | 169/201 [02:46<00:30,  1.06it/s]Loss: 0.00450:  84%|████████▍ | 169/201 [02:46<00:30,  1.06it/s]Loss: 0.00450:  85%|████████▍ | 170/201 [02:47<00:29,  1.07it/s]Loss: 0.00445:  85%|████████▍ | 170/201 [02:47<00:29,  1.07it/s]Loss: 0.00445:  85%|████████▌ | 171/201 [02:48<00:28,  1.07it/s]Loss: 0.00421:  85%|████████▌ | 171/201 [02:48<00:28,  1.07it/s]Loss: 0.00421:  86%|████████▌ | 172/201 [02:48<00:27,  1.07it/s]Loss: 0.00418:  86%|████████▌ | 172/201 [02:48<00:27,  1.07it/s]Loss: 0.00418:  86%|████████▌ | 173/201 [02:49<00:26,  1.07it/s]Loss: 0.00431:  86%|████████▌ | 173/201 [02:49<00:26,  1.07it/s]Loss: 0.00431:  87%|████████▋ | 174/201 [02:50<00:25,  1.07it/s]Loss: 0.00426:  87%|████████▋ | 174/201 [02:50<00:25,  1.07it/s]Loss: 0.00426:  87%|████████▋ | 175/201 [02:51<00:24,  1.07it/s]Loss: 0.00424:  87%|████████▋ | 175/201 [02:51<00:24,  1.07it/s]Loss: 0.00424:  88%|████████▊ | 176/201 [02:52<00:23,  1.07it/s]Loss: 0.00419:  88%|████████▊ | 176/201 [02:52<00:23,  1.07it/s]Loss: 0.00419:  88%|████████▊ | 177/201 [02:53<00:22,  1.07it/s]Loss: 0.00423:  88%|████████▊ | 177/201 [02:53<00:22,  1.07it/s]Loss: 0.00423:  89%|████████▊ | 178/201 [02:54<00:21,  1.07it/s]Loss: 0.00418:  89%|████████▊ | 178/201 [02:54<00:21,  1.07it/s]Loss: 0.00418:  89%|████████▉ | 179/201 [02:55<00:20,  1.07it/s]Loss: 0.00422:  89%|████████▉ | 179/201 [02:55<00:20,  1.07it/s]Loss: 0.00422:  90%|████████▉ | 180/201 [02:56<00:19,  1.07it/s]Loss: 0.00419:  90%|████████▉ | 180/201 [02:56<00:19,  1.07it/s]Loss: 0.00419:  90%|█████████ | 181/201 [02:57<00:19,  1.02it/s]Loss: 0.00417:  90%|█████████ | 181/201 [02:57<00:19,  1.02it/s]Loss: 0.00417:  91%|█████████ | 182/201 [02:58<00:18,  1.04it/s]Loss: 0.00413:  91%|█████████ | 182/201 [02:58<00:18,  1.04it/s]Loss: 0.00413:  91%|█████████ | 183/201 [02:59<00:17,  1.04it/s]Loss: 0.00412:  91%|█████████ | 183/201 [02:59<00:17,  1.04it/s]Loss: 0.00412:  92%|█████████▏| 184/201 [03:00<00:16,  1.05it/s]Loss: 0.00415:  92%|█████████▏| 184/201 [03:00<00:16,  1.05it/s]Loss: 0.00415:  92%|█████████▏| 185/201 [03:01<00:15,  1.06it/s]Loss: 0.00413:  92%|█████████▏| 185/201 [03:01<00:15,  1.06it/s]Loss: 0.00413:  93%|█████████▎| 186/201 [03:02<00:14,  1.06it/s]Loss: 0.00411:  93%|█████████▎| 186/201 [03:02<00:14,  1.06it/s]Loss: 0.00411:  93%|█████████▎| 187/201 [03:03<00:13,  1.06it/s]Loss: 0.00417:  93%|█████████▎| 187/201 [03:03<00:13,  1.06it/s]Loss: 0.00417:  94%|█████████▎| 188/201 [03:04<00:12,  1.06it/s]Loss: 0.00409:  94%|█████████▎| 188/201 [03:04<00:12,  1.06it/s]Loss: 0.00409:  94%|█████████▍| 189/201 [03:05<00:11,  1.07it/s]Loss: 0.00411:  94%|█████████▍| 189/201 [03:05<00:11,  1.07it/s]Loss: 0.00411:  95%|█████████▍| 190/201 [03:05<00:10,  1.07it/s]Loss: 0.00408:  95%|█████████▍| 190/201 [03:05<00:10,  1.07it/s]Loss: 0.00408:  95%|█████████▌| 191/201 [03:06<00:09,  1.07it/s]Loss: 0.00405:  95%|█████████▌| 191/201 [03:06<00:09,  1.07it/s]Loss: 0.00405:  96%|█████████▌| 192/201 [03:07<00:08,  1.07it/s]Loss: 0.00406:  96%|█████████▌| 192/201 [03:07<00:08,  1.07it/s]Loss: 0.00406:  96%|█████████▌| 193/201 [03:08<00:07,  1.07it/s]Loss: 0.00405:  96%|█████████▌| 193/201 [03:08<00:07,  1.07it/s]Loss: 0.00405:  97%|█████████▋| 194/201 [03:09<00:06,  1.07it/s]Loss: 0.00406:  97%|█████████▋| 194/201 [03:09<00:06,  1.07it/s]Loss: 0.00406:  97%|█████████▋| 195/201 [03:10<00:05,  1.07it/s]Loss: 0.00404:  97%|█████████▋| 195/201 [03:10<00:05,  1.07it/s]Loss: 0.00404:  98%|█████████▊| 196/201 [03:11<00:04,  1.07it/s]Loss: 0.00401:  98%|█████████▊| 196/201 [03:11<00:04,  1.07it/s]Loss: 0.00401:  98%|█████████▊| 197/201 [03:12<00:03,  1.07it/s]Loss: 0.00399:  98%|█████████▊| 197/201 [03:12<00:03,  1.07it/s]Loss: 0.00399:  99%|█████████▊| 198/201 [03:13<00:02,  1.07it/s]Loss: 0.00403:  99%|█████████▊| 198/201 [03:13<00:02,  1.07it/s]Loss: 0.00403:  99%|█████████▉| 199/201 [03:14<00:01,  1.07it/s]Loss: 0.00399:  99%|█████████▉| 199/201 [03:14<00:01,  1.07it/s]Loss: 0.00399: 100%|█████████▉| 200/201 [03:15<00:00,  1.07it/s]Loss: 0.00401: 100%|█████████▉| 200/201 [03:15<00:00,  1.07it/s]Loss: 0.00401: 100%|██████████| 201/201 [03:16<00:00,  1.02it/s]Loss: 0.00400: 100%|██████████| 201/201 [03:16<00:00,  1.02it/s]Loss: 0.00400: 100%|██████████| 201/201 [03:16<00:00,  1.02it/s]Load volume "/media/storage0/qadwu/floats/chameleon_1024x1024x1080_float32_raw_1024x1024x1080_float.cvol"
Loaded

max loss: 0.08070790022611618
Densities: min=0.0, max=1.0, mean=0.18266494572162628
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 196.38572120666504 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json
Latent space memory: 57.4MiB
Latent space memory: 57.4MiB
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/chameleon_1024x1024x1080_float32_raw_1024x1024x1080_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 8, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 3, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 14992896
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.10it/s]1it [00:00,  3.10it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.3309527039527893
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00,  2.70it/s]Render: : 1it [00:00,  2.70it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/chameleon.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.005, 'epochs': 200, 'lr_gamma': 0.8, 'lr_step': 10, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [1024, 1024, 1080], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/chameleon-20220916174935-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 8, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 3}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<01:34,  2.12it/s]Loss: 0.10167:   0%|          | 1/201 [00:00<01:34,  2.12it/s]Loss: 0.10167:   1%|          | 2/201 [00:00<01:15,  2.64it/s]Loss: 0.02073:   1%|          | 2/201 [00:00<01:15,  2.64it/s]Loss: 0.02073:   1%|▏         | 3/201 [00:01<01:09,  2.85it/s]Loss: 0.01388:   1%|▏         | 3/201 [00:01<01:09,  2.85it/s]Loss: 0.01388:   2%|▏         | 4/201 [00:01<01:06,  2.96it/s]Loss: 0.01125:   2%|▏         | 4/201 [00:01<01:06,  2.96it/s]Loss: 0.01125:   2%|▏         | 5/201 [00:01<01:04,  3.03it/s]Loss: 0.01015:   2%|▏         | 5/201 [00:01<01:04,  3.03it/s]Loss: 0.01015:   3%|▎         | 6/201 [00:02<01:03,  3.07it/s]Loss: 0.00926:   3%|▎         | 6/201 [00:02<01:03,  3.07it/s]Loss: 0.00926:   3%|▎         | 7/201 [00:02<01:02,  3.10it/s]Loss: 0.00857:   3%|▎         | 7/201 [00:02<01:02,  3.10it/s]Loss: 0.00857:   4%|▍         | 8/201 [00:02<01:01,  3.11it/s]Loss: 0.00808:   4%|▍         | 8/201 [00:02<01:01,  3.11it/s]Loss: 0.00808:   4%|▍         | 9/201 [00:03<01:01,  3.13it/s]Loss: 0.00773:   4%|▍         | 9/201 [00:03<01:01,  3.13it/s]Loss: 0.00773:   5%|▍         | 10/201 [00:03<01:00,  3.13it/s]Loss: 0.00738:   5%|▍         | 10/201 [00:03<01:00,  3.13it/s]Loss: 0.00738:   5%|▌         | 11/201 [00:03<01:00,  3.14it/s]Loss: 0.00691:   5%|▌         | 11/201 [00:03<01:00,  3.14it/s]Loss: 0.00691:   6%|▌         | 12/201 [00:03<01:00,  3.14it/s]Loss: 0.00681:   6%|▌         | 12/201 [00:03<01:00,  3.14it/s]Loss: 0.00681:   6%|▋         | 13/201 [00:04<00:59,  3.15it/s]Loss: 0.00593:   6%|▋         | 13/201 [00:04<00:59,  3.15it/s]Loss: 0.00593:   7%|▋         | 14/201 [00:04<00:59,  3.15it/s]Loss: 0.00589:   7%|▋         | 14/201 [00:04<00:59,  3.15it/s]Loss: 0.00589:   7%|▋         | 15/201 [00:04<00:59,  3.15it/s]Loss: 0.00553:   7%|▋         | 15/201 [00:04<00:59,  3.15it/s]Loss: 0.00553:   8%|▊         | 16/201 [00:05<00:58,  3.15it/s]Loss: 0.00568:   8%|▊         | 16/201 [00:05<00:58,  3.15it/s]Loss: 0.00568:   8%|▊         | 17/201 [00:05<00:58,  3.15it/s]Loss: 0.00533:   8%|▊         | 17/201 [00:05<00:58,  3.15it/s]Loss: 0.00533:   9%|▉         | 18/201 [00:05<00:58,  3.15it/s]Loss: 0.00547:   9%|▉         | 18/201 [00:05<00:58,  3.15it/s]Loss: 0.00547:   9%|▉         | 19/201 [00:06<00:57,  3.15it/s]Loss: 0.00527:   9%|▉         | 19/201 [00:06<00:57,  3.15it/s]Loss: 0.00527:  10%|▉         | 20/201 [00:06<00:57,  3.15it/s]Loss: 0.00547:  10%|▉         | 20/201 [00:06<00:57,  3.15it/s]Loss: 0.00547:  10%|█         | 21/201 [00:06<01:05,  2.76it/s]Loss: 0.00457:  10%|█         | 21/201 [00:06<01:05,  2.76it/s]Loss: 0.00457:  11%|█         | 22/201 [00:07<01:02,  2.88it/s]Loss: 0.00428:  11%|█         | 22/201 [00:07<01:02,  2.88it/s]Loss: 0.00428:  11%|█▏        | 23/201 [00:07<01:00,  2.95it/s]Loss: 0.00426:  11%|█▏        | 23/201 [00:07<01:00,  2.95it/s]Loss: 0.00426:  12%|█▏        | 24/201 [00:07<00:58,  3.01it/s]Loss: 0.00429:  12%|█▏        | 24/201 [00:07<00:58,  3.01it/s]Loss: 0.00429:  12%|█▏        | 25/201 [00:08<00:57,  3.04it/s]Loss: 0.00426:  12%|█▏        | 25/201 [00:08<00:57,  3.04it/s]Loss: 0.00426:  13%|█▎        | 26/201 [00:08<00:56,  3.07it/s]Loss: 0.00426:  13%|█▎        | 26/201 [00:08<00:56,  3.07it/s]Loss: 0.00426:  13%|█▎        | 27/201 [00:08<00:56,  3.09it/s]Loss: 0.00425:  13%|█▎        | 27/201 [00:08<00:56,  3.09it/s]Loss: 0.00425:  14%|█▍        | 28/201 [00:09<00:55,  3.11it/s]Loss: 0.00444:  14%|█▍        | 28/201 [00:09<00:55,  3.11it/s]Loss: 0.00444:  14%|█▍        | 29/201 [00:09<00:55,  3.12it/s]Loss: 0.00428:  14%|█▍        | 29/201 [00:09<00:55,  3.12it/s]Loss: 0.00428:  15%|█▍        | 30/201 [00:09<00:54,  3.13it/s]Loss: 0.00420:  15%|█▍        | 30/201 [00:09<00:54,  3.13it/s]Loss: 0.00420:  15%|█▌        | 31/201 [00:10<00:54,  3.13it/s]Loss: 0.00389:  15%|█▌        | 31/201 [00:10<00:54,  3.13it/s]Loss: 0.00389:  16%|█▌        | 32/201 [00:10<00:53,  3.13it/s]Loss: 0.00365:  16%|█▌        | 32/201 [00:10<00:53,  3.13it/s]Loss: 0.00365:  16%|█▋        | 33/201 [00:10<00:53,  3.14it/s]Loss: 0.00350:  16%|█▋        | 33/201 [00:10<00:53,  3.14it/s]Loss: 0.00350:  17%|█▋        | 34/201 [00:11<00:53,  3.13it/s]Loss: 0.00346:  17%|█▋        | 34/201 [00:11<00:53,  3.13it/s]Loss: 0.00346:  17%|█▋        | 35/201 [00:11<00:52,  3.14it/s]Loss: 0.00361:  17%|█▋        | 35/201 [00:11<00:52,  3.14it/s]Loss: 0.00361:  18%|█▊        | 36/201 [00:11<00:52,  3.14it/s]Loss: 0.00362:  18%|█▊        | 36/201 [00:11<00:52,  3.14it/s]Loss: 0.00362:  18%|█▊        | 37/201 [00:12<00:52,  3.14it/s]Loss: 0.00357:  18%|█▊        | 37/201 [00:12<00:52,  3.14it/s]Loss: 0.00357:  19%|█▉        | 38/201 [00:12<00:51,  3.14it/s]Loss: 0.00389:  19%|█▉        | 38/201 [00:12<00:51,  3.14it/s]Loss: 0.00389:  19%|█▉        | 39/201 [00:12<00:51,  3.14it/s]Loss: 0.00359:  19%|█▉        | 39/201 [00:12<00:51,  3.14it/s]Loss: 0.00359:  20%|█▉        | 40/201 [00:13<00:51,  3.14it/s]Loss: 0.00348:  20%|█▉        | 40/201 [00:13<00:51,  3.14it/s]Loss: 0.00348:  20%|██        | 41/201 [00:13<00:57,  2.76it/s]Loss: 0.00320:  20%|██        | 41/201 [00:13<00:57,  2.76it/s]Loss: 0.00320:  21%|██        | 42/201 [00:13<00:55,  2.87it/s]Loss: 0.00303:  21%|██        | 42/201 [00:13<00:55,  2.87it/s]Loss: 0.00303:  21%|██▏       | 43/201 [00:14<00:53,  2.95it/s]Loss: 0.00293:  21%|██▏       | 43/201 [00:14<00:53,  2.95it/s]Loss: 0.00293:  22%|██▏       | 44/201 [00:14<00:52,  3.01it/s]Loss: 0.00310:  22%|██▏       | 44/201 [00:14<00:52,  3.01it/s]Loss: 0.00310:  22%|██▏       | 45/201 [00:14<00:51,  3.05it/s]Loss: 0.00313:  22%|██▏       | 45/201 [00:14<00:51,  3.05it/s]Loss: 0.00313:  23%|██▎       | 46/201 [00:15<00:50,  3.07it/s]Loss: 0.00327:  23%|██▎       | 46/201 [00:15<00:50,  3.07it/s]Loss: 0.00327:  23%|██▎       | 47/201 [00:15<00:49,  3.09it/s]Loss: 0.00340:  23%|██▎       | 47/201 [00:15<00:49,  3.09it/s]Loss: 0.00340:  24%|██▍       | 48/201 [00:15<00:49,  3.11it/s]Loss: 0.00294:  24%|██▍       | 48/201 [00:15<00:49,  3.11it/s]Loss: 0.00294:  24%|██▍       | 49/201 [00:16<00:48,  3.12it/s]Loss: 0.00293:  24%|██▍       | 49/201 [00:16<00:48,  3.12it/s]Loss: 0.00293:  25%|██▍       | 50/201 [00:16<00:48,  3.13it/s]Loss: 0.00302:  25%|██▍       | 50/201 [00:16<00:48,  3.13it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.23s/it][A1it [00:01,  1.23s/it]
Loss: 0.00302:  25%|██▌       | 51/201 [00:17<01:43,  1.44it/s]Loss: 0.00441:  25%|██▌       | 51/201 [00:17<01:43,  1.44it/s]Loss: 0.00441:  26%|██▌       | 52/201 [00:18<01:26,  1.72it/s]Loss: 0.00360:  26%|██▌       | 52/201 [00:18<01:26,  1.72it/s]Loss: 0.00360:  26%|██▋       | 53/201 [00:18<01:14,  1.99it/s]Loss: 0.00316:  26%|██▋       | 53/201 [00:18<01:14,  1.99it/s]Loss: 0.00316:  27%|██▋       | 54/201 [00:18<01:05,  2.23it/s]Loss: 0.00287:  27%|██▋       | 54/201 [00:18<01:05,  2.23it/s]Loss: 0.00287:  27%|██▋       | 55/201 [00:19<00:59,  2.44it/s]Loss: 0.00266:  27%|██▋       | 55/201 [00:19<00:59,  2.44it/s]Loss: 0.00266:  28%|██▊       | 56/201 [00:19<00:55,  2.61it/s]Loss: 0.00250:  28%|██▊       | 56/201 [00:19<00:55,  2.61it/s]Loss: 0.00250:  28%|██▊       | 57/201 [00:19<00:52,  2.74it/s]Loss: 0.00236:  28%|██▊       | 57/201 [00:19<00:52,  2.74it/s]Loss: 0.00236:  29%|██▉       | 58/201 [00:20<00:50,  2.85it/s]Loss: 0.00224:  29%|██▉       | 58/201 [00:20<00:50,  2.85it/s]Loss: 0.00224:  29%|██▉       | 59/201 [00:20<00:48,  2.92it/s]Loss: 0.00215:  29%|██▉       | 59/201 [00:20<00:48,  2.92it/s]Loss: 0.00215:  30%|██▉       | 60/201 [00:20<00:47,  2.98it/s]Loss: 0.00207:  30%|██▉       | 60/201 [00:20<00:47,  2.98it/s]Loss: 0.00207:  30%|███       | 61/201 [00:21<00:52,  2.66it/s]Loss: 0.00195:  30%|███       | 61/201 [00:21<00:52,  2.66it/s]Loss: 0.00195:  31%|███       | 62/201 [00:21<00:49,  2.79it/s]Loss: 0.00187:  31%|███       | 62/201 [00:21<00:49,  2.79it/s]Loss: 0.00187:  31%|███▏      | 63/201 [00:21<00:47,  2.88it/s]Loss: 0.00180:  31%|███▏      | 63/201 [00:21<00:47,  2.88it/s]Loss: 0.00180:  32%|███▏      | 64/201 [00:22<00:46,  2.95it/s]Loss: 0.00175:  32%|███▏      | 64/201 [00:22<00:46,  2.95it/s]Loss: 0.00175:  32%|███▏      | 65/201 [00:22<00:45,  2.99it/s]Loss: 0.00171:  32%|███▏      | 65/201 [00:22<00:45,  2.99it/s]Loss: 0.00171:  33%|███▎      | 66/201 [00:22<00:44,  3.03it/s]Loss: 0.00167:  33%|███▎      | 66/201 [00:22<00:44,  3.03it/s]Loss: 0.00167:  33%|███▎      | 67/201 [00:23<00:43,  3.06it/s]Loss: 0.00163:  33%|███▎      | 67/201 [00:23<00:43,  3.06it/s]Loss: 0.00163:  34%|███▍      | 68/201 [00:23<00:43,  3.07it/s]Loss: 0.00160:  34%|███▍      | 68/201 [00:23<00:43,  3.07it/s]Loss: 0.00160:  34%|███▍      | 69/201 [00:23<00:42,  3.08it/s]Loss: 0.00156:  34%|███▍      | 69/201 [00:23<00:42,  3.08it/s]Loss: 0.00156:  35%|███▍      | 70/201 [00:24<00:42,  3.09it/s]Loss: 0.00154:  35%|███▍      | 70/201 [00:24<00:42,  3.09it/s]Loss: 0.00154:  35%|███▌      | 71/201 [00:24<00:41,  3.10it/s]Loss: 0.00147:  35%|███▌      | 71/201 [00:24<00:41,  3.10it/s]Loss: 0.00147:  36%|███▌      | 72/201 [00:24<00:41,  3.10it/s]Loss: 0.00142:  36%|███▌      | 72/201 [00:24<00:41,  3.10it/s]Loss: 0.00142:  36%|███▋      | 73/201 [00:25<00:41,  3.11it/s]Loss: 0.00139:  36%|███▋      | 73/201 [00:25<00:41,  3.11it/s]Loss: 0.00139:  37%|███▋      | 74/201 [00:25<00:40,  3.11it/s]Loss: 0.00137:  37%|███▋      | 74/201 [00:25<00:40,  3.11it/s]Loss: 0.00137:  37%|███▋      | 75/201 [00:25<00:40,  3.11it/s]Loss: 0.00135:  37%|███▋      | 75/201 [00:25<00:40,  3.11it/s]Loss: 0.00135:  38%|███▊      | 76/201 [00:26<00:40,  3.11it/s]Loss: 0.00133:  38%|███▊      | 76/201 [00:26<00:40,  3.11it/s]Loss: 0.00133:  38%|███▊      | 77/201 [00:26<00:39,  3.11it/s]Loss: 0.00131:  38%|███▊      | 77/201 [00:26<00:39,  3.11it/s]Loss: 0.00131:  39%|███▉      | 78/201 [00:26<00:39,  3.12it/s]Loss: 0.00129:  39%|███▉      | 78/201 [00:26<00:39,  3.12it/s]Loss: 0.00129:  39%|███▉      | 79/201 [00:27<00:39,  3.12it/s]Loss: 0.00128:  39%|███▉      | 79/201 [00:27<00:39,  3.12it/s]Loss: 0.00128:  40%|███▉      | 80/201 [00:27<00:38,  3.12it/s]Loss: 0.00126:  40%|███▉      | 80/201 [00:27<00:38,  3.12it/s]Loss: 0.00126:  40%|████      | 81/201 [00:27<00:43,  2.73it/s]Loss: 0.00121:  40%|████      | 81/201 [00:27<00:43,  2.73it/s]Loss: 0.00121:  41%|████      | 82/201 [00:28<00:41,  2.85it/s]Loss: 0.00118:  41%|████      | 82/201 [00:28<00:41,  2.85it/s]Loss: 0.00118:  41%|████▏     | 83/201 [00:28<00:40,  2.92it/s]Loss: 0.00116:  41%|████▏     | 83/201 [00:28<00:40,  2.92it/s]Loss: 0.00116:  42%|████▏     | 84/201 [00:28<00:39,  2.98it/s]Loss: 0.00114:  42%|████▏     | 84/201 [00:28<00:39,  2.98it/s]Loss: 0.00114:  42%|████▏     | 85/201 [00:29<00:38,  3.02it/s]Loss: 0.00113:  42%|████▏     | 85/201 [00:29<00:38,  3.02it/s]Loss: 0.00113:  43%|████▎     | 86/201 [00:29<00:37,  3.05it/s]Loss: 0.00113:  43%|████▎     | 86/201 [00:29<00:37,  3.05it/s]Loss: 0.00113:  43%|████▎     | 87/201 [00:29<00:37,  3.07it/s]Loss: 0.00112:  43%|████▎     | 87/201 [00:29<00:37,  3.07it/s]Loss: 0.00112:  44%|████▍     | 88/201 [00:30<00:36,  3.08it/s]Loss: 0.00112:  44%|████▍     | 88/201 [00:30<00:36,  3.08it/s]Loss: 0.00112:  44%|████▍     | 89/201 [00:30<00:36,  3.09it/s]Loss: 0.00109:  44%|████▍     | 89/201 [00:30<00:36,  3.09it/s]Loss: 0.00109:  45%|████▍     | 90/201 [00:30<00:35,  3.10it/s]Loss: 0.00111:  45%|████▍     | 90/201 [00:30<00:35,  3.10it/s]Loss: 0.00111:  45%|████▌     | 91/201 [00:31<00:35,  3.11it/s]Loss: 0.00106:  45%|████▌     | 91/201 [00:31<00:35,  3.11it/s]Loss: 0.00106:  46%|████▌     | 92/201 [00:31<00:35,  3.11it/s]Loss: 0.00104:  46%|████▌     | 92/201 [00:31<00:35,  3.11it/s]Loss: 0.00104:  46%|████▋     | 93/201 [00:31<00:34,  3.11it/s]Loss: 0.00103:  46%|████▋     | 93/201 [00:31<00:34,  3.11it/s]Loss: 0.00103:  47%|████▋     | 94/201 [00:31<00:34,  3.11it/s]Loss: 0.00102:  47%|████▋     | 94/201 [00:31<00:34,  3.11it/s]Loss: 0.00102:  47%|████▋     | 95/201 [00:32<00:34,  3.11it/s]Loss: 0.00100:  47%|████▋     | 95/201 [00:32<00:34,  3.11it/s]Loss: 0.00100:  48%|████▊     | 96/201 [00:32<00:33,  3.11it/s]Loss: 0.00100:  48%|████▊     | 96/201 [00:32<00:33,  3.11it/s]Loss: 0.00100:  48%|████▊     | 97/201 [00:32<00:33,  3.11it/s]Loss: 0.00098:  48%|████▊     | 97/201 [00:32<00:33,  3.11it/s]Loss: 0.00098:  49%|████▉     | 98/201 [00:33<00:33,  3.12it/s]Loss: 0.00098:  49%|████▉     | 98/201 [00:33<00:33,  3.12it/s]Loss: 0.00098:  49%|████▉     | 99/201 [00:33<00:32,  3.12it/s]Loss: 0.00100:  49%|████▉     | 99/201 [00:33<00:32,  3.12it/s]Loss: 0.00100:  50%|████▉     | 100/201 [00:33<00:32,  3.12it/s]Loss: 0.00099:  50%|████▉     | 100/201 [00:33<00:32,  3.12it/s]Loss: 0.00099:  50%|█████     | 101/201 [00:34<00:36,  2.74it/s]Loss: 0.00094:  50%|█████     | 101/201 [00:34<00:36,  2.74it/s]max loss: 0.11199982464313507
Densities: min=0.0, max=1.0, mean=0.1323057860136032
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.34s/it][A1it [00:01,  1.34s/it]
Loss: 0.00094:  51%|█████     | 102/201 [00:36<01:15,  1.32it/s]Loss: 0.00352:  51%|█████     | 102/201 [00:36<01:15,  1.32it/s]Loss: 0.00352:  51%|█████     | 103/201 [00:36<01:01,  1.60it/s]Loss: 0.00317:  51%|█████     | 103/201 [00:36<01:01,  1.60it/s]Loss: 0.00317:  52%|█████▏    | 104/201 [00:36<00:51,  1.87it/s]Loss: 0.00293:  52%|█████▏    | 104/201 [00:36<00:51,  1.87it/s]Loss: 0.00293:  52%|█████▏    | 105/201 [00:37<00:45,  2.12it/s]Loss: 0.00275:  52%|█████▏    | 105/201 [00:37<00:45,  2.12it/s]Loss: 0.00275:  53%|█████▎    | 106/201 [00:37<00:40,  2.35it/s]Loss: 0.00261:  53%|█████▎    | 106/201 [00:37<00:40,  2.35it/s]Loss: 0.00261:  53%|█████▎    | 107/201 [00:37<00:37,  2.54it/s]Loss: 0.00249:  53%|█████▎    | 107/201 [00:37<00:37,  2.54it/s]Loss: 0.00249:  54%|█████▎    | 108/201 [00:37<00:34,  2.69it/s]Loss: 0.00239:  54%|█████▎    | 108/201 [00:37<00:34,  2.69it/s]Loss: 0.00239:  54%|█████▍    | 109/201 [00:38<00:32,  2.80it/s]Loss: 0.00230:  54%|█████▍    | 109/201 [00:38<00:32,  2.80it/s]Loss: 0.00230:  55%|█████▍    | 110/201 [00:38<00:31,  2.89it/s]Loss: 0.00222:  55%|█████▍    | 110/201 [00:38<00:31,  2.89it/s]Loss: 0.00222:  55%|█████▌    | 111/201 [00:38<00:30,  2.96it/s]Loss: 0.00214:  55%|█████▌    | 111/201 [00:38<00:30,  2.96it/s]Loss: 0.00214:  56%|█████▌    | 112/201 [00:39<00:29,  3.00it/s]Loss: 0.00208:  56%|█████▌    | 112/201 [00:39<00:29,  3.00it/s]Loss: 0.00208:  56%|█████▌    | 113/201 [00:39<00:29,  3.03it/s]Loss: 0.00203:  56%|█████▌    | 113/201 [00:39<00:29,  3.03it/s]Loss: 0.00203:  57%|█████▋    | 114/201 [00:39<00:28,  3.06it/s]Loss: 0.00198:  57%|█████▋    | 114/201 [00:39<00:28,  3.06it/s]Loss: 0.00198:  57%|█████▋    | 115/201 [00:40<00:27,  3.08it/s]Loss: 0.00194:  57%|█████▋    | 115/201 [00:40<00:27,  3.08it/s]Loss: 0.00194:  58%|█████▊    | 116/201 [00:40<00:27,  3.09it/s]Loss: 0.00190:  58%|█████▊    | 116/201 [00:40<00:27,  3.09it/s]Loss: 0.00190:  58%|█████▊    | 117/201 [00:40<00:27,  3.10it/s]Loss: 0.00186:  58%|█████▊    | 117/201 [00:40<00:27,  3.10it/s]Loss: 0.00186:  59%|█████▊    | 118/201 [00:41<00:26,  3.10it/s]Loss: 0.00182:  59%|█████▊    | 118/201 [00:41<00:26,  3.10it/s]Loss: 0.00182:  59%|█████▉    | 119/201 [00:41<00:26,  3.11it/s]Loss: 0.00179:  59%|█████▉    | 119/201 [00:41<00:26,  3.11it/s]Loss: 0.00179:  60%|█████▉    | 120/201 [00:41<00:26,  3.11it/s]Loss: 0.00176:  60%|█████▉    | 120/201 [00:41<00:26,  3.11it/s]Loss: 0.00176:  60%|██████    | 121/201 [00:42<00:29,  2.74it/s]Loss: 0.00171:  60%|██████    | 121/201 [00:42<00:29,  2.74it/s]Loss: 0.00171:  61%|██████    | 122/201 [00:42<00:27,  2.85it/s]Loss: 0.00168:  61%|██████    | 122/201 [00:42<00:27,  2.85it/s]Loss: 0.00168:  61%|██████    | 123/201 [00:42<00:26,  2.92it/s]Loss: 0.00166:  61%|██████    | 123/201 [00:42<00:26,  2.92it/s]Loss: 0.00166:  62%|██████▏   | 124/201 [00:43<00:25,  2.98it/s]Loss: 0.00163:  62%|██████▏   | 124/201 [00:43<00:25,  2.98it/s]Loss: 0.00163:  62%|██████▏   | 125/201 [00:43<00:25,  3.02it/s]Loss: 0.00161:  62%|██████▏   | 125/201 [00:43<00:25,  3.02it/s]Loss: 0.00161:  63%|██████▎   | 126/201 [00:43<00:24,  3.05it/s]Loss: 0.00159:  63%|██████▎   | 126/201 [00:43<00:24,  3.05it/s]Loss: 0.00159:  63%|██████▎   | 127/201 [00:44<00:24,  3.07it/s]Loss: 0.00157:  63%|██████▎   | 127/201 [00:44<00:24,  3.07it/s]Loss: 0.00157:  64%|██████▎   | 128/201 [00:44<00:23,  3.08it/s]Loss: 0.00156:  64%|██████▎   | 128/201 [00:44<00:23,  3.08it/s]Loss: 0.00156:  64%|██████▍   | 129/201 [00:44<00:23,  3.09it/s]Loss: 0.00154:  64%|██████▍   | 129/201 [00:44<00:23,  3.09it/s]Loss: 0.00154:  65%|██████▍   | 130/201 [00:45<00:22,  3.10it/s]Loss: 0.00152:  65%|██████▍   | 130/201 [00:45<00:22,  3.10it/s]Loss: 0.00152:  65%|██████▌   | 131/201 [00:45<00:22,  3.10it/s]Loss: 0.00149:  65%|██████▌   | 131/201 [00:45<00:22,  3.10it/s]Loss: 0.00149:  66%|██████▌   | 132/201 [00:45<00:22,  3.11it/s]Loss: 0.00147:  66%|██████▌   | 132/201 [00:45<00:22,  3.11it/s]Loss: 0.00147:  66%|██████▌   | 133/201 [00:46<00:21,  3.11it/s]Loss: 0.00145:  66%|██████▌   | 133/201 [00:46<00:21,  3.11it/s]Loss: 0.00145:  67%|██████▋   | 134/201 [00:46<00:21,  3.11it/s]Loss: 0.00144:  67%|██████▋   | 134/201 [00:46<00:21,  3.11it/s]Loss: 0.00144:  67%|██████▋   | 135/201 [00:46<00:21,  3.11it/s]Loss: 0.00142:  67%|██████▋   | 135/201 [00:46<00:21,  3.11it/s]Loss: 0.00142:  68%|██████▊   | 136/201 [00:47<00:20,  3.11it/s]Loss: 0.00141:  68%|██████▊   | 136/201 [00:47<00:20,  3.11it/s]Loss: 0.00141:  68%|██████▊   | 137/201 [00:47<00:20,  3.11it/s]Loss: 0.00140:  68%|██████▊   | 137/201 [00:47<00:20,  3.11it/s]Loss: 0.00140:  69%|██████▊   | 138/201 [00:47<00:20,  3.11it/s]Loss: 0.00139:  69%|██████▊   | 138/201 [00:47<00:20,  3.11it/s]Loss: 0.00139:  69%|██████▉   | 139/201 [00:48<00:19,  3.12it/s]Loss: 0.00138:  69%|██████▉   | 139/201 [00:48<00:19,  3.12it/s]Loss: 0.00138:  70%|██████▉   | 140/201 [00:48<00:19,  3.11it/s]Loss: 0.00138:  70%|██████▉   | 140/201 [00:48<00:19,  3.11it/s]Loss: 0.00138:  70%|███████   | 141/201 [00:48<00:21,  2.73it/s]Loss: 0.00135:  70%|███████   | 141/201 [00:48<00:21,  2.73it/s]Loss: 0.00135:  71%|███████   | 142/201 [00:49<00:20,  2.84it/s]Loss: 0.00133:  71%|███████   | 142/201 [00:49<00:20,  2.84it/s]Loss: 0.00133:  71%|███████   | 143/201 [00:49<00:19,  2.92it/s]Loss: 0.00132:  71%|███████   | 143/201 [00:49<00:19,  2.92it/s]Loss: 0.00132:  72%|███████▏  | 144/201 [00:49<00:19,  2.98it/s]Loss: 0.00131:  72%|███████▏  | 144/201 [00:49<00:19,  2.98it/s]Loss: 0.00131:  72%|███████▏  | 145/201 [00:50<00:18,  3.02it/s]Loss: 0.00130:  72%|███████▏  | 145/201 [00:50<00:18,  3.02it/s]Loss: 0.00130:  73%|███████▎  | 146/201 [00:50<00:18,  3.05it/s]Loss: 0.00129:  73%|███████▎  | 146/201 [00:50<00:18,  3.05it/s]Loss: 0.00129:  73%|███████▎  | 147/201 [00:50<00:17,  3.07it/s]Loss: 0.00128:  73%|███████▎  | 147/201 [00:50<00:17,  3.07it/s]Loss: 0.00128:  74%|███████▎  | 148/201 [00:51<00:17,  3.08it/s]Loss: 0.00128:  74%|███████▎  | 148/201 [00:51<00:17,  3.08it/s]Loss: 0.00128:  74%|███████▍  | 149/201 [00:51<00:16,  3.09it/s]Loss: 0.00127:  74%|███████▍  | 149/201 [00:51<00:16,  3.09it/s]Loss: 0.00127:  75%|███████▍  | 150/201 [00:51<00:16,  3.10it/s]Loss: 0.00127:  75%|███████▍  | 150/201 [00:51<00:16,  3.10it/s]Loss: 0.00127:  75%|███████▌  | 151/201 [00:52<00:16,  3.11it/s]Loss: 0.00125:  75%|███████▌  | 151/201 [00:52<00:16,  3.11it/s]Loss: 0.00125:  76%|███████▌  | 152/201 [00:52<00:15,  3.11it/s]Loss: 0.00124:  76%|███████▌  | 152/201 [00:52<00:15,  3.11it/s]max loss: 0.09347470849752426
Densities: min=0.0, max=1.0, mean=0.1558712124824524
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.36s/it][A1it [00:01,  1.36s/it]
Loss: 0.00124:  76%|███████▌  | 153/201 [00:54<00:35,  1.37it/s]Loss: 0.00326:  76%|███████▌  | 153/201 [00:54<00:35,  1.37it/s]Loss: 0.00326:  77%|███████▋  | 154/201 [00:54<00:28,  1.64it/s]Loss: 0.00310:  77%|███████▋  | 154/201 [00:54<00:28,  1.64it/s]Loss: 0.00310:  77%|███████▋  | 155/201 [00:54<00:24,  1.92it/s]Loss: 0.00297:  77%|███████▋  | 155/201 [00:54<00:24,  1.92it/s]Loss: 0.00297:  78%|███████▊  | 156/201 [00:55<00:20,  2.17it/s]Loss: 0.00287:  78%|███████▊  | 156/201 [00:55<00:20,  2.17it/s]Loss: 0.00287:  78%|███████▊  | 157/201 [00:55<00:18,  2.38it/s]Loss: 0.00278:  78%|███████▊  | 157/201 [00:55<00:18,  2.38it/s]Loss: 0.00278:  79%|███████▊  | 158/201 [00:55<00:16,  2.56it/s]Loss: 0.00271:  79%|███████▊  | 158/201 [00:55<00:16,  2.56it/s]Loss: 0.00271:  79%|███████▉  | 159/201 [00:56<00:15,  2.71it/s]Loss: 0.00264:  79%|███████▉  | 159/201 [00:56<00:15,  2.71it/s]Loss: 0.00264:  80%|███████▉  | 160/201 [00:56<00:14,  2.82it/s]Loss: 0.00258:  80%|███████▉  | 160/201 [00:56<00:14,  2.82it/s]Loss: 0.00258:  80%|████████  | 161/201 [00:56<00:15,  2.57it/s]Loss: 0.00252:  80%|████████  | 161/201 [00:56<00:15,  2.57it/s]Loss: 0.00252:  81%|████████  | 162/201 [00:57<00:14,  2.72it/s]Loss: 0.00248:  81%|████████  | 162/201 [00:57<00:14,  2.72it/s]Loss: 0.00248:  81%|████████  | 163/201 [00:57<00:13,  2.82it/s]Loss: 0.00244:  81%|████████  | 163/201 [00:57<00:13,  2.82it/s]Loss: 0.00244:  82%|████████▏ | 164/201 [00:57<00:12,  2.91it/s]Loss: 0.00240:  82%|████████▏ | 164/201 [00:57<00:12,  2.91it/s]Loss: 0.00240:  82%|████████▏ | 165/201 [00:58<00:12,  2.97it/s]Loss: 0.00236:  82%|████████▏ | 165/201 [00:58<00:12,  2.97it/s]Loss: 0.00236:  83%|████████▎ | 166/201 [00:58<00:11,  3.01it/s]Loss: 0.00233:  83%|████████▎ | 166/201 [00:58<00:11,  3.01it/s]Loss: 0.00233:  83%|████████▎ | 167/201 [00:58<00:11,  3.04it/s]Loss: 0.00230:  83%|████████▎ | 167/201 [00:58<00:11,  3.04it/s]Loss: 0.00230:  84%|████████▎ | 168/201 [00:59<00:10,  3.06it/s]Loss: 0.00227:  84%|████████▎ | 168/201 [00:59<00:10,  3.06it/s]Loss: 0.00227:  84%|████████▍ | 169/201 [00:59<00:10,  3.08it/s]Loss: 0.00224:  84%|████████▍ | 169/201 [00:59<00:10,  3.08it/s]Loss: 0.00224:  85%|████████▍ | 170/201 [00:59<00:10,  3.09it/s]Loss: 0.00221:  85%|████████▍ | 170/201 [00:59<00:10,  3.09it/s]Loss: 0.00221:  85%|████████▌ | 171/201 [00:59<00:09,  3.10it/s]Loss: 0.00218:  85%|████████▌ | 171/201 [01:00<00:09,  3.10it/s]Loss: 0.00218:  86%|████████▌ | 172/201 [01:00<00:09,  3.11it/s]Loss: 0.00216:  86%|████████▌ | 172/201 [01:00<00:09,  3.11it/s]Loss: 0.00216:  86%|████████▌ | 173/201 [01:00<00:08,  3.11it/s]Loss: 0.00214:  86%|████████▌ | 173/201 [01:00<00:08,  3.11it/s]Loss: 0.00214:  87%|████████▋ | 174/201 [01:00<00:08,  3.11it/s]Loss: 0.00212:  87%|████████▋ | 174/201 [01:00<00:08,  3.11it/s]Loss: 0.00212:  87%|████████▋ | 175/201 [01:01<00:08,  3.12it/s]Loss: 0.00210:  87%|████████▋ | 175/201 [01:01<00:08,  3.12it/s]Loss: 0.00210:  88%|████████▊ | 176/201 [01:01<00:08,  3.12it/s]Loss: 0.00208:  88%|████████▊ | 176/201 [01:01<00:08,  3.12it/s]Loss: 0.00208:  88%|████████▊ | 177/201 [01:01<00:07,  3.12it/s]Loss: 0.00206:  88%|████████▊ | 177/201 [01:01<00:07,  3.12it/s]Loss: 0.00206:  89%|████████▊ | 178/201 [01:02<00:07,  3.12it/s]Loss: 0.00205:  89%|████████▊ | 178/201 [01:02<00:07,  3.12it/s]Loss: 0.00205:  89%|████████▉ | 179/201 [01:02<00:07,  3.12it/s]Loss: 0.00203:  89%|████████▉ | 179/201 [01:02<00:07,  3.12it/s]Loss: 0.00203:  90%|████████▉ | 180/201 [01:02<00:06,  3.12it/s]Loss: 0.00201:  90%|████████▉ | 180/201 [01:02<00:06,  3.12it/s]Loss: 0.00201:  90%|█████████ | 181/201 [01:03<00:07,  2.74it/s]Loss: 0.00199:  90%|█████████ | 181/201 [01:03<00:07,  2.74it/s]Loss: 0.00199:  91%|█████████ | 182/201 [01:03<00:06,  2.85it/s]Loss: 0.00198:  91%|█████████ | 182/201 [01:03<00:06,  2.85it/s]Loss: 0.00198:  91%|█████████ | 183/201 [01:03<00:06,  2.93it/s]Loss: 0.00197:  91%|█████████ | 183/201 [01:03<00:06,  2.93it/s]Loss: 0.00197:  92%|█████████▏| 184/201 [01:04<00:05,  2.98it/s]Loss: 0.00195:  92%|█████████▏| 184/201 [01:04<00:05,  2.98it/s]Loss: 0.00195:  92%|█████████▏| 185/201 [01:04<00:05,  3.02it/s]Loss: 0.00194:  92%|█████████▏| 185/201 [01:04<00:05,  3.02it/s]Loss: 0.00194:  93%|█████████▎| 186/201 [01:04<00:04,  3.05it/s]Loss: 0.00193:  93%|█████████▎| 186/201 [01:04<00:04,  3.05it/s]Loss: 0.00193:  93%|█████████▎| 187/201 [01:05<00:04,  3.07it/s]Loss: 0.00192:  93%|█████████▎| 187/201 [01:05<00:04,  3.07it/s]Loss: 0.00192:  94%|█████████▎| 188/201 [01:05<00:04,  3.09it/s]Loss: 0.00191:  94%|█████████▎| 188/201 [01:05<00:04,  3.09it/s]Loss: 0.00191:  94%|█████████▍| 189/201 [01:05<00:03,  3.10it/s]Loss: 0.00189:  94%|█████████▍| 189/201 [01:05<00:03,  3.10it/s]Loss: 0.00189:  95%|█████████▍| 190/201 [01:06<00:03,  3.11it/s]Loss: 0.00188:  95%|█████████▍| 190/201 [01:06<00:03,  3.11it/s]Loss: 0.00188:  95%|█████████▌| 191/201 [01:06<00:03,  3.11it/s]Loss: 0.00187:  95%|█████████▌| 191/201 [01:06<00:03,  3.11it/s]Loss: 0.00187:  96%|█████████▌| 192/201 [01:06<00:02,  3.11it/s]Loss: 0.00186:  96%|█████████▌| 192/201 [01:06<00:02,  3.11it/s]Loss: 0.00186:  96%|█████████▌| 193/201 [01:07<00:02,  3.12it/s]Loss: 0.00185:  96%|█████████▌| 193/201 [01:07<00:02,  3.12it/s]Loss: 0.00185:  97%|█████████▋| 194/201 [01:07<00:02,  3.12it/s]Loss: 0.00184:  97%|█████████▋| 194/201 [01:07<00:02,  3.12it/s]Loss: 0.00184:  97%|█████████▋| 195/201 [01:07<00:01,  3.12it/s]Loss: 0.00183:  97%|█████████▋| 195/201 [01:07<00:01,  3.12it/s]Loss: 0.00183:  98%|█████████▊| 196/201 [01:08<00:01,  3.12it/s]Loss: 0.00183:  98%|█████████▊| 196/201 [01:08<00:01,  3.12it/s]Loss: 0.00183:  98%|█████████▊| 197/201 [01:08<00:01,  3.12it/s]Loss: 0.00182:  98%|█████████▊| 197/201 [01:08<00:01,  3.12it/s]Loss: 0.00182:  99%|█████████▊| 198/201 [01:08<00:00,  3.12it/s]Loss: 0.00181:  99%|█████████▊| 198/201 [01:08<00:00,  3.12it/s]Loss: 0.00181:  99%|█████████▉| 199/201 [01:09<00:00,  3.12it/s]Loss: 0.00180:  99%|█████████▉| 199/201 [01:09<00:00,  3.12it/s]Loss: 0.00180: 100%|█████████▉| 200/201 [01:09<00:00,  3.12it/s]Loss: 0.00179: 100%|█████████▉| 200/201 [01:09<00:00,  3.12it/s]Loss: 0.00179: 100%|██████████| 201/201 [01:09<00:00,  2.74it/s]Loss: 0.00178: 100%|██████████| 201/201 [01:09<00:00,  2.74it/s]Loss: 0.00178: 100%|██████████| 201/201 [01:09<00:00,  2.88it/s]
max loss: 0.08134974539279938
Densities: min=0.0, max=1.0, mean=0.15839631855487823
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/chameleon_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 69.90734648704529 seconds
-1.0 2.0800781
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/supernova_432x432x432_float32_raw_432x432x432_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json
Initialize network
Latent space memory: 17.5MiB
# of network parameters: 4609281
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.44it/s]1it [00:00,  3.44it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=1.1987038321854566e-14, max=0.994645893573761, mean=0.4139401316642761
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00, 276.76it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 120, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 66, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [432, 432, 432], 'inr': None, 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<04:23,  1.32s/it]Loss: 0.12472:   0%|          | 1/201 [00:01<04:23,  1.32s/it]Loss: 0.12472:   1%|          | 2/201 [00:01<02:55,  1.14it/s]Loss: 0.02413:   1%|          | 2/201 [00:01<02:55,  1.14it/s]Loss: 0.02413:   1%|▏         | 3/201 [00:02<02:26,  1.35it/s]Loss: 0.01465:   1%|▏         | 3/201 [00:02<02:26,  1.35it/s]Loss: 0.01465:   2%|▏         | 4/201 [00:03<02:13,  1.48it/s]Loss: 0.01325:   2%|▏         | 4/201 [00:03<02:13,  1.48it/s]Loss: 0.01325:   2%|▏         | 5/201 [00:03<02:05,  1.56it/s]Loss: 0.01310:   2%|▏         | 5/201 [00:03<02:05,  1.56it/s]Loss: 0.01310:   3%|▎         | 6/201 [00:04<02:00,  1.62it/s]Loss: 0.01233:   3%|▎         | 6/201 [00:04<02:00,  1.62it/s]Loss: 0.01233:   3%|▎         | 7/201 [00:04<01:57,  1.65it/s]Loss: 0.01177:   3%|▎         | 7/201 [00:04<01:57,  1.65it/s]Loss: 0.01177:   4%|▍         | 8/201 [00:05<01:55,  1.68it/s]Loss: 0.01127:   4%|▍         | 8/201 [00:05<01:55,  1.68it/s]Loss: 0.01127:   4%|▍         | 9/201 [00:05<01:53,  1.70it/s]Loss: 0.01096:   4%|▍         | 9/201 [00:05<01:53,  1.70it/s]Loss: 0.01096:   5%|▍         | 10/201 [00:06<01:51,  1.71it/s]Loss: 0.01050:   5%|▍         | 10/201 [00:06<01:51,  1.71it/s]Loss: 0.01050:   5%|▌         | 11/201 [00:07<01:50,  1.72it/s]Loss: 0.01012:   5%|▌         | 11/201 [00:07<01:50,  1.72it/s]Loss: 0.01012:   6%|▌         | 12/201 [00:07<01:49,  1.72it/s]Loss: 0.00983:   6%|▌         | 12/201 [00:07<01:49,  1.72it/s]Loss: 0.00983:   6%|▋         | 13/201 [00:08<01:48,  1.73it/s]Loss: 0.00954:   6%|▋         | 13/201 [00:08<01:48,  1.73it/s]Loss: 0.00954:   7%|▋         | 14/201 [00:08<01:48,  1.73it/s]Loss: 0.00927:   7%|▋         | 14/201 [00:08<01:48,  1.73it/s]Loss: 0.00927:   7%|▋         | 15/201 [00:09<01:47,  1.73it/s]Loss: 0.00907:   7%|▋         | 15/201 [00:09<01:47,  1.73it/s]Loss: 0.00907:   8%|▊         | 16/201 [00:09<01:46,  1.73it/s]Loss: 0.00886:   8%|▊         | 16/201 [00:09<01:46,  1.73it/s]Loss: 0.00886:   8%|▊         | 17/201 [00:10<01:46,  1.73it/s]Loss: 0.00864:   8%|▊         | 17/201 [00:10<01:46,  1.73it/s]Loss: 0.00864:   9%|▉         | 18/201 [00:11<01:45,  1.73it/s]Loss: 0.00837:   9%|▉         | 18/201 [00:11<01:45,  1.73it/s]Loss: 0.00837:   9%|▉         | 19/201 [00:11<01:44,  1.73it/s]Loss: 0.00819:   9%|▉         | 19/201 [00:11<01:44,  1.73it/s]Loss: 0.00819:  10%|▉         | 20/201 [00:12<01:44,  1.73it/s]Loss: 0.00804:  10%|▉         | 20/201 [00:12<01:44,  1.73it/s]Loss: 0.00804:  10%|█         | 21/201 [00:12<01:45,  1.71it/s]Loss: 0.00788:  10%|█         | 21/201 [00:12<01:45,  1.71it/s]Loss: 0.00788:  11%|█         | 22/201 [00:13<01:44,  1.72it/s]Loss: 0.00773:  11%|█         | 22/201 [00:13<01:44,  1.72it/s]Loss: 0.00773:  11%|█▏        | 23/201 [00:14<01:43,  1.72it/s]Loss: 0.00779:  11%|█▏        | 23/201 [00:14<01:43,  1.72it/s]Loss: 0.00779:  12%|█▏        | 24/201 [00:14<01:42,  1.73it/s]Loss: 0.00769:  12%|█▏        | 24/201 [00:14<01:42,  1.73it/s]Loss: 0.00769:  12%|█▏        | 25/201 [00:15<01:41,  1.73it/s]Loss: 0.00747:  12%|█▏        | 25/201 [00:15<01:41,  1.73it/s]Loss: 0.00747:  13%|█▎        | 26/201 [00:15<01:41,  1.73it/s]Loss: 0.00750:  13%|█▎        | 26/201 [00:15<01:41,  1.73it/s]Loss: 0.00750:  13%|█▎        | 27/201 [00:16<01:40,  1.73it/s]Loss: 0.00742:  13%|█▎        | 27/201 [00:16<01:40,  1.73it/s]Loss: 0.00742:  14%|█▍        | 28/201 [00:16<01:39,  1.73it/s]Loss: 0.00732:  14%|█▍        | 28/201 [00:16<01:39,  1.73it/s]Loss: 0.00732:  14%|█▍        | 29/201 [00:17<01:39,  1.73it/s]Loss: 0.00729:  14%|█▍        | 29/201 [00:17<01:39,  1.73it/s]Loss: 0.00729:  15%|█▍        | 30/201 [00:18<01:38,  1.73it/s]Loss: 0.00702:  15%|█▍        | 30/201 [00:18<01:38,  1.73it/s]Loss: 0.00702:  15%|█▌        | 31/201 [00:18<01:38,  1.73it/s]Loss: 0.00689:  15%|█▌        | 31/201 [00:18<01:38,  1.73it/s]Loss: 0.00689:  16%|█▌        | 32/201 [00:19<01:37,  1.73it/s]Loss: 0.00687:  16%|█▌        | 32/201 [00:19<01:37,  1.73it/s]Loss: 0.00687:  16%|█▋        | 33/201 [00:19<01:37,  1.73it/s]Loss: 0.00679:  16%|█▋        | 33/201 [00:19<01:37,  1.73it/s]Loss: 0.00679:  17%|█▋        | 34/201 [00:20<01:36,  1.73it/s]Loss: 0.00677:  17%|█▋        | 34/201 [00:20<01:36,  1.73it/s]Loss: 0.00677:  17%|█▋        | 35/201 [00:20<01:35,  1.73it/s]Loss: 0.00686:  17%|█▋        | 35/201 [00:20<01:35,  1.73it/s]Loss: 0.00686:  18%|█▊        | 36/201 [00:21<01:35,  1.73it/s]Loss: 0.00667:  18%|█▊        | 36/201 [00:21<01:35,  1.73it/s]Loss: 0.00667:  18%|█▊        | 37/201 [00:22<01:34,  1.73it/s]Loss: 0.00657:  18%|█▊        | 37/201 [00:22<01:34,  1.73it/s]Loss: 0.00657:  19%|█▉        | 38/201 [00:22<01:34,  1.73it/s]Loss: 0.00654:  19%|█▉        | 38/201 [00:22<01:34,  1.73it/s]Loss: 0.00654:  19%|█▉        | 39/201 [00:23<01:33,  1.73it/s]Loss: 0.00640:  19%|█▉        | 39/201 [00:23<01:33,  1.73it/s]Loss: 0.00640:  20%|█▉        | 40/201 [00:23<01:32,  1.73it/s]Loss: 0.00646:  20%|█▉        | 40/201 [00:23<01:32,  1.73it/s]Loss: 0.00646:  20%|██        | 41/201 [00:24<01:33,  1.71it/s]Loss: 0.00662:  20%|██        | 41/201 [00:24<01:33,  1.71it/s]Loss: 0.00662:  21%|██        | 42/201 [00:25<01:32,  1.72it/s]Loss: 0.00652:  21%|██        | 42/201 [00:25<01:32,  1.72it/s]Loss: 0.00652:  21%|██▏       | 43/201 [00:25<01:31,  1.72it/s]Loss: 0.00636:  21%|██▏       | 43/201 [00:25<01:31,  1.72it/s]Loss: 0.00636:  22%|██▏       | 44/201 [00:26<01:31,  1.72it/s]Loss: 0.00625:  22%|██▏       | 44/201 [00:26<01:31,  1.72it/s]Loss: 0.00625:  22%|██▏       | 45/201 [00:26<01:30,  1.73it/s]Loss: 0.00623:  22%|██▏       | 45/201 [00:26<01:30,  1.73it/s]Loss: 0.00623:  23%|██▎       | 46/201 [00:27<01:29,  1.73it/s]Loss: 0.00611:  23%|██▎       | 46/201 [00:27<01:29,  1.73it/s]Loss: 0.00611:  23%|██▎       | 47/201 [00:27<01:29,  1.73it/s]Loss: 0.00619:  23%|██▎       | 47/201 [00:27<01:29,  1.73it/s]Loss: 0.00619:  24%|██▍       | 48/201 [00:28<01:28,  1.73it/s]Loss: 0.00614:  24%|██▍       | 48/201 [00:28<01:28,  1.73it/s]Loss: 0.00614:  24%|██▍       | 49/201 [00:29<01:27,  1.73it/s]Loss: 0.00618:  24%|██▍       | 49/201 [00:29<01:27,  1.73it/s]Loss: 0.00618:  25%|██▍       | 50/201 [00:29<01:27,  1.73it/s]Loss: 0.00613:  25%|██▍       | 50/201 [00:29<01:27,  1.73it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.47s/it][A1it [00:01,  1.47s/it]
Loss: 0.00613:  25%|██▌       | 51/201 [00:31<02:33,  1.02s/it]Loss: 0.02141:  25%|██▌       | 51/201 [00:31<02:33,  1.02s/it]Loss: 0.02141:  26%|██▌       | 52/201 [00:32<02:12,  1.12it/s]Loss: 0.00936:  26%|██▌       | 52/201 [00:32<02:12,  1.12it/s]Loss: 0.00936:  26%|██▋       | 53/201 [00:32<01:58,  1.25it/s]Loss: 0.00661:  26%|██▋       | 53/201 [00:32<01:58,  1.25it/s]Loss: 0.00661:  27%|██▋       | 54/201 [00:33<01:47,  1.36it/s]Loss: 0.00544:  27%|██▋       | 54/201 [00:33<01:47,  1.36it/s]Loss: 0.00544:  27%|██▋       | 55/201 [00:34<01:40,  1.45it/s]Loss: 0.00657:  27%|██▋       | 55/201 [00:34<01:40,  1.45it/s]Loss: 0.00657:  28%|██▊       | 56/201 [00:34<01:35,  1.52it/s]Loss: 0.00651:  28%|██▊       | 56/201 [00:34<01:35,  1.52it/s]Loss: 0.00651:  28%|██▊       | 57/201 [00:35<01:31,  1.58it/s]Loss: 0.00457:  28%|██▊       | 57/201 [00:35<01:31,  1.58it/s]Loss: 0.00457:  29%|██▉       | 58/201 [00:35<01:28,  1.62it/s]Loss: 0.00434:  29%|██▉       | 58/201 [00:35<01:28,  1.62it/s]Loss: 0.00434:  29%|██▉       | 59/201 [00:36<01:26,  1.64it/s]Loss: 0.00422:  29%|██▉       | 59/201 [00:36<01:26,  1.64it/s]Loss: 0.00422:  30%|██▉       | 60/201 [00:36<01:24,  1.67it/s]Loss: 0.00400:  30%|██▉       | 60/201 [00:36<01:24,  1.67it/s]Loss: 0.00400:  30%|███       | 61/201 [00:37<01:24,  1.66it/s]Loss: 0.00399:  30%|███       | 61/201 [00:37<01:24,  1.66it/s]Loss: 0.00399:  31%|███       | 62/201 [00:38<01:22,  1.68it/s]Loss: 0.00381:  31%|███       | 62/201 [00:38<01:22,  1.68it/s]Loss: 0.00381:  31%|███▏      | 63/201 [00:38<01:21,  1.69it/s]Loss: 0.00383:  31%|███▏      | 63/201 [00:38<01:21,  1.69it/s]Loss: 0.00383:  32%|███▏      | 64/201 [00:39<01:20,  1.70it/s]Loss: 0.00368:  32%|███▏      | 64/201 [00:39<01:20,  1.70it/s]Loss: 0.00368:  32%|███▏      | 65/201 [00:39<01:19,  1.70it/s]Loss: 0.00371:  32%|███▏      | 65/201 [00:39<01:19,  1.70it/s]Loss: 0.00371:  33%|███▎      | 66/201 [00:40<01:19,  1.71it/s]Loss: 0.00358:  33%|███▎      | 66/201 [00:40<01:19,  1.71it/s]Loss: 0.00358:  33%|███▎      | 67/201 [00:41<01:18,  1.71it/s]Loss: 0.00363:  33%|███▎      | 67/201 [00:41<01:18,  1.71it/s]Loss: 0.00363:  34%|███▍      | 68/201 [00:41<01:17,  1.71it/s]Loss: 0.00351:  34%|███▍      | 68/201 [00:41<01:17,  1.71it/s]Loss: 0.00351:  34%|███▍      | 69/201 [00:42<01:17,  1.71it/s]Loss: 0.00353:  34%|███▍      | 69/201 [00:42<01:17,  1.71it/s]Loss: 0.00353:  35%|███▍      | 70/201 [00:42<01:16,  1.71it/s]Loss: 0.00344:  35%|███▍      | 70/201 [00:42<01:16,  1.71it/s]Loss: 0.00344:  35%|███▌      | 71/201 [00:43<01:15,  1.72it/s]Loss: 0.00347:  35%|███▌      | 71/201 [00:43<01:15,  1.72it/s]Loss: 0.00347:  36%|███▌      | 72/201 [00:43<01:15,  1.72it/s]Loss: 0.00340:  36%|███▌      | 72/201 [00:43<01:15,  1.72it/s]Loss: 0.00340:  36%|███▋      | 73/201 [00:44<01:14,  1.72it/s]Loss: 0.00342:  36%|███▋      | 73/201 [00:44<01:14,  1.72it/s]Loss: 0.00342:  37%|███▋      | 74/201 [00:45<01:14,  1.71it/s]Loss: 0.00334:  37%|███▋      | 74/201 [00:45<01:14,  1.71it/s]Loss: 0.00334:  37%|███▋      | 75/201 [00:45<01:13,  1.71it/s]Loss: 0.00339:  37%|███▋      | 75/201 [00:45<01:13,  1.71it/s]Loss: 0.00339:  38%|███▊      | 76/201 [00:46<01:12,  1.72it/s]Loss: 0.00331:  38%|███▊      | 76/201 [00:46<01:12,  1.72it/s]Loss: 0.00331:  38%|███▊      | 77/201 [00:46<01:12,  1.72it/s]Loss: 0.00334:  38%|███▊      | 77/201 [00:46<01:12,  1.72it/s]Loss: 0.00334:  39%|███▉      | 78/201 [00:47<01:11,  1.72it/s]Loss: 0.00327:  39%|███▉      | 78/201 [00:47<01:11,  1.72it/s]Loss: 0.00327:  39%|███▉      | 79/201 [00:48<01:11,  1.72it/s]Loss: 0.00330:  39%|███▉      | 79/201 [00:48<01:11,  1.72it/s]Loss: 0.00330:  40%|███▉      | 80/201 [00:48<01:10,  1.72it/s]Loss: 0.00323:  40%|███▉      | 80/201 [00:48<01:10,  1.72it/s]Loss: 0.00323:  40%|████      | 81/201 [00:49<01:10,  1.69it/s]Loss: 0.00328:  40%|████      | 81/201 [00:49<01:10,  1.69it/s]Loss: 0.00328:  41%|████      | 82/201 [00:49<01:09,  1.70it/s]Loss: 0.00323:  41%|████      | 82/201 [00:49<01:09,  1.70it/s]Loss: 0.00323:  41%|████▏     | 83/201 [00:50<01:09,  1.71it/s]Loss: 0.00324:  41%|████▏     | 83/201 [00:50<01:09,  1.71it/s]Loss: 0.00324:  42%|████▏     | 84/201 [00:50<01:08,  1.71it/s]Loss: 0.00317:  42%|████▏     | 84/201 [00:50<01:08,  1.71it/s]Loss: 0.00317:  42%|████▏     | 85/201 [00:51<01:07,  1.71it/s]Loss: 0.00322:  42%|████▏     | 85/201 [00:51<01:07,  1.71it/s]Loss: 0.00322:  43%|████▎     | 86/201 [00:52<01:07,  1.71it/s]Loss: 0.00321:  43%|████▎     | 86/201 [00:52<01:07,  1.71it/s]Loss: 0.00321:  43%|████▎     | 87/201 [00:52<01:06,  1.71it/s]Loss: 0.00323:  43%|████▎     | 87/201 [00:52<01:06,  1.71it/s]Loss: 0.00323:  44%|████▍     | 88/201 [00:53<01:05,  1.71it/s]Loss: 0.00316:  44%|████▍     | 88/201 [00:53<01:05,  1.71it/s]Loss: 0.00316:  44%|████▍     | 89/201 [00:53<01:05,  1.72it/s]Loss: 0.00321:  44%|████▍     | 89/201 [00:53<01:05,  1.72it/s]Loss: 0.00321:  45%|████▍     | 90/201 [00:54<01:04,  1.72it/s]Loss: 0.00319:  45%|████▍     | 90/201 [00:54<01:04,  1.72it/s]Loss: 0.00319:  45%|████▌     | 91/201 [00:55<01:03,  1.72it/s]Loss: 0.00321:  45%|████▌     | 91/201 [00:55<01:03,  1.72it/s]Loss: 0.00321:  46%|████▌     | 92/201 [00:55<01:03,  1.72it/s]Loss: 0.00314:  46%|████▌     | 92/201 [00:55<01:03,  1.72it/s]Loss: 0.00314:  46%|████▋     | 93/201 [00:56<01:02,  1.72it/s]Loss: 0.00316:  46%|████▋     | 93/201 [00:56<01:02,  1.72it/s]Loss: 0.00316:  47%|████▋     | 94/201 [00:56<01:02,  1.72it/s]Loss: 0.00332:  47%|████▋     | 94/201 [00:56<01:02,  1.72it/s]Loss: 0.00332:  47%|████▋     | 95/201 [00:57<01:01,  1.72it/s]Loss: 0.00320:  47%|████▋     | 95/201 [00:57<01:01,  1.72it/s]Loss: 0.00320:  48%|████▊     | 96/201 [00:57<01:01,  1.72it/s]Loss: 0.00327:  48%|████▊     | 96/201 [00:57<01:01,  1.72it/s]Loss: 0.00327:  48%|████▊     | 97/201 [00:58<01:00,  1.72it/s]Loss: 0.00312:  48%|████▊     | 97/201 [00:58<01:00,  1.72it/s]Loss: 0.00312:  49%|████▉     | 98/201 [00:59<00:59,  1.72it/s]Loss: 0.00314:  49%|████▉     | 98/201 [00:59<00:59,  1.72it/s]Loss: 0.00314:  49%|████▉     | 99/201 [00:59<00:59,  1.72it/s]Loss: 0.00312:  49%|████▉     | 99/201 [00:59<00:59,  1.72it/s]Loss: 0.00312:  50%|████▉     | 100/201 [01:00<00:58,  1.72it/s]Loss: 0.00339:  50%|████▉     | 100/201 [01:00<00:58,  1.72it/s]Loss: 0.00339:  50%|█████     | 101/201 [01:00<00:59,  1.69it/s]Loss: 0.00311:  50%|█████     | 101/201 [01:00<00:59,  1.69it/s]max loss: 0.4012152850627899
Densities: min=2.310280246053736e-15, max=0.9978476762771606, mean=0.09356240928173065
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.43s/it][A1it [00:01,  1.43s/it]
Loss: 0.00311:  51%|█████     | 102/201 [01:02<01:40,  1.02s/it]Loss: 0.00381:  51%|█████     | 102/201 [01:02<01:40,  1.02s/it]Loss: 0.00381:  51%|█████     | 103/201 [01:03<01:27,  1.13it/s]Loss: 0.00329:  51%|█████     | 103/201 [01:03<01:27,  1.13it/s]Loss: 0.00329:  52%|█████▏    | 104/201 [01:04<01:17,  1.26it/s]Loss: 0.00333:  52%|█████▏    | 104/201 [01:04<01:17,  1.26it/s]Loss: 0.00333:  52%|█████▏    | 105/201 [01:04<01:10,  1.37it/s]Loss: 0.00379:  52%|█████▏    | 105/201 [01:04<01:10,  1.37it/s]Loss: 0.00379:  53%|█████▎    | 106/201 [01:05<01:05,  1.46it/s]Loss: 0.00377:  53%|█████▎    | 106/201 [01:05<01:05,  1.46it/s]Loss: 0.00377:  53%|█████▎    | 107/201 [01:05<01:01,  1.53it/s]Loss: 0.00374:  53%|█████▎    | 107/201 [01:05<01:01,  1.53it/s]Loss: 0.00374:  54%|█████▎    | 108/201 [01:06<00:58,  1.58it/s]Loss: 0.00377:  54%|█████▎    | 108/201 [01:06<00:58,  1.58it/s]Loss: 0.00377:  54%|█████▍    | 109/201 [01:06<00:56,  1.62it/s]Loss: 0.00371:  54%|█████▍    | 109/201 [01:06<00:56,  1.62it/s]Loss: 0.00371:  55%|█████▍    | 110/201 [01:07<00:55,  1.65it/s]Loss: 0.00375:  55%|█████▍    | 110/201 [01:07<00:55,  1.65it/s]Loss: 0.00375:  55%|█████▌    | 111/201 [01:08<00:53,  1.67it/s]Loss: 0.00373:  55%|█████▌    | 111/201 [01:08<00:53,  1.67it/s]Loss: 0.00373:  56%|█████▌    | 112/201 [01:08<00:52,  1.68it/s]Loss: 0.00381:  56%|█████▌    | 112/201 [01:08<00:52,  1.68it/s]Loss: 0.00381:  56%|█████▌    | 113/201 [01:09<00:51,  1.69it/s]Loss: 0.00373:  56%|█████▌    | 113/201 [01:09<00:51,  1.69it/s]Loss: 0.00373:  57%|█████▋    | 114/201 [01:09<00:51,  1.70it/s]Loss: 0.00369:  57%|█████▋    | 114/201 [01:09<00:51,  1.70it/s]Loss: 0.00369:  57%|█████▋    | 115/201 [01:10<00:50,  1.70it/s]Loss: 0.00365:  57%|█████▋    | 115/201 [01:10<00:50,  1.70it/s]Loss: 0.00365:  58%|█████▊    | 116/201 [01:11<00:49,  1.71it/s]Loss: 0.00370:  58%|█████▊    | 116/201 [01:11<00:49,  1.71it/s]Loss: 0.00370:  58%|█████▊    | 117/201 [01:11<00:49,  1.71it/s]Loss: 0.00370:  58%|█████▊    | 117/201 [01:11<00:49,  1.71it/s]Loss: 0.00370:  59%|█████▊    | 118/201 [01:12<00:48,  1.71it/s]Loss: 0.00374:  59%|█████▊    | 118/201 [01:12<00:48,  1.71it/s]Loss: 0.00374:  59%|█████▉    | 119/201 [01:12<00:47,  1.71it/s]Loss: 0.00365:  59%|█████▉    | 119/201 [01:12<00:47,  1.71it/s]Loss: 0.00365:  60%|█████▉    | 120/201 [01:13<00:47,  1.71it/s]Loss: 0.00365:  60%|█████▉    | 120/201 [01:13<00:47,  1.71it/s]Loss: 0.00365:  60%|██████    | 121/201 [01:14<00:47,  1.69it/s]Loss: 0.00310:  60%|██████    | 121/201 [01:14<00:47,  1.69it/s]Loss: 0.00310:  61%|██████    | 122/201 [01:14<00:46,  1.70it/s]Loss: 0.00289:  61%|██████    | 122/201 [01:14<00:46,  1.70it/s]Loss: 0.00289:  61%|██████    | 123/201 [01:15<00:45,  1.70it/s]Loss: 0.00267:  61%|██████    | 123/201 [01:15<00:45,  1.70it/s]Loss: 0.00267:  62%|██████▏   | 124/201 [01:15<00:45,  1.71it/s]Loss: 0.00267:  62%|██████▏   | 124/201 [01:15<00:45,  1.71it/s]Loss: 0.00267:  62%|██████▏   | 125/201 [01:16<00:44,  1.71it/s]Loss: 0.00295:  62%|██████▏   | 125/201 [01:16<00:44,  1.71it/s]Loss: 0.00295:  63%|██████▎   | 126/201 [01:16<00:43,  1.71it/s]Loss: 0.00298:  63%|██████▎   | 126/201 [01:16<00:43,  1.71it/s]Loss: 0.00298:  63%|██████▎   | 127/201 [01:17<00:43,  1.71it/s]Loss: 0.00292:  63%|██████▎   | 127/201 [01:17<00:43,  1.71it/s]Loss: 0.00292:  64%|██████▎   | 128/201 [01:18<00:42,  1.71it/s]Loss: 0.00291:  64%|██████▎   | 128/201 [01:18<00:42,  1.71it/s]Loss: 0.00291:  64%|██████▍   | 129/201 [01:18<00:41,  1.71it/s]Loss: 0.00289:  64%|██████▍   | 129/201 [01:18<00:41,  1.71it/s]Loss: 0.00289:  65%|██████▍   | 130/201 [01:19<00:41,  1.71it/s]Loss: 0.00292:  65%|██████▍   | 130/201 [01:19<00:41,  1.71it/s]Loss: 0.00292:  65%|██████▌   | 131/201 [01:19<00:40,  1.72it/s]Loss: 0.00291:  65%|██████▌   | 131/201 [01:19<00:40,  1.72it/s]Loss: 0.00291:  66%|██████▌   | 132/201 [01:20<00:40,  1.72it/s]Loss: 0.00290:  66%|██████▌   | 132/201 [01:20<00:40,  1.72it/s]Loss: 0.00290:  66%|██████▌   | 133/201 [01:21<00:39,  1.72it/s]Loss: 0.00290:  66%|██████▌   | 133/201 [01:21<00:39,  1.72it/s]Loss: 0.00290:  67%|██████▋   | 134/201 [01:21<00:39,  1.72it/s]Loss: 0.00291:  67%|██████▋   | 134/201 [01:21<00:39,  1.72it/s]Loss: 0.00291:  67%|██████▋   | 135/201 [01:22<00:38,  1.72it/s]Loss: 0.00290:  67%|██████▋   | 135/201 [01:22<00:38,  1.72it/s]Loss: 0.00290:  68%|██████▊   | 136/201 [01:22<00:37,  1.72it/s]Loss: 0.00289:  68%|██████▊   | 136/201 [01:22<00:37,  1.72it/s]Loss: 0.00289:  68%|██████▊   | 137/201 [01:23<00:37,  1.72it/s]Loss: 0.00288:  68%|██████▊   | 137/201 [01:23<00:37,  1.72it/s]Loss: 0.00288:  69%|██████▊   | 138/201 [01:23<00:36,  1.72it/s]Loss: 0.00287:  69%|██████▊   | 138/201 [01:23<00:36,  1.72it/s]Loss: 0.00287:  69%|██████▉   | 139/201 [01:24<00:36,  1.72it/s]Loss: 0.00287:  69%|██████▉   | 139/201 [01:24<00:36,  1.72it/s]Loss: 0.00287:  70%|██████▉   | 140/201 [01:25<00:35,  1.72it/s]Loss: 0.00287:  70%|██████▉   | 140/201 [01:25<00:35,  1.72it/s]Loss: 0.00287:  70%|███████   | 141/201 [01:25<00:35,  1.69it/s]Loss: 0.00286:  70%|███████   | 141/201 [01:25<00:35,  1.69it/s]Loss: 0.00286:  71%|███████   | 142/201 [01:26<00:34,  1.70it/s]Loss: 0.00286:  71%|███████   | 142/201 [01:26<00:34,  1.70it/s]Loss: 0.00286:  71%|███████   | 143/201 [01:26<00:34,  1.71it/s]Loss: 0.00285:  71%|███████   | 143/201 [01:26<00:34,  1.71it/s]Loss: 0.00285:  72%|███████▏  | 144/201 [01:27<00:33,  1.71it/s]Loss: 0.00285:  72%|███████▏  | 144/201 [01:27<00:33,  1.71it/s]Loss: 0.00285:  72%|███████▏  | 145/201 [01:28<00:32,  1.71it/s]Loss: 0.00285:  72%|███████▏  | 145/201 [01:28<00:32,  1.71it/s]Loss: 0.00285:  73%|███████▎  | 146/201 [01:28<00:32,  1.71it/s]Loss: 0.00285:  73%|███████▎  | 146/201 [01:28<00:32,  1.71it/s]Loss: 0.00285:  73%|███████▎  | 147/201 [01:29<00:31,  1.71it/s]Loss: 0.00284:  73%|███████▎  | 147/201 [01:29<00:31,  1.71it/s]Loss: 0.00284:  74%|███████▎  | 148/201 [01:29<00:30,  1.71it/s]Loss: 0.00285:  74%|███████▎  | 148/201 [01:29<00:30,  1.71it/s]Loss: 0.00285:  74%|███████▍  | 149/201 [01:30<00:30,  1.72it/s]Loss: 0.00286:  74%|███████▍  | 149/201 [01:30<00:30,  1.72it/s]Loss: 0.00286:  75%|███████▍  | 150/201 [01:30<00:29,  1.72it/s]Loss: 0.00285:  75%|███████▍  | 150/201 [01:30<00:29,  1.72it/s]Loss: 0.00285:  75%|███████▌  | 151/201 [01:31<00:29,  1.72it/s]Loss: 0.00284:  75%|███████▌  | 151/201 [01:31<00:29,  1.72it/s]Loss: 0.00284:  76%|███████▌  | 152/201 [01:32<00:28,  1.71it/s]Loss: 0.00283:  76%|███████▌  | 152/201 [01:32<00:28,  1.71it/s]max loss: 0.07314030081033707
Densities: min=2.764855723790807e-15, max=0.996854305267334, mean=0.1449815183877945
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.48s/it][A1it [00:01,  1.48s/it]
Loss: 0.00283:  76%|███████▌  | 153/201 [01:34<00:49,  1.03s/it]Loss: 0.00430:  76%|███████▌  | 153/201 [01:34<00:49,  1.03s/it]Loss: 0.00430:  77%|███████▋  | 154/201 [01:34<00:42,  1.11it/s]Loss: 0.00414:  77%|███████▋  | 154/201 [01:34<00:42,  1.11it/s]Loss: 0.00414:  77%|███████▋  | 155/201 [01:35<00:36,  1.24it/s]Loss: 0.00408:  77%|███████▋  | 155/201 [01:35<00:36,  1.24it/s]Loss: 0.00408:  78%|███████▊  | 156/201 [01:35<00:33,  1.36it/s]Loss: 0.00405:  78%|███████▊  | 156/201 [01:35<00:33,  1.36it/s]Loss: 0.00405:  78%|███████▊  | 157/201 [01:36<00:30,  1.45it/s]Loss: 0.00399:  78%|███████▊  | 157/201 [01:36<00:30,  1.45it/s]Loss: 0.00399:  79%|███████▊  | 158/201 [01:37<00:28,  1.52it/s]Loss: 0.00407:  79%|███████▊  | 158/201 [01:37<00:28,  1.52it/s]Loss: 0.00407:  79%|███████▉  | 159/201 [01:37<00:26,  1.57it/s]Loss: 0.00397:  79%|███████▉  | 159/201 [01:37<00:26,  1.57it/s]Loss: 0.00397:  80%|███████▉  | 160/201 [01:38<00:25,  1.61it/s]Loss: 0.00398:  80%|███████▉  | 160/201 [01:38<00:25,  1.61it/s]Loss: 0.00398:  80%|████████  | 161/201 [01:38<00:24,  1.62it/s]Loss: 0.00393:  80%|████████  | 161/201 [01:38<00:24,  1.62it/s]Loss: 0.00393:  81%|████████  | 162/201 [01:39<00:23,  1.65it/s]Loss: 0.00396:  81%|████████  | 162/201 [01:39<00:23,  1.65it/s]Loss: 0.00396:  81%|████████  | 163/201 [01:40<00:22,  1.67it/s]Loss: 0.00396:  81%|████████  | 163/201 [01:40<00:22,  1.67it/s]Loss: 0.00396:  82%|████████▏ | 164/201 [01:40<00:21,  1.68it/s]Loss: 0.00393:  82%|████████▏ | 164/201 [01:40<00:21,  1.68it/s]Loss: 0.00393:  82%|████████▏ | 165/201 [01:41<00:21,  1.69it/s]Loss: 0.00393:  82%|████████▏ | 165/201 [01:41<00:21,  1.69it/s]Loss: 0.00393:  83%|████████▎ | 166/201 [01:41<00:20,  1.70it/s]Loss: 0.00390:  83%|████████▎ | 166/201 [01:41<00:20,  1.70it/s]Loss: 0.00390:  83%|████████▎ | 167/201 [01:42<00:19,  1.71it/s]Loss: 0.00389:  83%|████████▎ | 167/201 [01:42<00:19,  1.71it/s]Loss: 0.00389:  84%|████████▎ | 168/201 [01:42<00:19,  1.71it/s]Loss: 0.00391:  84%|████████▎ | 168/201 [01:42<00:19,  1.71it/s]Loss: 0.00391:  84%|████████▍ | 169/201 [01:43<00:18,  1.71it/s]Loss: 0.00389:  84%|████████▍ | 169/201 [01:43<00:18,  1.71it/s]Loss: 0.00389:  85%|████████▍ | 170/201 [01:44<00:18,  1.71it/s]Loss: 0.00390:  85%|████████▍ | 170/201 [01:44<00:18,  1.71it/s]Loss: 0.00390:  85%|████████▌ | 171/201 [01:44<00:17,  1.71it/s]Loss: 0.00390:  85%|████████▌ | 171/201 [01:44<00:17,  1.71it/s]Loss: 0.00390:  86%|████████▌ | 172/201 [01:45<00:16,  1.71it/s]Loss: 0.00384:  86%|████████▌ | 172/201 [01:45<00:16,  1.71it/s]Loss: 0.00384:  86%|████████▌ | 173/201 [01:45<00:16,  1.71it/s]Loss: 0.00388:  86%|████████▌ | 173/201 [01:45<00:16,  1.71it/s]Loss: 0.00388:  87%|████████▋ | 174/201 [01:46<00:15,  1.71it/s]Loss: 0.00389:  87%|████████▋ | 174/201 [01:46<00:15,  1.71it/s]Loss: 0.00389:  87%|████████▋ | 175/201 [01:47<00:15,  1.71it/s]Loss: 0.00388:  87%|████████▋ | 175/201 [01:47<00:15,  1.71it/s]Loss: 0.00388:  88%|████████▊ | 176/201 [01:47<00:14,  1.71it/s]Loss: 0.00395:  88%|████████▊ | 176/201 [01:47<00:14,  1.71it/s]Loss: 0.00395:  88%|████████▊ | 177/201 [01:48<00:13,  1.71it/s]Loss: 0.00398:  88%|████████▊ | 177/201 [01:48<00:13,  1.71it/s]Loss: 0.00398:  89%|████████▊ | 178/201 [01:48<00:13,  1.71it/s]Loss: 0.00382:  89%|████████▊ | 178/201 [01:48<00:13,  1.71it/s]Loss: 0.00382:  89%|████████▉ | 179/201 [01:49<00:12,  1.71it/s]Loss: 0.00385:  89%|████████▉ | 179/201 [01:49<00:12,  1.71it/s]Loss: 0.00385:  90%|████████▉ | 180/201 [01:49<00:12,  1.72it/s]Loss: 0.00386:  90%|████████▉ | 180/201 [01:49<00:12,  1.72it/s]Loss: 0.00386:  90%|█████████ | 181/201 [01:50<00:11,  1.69it/s]Loss: 0.00386:  90%|█████████ | 181/201 [01:50<00:11,  1.69it/s]Loss: 0.00386:  91%|█████████ | 182/201 [01:51<00:11,  1.70it/s]Loss: 0.00384:  91%|█████████ | 182/201 [01:51<00:11,  1.70it/s]Loss: 0.00384:  91%|█████████ | 183/201 [01:51<00:10,  1.70it/s]Loss: 0.00381:  91%|█████████ | 183/201 [01:51<00:10,  1.70it/s]Loss: 0.00381:  92%|█████████▏| 184/201 [01:52<00:09,  1.71it/s]Loss: 0.00381:  92%|█████████▏| 184/201 [01:52<00:09,  1.71it/s]Loss: 0.00381:  92%|█████████▏| 185/201 [01:52<00:09,  1.71it/s]Loss: 0.00380:  92%|█████████▏| 185/201 [01:52<00:09,  1.71it/s]Loss: 0.00380:  93%|█████████▎| 186/201 [01:53<00:08,  1.71it/s]Loss: 0.00387:  93%|█████████▎| 186/201 [01:53<00:08,  1.71it/s]Loss: 0.00387:  93%|█████████▎| 187/201 [01:54<00:08,  1.71it/s]Loss: 0.00383:  93%|█████████▎| 187/201 [01:54<00:08,  1.71it/s]Loss: 0.00383:  94%|█████████▎| 188/201 [01:54<00:07,  1.71it/s]Loss: 0.00378:  94%|█████████▎| 188/201 [01:54<00:07,  1.71it/s]Loss: 0.00378:  94%|█████████▍| 189/201 [01:55<00:06,  1.72it/s]Loss: 0.00379:  94%|█████████▍| 189/201 [01:55<00:06,  1.72it/s]Loss: 0.00379:  95%|█████████▍| 190/201 [01:55<00:06,  1.72it/s]Loss: 0.00383:  95%|█████████▍| 190/201 [01:55<00:06,  1.72it/s]Loss: 0.00383:  95%|█████████▌| 191/201 [01:56<00:05,  1.72it/s]Loss: 0.00381:  95%|█████████▌| 191/201 [01:56<00:05,  1.72it/s]Loss: 0.00381:  96%|█████████▌| 192/201 [01:56<00:05,  1.72it/s]Loss: 0.00378:  96%|█████████▌| 192/201 [01:56<00:05,  1.72it/s]Loss: 0.00378:  96%|█████████▌| 193/201 [01:57<00:04,  1.72it/s]Loss: 0.00377:  96%|█████████▌| 193/201 [01:57<00:04,  1.72it/s]Loss: 0.00377:  97%|█████████▋| 194/201 [01:58<00:04,  1.72it/s]Loss: 0.00378:  97%|█████████▋| 194/201 [01:58<00:04,  1.72it/s]Loss: 0.00378:  97%|█████████▋| 195/201 [01:58<00:03,  1.72it/s]Loss: 0.00370:  97%|█████████▋| 195/201 [01:58<00:03,  1.72it/s]Loss: 0.00370:  98%|█████████▊| 196/201 [01:59<00:02,  1.72it/s]Loss: 0.00367:  98%|█████████▊| 196/201 [01:59<00:02,  1.72it/s]Loss: 0.00367:  98%|█████████▊| 197/201 [01:59<00:02,  1.72it/s]Loss: 0.00382:  98%|█████████▊| 197/201 [01:59<00:02,  1.72it/s]Loss: 0.00382:  99%|█████████▊| 198/201 [02:00<00:01,  1.72it/s]Loss: 0.00381:  99%|█████████▊| 198/201 [02:00<00:01,  1.72it/s]Loss: 0.00381:  99%|█████████▉| 199/201 [02:01<00:01,  1.72it/s]Loss: 0.00383:  99%|█████████▉| 199/201 [02:01<00:01,  1.72it/s]Loss: 0.00383: 100%|█████████▉| 200/201 [02:01<00:00,  1.72it/s]Loss: 0.00378: 100%|█████████▉| 200/201 [02:01<00:00,  1.72it/s]Loss: 0.00378: 100%|██████████| 201/201 [02:02<00:00,  1.69it/s]Loss: 0.00375: 100%|██████████| 201/201 [02:02<00:00,  1.69it/s]Loss: 0.00375: 100%|██████████| 201/201 [02:02<00:00,  1.64it/s]Load volume "/media/storage0/qadwu/floats/supernova_432x432x432_float32_raw_432x432x432_float.cvol"
Loaded

max loss: 0.07571999728679657
Densities: min=9.371014333709338e-15, max=0.9995036125183105, mean=0.21003447473049164
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 122.23967456817627 seconds
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json
Latent space memory: 17.5MiB
Latent space memory: 17.5MiB
Warps shared: 7 , warps mixed: 7
Loaded, output mode: density:direct
Warps shared: 7 , warps mixed: 7
Loaded, output mode: density:direct
Convert model /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/supernova_432x432x432_float32_raw_432x432x432_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/opt/nfs/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 17, 'n_features_per_level': 8, 'n_levels': 8, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 2, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 4503040
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.28it/s]1it [00:00,  3.28it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=1.1987038321854566e-14, max=0.994645893573761, mean=0.4139387011528015
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:00, 90.00it/s]
Load TF 0, timestep 0, ensemble 0
Model directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model
Log directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/log
HDF5 directory: /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/hdf5
Current run: 00001
{'settings': '/opt/nfs/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/supernova.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.005, 'epochs': 200, 'lr_gamma': 0.8, 'lr_step': 10, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/log', 'modeldir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model', 'hdf5dir': '/mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [432, 432, 432], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/supernova-20220916175236-network.json', 'dryrun': False, 'CUDA_Device': 'NVIDIA GeForce RTX 3090 Ti', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 8, 'n_features_per_level': 8, 'log2_hashmap_size': 17, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 2}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<00:57,  3.49it/s]Loss: 0.11868:   0%|          | 1/201 [00:00<00:57,  3.49it/s]Loss: 0.11868:   1%|          | 2/201 [00:00<00:51,  3.86it/s]Loss: 0.01711:   1%|          | 2/201 [00:00<00:51,  3.86it/s]Loss: 0.01711:   1%|▏         | 3/201 [00:00<00:49,  3.99it/s]Loss: 0.01179:   1%|▏         | 3/201 [00:00<00:49,  3.99it/s]Loss: 0.01179:   2%|▏         | 4/201 [00:01<00:48,  4.06it/s]Loss: 0.01020:   2%|▏         | 4/201 [00:01<00:48,  4.06it/s]Loss: 0.01020:   2%|▏         | 5/201 [00:01<00:47,  4.10it/s]Loss: 0.00987:   2%|▏         | 5/201 [00:01<00:47,  4.10it/s]Loss: 0.00987:   3%|▎         | 6/201 [00:01<00:47,  4.13it/s]Loss: 0.00943:   3%|▎         | 6/201 [00:01<00:47,  4.13it/s]Loss: 0.00943:   3%|▎         | 7/201 [00:01<00:46,  4.14it/s]Loss: 0.00890:   3%|▎         | 7/201 [00:01<00:46,  4.14it/s]Loss: 0.00890:   4%|▍         | 8/201 [00:01<00:46,  4.15it/s]Loss: 0.00873:   4%|▍         | 8/201 [00:01<00:46,  4.15it/s]Loss: 0.00873:   4%|▍         | 9/201 [00:02<00:46,  4.15it/s]Loss: 0.00822:   4%|▍         | 9/201 [00:02<00:46,  4.15it/s]Loss: 0.00822:   5%|▍         | 10/201 [00:02<00:45,  4.16it/s]Loss: 0.00827:   5%|▍         | 10/201 [00:02<00:45,  4.16it/s]Loss: 0.00827:   5%|▌         | 11/201 [00:02<00:45,  4.16it/s]Loss: 0.00677:   5%|▌         | 11/201 [00:02<00:45,  4.16it/s]Loss: 0.00677:   6%|▌         | 12/201 [00:02<00:45,  4.17it/s]Loss: 0.00683:   6%|▌         | 12/201 [00:02<00:45,  4.17it/s]Loss: 0.00683:   6%|▋         | 13/201 [00:03<00:45,  4.17it/s]Loss: 0.00657:   6%|▋         | 13/201 [00:03<00:45,  4.17it/s]Loss: 0.00657:   7%|▋         | 14/201 [00:03<00:44,  4.17it/s]Loss: 0.00623:   7%|▋         | 14/201 [00:03<00:44,  4.17it/s]Loss: 0.00623:   7%|▋         | 15/201 [00:03<00:44,  4.17it/s]Loss: 0.00639:   7%|▋         | 15/201 [00:03<00:44,  4.17it/s]Loss: 0.00639:   8%|▊         | 16/201 [00:03<00:44,  4.13it/s]Loss: 0.00641:   8%|▊         | 16/201 [00:03<00:44,  4.13it/s]Loss: 0.00641:   8%|▊         | 17/201 [00:04<00:44,  4.12it/s]Loss: 0.00616:   8%|▊         | 17/201 [00:04<00:44,  4.12it/s]Loss: 0.00616:   9%|▉         | 18/201 [00:04<00:44,  4.14it/s]Loss: 0.00602:   9%|▉         | 18/201 [00:04<00:44,  4.14it/s]Loss: 0.00602:   9%|▉         | 19/201 [00:04<00:43,  4.14it/s]Loss: 0.00609:   9%|▉         | 19/201 [00:04<00:43,  4.14it/s]Loss: 0.00609:  10%|▉         | 20/201 [00:04<00:43,  4.15it/s]Loss: 0.00599:  10%|▉         | 20/201 [00:04<00:43,  4.15it/s]Loss: 0.00599:  10%|█         | 21/201 [00:05<00:44,  4.03it/s]Loss: 0.00488:  10%|█         | 21/201 [00:05<00:44,  4.03it/s]Loss: 0.00488:  11%|█         | 22/201 [00:05<00:43,  4.07it/s]Loss: 0.00496:  11%|█         | 22/201 [00:05<00:43,  4.07it/s]Loss: 0.00496:  11%|█▏        | 23/201 [00:05<00:43,  4.10it/s]Loss: 0.00496:  11%|█▏        | 23/201 [00:05<00:43,  4.10it/s]Loss: 0.00496:  12%|█▏        | 24/201 [00:05<00:42,  4.12it/s]Loss: 0.00491:  12%|█▏        | 24/201 [00:05<00:42,  4.12it/s]Loss: 0.00491:  12%|█▏        | 25/201 [00:06<00:42,  4.14it/s]Loss: 0.00485:  12%|█▏        | 25/201 [00:06<00:42,  4.14it/s]Loss: 0.00485:  13%|█▎        | 26/201 [00:06<00:42,  4.15it/s]Loss: 0.00488:  13%|█▎        | 26/201 [00:06<00:42,  4.15it/s]Loss: 0.00488:  13%|█▎        | 27/201 [00:06<00:41,  4.15it/s]Loss: 0.00481:  13%|█▎        | 27/201 [00:06<00:41,  4.15it/s]Loss: 0.00481:  14%|█▍        | 28/201 [00:06<00:41,  4.15it/s]Loss: 0.00468:  14%|█▍        | 28/201 [00:06<00:41,  4.15it/s]Loss: 0.00468:  14%|█▍        | 29/201 [00:07<00:41,  4.16it/s]Loss: 0.00475:  14%|█▍        | 29/201 [00:07<00:41,  4.16it/s]Loss: 0.00475:  15%|█▍        | 30/201 [00:07<00:41,  4.16it/s]Loss: 0.00468:  15%|█▍        | 30/201 [00:07<00:41,  4.16it/s]Loss: 0.00468:  15%|█▌        | 31/201 [00:07<00:40,  4.17it/s]Loss: 0.00426:  15%|█▌        | 31/201 [00:07<00:40,  4.17it/s]Loss: 0.00426:  16%|█▌        | 32/201 [00:07<00:40,  4.17it/s]Loss: 0.00404:  16%|█▌        | 32/201 [00:07<00:40,  4.17it/s]Loss: 0.00404:  16%|█▋        | 33/201 [00:07<00:40,  4.17it/s]Loss: 0.00408:  16%|█▋        | 33/201 [00:07<00:40,  4.17it/s]Loss: 0.00408:  17%|█▋        | 34/201 [00:08<00:40,  4.17it/s]Loss: 0.00408:  17%|█▋        | 34/201 [00:08<00:40,  4.17it/s]Loss: 0.00408:  17%|█▋        | 35/201 [00:08<00:39,  4.17it/s]Loss: 0.00404:  17%|█▋        | 35/201 [00:08<00:39,  4.17it/s]Loss: 0.00404:  18%|█▊        | 36/201 [00:08<00:39,  4.17it/s]Loss: 0.00405:  18%|█▊        | 36/201 [00:08<00:39,  4.17it/s]Loss: 0.00405:  18%|█▊        | 37/201 [00:08<00:39,  4.17it/s]Loss: 0.00401:  18%|█▊        | 37/201 [00:08<00:39,  4.17it/s]Loss: 0.00401:  19%|█▉        | 38/201 [00:09<00:39,  4.17it/s]Loss: 0.00407:  19%|█▉        | 38/201 [00:09<00:39,  4.17it/s]Loss: 0.00407:  19%|█▉        | 39/201 [00:09<00:38,  4.17it/s]Loss: 0.00401:  19%|█▉        | 39/201 [00:09<00:38,  4.17it/s]Loss: 0.00401:  20%|█▉        | 40/201 [00:09<00:38,  4.17it/s]Loss: 0.00398:  20%|█▉        | 40/201 [00:09<00:38,  4.17it/s]Loss: 0.00398:  20%|██        | 41/201 [00:09<00:39,  4.03it/s]Loss: 0.00361:  20%|██        | 41/201 [00:09<00:39,  4.03it/s]Loss: 0.00361:  21%|██        | 42/201 [00:10<00:39,  4.07it/s]Loss: 0.00353:  21%|██        | 42/201 [00:10<00:39,  4.07it/s]Loss: 0.00353:  21%|██▏       | 43/201 [00:10<00:38,  4.10it/s]Loss: 0.00349:  21%|██▏       | 43/201 [00:10<00:38,  4.10it/s]Loss: 0.00349:  22%|██▏       | 44/201 [00:10<00:38,  4.12it/s]Loss: 0.00352:  22%|██▏       | 44/201 [00:10<00:38,  4.12it/s]Loss: 0.00352:  22%|██▏       | 45/201 [00:10<00:37,  4.14it/s]Loss: 0.00356:  22%|██▏       | 45/201 [00:10<00:37,  4.14it/s]Loss: 0.00356:  23%|██▎       | 46/201 [00:11<00:37,  4.15it/s]Loss: 0.00355:  23%|██▎       | 46/201 [00:11<00:37,  4.15it/s]Loss: 0.00355:  23%|██▎       | 47/201 [00:11<00:37,  4.16it/s]Loss: 0.00355:  23%|██▎       | 47/201 [00:11<00:37,  4.16it/s]Loss: 0.00355:  24%|██▍       | 48/201 [00:11<00:36,  4.16it/s]Loss: 0.00357:  24%|██▍       | 48/201 [00:11<00:36,  4.16it/s]Loss: 0.00357:  24%|██▍       | 49/201 [00:11<00:36,  4.17it/s]Loss: 0.00361:  24%|██▍       | 49/201 [00:11<00:36,  4.17it/s]Loss: 0.00361:  25%|██▍       | 50/201 [00:12<00:36,  4.17it/s]Loss: 0.00360:  25%|██▍       | 50/201 [00:12<00:36,  4.17it/s]Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.18s/it][A1it [00:01,  1.18s/it]
Loss: 0.00360:  25%|██▌       | 51/201 [00:13<01:29,  1.67it/s]Loss: 0.00352:  25%|██▌       | 51/201 [00:13<01:29,  1.67it/s]Loss: 0.00352:  26%|██▌       | 52/201 [00:13<01:12,  2.05it/s]Loss: 0.00314:  26%|██▌       | 52/201 [00:13<01:12,  2.05it/s]Loss: 0.00314:  26%|██▋       | 53/201 [00:14<01:01,  2.42it/s]Loss: 0.00293:  26%|██▋       | 53/201 [00:14<01:01,  2.42it/s]Loss: 0.00293:  27%|██▋       | 54/201 [00:14<00:52,  2.78it/s]Loss: 0.00279:  27%|██▋       | 54/201 [00:14<00:52,  2.78it/s]Loss: 0.00279:  27%|██▋       | 55/201 [00:14<00:47,  3.10it/s]Loss: 0.00269:  27%|██▋       | 55/201 [00:14<00:47,  3.10it/s]Loss: 0.00269:  28%|██▊       | 56/201 [00:14<00:43,  3.37it/s]Loss: 0.00261:  28%|██▊       | 56/201 [00:14<00:43,  3.37it/s]Loss: 0.00261:  28%|██▊       | 57/201 [00:14<00:40,  3.59it/s]Loss: 0.00255:  28%|██▊       | 57/201 [00:14<00:40,  3.59it/s]Loss: 0.00255:  29%|██▉       | 58/201 [00:15<00:38,  3.76it/s]Loss: 0.00249:  29%|██▉       | 58/201 [00:15<00:38,  3.76it/s]Loss: 0.00249:  29%|██▉       | 59/201 [00:15<00:36,  3.89it/s]Loss: 0.00244:  29%|██▉       | 59/201 [00:15<00:36,  3.89it/s]Loss: 0.00244:  30%|██▉       | 60/201 [00:15<00:35,  3.99it/s]Loss: 0.00240:  30%|██▉       | 60/201 [00:15<00:35,  3.99it/s]Loss: 0.00240:  30%|███       | 61/201 [00:15<00:35,  3.93it/s]Loss: 0.00233:  30%|███       | 61/201 [00:15<00:35,  3.93it/s]Loss: 0.00233:  31%|███       | 62/201 [00:16<00:34,  4.02it/s]Loss: 0.00229:  31%|███       | 62/201 [00:16<00:34,  4.02it/s]Loss: 0.00229:  31%|███▏      | 63/201 [00:16<00:33,  4.08it/s]Loss: 0.00226:  31%|███▏      | 63/201 [00:16<00:33,  4.08it/s]Loss: 0.00226:  32%|███▏      | 64/201 [00:16<00:32,  4.17it/s]Loss: 0.00223:  32%|███▏      | 64/201 [00:16<00:32,  4.17it/s]Loss: 0.00223:  32%|███▏      | 65/201 [00:16<00:32,  4.23it/s]Loss: 0.00221:  32%|███▏      | 65/201 [00:16<00:32,  4.23it/s]Loss: 0.00221:  33%|███▎      | 66/201 [00:17<00:31,  4.27it/s]Loss: 0.00220:  33%|███▎      | 66/201 [00:17<00:31,  4.27it/s]Loss: 0.00220:  33%|███▎      | 67/201 [00:17<00:31,  4.31it/s]Loss: 0.00218:  33%|███▎      | 67/201 [00:17<00:31,  4.31it/s]Loss: 0.00218:  34%|███▍      | 68/201 [00:17<00:30,  4.33it/s]Loss: 0.00216:  34%|███▍      | 68/201 [00:17<00:30,  4.33it/s]Loss: 0.00216:  34%|███▍      | 69/201 [00:17<00:30,  4.34it/s]Loss: 0.00214:  34%|███▍      | 69/201 [00:17<00:30,  4.34it/s]Loss: 0.00214:  35%|███▍      | 70/201 [00:17<00:30,  4.32it/s]Loss: 0.00213:  35%|███▍      | 70/201 [00:17<00:30,  4.32it/s]Loss: 0.00213:  35%|███▌      | 71/201 [00:18<00:30,  4.29it/s]Loss: 0.00208:  35%|███▌      | 71/201 [00:18<00:30,  4.29it/s]Loss: 0.00208:  36%|███▌      | 72/201 [00:18<00:30,  4.27it/s]Loss: 0.00206:  36%|███▌      | 72/201 [00:18<00:30,  4.27it/s]Loss: 0.00206:  36%|███▋      | 73/201 [00:18<00:30,  4.26it/s]Loss: 0.00204:  36%|███▋      | 73/201 [00:18<00:30,  4.26it/s]Loss: 0.00204:  37%|███▋      | 74/201 [00:18<00:30,  4.22it/s]Loss: 0.00203:  37%|███▋      | 74/201 [00:18<00:30,  4.22it/s]Loss: 0.00203:  37%|███▋      | 75/201 [00:19<00:29,  4.21it/s]Loss: 0.00202:  37%|███▋      | 75/201 [00:19<00:29,  4.21it/s]Loss: 0.00202:  38%|███▊      | 76/201 [00:19<00:29,  4.23it/s]Loss: 0.00201:  38%|███▊      | 76/201 [00:19<00:29,  4.23it/s]Loss: 0.00201:  38%|███▊      | 77/201 [00:19<00:29,  4.24it/s]Loss: 0.00200:  38%|███▊      | 77/201 [00:19<00:29,  4.24it/s]Loss: 0.00200:  39%|███▉      | 78/201 [00:19<00:29,  4.23it/s]Loss: 0.00199:  39%|███▉      | 78/201 [00:19<00:29,  4.23it/s]Loss: 0.00199:  39%|███▉      | 79/201 [00:20<00:28,  4.23it/s]Loss: 0.00199:  39%|███▉      | 79/201 [00:20<00:28,  4.23it/s]Loss: 0.00199:  40%|███▉      | 80/201 [00:20<00:28,  4.23it/s]Loss: 0.00198:  40%|███▉      | 80/201 [00:20<00:28,  4.23it/s]Loss: 0.00198:  40%|████      | 81/201 [00:20<00:29,  4.09it/s]Loss: 0.00194:  40%|████      | 81/201 [00:20<00:29,  4.09it/s]Loss: 0.00194:  41%|████      | 82/201 [00:20<00:28,  4.13it/s]Loss: 0.00192:  41%|████      | 82/201 [00:20<00:28,  4.13it/s]Loss: 0.00192:  41%|████▏     | 83/201 [00:21<00:28,  4.15it/s]Loss: 0.00191:  41%|████▏     | 83/201 [00:21<00:28,  4.15it/s]Loss: 0.00191:  42%|████▏     | 84/201 [00:21<00:28,  4.17it/s]Loss: 0.00191:  42%|████▏     | 84/201 [00:21<00:28,  4.17it/s]Loss: 0.00191:  42%|████▏     | 85/201 [00:21<00:27,  4.18it/s]Loss: 0.00191:  42%|████▏     | 85/201 [00:21<00:27,  4.18it/s]Loss: 0.00191:  43%|████▎     | 86/201 [00:21<00:27,  4.20it/s]Loss: 0.00191:  43%|████▎     | 86/201 [00:21<00:27,  4.20it/s]Loss: 0.00191:  43%|████▎     | 87/201 [00:22<00:27,  4.20it/s]Loss: 0.00190:  43%|████▎     | 87/201 [00:22<00:27,  4.20it/s]Loss: 0.00190:  44%|████▍     | 88/201 [00:22<00:26,  4.21it/s]Loss: 0.00191:  44%|████▍     | 88/201 [00:22<00:26,  4.21it/s]Loss: 0.00191:  44%|████▍     | 89/201 [00:22<00:26,  4.21it/s]Loss: 0.00188:  44%|████▍     | 89/201 [00:22<00:26,  4.21it/s]Loss: 0.00188:  45%|████▍     | 90/201 [00:22<00:26,  4.21it/s]Loss: 0.00188:  45%|████▍     | 90/201 [00:22<00:26,  4.21it/s]Loss: 0.00188:  45%|████▌     | 91/201 [00:23<00:26,  4.21it/s]Loss: 0.00185:  45%|████▌     | 91/201 [00:23<00:26,  4.21it/s]Loss: 0.00185:  46%|████▌     | 92/201 [00:23<00:25,  4.19it/s]Loss: 0.00183:  46%|████▌     | 92/201 [00:23<00:25,  4.19it/s]Loss: 0.00183:  46%|████▋     | 93/201 [00:23<00:25,  4.20it/s]Loss: 0.00183:  46%|████▋     | 93/201 [00:23<00:25,  4.20it/s]Loss: 0.00183:  47%|████▋     | 94/201 [00:23<00:25,  4.20it/s]Loss: 0.00182:  47%|████▋     | 94/201 [00:23<00:25,  4.20it/s]Loss: 0.00182:  47%|████▋     | 95/201 [00:23<00:25,  4.21it/s]Loss: 0.00182:  47%|████▋     | 95/201 [00:23<00:25,  4.21it/s]Loss: 0.00182:  48%|████▊     | 96/201 [00:24<00:24,  4.21it/s]Loss: 0.00182:  48%|████▊     | 96/201 [00:24<00:24,  4.21it/s]Loss: 0.00182:  48%|████▊     | 97/201 [00:24<00:24,  4.21it/s]Loss: 0.00181:  48%|████▊     | 97/201 [00:24<00:24,  4.21it/s]Loss: 0.00181:  49%|████▉     | 98/201 [00:24<00:24,  4.21it/s]Loss: 0.00181:  49%|████▉     | 98/201 [00:24<00:24,  4.21it/s]Loss: 0.00181:  49%|████▉     | 99/201 [00:24<00:24,  4.22it/s]Loss: 0.00181:  49%|████▉     | 99/201 [00:24<00:24,  4.22it/s]Loss: 0.00181:  50%|████▉     | 100/201 [00:25<00:23,  4.22it/s]Loss: 0.00180:  50%|████▉     | 100/201 [00:25<00:23,  4.22it/s]Loss: 0.00180:  50%|█████     | 101/201 [00:25<00:24,  4.08it/s]Loss: 0.00178:  50%|█████     | 101/201 [00:25<00:24,  4.08it/s]max loss: 0.061664480715990067
Densities: min=2.310280246053736e-15, max=0.9948866367340088, mean=0.23279616236686707
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.29s/it][A1it [00:01,  1.29s/it]
Loss: 0.00178:  51%|█████     | 102/201 [00:26<01:02,  1.58it/s]Loss: 0.00355:  51%|█████     | 102/201 [00:26<01:02,  1.58it/s]Loss: 0.00355:  51%|█████     | 103/201 [00:27<00:50,  1.94it/s]Loss: 0.00329:  51%|█████     | 103/201 [00:27<00:50,  1.94it/s]Loss: 0.00329:  52%|█████▏    | 104/201 [00:27<00:41,  2.31it/s]Loss: 0.00312:  52%|█████▏    | 104/201 [00:27<00:41,  2.31it/s]Loss: 0.00312:  52%|█████▏    | 105/201 [00:27<00:35,  2.67it/s]Loss: 0.00301:  52%|█████▏    | 105/201 [00:27<00:35,  2.67it/s]Loss: 0.00301:  53%|█████▎    | 106/201 [00:27<00:31,  2.99it/s]Loss: 0.00292:  53%|█████▎    | 106/201 [00:27<00:31,  2.99it/s]Loss: 0.00292:  53%|█████▎    | 107/201 [00:28<00:28,  3.28it/s]Loss: 0.00285:  53%|█████▎    | 107/201 [00:28<00:28,  3.28it/s]Loss: 0.00285:  54%|█████▎    | 108/201 [00:28<00:26,  3.51it/s]Loss: 0.00279:  54%|█████▎    | 108/201 [00:28<00:26,  3.51it/s]Loss: 0.00279:  54%|█████▍    | 109/201 [00:28<00:24,  3.69it/s]Loss: 0.00274:  54%|█████▍    | 109/201 [00:28<00:24,  3.69it/s]Loss: 0.00274:  55%|█████▍    | 110/201 [00:28<00:23,  3.83it/s]Loss: 0.00269:  55%|█████▍    | 110/201 [00:28<00:23,  3.83it/s]Loss: 0.00269:  55%|█████▌    | 111/201 [00:29<00:22,  3.94it/s]Loss: 0.00264:  55%|█████▌    | 111/201 [00:29<00:22,  3.94it/s]Loss: 0.00264:  56%|█████▌    | 112/201 [00:29<00:22,  4.01it/s]Loss: 0.00261:  56%|█████▌    | 112/201 [00:29<00:22,  4.01it/s]Loss: 0.00261:  56%|█████▌    | 113/201 [00:29<00:21,  4.06it/s]Loss: 0.00258:  56%|█████▌    | 113/201 [00:29<00:21,  4.06it/s]Loss: 0.00258:  57%|█████▋    | 114/201 [00:29<00:21,  4.10it/s]Loss: 0.00255:  57%|█████▋    | 114/201 [00:29<00:21,  4.10it/s]Loss: 0.00255:  57%|█████▋    | 115/201 [00:30<00:20,  4.13it/s]Loss: 0.00253:  57%|█████▋    | 115/201 [00:30<00:20,  4.13it/s]Loss: 0.00253:  58%|█████▊    | 116/201 [00:30<00:20,  4.15it/s]Loss: 0.00251:  58%|█████▊    | 116/201 [00:30<00:20,  4.15it/s]Loss: 0.00251:  58%|█████▊    | 117/201 [00:30<00:20,  4.17it/s]Loss: 0.00249:  58%|█████▊    | 117/201 [00:30<00:20,  4.17it/s]Loss: 0.00249:  59%|█████▊    | 118/201 [00:30<00:19,  4.18it/s]Loss: 0.00247:  59%|█████▊    | 118/201 [00:30<00:19,  4.18it/s]Loss: 0.00247:  59%|█████▉    | 119/201 [00:30<00:19,  4.18it/s]Loss: 0.00245:  59%|█████▉    | 119/201 [00:30<00:19,  4.18it/s]Loss: 0.00245:  60%|█████▉    | 120/201 [00:31<00:19,  4.19it/s]Loss: 0.00244:  60%|█████▉    | 120/201 [00:31<00:19,  4.19it/s]Loss: 0.00244:  60%|██████    | 121/201 [00:31<00:19,  4.06it/s]Loss: 0.00241:  60%|██████    | 121/201 [00:31<00:19,  4.06it/s]Loss: 0.00241:  61%|██████    | 122/201 [00:31<00:19,  4.10it/s]Loss: 0.00239:  61%|██████    | 122/201 [00:31<00:19,  4.10it/s]Loss: 0.00239:  61%|██████    | 123/201 [00:31<00:18,  4.13it/s]Loss: 0.00238:  61%|██████    | 123/201 [00:31<00:18,  4.13it/s]Loss: 0.00238:  62%|██████▏   | 124/201 [00:32<00:18,  4.15it/s]Loss: 0.00237:  62%|██████▏   | 124/201 [00:32<00:18,  4.15it/s]Loss: 0.00237:  62%|██████▏   | 125/201 [00:32<00:18,  4.16it/s]Loss: 0.00236:  62%|██████▏   | 125/201 [00:32<00:18,  4.16it/s]Loss: 0.00236:  63%|██████▎   | 126/201 [00:32<00:18,  4.16it/s]Loss: 0.00235:  63%|██████▎   | 126/201 [00:32<00:18,  4.16it/s]Loss: 0.00235:  63%|██████▎   | 127/201 [00:32<00:17,  4.18it/s]Loss: 0.00234:  63%|██████▎   | 127/201 [00:32<00:17,  4.18it/s]Loss: 0.00234:  64%|██████▎   | 128/201 [00:33<00:17,  4.18it/s]Loss: 0.00233:  64%|██████▎   | 128/201 [00:33<00:17,  4.18it/s]Loss: 0.00233:  64%|██████▍   | 129/201 [00:33<00:17,  4.17it/s]Loss: 0.00232:  64%|██████▍   | 129/201 [00:33<00:17,  4.17it/s]Loss: 0.00232:  65%|██████▍   | 130/201 [00:33<00:17,  4.15it/s]Loss: 0.00231:  65%|██████▍   | 130/201 [00:33<00:17,  4.15it/s]Loss: 0.00231:  65%|██████▌   | 131/201 [00:33<00:16,  4.16it/s]Loss: 0.00229:  65%|██████▌   | 131/201 [00:33<00:16,  4.16it/s]Loss: 0.00229:  66%|██████▌   | 132/201 [00:34<00:16,  4.17it/s]Loss: 0.00228:  66%|██████▌   | 132/201 [00:34<00:16,  4.17it/s]Loss: 0.00228:  66%|██████▌   | 133/201 [00:34<00:16,  4.18it/s]Loss: 0.00227:  66%|██████▌   | 133/201 [00:34<00:16,  4.18it/s]Loss: 0.00227:  67%|██████▋   | 134/201 [00:34<00:16,  4.19it/s]Loss: 0.00226:  67%|██████▋   | 134/201 [00:34<00:16,  4.19it/s]Loss: 0.00226:  67%|██████▋   | 135/201 [00:34<00:15,  4.19it/s]Loss: 0.00226:  67%|██████▋   | 135/201 [00:34<00:15,  4.19it/s]Loss: 0.00226:  68%|██████▊   | 136/201 [00:35<00:15,  4.19it/s]Loss: 0.00225:  68%|██████▊   | 136/201 [00:35<00:15,  4.19it/s]Loss: 0.00225:  68%|██████▊   | 137/201 [00:35<00:15,  4.20it/s]Loss: 0.00224:  68%|██████▊   | 137/201 [00:35<00:15,  4.20it/s]Loss: 0.00224:  69%|██████▊   | 138/201 [00:35<00:15,  4.20it/s]Loss: 0.00224:  69%|██████▊   | 138/201 [00:35<00:15,  4.20it/s]Loss: 0.00224:  69%|██████▉   | 139/201 [00:35<00:14,  4.20it/s]Loss: 0.00223:  69%|██████▉   | 139/201 [00:35<00:14,  4.20it/s]Loss: 0.00223:  70%|██████▉   | 140/201 [00:36<00:14,  4.20it/s]Loss: 0.00223:  70%|██████▉   | 140/201 [00:36<00:14,  4.20it/s]Loss: 0.00223:  70%|███████   | 141/201 [00:36<00:14,  4.06it/s]Loss: 0.00221:  70%|███████   | 141/201 [00:36<00:14,  4.06it/s]Loss: 0.00221:  71%|███████   | 142/201 [00:36<00:14,  4.10it/s]Loss: 0.00220:  71%|███████   | 142/201 [00:36<00:14,  4.10it/s]Loss: 0.00220:  71%|███████   | 143/201 [00:36<00:14,  4.13it/s]Loss: 0.00220:  71%|███████   | 143/201 [00:36<00:14,  4.13it/s]Loss: 0.00220:  72%|███████▏  | 144/201 [00:37<00:13,  4.15it/s]Loss: 0.00219:  72%|███████▏  | 144/201 [00:37<00:13,  4.15it/s]Loss: 0.00219:  72%|███████▏  | 145/201 [00:37<00:13,  4.17it/s]Loss: 0.00219:  72%|███████▏  | 145/201 [00:37<00:13,  4.17it/s]Loss: 0.00219:  73%|███████▎  | 146/201 [00:37<00:13,  4.18it/s]Loss: 0.00218:  73%|███████▎  | 146/201 [00:37<00:13,  4.18it/s]Loss: 0.00218:  73%|███████▎  | 147/201 [00:37<00:12,  4.19it/s]Loss: 0.00218:  73%|███████▎  | 147/201 [00:37<00:12,  4.19it/s]Loss: 0.00218:  74%|███████▎  | 148/201 [00:37<00:12,  4.19it/s]Loss: 0.00218:  74%|███████▎  | 148/201 [00:37<00:12,  4.19it/s]Loss: 0.00218:  74%|███████▍  | 149/201 [00:38<00:12,  4.19it/s]Loss: 0.00217:  74%|███████▍  | 149/201 [00:38<00:12,  4.19it/s]Loss: 0.00217:  75%|███████▍  | 150/201 [00:38<00:12,  4.17it/s]Loss: 0.00217:  75%|███████▍  | 150/201 [00:38<00:12,  4.17it/s]Loss: 0.00217:  75%|███████▌  | 151/201 [00:38<00:12,  4.15it/s]Loss: 0.00215:  75%|███████▌  | 151/201 [00:38<00:12,  4.15it/s]Loss: 0.00215:  76%|███████▌  | 152/201 [00:38<00:11,  4.17it/s]Loss: 0.00215:  76%|███████▌  | 152/201 [00:38<00:11,  4.17it/s]max loss: 0.03746572509407997
Densities: min=2.764855723790807e-15, max=0.996854305267334, mean=0.28893938660621643
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.30s/it][A1it [00:01,  1.30s/it]
Loss: 0.00215:  76%|███████▌  | 153/201 [00:40<00:30,  1.58it/s]Loss: 0.00314:  76%|███████▌  | 153/201 [00:40<00:30,  1.58it/s]Loss: 0.00314:  77%|███████▋  | 154/201 [00:40<00:24,  1.94it/s]Loss: 0.00303:  77%|███████▋  | 154/201 [00:40<00:24,  1.94it/s]Loss: 0.00303:  77%|███████▋  | 155/201 [00:40<00:19,  2.32it/s]Loss: 0.00294:  77%|███████▋  | 155/201 [00:40<00:19,  2.32it/s]Loss: 0.00294:  78%|███████▊  | 156/201 [00:41<00:16,  2.68it/s]Loss: 0.00287:  78%|███████▊  | 156/201 [00:41<00:16,  2.68it/s]Loss: 0.00287:  78%|███████▊  | 157/201 [00:41<00:14,  3.01it/s]Loss: 0.00282:  78%|███████▊  | 157/201 [00:41<00:14,  3.01it/s]Loss: 0.00282:  79%|███████▊  | 158/201 [00:41<00:13,  3.29it/s]Loss: 0.00277:  79%|███████▊  | 158/201 [00:41<00:13,  3.29it/s]Loss: 0.00277:  79%|███████▉  | 159/201 [00:41<00:11,  3.52it/s]Loss: 0.00273:  79%|███████▉  | 159/201 [00:41<00:11,  3.52it/s]Loss: 0.00273:  80%|███████▉  | 160/201 [00:42<00:11,  3.71it/s]Loss: 0.00269:  80%|███████▉  | 160/201 [00:42<00:11,  3.71it/s]Loss: 0.00269:  80%|████████  | 161/201 [00:42<00:10,  3.74it/s]Loss: 0.00266:  80%|████████  | 161/201 [00:42<00:10,  3.74it/s]Loss: 0.00266:  81%|████████  | 162/201 [00:42<00:10,  3.87it/s]Loss: 0.00263:  81%|████████  | 162/201 [00:42<00:10,  3.87it/s]Loss: 0.00263:  81%|████████  | 163/201 [00:42<00:09,  3.97it/s]Loss: 0.00261:  81%|████████  | 163/201 [00:42<00:09,  3.97it/s]Loss: 0.00261:  82%|████████▏ | 164/201 [00:43<00:09,  4.05it/s]Loss: 0.00259:  82%|████████▏ | 164/201 [00:43<00:09,  4.05it/s]Loss: 0.00259:  82%|████████▏ | 165/201 [00:43<00:08,  4.10it/s]Loss: 0.00257:  82%|████████▏ | 165/201 [00:43<00:08,  4.10it/s]Loss: 0.00257:  83%|████████▎ | 166/201 [00:43<00:08,  4.14it/s]Loss: 0.00255:  83%|████████▎ | 166/201 [00:43<00:08,  4.14it/s]Loss: 0.00255:  83%|████████▎ | 167/201 [00:43<00:08,  4.16it/s]Loss: 0.00253:  83%|████████▎ | 167/201 [00:43<00:08,  4.16it/s]Loss: 0.00253:  84%|████████▎ | 168/201 [00:44<00:07,  4.18it/s]Loss: 0.00252:  84%|████████▎ | 168/201 [00:44<00:07,  4.18it/s]Loss: 0.00252:  84%|████████▍ | 169/201 [00:44<00:07,  4.20it/s]Loss: 0.00250:  84%|████████▍ | 169/201 [00:44<00:07,  4.20it/s]Loss: 0.00250:  85%|████████▍ | 170/201 [00:44<00:07,  4.20it/s]Loss: 0.00248:  85%|████████▍ | 170/201 [00:44<00:07,  4.20it/s]Loss: 0.00248:  85%|████████▌ | 171/201 [00:44<00:07,  4.21it/s]Loss: 0.00247:  85%|████████▌ | 171/201 [00:44<00:07,  4.21it/s]Loss: 0.00247:  86%|████████▌ | 172/201 [00:45<00:06,  4.22it/s]Loss: 0.00245:  86%|████████▌ | 172/201 [00:45<00:06,  4.22it/s]Loss: 0.00245:  86%|████████▌ | 173/201 [00:45<00:06,  4.22it/s]Loss: 0.00244:  86%|████████▌ | 173/201 [00:45<00:06,  4.22it/s]Loss: 0.00244:  87%|████████▋ | 174/201 [00:45<00:06,  4.22it/s]Loss: 0.00243:  87%|████████▋ | 174/201 [00:45<00:06,  4.22it/s]Loss: 0.00243:  87%|████████▋ | 175/201 [00:45<00:06,  4.22it/s]Loss: 0.00242:  87%|████████▋ | 175/201 [00:45<00:06,  4.22it/s]Loss: 0.00242:  88%|████████▊ | 176/201 [00:45<00:05,  4.23it/s]Loss: 0.00241:  88%|████████▊ | 176/201 [00:45<00:05,  4.23it/s]Loss: 0.00241:  88%|████████▊ | 177/201 [00:46<00:05,  4.23it/s]Loss: 0.00240:  88%|████████▊ | 177/201 [00:46<00:05,  4.23it/s]Loss: 0.00240:  89%|████████▊ | 178/201 [00:46<00:05,  4.23it/s]Loss: 0.00239:  89%|████████▊ | 178/201 [00:46<00:05,  4.23it/s]Loss: 0.00239:  89%|████████▉ | 179/201 [00:46<00:05,  4.23it/s]Loss: 0.00238:  89%|████████▉ | 179/201 [00:46<00:05,  4.23it/s]Loss: 0.00238:  90%|████████▉ | 180/201 [00:46<00:04,  4.23it/s]Loss: 0.00238:  90%|████████▉ | 180/201 [00:46<00:04,  4.23it/s]Loss: 0.00238:  90%|█████████ | 181/201 [00:47<00:04,  4.05it/s]Loss: 0.00236:  90%|█████████ | 181/201 [00:47<00:04,  4.05it/s]Loss: 0.00236:  91%|█████████ | 182/201 [00:47<00:04,  4.09it/s]Loss: 0.00236:  91%|█████████ | 182/201 [00:47<00:04,  4.09it/s]Loss: 0.00236:  91%|█████████ | 183/201 [00:47<00:04,  4.12it/s]Loss: 0.00235:  91%|█████████ | 183/201 [00:47<00:04,  4.12it/s]Loss: 0.00235:  92%|█████████▏| 184/201 [00:47<00:04,  4.14it/s]Loss: 0.00234:  92%|█████████▏| 184/201 [00:47<00:04,  4.14it/s]Loss: 0.00234:  92%|█████████▏| 185/201 [00:48<00:03,  4.16it/s]Loss: 0.00234:  92%|█████████▏| 185/201 [00:48<00:03,  4.16it/s]Loss: 0.00234:  93%|█████████▎| 186/201 [00:48<00:03,  4.17it/s]Loss: 0.00233:  93%|█████████▎| 186/201 [00:48<00:03,  4.17it/s]Loss: 0.00233:  93%|█████████▎| 187/201 [00:48<00:03,  4.18it/s]Loss: 0.00232:  93%|█████████▎| 187/201 [00:48<00:03,  4.18it/s]Loss: 0.00232:  94%|█████████▎| 188/201 [00:48<00:03,  4.19it/s]Loss: 0.00232:  94%|█████████▎| 188/201 [00:48<00:03,  4.19it/s]Loss: 0.00232:  94%|█████████▍| 189/201 [00:49<00:02,  4.19it/s]Loss: 0.00231:  94%|█████████▍| 189/201 [00:49<00:02,  4.19it/s]Loss: 0.00231:  95%|█████████▍| 190/201 [00:49<00:02,  4.20it/s]Loss: 0.00231:  95%|█████████▍| 190/201 [00:49<00:02,  4.20it/s]Loss: 0.00231:  95%|█████████▌| 191/201 [00:49<00:02,  4.20it/s]Loss: 0.00230:  95%|█████████▌| 191/201 [00:49<00:02,  4.20it/s]Loss: 0.00230:  96%|█████████▌| 192/201 [00:49<00:02,  4.20it/s]Loss: 0.00229:  96%|█████████▌| 192/201 [00:49<00:02,  4.20it/s]Loss: 0.00229:  96%|█████████▌| 193/201 [00:50<00:01,  4.20it/s]Loss: 0.00229:  96%|█████████▌| 193/201 [00:50<00:01,  4.20it/s]Loss: 0.00229:  97%|█████████▋| 194/201 [00:50<00:01,  4.21it/s]Loss: 0.00228:  97%|█████████▋| 194/201 [00:50<00:01,  4.21it/s]Loss: 0.00228:  97%|█████████▋| 195/201 [00:50<00:01,  4.19it/s]Loss: 0.00228:  97%|█████████▋| 195/201 [00:50<00:01,  4.19it/s]Loss: 0.00228:  98%|█████████▊| 196/201 [00:50<00:01,  4.15it/s]Loss: 0.00228:  98%|█████████▊| 196/201 [00:50<00:01,  4.15it/s]Loss: 0.00228:  98%|█████████▊| 197/201 [00:50<00:00,  4.17it/s]Loss: 0.00227:  98%|█████████▊| 197/201 [00:50<00:00,  4.17it/s]Loss: 0.00227:  99%|█████████▊| 198/201 [00:51<00:00,  4.18it/s]Loss: 0.00227:  99%|█████████▊| 198/201 [00:51<00:00,  4.18it/s]Loss: 0.00227:  99%|█████████▉| 199/201 [00:51<00:00,  4.19it/s]Loss: 0.00226:  99%|█████████▉| 199/201 [00:51<00:00,  4.19it/s]Loss: 0.00226: 100%|█████████▉| 200/201 [00:51<00:00,  4.19it/s]Loss: 0.00226: 100%|█████████▉| 200/201 [00:51<00:00,  4.19it/s]Loss: 0.00226: 100%|██████████| 201/201 [00:51<00:00,  3.99it/s]Loss: 0.00225: 100%|██████████| 201/201 [00:51<00:00,  3.99it/s]Loss: 0.00225: 100%|██████████| 201/201 [00:51<00:00,  3.87it/s]
max loss: 0.037467241287231445
Densities: min=9.170141317300928e-15, max=0.9995036125183105, mean=0.2785898745059967
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to /mnt/scratch/ssd/qadwu/fvsrn/run03-rebuild/supernova_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 51.98398804664612 seconds
-1.0 2.015625
