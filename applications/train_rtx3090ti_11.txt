16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/richtmyer_meshkov_2048x2048x1920_float32_raw_2048x2048x1920_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/richtmyer_meshkov.json
Initialize network
Latent space memory: 105.5MiB
# of network parameters: 27669825
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.73it/s]1it [00:00,  3.73it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.9359368085861206
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:03,  3.29s/it]Render: : 1it [00:03,  3.29s/it]
Load TF 0, timestep 0, ensemble 0
Model directory: run03-rebuild/richtmyer_meshkov_hybrid/srn/model
Log directory: run03-rebuild/richtmyer_meshkov_hybrid/srn/log
HDF5 directory: run03-rebuild/richtmyer_meshkov_hybrid/srn/hdf5
Current run: 00001
{'settings': '/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/richtmyer_meshkov.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 120, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 120, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': 'run03-rebuild/richtmyer_meshkov_hybrid/srn/log', 'modeldir': 'run03-rebuild/richtmyer_meshkov_hybrid/srn/model', 'hdf5dir': 'run03-rebuild/richtmyer_meshkov_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [2048, 2048, 1920], 'inr': None, 'dryrun': False, 'CUDA_Device': 'Quadro RTX 8000'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:03<11:43,  3.52s/it]Loss: 0.24910:   0%|          | 1/201 [00:03<11:43,  3.52s/it]Loss: 0.24910:   1%|          | 2/201 [00:06<09:42,  2.93s/it]Loss: 0.08005:   1%|          | 2/201 [00:06<09:42,  2.93s/it]Loss: 0.08005:   1%|▏         | 3/201 [00:08<09:05,  2.75s/it]Loss: 0.04417:   1%|▏         | 3/201 [00:08<09:05,  2.75s/it]Loss: 0.04417:   2%|▏         | 4/201 [00:11<08:46,  2.67s/it]Loss: 0.02867:   2%|▏         | 4/201 [00:11<08:46,  2.67s/it]Loss: 0.02867:   2%|▏         | 5/201 [00:13<08:34,  2.62s/it]Loss: 0.02426:   2%|▏         | 5/201 [00:13<08:34,  2.62s/it]Loss: 0.02426:   3%|▎         | 6/201 [00:16<08:26,  2.60s/it]Loss: 0.02183:   3%|▎         | 6/201 [00:16<08:26,  2.60s/it]Loss: 0.02183:   3%|▎         | 7/201 [00:18<08:20,  2.58s/it]Loss: 0.02929:   3%|▎         | 7/201 [00:18<08:20,  2.58s/it]Loss: 0.02929:   4%|▍         | 8/201 [00:21<08:16,  2.57s/it]Loss: 0.02327:   4%|▍         | 8/201 [00:21<08:16,  2.57s/it]Loss: 0.02327:   4%|▍         | 9/201 [00:23<08:12,  2.57s/it]Loss: 0.02558:   4%|▍         | 9/201 [00:23<08:12,  2.57s/it]Loss: 0.02558:   5%|▍         | 10/201 [00:26<08:08,  2.56s/it]Loss: 0.01826:   5%|▍         | 10/201 [00:26<08:08,  2.56s/it]Loss: 0.01826:   5%|▌         | 11/201 [00:28<08:05,  2.56s/it]Loss: 0.02587:   5%|▌         | 11/201 [00:28<08:05,  2.56s/it]Loss: 0.02587:   6%|▌         | 12/201 [00:31<08:02,  2.55s/it]Loss: 0.01617:   6%|▌         | 12/201 [00:31<08:02,  2.55s/it]Loss: 0.01617:   6%|▋         | 13/201 [00:34<07:59,  2.55s/it]Loss: 0.01540:   6%|▋         | 13/201 [00:34<07:59,  2.55s/it]Loss: 0.01540:   7%|▋         | 14/201 [00:36<07:56,  2.55s/it]Loss: 0.01473:   7%|▋         | 14/201 [00:36<07:56,  2.55s/it]Loss: 0.01473:   7%|▋         | 15/201 [00:39<07:54,  2.55s/it]Loss: 0.02062:   7%|▋         | 15/201 [00:39<07:54,  2.55s/it]Loss: 0.02062:   8%|▊         | 16/201 [00:41<07:51,  2.55s/it]Loss: 0.01408:   8%|▊         | 16/201 [00:41<07:51,  2.55s/it]Loss: 0.01408:   8%|▊         | 17/201 [00:44<07:48,  2.55s/it]Loss: 0.01363:   8%|▊         | 17/201 [00:44<07:48,  2.55s/it]Loss: 0.01363:   9%|▉         | 18/201 [00:46<07:46,  2.55s/it]Loss: 0.01196:   9%|▉         | 18/201 [00:46<07:46,  2.55s/it]Loss: 0.01196:   9%|▉         | 19/201 [00:49<07:43,  2.55s/it]Loss: 0.01254:   9%|▉         | 19/201 [00:49<07:43,  2.55s/it]Loss: 0.01254:  10%|▉         | 20/201 [00:51<07:40,  2.55s/it]Loss: 0.02503:  10%|▉         | 20/201 [00:51<07:40,  2.55s/it]Loss: 0.02503:  10%|█         | 21/201 [00:54<07:58,  2.66s/it]Loss: 0.01450:  10%|█         | 21/201 [00:54<07:58,  2.66s/it]Loss: 0.01450:  11%|█         | 22/201 [00:57<07:48,  2.62s/it]Loss: 0.02007:  11%|█         | 22/201 [00:57<07:48,  2.62s/it]Loss: 0.02007:  11%|█▏        | 23/201 [00:59<07:41,  2.59s/it]Loss: 0.01620:  11%|█▏        | 23/201 [00:59<07:41,  2.59s/it]Loss: 0.01620:  12%|█▏        | 24/201 [01:02<07:36,  2.58s/it]Loss: 0.01089:  12%|█▏        | 24/201 [01:02<07:36,  2.58s/it]Loss: 0.01089:  12%|█▏        | 25/201 [01:04<07:31,  2.57s/it]Loss: 0.01218:  12%|█▏        | 25/201 [01:04<07:31,  2.57s/it]Loss: 0.01218:  13%|█▎        | 26/201 [01:07<07:27,  2.56s/it]Loss: 0.02000:  13%|█▎        | 26/201 [01:07<07:27,  2.56s/it]Loss: 0.02000:  13%|█▎        | 27/201 [01:10<07:24,  2.55s/it]Loss: 0.01104:  13%|█▎        | 27/201 [01:10<07:24,  2.55s/it]Loss: 0.01104:  14%|█▍        | 28/201 [01:12<07:20,  2.55s/it]Loss: 0.01014:  14%|█▍        | 28/201 [01:12<07:20,  2.55s/it]Loss: 0.01014:  14%|█▍        | 29/201 [01:15<07:18,  2.55s/it]Loss: 0.01260:  14%|█▍        | 29/201 [01:15<07:18,  2.55s/it]Loss: 0.01260:  15%|█▍        | 30/201 [01:17<07:15,  2.55s/it]Loss: 0.00993:  15%|█▍        | 30/201 [01:17<07:15,  2.55s/it]Loss: 0.00993:  15%|█▌        | 31/201 [01:20<07:12,  2.54s/it]Loss: 0.01134:  15%|█▌        | 31/201 [01:20<07:12,  2.54s/it]Loss: 0.01134:  16%|█▌        | 32/201 [01:22<07:09,  2.54s/it]Loss: 0.01839:  16%|█▌        | 32/201 [01:22<07:09,  2.54s/it]Loss: 0.01839:  16%|█▋        | 33/201 [01:25<07:07,  2.54s/it]Loss: 0.01234:  16%|█▋        | 33/201 [01:25<07:07,  2.54s/it]Loss: 0.01234:  17%|█▋        | 34/201 [01:27<07:04,  2.54s/it]Loss: 0.01012:  17%|█▋        | 34/201 [01:27<07:04,  2.54s/it]Loss: 0.01012:  17%|█▋        | 35/201 [01:30<07:02,  2.54s/it]Loss: 0.01166:  17%|█▋        | 35/201 [01:30<07:02,  2.54s/it]Loss: 0.01166:  18%|█▊        | 36/201 [01:32<06:59,  2.54s/it]Loss: 0.01132:  18%|█▊        | 36/201 [01:32<06:59,  2.54s/it]Loss: 0.01132:  18%|█▊        | 37/201 [01:35<06:56,  2.54s/it]Loss: 0.00603:  18%|█▊        | 37/201 [01:35<06:56,  2.54s/it]Loss: 0.00603:  19%|█▉        | 38/201 [01:37<06:54,  2.54s/it]Loss: 0.00628:  19%|█▉        | 38/201 [01:37<06:54,  2.54s/it]Loss: 0.00628:  19%|█▉        | 39/201 [01:40<06:51,  2.54s/it]Loss: 0.00607:  19%|█▉        | 39/201 [01:40<06:51,  2.54s/it]Loss: 0.00607:  20%|█▉        | 40/201 [01:43<06:49,  2.54s/it]Loss: 0.00776:  20%|█▉        | 40/201 [01:43<06:49,  2.54s/it]Loss: 0.00776:  20%|██        | 41/201 [01:45<07:04,  2.66s/it]Loss: 0.00813:  20%|██        | 41/201 [01:45<07:04,  2.66s/it]Loss: 0.00813:  21%|██        | 42/201 [01:48<06:55,  2.61s/it]Loss: 0.00805:  21%|██        | 42/201 [01:48<06:55,  2.61s/it]Loss: 0.00805:  21%|██▏       | 43/201 [01:51<06:49,  2.59s/it]Loss: 0.00750:  21%|██▏       | 43/201 [01:51<06:49,  2.59s/it]Loss: 0.00750:  22%|██▏       | 44/201 [01:53<06:44,  2.58s/it]Loss: 0.00795:  22%|██▏       | 44/201 [01:53<06:44,  2.58s/it]Loss: 0.00795:  22%|██▏       | 45/201 [01:56<06:40,  2.57s/it]Loss: 0.00749:  22%|██▏       | 45/201 [01:56<06:40,  2.57s/it]Loss: 0.00749:  23%|██▎       | 46/201 [01:58<06:36,  2.56s/it]Loss: 0.00769:  23%|██▎       | 46/201 [01:58<06:36,  2.56s/it]Loss: 0.00769:  23%|██▎       | 47/201 [02:01<06:32,  2.55s/it]Loss: 0.00753:  23%|██▎       | 47/201 [02:01<06:32,  2.55s/it]Loss: 0.00753:  24%|██▍       | 48/201 [02:03<06:29,  2.55s/it]Loss: 0.00739:  24%|██▍       | 48/201 [02:03<06:29,  2.55s/it]Loss: 0.00739:  24%|██▍       | 49/201 [02:06<06:27,  2.55s/it]Loss: 0.00714:  24%|██▍       | 49/201 [02:06<06:27,  2.55s/it]Loss: 0.00714:  25%|██▍       | 50/201 [02:08<06:24,  2.55s/it]Loss: 0.00725:  25%|██▍       | 50/201 [02:08<06:24,  2.55s/it]Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.89s/it][A1it [00:01,  1.89s/it]
Loss: 0.00725:  25%|██▌       | 51/201 [02:13<07:47,  3.12s/it]Loss: 0.33154:  25%|██▌       | 51/201 [02:13<07:47,  3.12s/it]Loss: 0.33154:  26%|██▌       | 52/201 [02:15<07:19,  2.95s/it]Loss: 0.10936:  26%|██▌       | 52/201 [02:15<07:19,  2.95s/it]Loss: 0.10936:  26%|██▋       | 53/201 [02:18<06:59,  2.84s/it]Loss: 0.08200:  26%|██▋       | 53/201 [02:18<06:59,  2.84s/it]Loss: 0.08200:  27%|██▋       | 54/201 [02:20<06:44,  2.75s/it]Loss: 0.06239:  27%|██▋       | 54/201 [02:20<06:44,  2.75s/it]Loss: 0.06239:  27%|██▋       | 55/201 [02:23<06:34,  2.70s/it]Loss: 0.05617:  27%|██▋       | 55/201 [02:23<06:34,  2.70s/it]Loss: 0.05617:  28%|██▊       | 56/201 [02:26<06:25,  2.66s/it]Loss: 0.05073:  28%|██▊       | 56/201 [02:26<06:25,  2.66s/it]Loss: 0.05073:  28%|██▊       | 57/201 [02:28<06:18,  2.63s/it]Loss: 0.04733:  28%|██▊       | 57/201 [02:28<06:18,  2.63s/it]Loss: 0.04733:  29%|██▉       | 58/201 [02:31<06:13,  2.61s/it]Loss: 0.04471:  29%|██▉       | 58/201 [02:31<06:13,  2.61s/it]Loss: 0.04471:  29%|██▉       | 59/201 [02:33<06:08,  2.60s/it]Loss: 0.04274:  29%|██▉       | 59/201 [02:33<06:08,  2.60s/it]Loss: 0.04274:  30%|██▉       | 60/201 [02:36<06:04,  2.59s/it]Loss: 0.04089:  30%|██▉       | 60/201 [02:36<06:04,  2.59s/it]Loss: 0.04089:  30%|███       | 61/201 [02:39<06:14,  2.68s/it]Loss: 0.03931:  30%|███       | 61/201 [02:39<06:14,  2.68s/it]Loss: 0.03931:  31%|███       | 62/201 [02:41<06:06,  2.63s/it]Loss: 0.03794:  31%|███       | 62/201 [02:41<06:06,  2.63s/it]Loss: 0.03794:  31%|███▏      | 63/201 [02:44<06:00,  2.61s/it]Loss: 0.03674:  31%|███▏      | 63/201 [02:44<06:00,  2.61s/it]Loss: 0.03674:  32%|███▏      | 64/201 [02:46<05:56,  2.60s/it]Loss: 0.03553:  32%|███▏      | 64/201 [02:46<05:56,  2.60s/it]Loss: 0.03553:  32%|███▏      | 65/201 [02:49<05:52,  2.59s/it]Loss: 0.03453:  32%|███▏      | 65/201 [02:49<05:52,  2.59s/it]Loss: 0.03453:  33%|███▎      | 66/201 [02:52<05:48,  2.58s/it]Loss: 0.03363:  33%|███▎      | 66/201 [02:52<05:48,  2.58s/it]Loss: 0.03363:  33%|███▎      | 67/201 [02:54<05:45,  2.58s/it]Loss: 0.03271:  33%|███▎      | 67/201 [02:54<05:45,  2.58s/it]Loss: 0.03271:  34%|███▍      | 68/201 [02:57<05:42,  2.57s/it]Loss: 0.03200:  34%|███▍      | 68/201 [02:57<05:42,  2.57s/it]Loss: 0.03200:  34%|███▍      | 69/201 [02:59<05:39,  2.57s/it]Loss: 0.03113:  34%|███▍      | 69/201 [02:59<05:39,  2.57s/it]Loss: 0.03113:  35%|███▍      | 70/201 [03:02<05:36,  2.57s/it]Loss: 0.03051:  35%|███▍      | 70/201 [03:02<05:36,  2.57s/it]Loss: 0.03051:  35%|███▌      | 71/201 [03:04<05:33,  2.57s/it]Loss: 0.02993:  35%|███▌      | 71/201 [03:04<05:33,  2.57s/it]Loss: 0.02993:  36%|███▌      | 72/201 [03:07<05:31,  2.57s/it]Loss: 0.02917:  36%|███▌      | 72/201 [03:07<05:31,  2.57s/it]Loss: 0.02917:  36%|███▋      | 73/201 [03:10<05:28,  2.57s/it]Loss: 0.02871:  36%|███▋      | 73/201 [03:10<05:28,  2.57s/it]Loss: 0.02871:  37%|███▋      | 74/201 [03:12<05:26,  2.57s/it]Loss: 0.02819:  37%|███▋      | 74/201 [03:12<05:26,  2.57s/it]Loss: 0.02819:  37%|███▋      | 75/201 [03:15<05:23,  2.57s/it]Loss: 0.02773:  37%|███▋      | 75/201 [03:15<05:23,  2.57s/it]Loss: 0.02773:  38%|███▊      | 76/201 [03:17<05:21,  2.57s/it]Loss: 0.02709:  38%|███▊      | 76/201 [03:17<05:21,  2.57s/it]Loss: 0.02709:  38%|███▊      | 77/201 [03:20<05:18,  2.57s/it]Loss: 0.02677:  38%|███▊      | 77/201 [03:20<05:18,  2.57s/it]Loss: 0.02677:  39%|███▉      | 78/201 [03:22<05:15,  2.57s/it]Loss: 0.02636:  39%|███▉      | 78/201 [03:22<05:15,  2.57s/it]Loss: 0.02636:  39%|███▉      | 79/201 [03:25<05:13,  2.57s/it]Loss: 0.02599:  39%|███▉      | 79/201 [03:25<05:13,  2.57s/it]Loss: 0.02599:  40%|███▉      | 80/201 [03:27<05:10,  2.57s/it]Loss: 0.02563:  40%|███▉      | 80/201 [03:27<05:10,  2.57s/it]Loss: 0.02563:  40%|████      | 81/201 [03:30<05:20,  2.67s/it]Loss: 0.02525:  40%|████      | 81/201 [03:30<05:20,  2.67s/it]Loss: 0.02525:  41%|████      | 82/201 [03:33<05:13,  2.63s/it]Loss: 0.02480:  41%|████      | 82/201 [03:33<05:13,  2.63s/it]Loss: 0.02480:  41%|████▏     | 83/201 [03:36<05:08,  2.61s/it]Loss: 0.02446:  41%|████▏     | 83/201 [03:36<05:08,  2.61s/it]Loss: 0.02446:  42%|████▏     | 84/201 [03:38<05:04,  2.60s/it]Loss: 0.02421:  42%|████▏     | 84/201 [03:38<05:04,  2.60s/it]Loss: 0.02421:  42%|████▏     | 85/201 [03:41<05:00,  2.59s/it]Loss: 0.02399:  42%|████▏     | 85/201 [03:41<05:00,  2.59s/it]Loss: 0.02399:  43%|████▎     | 86/201 [03:43<04:56,  2.58s/it]Loss: 0.02371:  43%|████▎     | 86/201 [03:43<04:56,  2.58s/it]Loss: 0.02371:  43%|████▎     | 87/201 [03:46<04:53,  2.58s/it]Loss: 0.02344:  43%|████▎     | 87/201 [03:46<04:53,  2.58s/it]Loss: 0.02344:  44%|████▍     | 88/201 [03:48<04:50,  2.57s/it]Loss: 0.02311:  44%|████▍     | 88/201 [03:48<04:50,  2.57s/it]Loss: 0.02311:  44%|████▍     | 89/201 [03:51<04:48,  2.57s/it]Loss: 0.02284:  44%|████▍     | 89/201 [03:51<04:48,  2.57s/it]Loss: 0.02284:  45%|████▍     | 90/201 [03:53<04:45,  2.57s/it]Loss: 0.02267:  45%|████▍     | 90/201 [03:53<04:45,  2.57s/it]Loss: 0.02267:  45%|████▌     | 91/201 [03:56<04:42,  2.57s/it]Loss: 0.02238:  45%|████▌     | 91/201 [03:56<04:42,  2.57s/it]Loss: 0.02238:  46%|████▌     | 92/201 [03:59<04:39,  2.57s/it]Loss: 0.02203:  46%|████▌     | 92/201 [03:59<04:39,  2.57s/it]Loss: 0.02203:  46%|████▋     | 93/201 [04:01<04:36,  2.56s/it]Loss: 0.02190:  46%|████▋     | 93/201 [04:01<04:36,  2.56s/it]Loss: 0.02190:  47%|████▋     | 94/201 [04:04<04:34,  2.57s/it]Loss: 0.02177:  47%|████▋     | 94/201 [04:04<04:34,  2.57s/it]Loss: 0.02177:  47%|████▋     | 95/201 [04:06<04:31,  2.56s/it]Loss: 0.02152:  47%|████▋     | 95/201 [04:06<04:31,  2.56s/it]Loss: 0.02152:  48%|████▊     | 96/201 [04:09<04:29,  2.56s/it]Loss: 0.02133:  48%|████▊     | 96/201 [04:09<04:29,  2.56s/it]Loss: 0.02133:  48%|████▊     | 97/201 [04:11<04:26,  2.56s/it]Loss: 0.02105:  48%|████▊     | 97/201 [04:11<04:26,  2.56s/it]Loss: 0.02105:  49%|████▉     | 98/201 [04:14<04:24,  2.56s/it]Loss: 0.02117:  49%|████▉     | 98/201 [04:14<04:24,  2.56s/it]Loss: 0.02117:  49%|████▉     | 99/201 [04:17<04:21,  2.57s/it]Loss: 0.02094:  49%|████▉     | 99/201 [04:17<04:21,  2.57s/it]Loss: 0.02094:  50%|████▉     | 100/201 [04:19<04:19,  2.57s/it]Loss: 0.02063:  50%|████▉     | 100/201 [04:19<04:19,  2.57s/it]Loss: 0.02063:  50%|█████     | 101/201 [04:22<04:26,  2.66s/it]Loss: 0.02095:  50%|█████     | 101/201 [04:22<04:26,  2.66s/it]max loss: 0.9923564195632935
Densities: min=0.0, max=1.0, mean=0.18376995623111725
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:02,  2.01s/it][A1it [00:02,  2.01s/it]
Loss: 0.02095:  51%|█████     | 102/201 [04:27<05:19,  3.22s/it]Loss: 0.07684:  51%|█████     | 102/201 [04:27<05:19,  3.22s/it]Loss: 0.07684:  51%|█████     | 103/201 [04:29<04:55,  3.02s/it]Loss: 0.08617:  51%|█████     | 103/201 [04:29<04:55,  3.02s/it]Loss: 0.08617:  52%|█████▏    | 104/201 [04:32<04:38,  2.88s/it]Loss: 0.06602:  52%|█████▏    | 104/201 [04:32<04:38,  2.88s/it]Loss: 0.06602:  52%|█████▏    | 105/201 [04:34<04:26,  2.77s/it]Loss: 0.05995:  52%|█████▏    | 105/201 [04:34<04:26,  2.77s/it]Loss: 0.05995:  53%|█████▎    | 106/201 [04:37<04:17,  2.71s/it]Loss: 0.05839:  53%|█████▎    | 106/201 [04:37<04:17,  2.71s/it]Loss: 0.05839:  53%|█████▎    | 107/201 [04:39<04:09,  2.66s/it]Loss: 0.05479:  53%|█████▎    | 107/201 [04:39<04:09,  2.66s/it]Loss: 0.05479:  54%|█████▎    | 108/201 [04:42<04:03,  2.62s/it]Loss: 0.05264:  54%|█████▎    | 108/201 [04:42<04:03,  2.62s/it]Loss: 0.05264:  54%|█████▍    | 109/201 [04:44<03:58,  2.60s/it]Loss: 0.05115:  54%|█████▍    | 109/201 [04:44<03:58,  2.60s/it]Loss: 0.05115:  55%|█████▍    | 110/201 [04:47<03:54,  2.58s/it]Loss: 0.04984:  55%|█████▍    | 110/201 [04:47<03:54,  2.58s/it]Loss: 0.04984:  55%|█████▌    | 111/201 [04:49<03:51,  2.57s/it]Loss: 0.04870:  55%|█████▌    | 111/201 [04:49<03:51,  2.57s/it]Loss: 0.04870:  56%|█████▌    | 112/201 [04:52<03:47,  2.56s/it]Loss: 0.04781:  56%|█████▌    | 112/201 [04:52<03:47,  2.56s/it]Loss: 0.04781:  56%|█████▌    | 113/201 [04:54<03:44,  2.56s/it]Loss: 0.04687:  56%|█████▌    | 113/201 [04:54<03:44,  2.56s/it]Loss: 0.04687:  57%|█████▋    | 114/201 [04:57<03:41,  2.55s/it]Loss: 0.04608:  57%|█████▋    | 114/201 [04:57<03:41,  2.55s/it]Loss: 0.04608:  57%|█████▋    | 115/201 [05:00<03:39,  2.55s/it]Loss: 0.04515:  57%|█████▋    | 115/201 [05:00<03:39,  2.55s/it]Loss: 0.04515:  58%|█████▊    | 116/201 [05:02<03:36,  2.55s/it]Loss: 0.04431:  58%|█████▊    | 116/201 [05:02<03:36,  2.55s/it]Loss: 0.04431:  58%|█████▊    | 117/201 [05:05<03:33,  2.54s/it]Loss: 0.04393:  58%|█████▊    | 117/201 [05:05<03:33,  2.54s/it]Loss: 0.04393:  59%|█████▊    | 118/201 [05:07<03:31,  2.54s/it]Loss: 0.04306:  59%|█████▊    | 118/201 [05:07<03:31,  2.54s/it]Loss: 0.04306:  59%|█████▉    | 119/201 [05:10<03:28,  2.54s/it]Loss: 0.04205:  59%|█████▉    | 119/201 [05:10<03:28,  2.54s/it]Loss: 0.04205:  60%|█████▉    | 120/201 [05:12<03:25,  2.54s/it]Loss: 0.04169:  60%|█████▉    | 120/201 [05:12<03:25,  2.54s/it]Loss: 0.04169:  60%|██████    | 121/201 [05:15<03:30,  2.64s/it]Loss: 0.03973:  60%|██████    | 121/201 [05:15<03:30,  2.64s/it]Loss: 0.03973:  61%|██████    | 122/201 [05:18<03:25,  2.60s/it]Loss: 0.03816:  61%|██████    | 122/201 [05:18<03:25,  2.60s/it]Loss: 0.03816:  61%|██████    | 123/201 [05:20<03:21,  2.58s/it]Loss: 0.03768:  61%|██████    | 123/201 [05:20<03:21,  2.58s/it]Loss: 0.03768:  62%|██████▏   | 124/201 [05:23<03:17,  2.57s/it]Loss: 0.03722:  62%|██████▏   | 124/201 [05:23<03:17,  2.57s/it]Loss: 0.03722:  62%|██████▏   | 125/201 [05:25<03:14,  2.56s/it]Loss: 0.03693:  62%|██████▏   | 125/201 [05:25<03:14,  2.56s/it]Loss: 0.03693:  63%|██████▎   | 126/201 [05:28<03:11,  2.55s/it]Loss: 0.03656:  63%|██████▎   | 126/201 [05:28<03:11,  2.55s/it]Loss: 0.03656:  63%|██████▎   | 127/201 [05:30<03:08,  2.55s/it]Loss: 0.03637:  63%|██████▎   | 127/201 [05:30<03:08,  2.55s/it]Loss: 0.03637:  64%|██████▎   | 128/201 [05:33<03:05,  2.55s/it]Loss: 0.03615:  64%|██████▎   | 128/201 [05:33<03:05,  2.55s/it]Loss: 0.03615:  64%|██████▍   | 129/201 [05:35<03:03,  2.54s/it]Loss: 0.03591:  64%|██████▍   | 129/201 [05:35<03:03,  2.54s/it]Loss: 0.03591:  65%|██████▍   | 130/201 [05:38<03:00,  2.54s/it]Loss: 0.03557:  65%|██████▍   | 130/201 [05:38<03:00,  2.54s/it]Loss: 0.03557:  65%|██████▌   | 131/201 [05:40<02:57,  2.54s/it]Loss: 0.03524:  65%|██████▌   | 131/201 [05:40<02:57,  2.54s/it]Loss: 0.03524:  66%|██████▌   | 132/201 [05:43<02:55,  2.54s/it]Loss: 0.03505:  66%|██████▌   | 132/201 [05:43<02:55,  2.54s/it]Loss: 0.03505:  66%|██████▌   | 133/201 [05:46<02:52,  2.54s/it]Loss: 0.03482:  66%|██████▌   | 133/201 [05:46<02:52,  2.54s/it]Loss: 0.03482:  67%|██████▋   | 134/201 [05:48<02:50,  2.54s/it]Loss: 0.03460:  67%|██████▋   | 134/201 [05:48<02:50,  2.54s/it]Loss: 0.03460:  67%|██████▋   | 135/201 [05:51<02:47,  2.54s/it]Loss: 0.03444:  67%|██████▋   | 135/201 [05:51<02:47,  2.54s/it]Loss: 0.03444:  68%|██████▊   | 136/201 [05:53<02:45,  2.54s/it]Loss: 0.03423:  68%|██████▊   | 136/201 [05:53<02:45,  2.54s/it]Loss: 0.03423:  68%|██████▊   | 137/201 [05:56<02:42,  2.54s/it]Loss: 0.03412:  68%|██████▊   | 137/201 [05:56<02:42,  2.54s/it]Loss: 0.03412:  69%|██████▊   | 138/201 [05:58<02:40,  2.54s/it]Loss: 0.03409:  69%|██████▊   | 138/201 [05:58<02:40,  2.54s/it]Loss: 0.03409:  69%|██████▉   | 139/201 [06:01<02:37,  2.54s/it]Loss: 0.03367:  69%|██████▉   | 139/201 [06:01<02:37,  2.54s/it]Loss: 0.03367:  70%|██████▉   | 140/201 [06:03<02:34,  2.54s/it]Loss: 0.03379:  70%|██████▉   | 140/201 [06:03<02:34,  2.54s/it]Loss: 0.03379:  70%|███████   | 141/201 [06:06<02:38,  2.64s/it]Loss: 0.03360:  70%|███████   | 141/201 [06:06<02:38,  2.64s/it]Loss: 0.03360:  71%|███████   | 142/201 [06:09<02:33,  2.60s/it]Loss: 0.03331:  71%|███████   | 142/201 [06:09<02:33,  2.60s/it]Loss: 0.03331:  71%|███████   | 143/201 [06:11<02:29,  2.58s/it]Loss: 0.03317:  71%|███████   | 143/201 [06:11<02:29,  2.58s/it]Loss: 0.03317:  72%|███████▏  | 144/201 [06:14<02:26,  2.57s/it]Loss: 0.03306:  72%|███████▏  | 144/201 [06:14<02:26,  2.57s/it]Loss: 0.03306:  72%|███████▏  | 145/201 [06:16<02:23,  2.56s/it]Loss: 0.03288:  72%|███████▏  | 145/201 [06:16<02:23,  2.56s/it]Loss: 0.03288:  73%|███████▎  | 146/201 [06:19<02:20,  2.55s/it]Loss: 0.03260:  73%|███████▎  | 146/201 [06:19<02:20,  2.55s/it]Loss: 0.03260:  73%|███████▎  | 147/201 [06:21<02:17,  2.55s/it]Loss: 0.03248:  73%|███████▎  | 147/201 [06:21<02:17,  2.55s/it]Loss: 0.03248:  74%|███████▎  | 148/201 [06:24<02:14,  2.55s/it]Loss: 0.03240:  74%|███████▎  | 148/201 [06:24<02:14,  2.55s/it]Loss: 0.03240:  74%|███████▍  | 149/201 [06:27<02:12,  2.54s/it]Loss: 0.03232:  74%|███████▍  | 149/201 [06:27<02:12,  2.54s/it]Loss: 0.03232:  75%|███████▍  | 150/201 [06:29<02:09,  2.54s/it]Loss: 0.03207:  75%|███████▍  | 150/201 [06:29<02:09,  2.54s/it]Loss: 0.03207:  75%|███████▌  | 151/201 [06:32<02:07,  2.54s/it]Loss: 0.03194:  75%|███████▌  | 151/201 [06:32<02:07,  2.54s/it]Loss: 0.03194:  76%|███████▌  | 152/201 [06:34<02:04,  2.54s/it]Loss: 0.03210:  76%|███████▌  | 152/201 [06:34<02:04,  2.54s/it]max loss: 0.8801357746124268
Densities: min=0.0, max=1.0, mean=0.39662986993789673
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:02,  2.04s/it][A1it [00:02,  2.04s/it]
Loss: 0.03210:  76%|███████▌  | 153/201 [06:39<02:29,  3.12s/it]Loss: 0.06025:  76%|███████▌  | 153/201 [06:39<02:29,  3.12s/it]Loss: 0.06025:  77%|███████▋  | 154/201 [06:41<02:17,  2.93s/it]Loss: 0.05480:  77%|███████▋  | 154/201 [06:41<02:17,  2.93s/it]Loss: 0.05480:  77%|███████▋  | 155/201 [06:44<02:08,  2.79s/it]Loss: 0.05204:  77%|███████▋  | 155/201 [06:44<02:08,  2.79s/it]Loss: 0.05204:  78%|███████▊  | 156/201 [06:46<02:01,  2.69s/it]Loss: 0.05021:  78%|███████▊  | 156/201 [06:46<02:01,  2.69s/it]Loss: 0.05021:  78%|███████▊  | 157/201 [06:48<01:55,  2.62s/it]Loss: 0.04889:  78%|███████▊  | 157/201 [06:48<01:55,  2.62s/it]Loss: 0.04889:  79%|███████▊  | 158/201 [06:51<01:50,  2.57s/it]Loss: 0.04777:  79%|███████▊  | 158/201 [06:51<01:50,  2.57s/it]Loss: 0.04777:  79%|███████▉  | 159/201 [06:53<01:46,  2.54s/it]Loss: 0.04678:  79%|███████▉  | 159/201 [06:53<01:46,  2.54s/it]Loss: 0.04678:  80%|███████▉  | 160/201 [06:56<01:43,  2.52s/it]Loss: 0.04590:  80%|███████▉  | 160/201 [06:56<01:43,  2.52s/it]Loss: 0.04590:  80%|████████  | 161/201 [06:59<01:43,  2.59s/it]Loss: 0.04525:  80%|████████  | 161/201 [06:59<01:43,  2.59s/it]Loss: 0.04525:  81%|████████  | 162/201 [07:01<01:39,  2.54s/it]Loss: 0.04454:  81%|████████  | 162/201 [07:01<01:39,  2.54s/it]Loss: 0.04454:  81%|████████  | 163/201 [07:04<01:35,  2.52s/it]Loss: 0.04392:  81%|████████  | 163/201 [07:04<01:35,  2.52s/it]Loss: 0.04392:  82%|████████▏ | 164/201 [07:06<01:32,  2.50s/it]Loss: 0.04329:  82%|████████▏ | 164/201 [07:06<01:32,  2.50s/it]Loss: 0.04329:  82%|████████▏ | 165/201 [07:08<01:29,  2.49s/it]Loss: 0.04274:  82%|████████▏ | 165/201 [07:08<01:29,  2.49s/it]Loss: 0.04274:  83%|████████▎ | 166/201 [07:11<01:26,  2.48s/it]Loss: 0.04231:  83%|████████▎ | 166/201 [07:11<01:26,  2.48s/it]Loss: 0.04231:  83%|████████▎ | 167/201 [07:13<01:24,  2.48s/it]Loss: 0.04186:  83%|████████▎ | 167/201 [07:13<01:24,  2.48s/it]Loss: 0.04186:  84%|████████▎ | 168/201 [07:16<01:21,  2.47s/it]Loss: 0.04145:  84%|████████▎ | 168/201 [07:16<01:21,  2.47s/it]Loss: 0.04145:  84%|████████▍ | 169/201 [07:18<01:19,  2.47s/it]Loss: 0.04108:  84%|████████▍ | 169/201 [07:18<01:19,  2.47s/it]Loss: 0.04108:  85%|████████▍ | 170/201 [07:21<01:16,  2.47s/it]Loss: 0.04069:  85%|████████▍ | 170/201 [07:21<01:16,  2.47s/it]Loss: 0.04069:  85%|████████▌ | 171/201 [07:23<01:14,  2.47s/it]Loss: 0.04041:  85%|████████▌ | 171/201 [07:23<01:14,  2.47s/it]Loss: 0.04041:  86%|████████▌ | 172/201 [07:26<01:11,  2.47s/it]Loss: 0.04029:  86%|████████▌ | 172/201 [07:26<01:11,  2.47s/it]Loss: 0.04029:  86%|████████▌ | 173/201 [07:28<01:09,  2.46s/it]Loss: 0.04004:  86%|████████▌ | 173/201 [07:28<01:09,  2.46s/it]Loss: 0.04004:  87%|████████▋ | 174/201 [07:31<01:06,  2.46s/it]Loss: 0.03978:  87%|████████▋ | 174/201 [07:31<01:06,  2.46s/it]Loss: 0.03978:  87%|████████▋ | 175/201 [07:33<01:04,  2.46s/it]Loss: 0.03971:  87%|████████▋ | 175/201 [07:33<01:04,  2.46s/it]Loss: 0.03971:  88%|████████▊ | 176/201 [07:36<01:01,  2.46s/it]Loss: 0.03945:  88%|████████▊ | 176/201 [07:36<01:01,  2.46s/it]Loss: 0.03945:  88%|████████▊ | 177/201 [07:38<00:59,  2.46s/it]Loss: 0.03939:  88%|████████▊ | 177/201 [07:38<00:59,  2.46s/it]Loss: 0.03939:  89%|████████▊ | 178/201 [07:40<00:56,  2.46s/it]Loss: 0.03876:  89%|████████▊ | 178/201 [07:40<00:56,  2.46s/it]Loss: 0.03876:  89%|████████▉ | 179/201 [07:43<00:54,  2.46s/it]Loss: 0.03856:  89%|████████▉ | 179/201 [07:43<00:54,  2.46s/it]Loss: 0.03856:  90%|████████▉ | 180/201 [07:45<00:51,  2.46s/it]Loss: 0.03803:  90%|████████▉ | 180/201 [07:45<00:51,  2.46s/it]Loss: 0.03803:  90%|█████████ | 181/201 [07:48<00:51,  2.56s/it]Loss: 0.03772:  90%|█████████ | 181/201 [07:48<00:51,  2.56s/it]Loss: 0.03772:  91%|█████████ | 182/201 [07:51<00:47,  2.52s/it]Loss: 0.03745:  91%|█████████ | 182/201 [07:51<00:47,  2.52s/it]Loss: 0.03745:  91%|█████████ | 183/201 [07:53<00:44,  2.50s/it]Loss: 0.03717:  91%|█████████ | 183/201 [07:53<00:44,  2.50s/it]Loss: 0.03717:  92%|█████████▏| 184/201 [07:56<00:42,  2.49s/it]Loss: 0.03744:  92%|█████████▏| 184/201 [07:56<00:42,  2.49s/it]Loss: 0.03744:  92%|█████████▏| 185/201 [07:58<00:39,  2.48s/it]Loss: 0.03738:  92%|█████████▏| 185/201 [07:58<00:39,  2.48s/it]Loss: 0.03738:  93%|█████████▎| 186/201 [08:00<00:37,  2.48s/it]Loss: 0.03677:  93%|█████████▎| 186/201 [08:00<00:37,  2.48s/it]Loss: 0.03677:  93%|█████████▎| 187/201 [08:03<00:34,  2.47s/it]Loss: 0.03641:  93%|█████████▎| 187/201 [08:03<00:34,  2.47s/it]Loss: 0.03641:  94%|█████████▎| 188/201 [08:05<00:32,  2.47s/it]Loss: 0.03633:  94%|█████████▎| 188/201 [08:05<00:32,  2.47s/it]Loss: 0.03633:  94%|█████████▍| 189/201 [08:08<00:29,  2.47s/it]Loss: 0.03646:  94%|█████████▍| 189/201 [08:08<00:29,  2.47s/it]Loss: 0.03646:  95%|█████████▍| 190/201 [08:10<00:27,  2.46s/it]Loss: 0.03630:  95%|█████████▍| 190/201 [08:10<00:27,  2.46s/it]Loss: 0.03630:  95%|█████████▌| 191/201 [08:13<00:24,  2.46s/it]Loss: 0.03589:  95%|█████████▌| 191/201 [08:13<00:24,  2.46s/it]Loss: 0.03589:  96%|█████████▌| 192/201 [08:15<00:22,  2.46s/it]Loss: 0.03549:  96%|█████████▌| 192/201 [08:15<00:22,  2.46s/it]Loss: 0.03549:  96%|█████████▌| 193/201 [08:18<00:19,  2.46s/it]Loss: 0.03529:  96%|█████████▌| 193/201 [08:18<00:19,  2.46s/it]Loss: 0.03529:  97%|█████████▋| 194/201 [08:20<00:17,  2.46s/it]Loss: 0.03565:  97%|█████████▋| 194/201 [08:20<00:17,  2.46s/it]Loss: 0.03565:  97%|█████████▋| 195/201 [08:23<00:14,  2.46s/it]Loss: 0.03543:  97%|█████████▋| 195/201 [08:23<00:14,  2.46s/it]Loss: 0.03543:  98%|█████████▊| 196/201 [08:25<00:12,  2.46s/it]Loss: 0.03528:  98%|█████████▊| 196/201 [08:25<00:12,  2.46s/it]Loss: 0.03528:  98%|█████████▊| 197/201 [08:27<00:09,  2.46s/it]Loss: 0.03526:  98%|█████████▊| 197/201 [08:27<00:09,  2.46s/it]Loss: 0.03526:  99%|█████████▊| 198/201 [08:30<00:07,  2.46s/it]Loss: 0.03496:  99%|█████████▊| 198/201 [08:30<00:07,  2.46s/it]Loss: 0.03496:  99%|█████████▉| 199/201 [08:32<00:04,  2.46s/it]Loss: 0.03495:  99%|█████████▉| 199/201 [08:32<00:04,  2.46s/it]Loss: 0.03495: 100%|█████████▉| 200/201 [08:35<00:02,  2.46s/it]Loss: 0.03512: 100%|█████████▉| 200/201 [08:35<00:02,  2.46s/it]Loss: 0.03512: 100%|██████████| 201/201 [08:38<00:00,  2.56s/it]Loss: 0.03524: 100%|██████████| 201/201 [08:38<00:00,  2.56s/it]Loss: 0.03524: 100%|██████████| 201/201 [08:38<00:00,  2.58s/it]Load volume "/media/storage0/qadwu/floats/richtmyer_meshkov_2048x2048x1920_float32_raw_2048x2048x1920_float.cvol"
Loaded

max loss: 0.5006411671638489
Densities: min=0.0, max=1.0, mean=0.3883448839187622
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 518.1557512283325 seconds
Load settings from /home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/richtmyer_meshkov.json
Latent space memory: 105.5MiB
Latent space memory: 105.5MiB
Warps shared: 1 , warps mixed: 1
Loaded, output mode: density:direct
Warps shared: 1 , warps mixed: 1
Loaded, output mode: density:direct
Convert model run03-rebuild/richtmyer_meshkov_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/richtmyer_meshkov_2048x2048x1920_float32_raw_2048x2048x1920_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/richtmyer_meshkov.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 19, 'n_features_per_level': 8, 'n_levels': 11, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 5, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 27586048
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  3.74it/s]1it [00:00,  3.74it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.0, max=1.0, mean=0.9359341859817505
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:03,  3.32s/it]Render: : 1it [00:03,  3.32s/it]
Load TF 0, timestep 0, ensemble 0
Model directory: run03-rebuild/richtmyer_meshkov_hybrid/inr/model
Log directory: run03-rebuild/richtmyer_meshkov_hybrid/inr/log
HDF5 directory: run03-rebuild/richtmyer_meshkov_hybrid/inr/hdf5
Current run: 00001
{'settings': '/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/richtmyer_meshkov.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.005, 'epochs': 200, 'lr_gamma': 0.8, 'lr_step': 10, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': 'run03-rebuild/richtmyer_meshkov_hybrid/inr/log', 'modeldir': 'run03-rebuild/richtmyer_meshkov_hybrid/inr/model', 'hdf5dir': 'run03-rebuild/richtmyer_meshkov_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [2048, 2048, 1920], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/richtmyer_meshkov-20220916183752-network.json', 'dryrun': False, 'CUDA_Device': 'Quadro RTX 8000', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 11, 'n_features_per_level': 8, 'log2_hashmap_size': 19, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 5}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<03:39,  1.10s/it]Loss: 0.39154:   0%|          | 1/201 [00:01<03:39,  1.10s/it]Loss: 0.39154:   1%|          | 2/201 [00:01<02:55,  1.14it/s]Loss: 0.06992:   1%|          | 2/201 [00:01<02:55,  1.14it/s]Loss: 0.06992:   1%|▏         | 3/201 [00:02<02:41,  1.23it/s]Loss: 0.03403:   1%|▏         | 3/201 [00:02<02:41,  1.23it/s]Loss: 0.03403:   2%|▏         | 4/201 [00:03<02:35,  1.27it/s]Loss: 0.03263:   2%|▏         | 4/201 [00:03<02:35,  1.27it/s]Loss: 0.03263:   2%|▏         | 5/201 [00:04<02:31,  1.30it/s]Loss: 0.03083:   2%|▏         | 5/201 [00:04<02:31,  1.30it/s]Loss: 0.03083:   3%|▎         | 6/201 [00:04<02:28,  1.31it/s]Loss: 0.02859:   3%|▎         | 6/201 [00:04<02:28,  1.31it/s]Loss: 0.02859:   3%|▎         | 7/201 [00:05<02:26,  1.32it/s]Loss: 0.02569:   3%|▎         | 7/201 [00:05<02:26,  1.32it/s]Loss: 0.02569:   4%|▍         | 8/201 [00:06<02:25,  1.33it/s]Loss: 0.02504:   4%|▍         | 8/201 [00:06<02:25,  1.33it/s]Loss: 0.02504:   4%|▍         | 9/201 [00:07<02:23,  1.34it/s]Loss: 0.02492:   4%|▍         | 9/201 [00:07<02:23,  1.34it/s]Loss: 0.02492:   5%|▍         | 10/201 [00:07<02:22,  1.34it/s]Loss: 0.03150:   5%|▍         | 10/201 [00:07<02:22,  1.34it/s]Loss: 0.03150:   5%|▌         | 11/201 [00:08<02:21,  1.34it/s]Loss: 0.02553:   5%|▌         | 11/201 [00:08<02:21,  1.34it/s]Loss: 0.02553:   6%|▌         | 12/201 [00:09<02:20,  1.34it/s]Loss: 0.01908:   6%|▌         | 12/201 [00:09<02:20,  1.34it/s]Loss: 0.01908:   6%|▋         | 13/201 [00:09<02:19,  1.34it/s]Loss: 0.01812:   6%|▋         | 13/201 [00:09<02:19,  1.34it/s]Loss: 0.01812:   7%|▋         | 14/201 [00:10<02:18,  1.35it/s]Loss: 0.01813:   7%|▋         | 14/201 [00:10<02:18,  1.35it/s]Loss: 0.01813:   7%|▋         | 15/201 [00:11<02:18,  1.35it/s]Loss: 0.01737:   7%|▋         | 15/201 [00:11<02:18,  1.35it/s]Loss: 0.01737:   8%|▊         | 16/201 [00:12<02:17,  1.34it/s]Loss: 0.01733:   8%|▊         | 16/201 [00:12<02:17,  1.34it/s]Loss: 0.01733:   8%|▊         | 17/201 [00:12<02:16,  1.34it/s]Loss: 0.03779:   8%|▊         | 17/201 [00:12<02:16,  1.34it/s]Loss: 0.03779:   9%|▉         | 18/201 [00:13<02:15,  1.35it/s]Loss: 0.06880:   9%|▉         | 18/201 [00:13<02:15,  1.35it/s]Loss: 0.06880:   9%|▉         | 19/201 [00:14<02:15,  1.35it/s]Loss: 0.02932:   9%|▉         | 19/201 [00:14<02:15,  1.35it/s]Loss: 0.02932:  10%|▉         | 20/201 [00:15<02:14,  1.35it/s]Loss: 0.01938:  10%|▉         | 20/201 [00:15<02:14,  1.35it/s]Loss: 0.01938:  10%|█         | 21/201 [00:16<02:31,  1.19it/s]Loss: 0.02314:  10%|█         | 21/201 [00:16<02:31,  1.19it/s]Loss: 0.02314:  11%|█         | 22/201 [00:16<02:24,  1.24it/s]Loss: 0.02254:  11%|█         | 22/201 [00:16<02:24,  1.24it/s]Loss: 0.02254:  11%|█▏        | 23/201 [00:17<02:20,  1.27it/s]Loss: 0.02141:  11%|█▏        | 23/201 [00:17<02:20,  1.27it/s]Loss: 0.02141:  12%|█▏        | 24/201 [00:18<02:16,  1.29it/s]Loss: 0.02143:  12%|█▏        | 24/201 [00:18<02:16,  1.29it/s]Loss: 0.02143:  12%|█▏        | 25/201 [00:19<02:14,  1.31it/s]Loss: 0.02169:  12%|█▏        | 25/201 [00:19<02:14,  1.31it/s]Loss: 0.02169:  13%|█▎        | 26/201 [00:19<02:12,  1.32it/s]Loss: 0.02000:  13%|█▎        | 26/201 [00:19<02:12,  1.32it/s]Loss: 0.02000:  13%|█▎        | 27/201 [00:20<02:11,  1.33it/s]Loss: 0.02139:  13%|█▎        | 27/201 [00:20<02:11,  1.33it/s]Loss: 0.02139:  14%|█▍        | 28/201 [00:21<02:09,  1.33it/s]Loss: 0.03679:  14%|█▍        | 28/201 [00:21<02:09,  1.33it/s]Loss: 0.03679:  14%|█▍        | 29/201 [00:22<02:08,  1.34it/s]Loss: 0.02724:  14%|█▍        | 29/201 [00:22<02:08,  1.34it/s]Loss: 0.02724:  15%|█▍        | 30/201 [00:22<02:07,  1.34it/s]Loss: 0.02042:  15%|█▍        | 30/201 [00:22<02:07,  1.34it/s]Loss: 0.02042:  15%|█▌        | 31/201 [00:23<02:06,  1.34it/s]Loss: 0.01620:  15%|█▌        | 31/201 [00:23<02:06,  1.34it/s]Loss: 0.01620:  16%|█▌        | 32/201 [00:24<02:05,  1.34it/s]Loss: 0.01683:  16%|█▌        | 32/201 [00:24<02:05,  1.34it/s]Loss: 0.01683:  16%|█▋        | 33/201 [00:25<02:05,  1.34it/s]Loss: 0.01598:  16%|█▋        | 33/201 [00:25<02:05,  1.34it/s]Loss: 0.01598:  17%|█▋        | 34/201 [00:25<02:04,  1.34it/s]Loss: 0.01537:  17%|█▋        | 34/201 [00:25<02:04,  1.34it/s]Loss: 0.01537:  17%|█▋        | 35/201 [00:26<02:03,  1.34it/s]Loss: 0.01578:  17%|█▋        | 35/201 [00:26<02:03,  1.34it/s]Loss: 0.01578:  18%|█▊        | 36/201 [00:27<02:02,  1.34it/s]Loss: 0.01572:  18%|█▊        | 36/201 [00:27<02:02,  1.34it/s]Loss: 0.01572:  18%|█▊        | 37/201 [00:28<02:01,  1.34it/s]Loss: 0.01516:  18%|█▊        | 37/201 [00:28<02:01,  1.34it/s]Loss: 0.01516:  19%|█▉        | 38/201 [00:28<02:01,  1.34it/s]Loss: 0.00849:  19%|█▉        | 38/201 [00:28<02:01,  1.34it/s]Loss: 0.00849:  19%|█▉        | 39/201 [00:29<02:00,  1.35it/s]Loss: 0.00788:  19%|█▉        | 39/201 [00:29<02:00,  1.35it/s]Loss: 0.00788:  20%|█▉        | 40/201 [00:30<01:59,  1.35it/s]Loss: 0.00923:  20%|█▉        | 40/201 [00:30<01:59,  1.35it/s]Loss: 0.00923:  20%|██        | 41/201 [00:31<02:19,  1.14it/s]Loss: 0.00952:  20%|██        | 41/201 [00:31<02:19,  1.14it/s]Loss: 0.00952:  21%|██        | 42/201 [00:32<02:12,  1.20it/s]Loss: 0.00911:  21%|██        | 42/201 [00:32<02:12,  1.20it/s]Loss: 0.00911:  21%|██▏       | 43/201 [00:33<02:07,  1.24it/s]Loss: 0.02284:  21%|██▏       | 43/201 [00:33<02:07,  1.24it/s]Loss: 0.02284:  22%|██▏       | 44/201 [00:33<02:03,  1.27it/s]Loss: 0.02340:  22%|██▏       | 44/201 [00:33<02:03,  1.27it/s]Loss: 0.02340:  22%|██▏       | 45/201 [00:34<02:00,  1.29it/s]Loss: 0.01322:  22%|██▏       | 45/201 [00:34<02:00,  1.29it/s]Loss: 0.01322:  23%|██▎       | 46/201 [00:35<01:58,  1.31it/s]Loss: 0.01307:  23%|██▎       | 46/201 [00:35<01:58,  1.31it/s]Loss: 0.01307:  23%|██▎       | 47/201 [00:35<01:56,  1.32it/s]Loss: 0.01287:  23%|██▎       | 47/201 [00:35<01:56,  1.32it/s]Loss: 0.01287:  24%|██▍       | 48/201 [00:36<01:55,  1.33it/s]Loss: 0.01189:  24%|██▍       | 48/201 [00:36<01:55,  1.33it/s]Loss: 0.01189:  24%|██▍       | 49/201 [00:37<01:53,  1.33it/s]Loss: 0.01294:  24%|██▍       | 49/201 [00:37<01:53,  1.33it/s]Loss: 0.01294:  25%|██▍       | 50/201 [00:38<01:52,  1.34it/s]Loss: 0.01217:  25%|██▍       | 50/201 [00:38<01:52,  1.34it/s]Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.43s/it][A1it [00:01,  1.43s/it]
Loss: 0.01217:  25%|██▌       | 51/201 [00:40<02:56,  1.18s/it]Loss: 0.12713:  25%|██▌       | 51/201 [00:40<02:56,  1.18s/it]Loss: 0.12713:  26%|██▌       | 52/201 [00:41<02:36,  1.05s/it]Loss: 0.07446:  26%|██▌       | 52/201 [00:41<02:36,  1.05s/it]Loss: 0.07446:  26%|██▋       | 53/201 [00:41<02:21,  1.05it/s]Loss: 0.05966:  26%|██▋       | 53/201 [00:41<02:21,  1.05it/s]Loss: 0.05966:  27%|██▋       | 54/201 [00:42<02:11,  1.12it/s]Loss: 0.05055:  27%|██▋       | 54/201 [00:42<02:11,  1.12it/s]Loss: 0.05055:  27%|██▋       | 55/201 [00:43<02:03,  1.18it/s]Loss: 0.04368:  27%|██▋       | 55/201 [00:43<02:03,  1.18it/s]Loss: 0.04368:  28%|██▊       | 56/201 [00:44<01:58,  1.23it/s]Loss: 0.03842:  28%|██▊       | 56/201 [00:44<01:58,  1.23it/s]Loss: 0.03842:  28%|██▊       | 57/201 [00:44<01:54,  1.26it/s]Loss: 0.03424:  28%|██▊       | 57/201 [00:44<01:54,  1.26it/s]Loss: 0.03424:  29%|██▉       | 58/201 [00:45<01:51,  1.28it/s]Loss: 0.03090:  29%|██▉       | 58/201 [00:45<01:51,  1.28it/s]Loss: 0.03090:  29%|██▉       | 59/201 [00:46<01:49,  1.30it/s]Loss: 0.02821:  29%|██▉       | 59/201 [00:46<01:49,  1.30it/s]Loss: 0.02821:  30%|██▉       | 60/201 [00:47<01:47,  1.32it/s]Loss: 0.02613:  30%|██▉       | 60/201 [00:47<01:47,  1.32it/s]Loss: 0.02613:  30%|███       | 61/201 [00:48<01:59,  1.17it/s]Loss: 0.02375:  30%|███       | 61/201 [00:48<01:59,  1.17it/s]Loss: 0.02375:  31%|███       | 62/201 [00:48<01:53,  1.23it/s]Loss: 0.02145:  31%|███       | 62/201 [00:48<01:53,  1.23it/s]Loss: 0.02145:  31%|███▏      | 63/201 [00:49<01:49,  1.26it/s]Loss: 0.02013:  31%|███▏      | 63/201 [00:49<01:49,  1.26it/s]Loss: 0.02013:  32%|███▏      | 64/201 [00:50<01:46,  1.29it/s]Loss: 0.01896:  32%|███▏      | 64/201 [00:50<01:46,  1.29it/s]Loss: 0.01896:  32%|███▏      | 65/201 [00:51<01:43,  1.31it/s]Loss: 0.01821:  32%|███▏      | 65/201 [00:51<01:43,  1.31it/s]Loss: 0.01821:  33%|███▎      | 66/201 [00:51<01:42,  1.32it/s]Loss: 0.01739:  33%|███▎      | 66/201 [00:51<01:42,  1.32it/s]Loss: 0.01739:  33%|███▎      | 67/201 [00:52<01:40,  1.33it/s]Loss: 0.01676:  33%|███▎      | 67/201 [00:52<01:40,  1.33it/s]Loss: 0.01676:  34%|███▍      | 68/201 [00:53<01:39,  1.34it/s]Loss: 0.01618:  34%|███▍      | 68/201 [00:53<01:39,  1.34it/s]Loss: 0.01618:  34%|███▍      | 69/201 [00:54<01:38,  1.34it/s]Loss: 0.01570:  34%|███▍      | 69/201 [00:54<01:38,  1.34it/s]Loss: 0.01570:  35%|███▍      | 70/201 [00:54<01:37,  1.34it/s]Loss: 0.01529:  35%|███▍      | 70/201 [00:54<01:37,  1.34it/s]Loss: 0.01529:  35%|███▌      | 71/201 [00:55<01:36,  1.34it/s]Loss: 0.01412:  35%|███▌      | 71/201 [00:55<01:36,  1.34it/s]Loss: 0.01412:  36%|███▌      | 72/201 [00:56<01:35,  1.35it/s]Loss: 0.01293:  36%|███▌      | 72/201 [00:56<01:35,  1.35it/s]Loss: 0.01293:  36%|███▋      | 73/201 [00:57<01:35,  1.35it/s]Loss: 0.01250:  36%|███▋      | 73/201 [00:57<01:35,  1.35it/s]Loss: 0.01250:  37%|███▋      | 74/201 [00:57<01:34,  1.34it/s]Loss: 0.01224:  37%|███▋      | 74/201 [00:57<01:34,  1.34it/s]Loss: 0.01224:  37%|███▋      | 75/201 [00:58<01:33,  1.35it/s]Loss: 0.01235:  37%|███▋      | 75/201 [00:58<01:33,  1.35it/s]Loss: 0.01235:  38%|███▊      | 76/201 [00:59<01:32,  1.35it/s]Loss: 0.01207:  38%|███▊      | 76/201 [00:59<01:32,  1.35it/s]Loss: 0.01207:  38%|███▊      | 77/201 [00:59<01:31,  1.35it/s]Loss: 0.01179:  38%|███▊      | 77/201 [00:59<01:31,  1.35it/s]Loss: 0.01179:  39%|███▉      | 78/201 [01:00<01:30,  1.35it/s]Loss: 0.01125:  39%|███▉      | 78/201 [01:00<01:30,  1.35it/s]Loss: 0.01125:  39%|███▉      | 79/201 [01:01<01:30,  1.35it/s]Loss: 0.01086:  39%|███▉      | 79/201 [01:01<01:30,  1.35it/s]Loss: 0.01086:  40%|███▉      | 80/201 [01:02<01:29,  1.35it/s]Loss: 0.01071:  40%|███▉      | 80/201 [01:02<01:29,  1.35it/s]Loss: 0.01071:  40%|████      | 81/201 [01:03<01:40,  1.19it/s]Loss: 0.01010:  40%|████      | 81/201 [01:03<01:40,  1.19it/s]Loss: 0.01010:  41%|████      | 82/201 [01:04<01:35,  1.24it/s]Loss: 0.00942:  41%|████      | 82/201 [01:04<01:35,  1.24it/s]Loss: 0.00942:  41%|████▏     | 83/201 [01:04<01:32,  1.27it/s]Loss: 0.00928:  41%|████▏     | 83/201 [01:04<01:32,  1.27it/s]Loss: 0.00928:  42%|████▏     | 84/201 [01:05<01:30,  1.29it/s]Loss: 0.00901:  42%|████▏     | 84/201 [01:05<01:30,  1.29it/s]Loss: 0.00901:  42%|████▏     | 85/201 [01:06<01:28,  1.31it/s]Loss: 0.00893:  42%|████▏     | 85/201 [01:06<01:28,  1.31it/s]Loss: 0.00893:  43%|████▎     | 86/201 [01:06<01:26,  1.32it/s]Loss: 0.00878:  43%|████▎     | 86/201 [01:06<01:26,  1.32it/s]Loss: 0.00878:  43%|████▎     | 87/201 [01:07<01:25,  1.33it/s]Loss: 0.00870:  43%|████▎     | 87/201 [01:07<01:25,  1.33it/s]Loss: 0.00870:  44%|████▍     | 88/201 [01:08<01:24,  1.34it/s]Loss: 0.00864:  44%|████▍     | 88/201 [01:08<01:24,  1.34it/s]Loss: 0.00864:  44%|████▍     | 89/201 [01:09<01:23,  1.34it/s]Loss: 0.00851:  44%|████▍     | 89/201 [01:09<01:23,  1.34it/s]Loss: 0.00851:  45%|████▍     | 90/201 [01:09<01:22,  1.35it/s]Loss: 0.00843:  45%|████▍     | 90/201 [01:09<01:22,  1.35it/s]Loss: 0.00843:  45%|████▌     | 91/201 [01:10<01:21,  1.35it/s]Loss: 0.00814:  45%|████▌     | 91/201 [01:10<01:21,  1.35it/s]Loss: 0.00814:  46%|████▌     | 92/201 [01:11<01:20,  1.35it/s]Loss: 0.00754:  46%|████▌     | 92/201 [01:11<01:20,  1.35it/s]Loss: 0.00754:  46%|████▋     | 93/201 [01:12<01:19,  1.35it/s]Loss: 0.00748:  46%|████▋     | 93/201 [01:12<01:19,  1.35it/s]Loss: 0.00748:  47%|████▋     | 94/201 [01:12<01:19,  1.35it/s]Loss: 0.00732:  47%|████▋     | 94/201 [01:12<01:19,  1.35it/s]Loss: 0.00732:  47%|████▋     | 95/201 [01:13<01:18,  1.35it/s]Loss: 0.00731:  47%|████▋     | 95/201 [01:13<01:18,  1.35it/s]Loss: 0.00731:  48%|████▊     | 96/201 [01:14<01:17,  1.35it/s]Loss: 0.00724:  48%|████▊     | 96/201 [01:14<01:17,  1.35it/s]Loss: 0.00724:  48%|████▊     | 97/201 [01:15<01:16,  1.35it/s]Loss: 0.00722:  48%|████▊     | 97/201 [01:15<01:16,  1.35it/s]Loss: 0.00722:  49%|████▉     | 98/201 [01:15<01:16,  1.35it/s]Loss: 0.00709:  49%|████▉     | 98/201 [01:15<01:16,  1.35it/s]Loss: 0.00709:  49%|████▉     | 99/201 [01:16<01:15,  1.35it/s]Loss: 0.00705:  49%|████▉     | 99/201 [01:16<01:15,  1.35it/s]Loss: 0.00705:  50%|████▉     | 100/201 [01:17<01:14,  1.35it/s]Loss: 0.00708:  50%|████▉     | 100/201 [01:17<01:14,  1.35it/s]Loss: 0.00708:  50%|█████     | 101/201 [01:18<01:23,  1.19it/s]Loss: 0.00686:  50%|█████     | 101/201 [01:18<01:23,  1.19it/s]max loss: 1.04222571849823
Densities: min=0.0, max=1.0, mean=0.31764042377471924
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.89s/it][A1it [00:01,  1.89s/it]
Loss: 0.00686:  51%|█████     | 102/201 [01:21<02:16,  1.38s/it]Loss: 0.06973:  51%|█████     | 102/201 [01:21<02:16,  1.38s/it]Loss: 0.06973:  51%|█████     | 103/201 [01:21<01:56,  1.19s/it]Loss: 0.06147:  51%|█████     | 103/201 [01:21<01:56,  1.19s/it]Loss: 0.06147:  52%|█████▏    | 104/201 [01:22<01:42,  1.05s/it]Loss: 0.05626:  52%|█████▏    | 104/201 [01:22<01:42,  1.05s/it]Loss: 0.05626:  52%|█████▏    | 105/201 [01:23<01:32,  1.04it/s]Loss: 0.05221:  52%|█████▏    | 105/201 [01:23<01:32,  1.04it/s]Loss: 0.05221:  53%|█████▎    | 106/201 [01:23<01:25,  1.12it/s]Loss: 0.04880:  53%|█████▎    | 106/201 [01:23<01:25,  1.12it/s]Loss: 0.04880:  53%|█████▎    | 107/201 [01:24<01:19,  1.18it/s]Loss: 0.04586:  53%|█████▎    | 107/201 [01:24<01:19,  1.18it/s]Loss: 0.04586:  54%|█████▎    | 108/201 [01:25<01:15,  1.22it/s]Loss: 0.04327:  54%|█████▎    | 108/201 [01:25<01:15,  1.22it/s]Loss: 0.04327:  54%|█████▍    | 109/201 [01:26<01:13,  1.26it/s]Loss: 0.04092:  54%|█████▍    | 109/201 [01:26<01:13,  1.26it/s]Loss: 0.04092:  55%|█████▍    | 110/201 [01:26<01:10,  1.29it/s]Loss: 0.03882:  55%|█████▍    | 110/201 [01:26<01:10,  1.29it/s]Loss: 0.03882:  55%|█████▌    | 111/201 [01:27<01:08,  1.30it/s]Loss: 0.03682:  55%|█████▌    | 111/201 [01:27<01:08,  1.30it/s]Loss: 0.03682:  56%|█████▌    | 112/201 [01:28<01:07,  1.32it/s]Loss: 0.03518:  56%|█████▌    | 112/201 [01:28<01:07,  1.32it/s]Loss: 0.03518:  56%|█████▌    | 113/201 [01:29<01:06,  1.33it/s]Loss: 0.03378:  56%|█████▌    | 113/201 [01:29<01:06,  1.33it/s]Loss: 0.03378:  57%|█████▋    | 114/201 [01:29<01:05,  1.33it/s]Loss: 0.03248:  57%|█████▋    | 114/201 [01:29<01:05,  1.33it/s]Loss: 0.03248:  57%|█████▋    | 115/201 [01:30<01:04,  1.34it/s]Loss: 0.03128:  57%|█████▋    | 115/201 [01:30<01:04,  1.34it/s]Loss: 0.03128:  58%|█████▊    | 116/201 [01:31<01:03,  1.34it/s]Loss: 0.03017:  58%|█████▊    | 116/201 [01:31<01:03,  1.34it/s]Loss: 0.03017:  58%|█████▊    | 117/201 [01:32<01:02,  1.34it/s]Loss: 0.02915:  58%|█████▊    | 117/201 [01:32<01:02,  1.34it/s]Loss: 0.02915:  59%|█████▊    | 118/201 [01:32<01:01,  1.35it/s]Loss: 0.02816:  59%|█████▊    | 118/201 [01:32<01:01,  1.35it/s]Loss: 0.02816:  59%|█████▉    | 119/201 [01:33<01:00,  1.35it/s]Loss: 0.02723:  59%|█████▉    | 119/201 [01:33<01:00,  1.35it/s]Loss: 0.02723:  60%|█████▉    | 120/201 [01:34<01:00,  1.35it/s]Loss: 0.02636:  60%|█████▉    | 120/201 [01:34<01:00,  1.35it/s]Loss: 0.02636:  60%|██████    | 121/201 [01:35<01:05,  1.22it/s]Loss: 0.02541:  60%|██████    | 121/201 [01:35<01:05,  1.22it/s]Loss: 0.02541:  61%|██████    | 122/201 [01:36<01:02,  1.26it/s]Loss: 0.02453:  61%|██████    | 122/201 [01:36<01:02,  1.26it/s]Loss: 0.02453:  61%|██████    | 123/201 [01:36<01:00,  1.28it/s]Loss: 0.02389:  61%|██████    | 123/201 [01:36<01:00,  1.28it/s]Loss: 0.02389:  62%|██████▏   | 124/201 [01:37<00:59,  1.30it/s]Loss: 0.02329:  62%|██████▏   | 124/201 [01:37<00:59,  1.30it/s]Loss: 0.02329:  62%|██████▏   | 125/201 [01:38<00:57,  1.32it/s]Loss: 0.02275:  62%|██████▏   | 125/201 [01:38<00:57,  1.32it/s]Loss: 0.02275:  63%|██████▎   | 126/201 [01:39<00:56,  1.33it/s]Loss: 0.02220:  63%|██████▎   | 126/201 [01:39<00:56,  1.33it/s]Loss: 0.02220:  63%|██████▎   | 127/201 [01:39<00:55,  1.33it/s]Loss: 0.02171:  63%|██████▎   | 127/201 [01:39<00:55,  1.33it/s]Loss: 0.02171:  64%|██████▎   | 128/201 [01:40<00:54,  1.34it/s]Loss: 0.02122:  64%|██████▎   | 128/201 [01:40<00:54,  1.34it/s]Loss: 0.02122:  64%|██████▍   | 129/201 [01:41<00:53,  1.34it/s]Loss: 0.02077:  64%|██████▍   | 129/201 [01:41<00:53,  1.34it/s]Loss: 0.02077:  65%|██████▍   | 130/201 [01:42<00:52,  1.35it/s]Loss: 0.02031:  65%|██████▍   | 130/201 [01:42<00:52,  1.35it/s]Loss: 0.02031:  65%|██████▌   | 131/201 [01:42<00:51,  1.35it/s]Loss: 0.01976:  65%|██████▌   | 131/201 [01:42<00:51,  1.35it/s]Loss: 0.01976:  66%|██████▌   | 132/201 [01:43<00:51,  1.35it/s]Loss: 0.01921:  66%|██████▌   | 132/201 [01:43<00:51,  1.35it/s]Loss: 0.01921:  66%|██████▌   | 133/201 [01:44<00:50,  1.35it/s]Loss: 0.01896:  66%|██████▌   | 133/201 [01:44<00:50,  1.35it/s]Loss: 0.01896:  67%|██████▋   | 134/201 [01:44<00:49,  1.35it/s]Loss: 0.01869:  67%|██████▋   | 134/201 [01:44<00:49,  1.35it/s]Loss: 0.01869:  67%|██████▋   | 135/201 [01:45<00:48,  1.35it/s]Loss: 0.01849:  67%|██████▋   | 135/201 [01:45<00:48,  1.35it/s]Loss: 0.01849:  68%|██████▊   | 136/201 [01:46<00:48,  1.35it/s]Loss: 0.01819:  68%|██████▊   | 136/201 [01:46<00:48,  1.35it/s]Loss: 0.01819:  68%|██████▊   | 137/201 [01:47<00:47,  1.35it/s]Loss: 0.01778:  68%|██████▊   | 137/201 [01:47<00:47,  1.35it/s]Loss: 0.01778:  69%|██████▊   | 138/201 [01:47<00:46,  1.35it/s]Loss: 0.01745:  69%|██████▊   | 138/201 [01:47<00:46,  1.35it/s]Loss: 0.01745:  69%|██████▉   | 139/201 [01:48<00:45,  1.35it/s]Loss: 0.01719:  69%|██████▉   | 139/201 [01:48<00:45,  1.35it/s]Loss: 0.01719:  70%|██████▉   | 140/201 [01:49<00:45,  1.35it/s]Loss: 0.01691:  70%|██████▉   | 140/201 [01:49<00:45,  1.35it/s]Loss: 0.01691:  70%|███████   | 141/201 [01:50<00:49,  1.21it/s]Loss: 0.01649:  70%|███████   | 141/201 [01:50<00:49,  1.21it/s]Loss: 0.01649:  71%|███████   | 142/201 [01:51<00:47,  1.25it/s]Loss: 0.01605:  71%|███████   | 142/201 [01:51<00:47,  1.25it/s]Loss: 0.01605:  71%|███████   | 143/201 [01:51<00:45,  1.28it/s]Loss: 0.01584:  71%|███████   | 143/201 [01:51<00:45,  1.28it/s]Loss: 0.01584:  72%|███████▏  | 144/201 [01:52<00:43,  1.30it/s]Loss: 0.01561:  72%|███████▏  | 144/201 [01:52<00:43,  1.30it/s]Loss: 0.01561:  72%|███████▏  | 145/201 [01:53<00:42,  1.31it/s]Loss: 0.01542:  72%|███████▏  | 145/201 [01:53<00:42,  1.31it/s]Loss: 0.01542:  73%|███████▎  | 146/201 [01:54<00:41,  1.33it/s]Loss: 0.01525:  73%|███████▎  | 146/201 [01:54<00:41,  1.33it/s]Loss: 0.01525:  73%|███████▎  | 147/201 [01:54<00:40,  1.33it/s]Loss: 0.01508:  73%|███████▎  | 147/201 [01:54<00:40,  1.33it/s]Loss: 0.01508:  74%|███████▎  | 148/201 [01:55<00:39,  1.34it/s]Loss: 0.01493:  74%|███████▎  | 148/201 [01:55<00:39,  1.34it/s]Loss: 0.01493:  74%|███████▍  | 149/201 [01:56<00:38,  1.34it/s]Loss: 0.01478:  74%|███████▍  | 149/201 [01:56<00:38,  1.34it/s]Loss: 0.01478:  75%|███████▍  | 150/201 [01:57<00:38,  1.34it/s]Loss: 0.01462:  75%|███████▍  | 150/201 [01:57<00:38,  1.34it/s]Loss: 0.01462:  75%|███████▌  | 151/201 [01:57<00:37,  1.34it/s]Loss: 0.01444:  75%|███████▌  | 151/201 [01:57<00:37,  1.34it/s]Loss: 0.01444:  76%|███████▌  | 152/201 [01:58<00:36,  1.34it/s]Loss: 0.01413:  76%|███████▌  | 152/201 [01:58<00:36,  1.34it/s]max loss: 0.7284228801727295
Densities: min=0.0, max=1.0, mean=0.3996959924697876
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.89s/it][A1it [00:01,  1.89s/it]
Loss: 0.01413:  76%|███████▌  | 153/201 [02:01<01:03,  1.31s/it]Loss: 0.06603:  76%|███████▌  | 153/201 [02:01<01:03,  1.31s/it]Loss: 0.06603:  77%|███████▋  | 154/201 [02:01<00:53,  1.14s/it]Loss: 0.06186:  77%|███████▋  | 154/201 [02:01<00:53,  1.14s/it]Loss: 0.06186:  77%|███████▋  | 155/201 [02:02<00:47,  1.02s/it]Loss: 0.05918:  77%|███████▋  | 155/201 [02:02<00:47,  1.02s/it]Loss: 0.05918:  78%|███████▊  | 156/201 [02:03<00:42,  1.07it/s]Loss: 0.05698:  78%|███████▊  | 156/201 [02:03<00:42,  1.07it/s]Loss: 0.05698:  78%|███████▊  | 157/201 [02:04<00:38,  1.14it/s]Loss: 0.05513:  78%|███████▊  | 157/201 [02:04<00:38,  1.14it/s]Loss: 0.05513:  79%|███████▊  | 158/201 [02:04<00:36,  1.19it/s]Loss: 0.05348:  79%|███████▊  | 158/201 [02:04<00:36,  1.19it/s]Loss: 0.05348:  79%|███████▉  | 159/201 [02:05<00:34,  1.23it/s]Loss: 0.05197:  79%|███████▉  | 159/201 [02:05<00:34,  1.23it/s]Loss: 0.05197:  80%|███████▉  | 160/201 [02:06<00:32,  1.27it/s]Loss: 0.05059:  80%|███████▉  | 160/201 [02:06<00:32,  1.27it/s]Loss: 0.05059:  80%|████████  | 161/201 [02:07<00:34,  1.16it/s]Loss: 0.04935:  80%|████████  | 161/201 [02:07<00:34,  1.16it/s]Loss: 0.04935:  81%|████████  | 162/201 [02:08<00:32,  1.21it/s]Loss: 0.04834:  81%|████████  | 162/201 [02:08<00:32,  1.21it/s]Loss: 0.04834:  81%|████████  | 163/201 [02:08<00:30,  1.25it/s]Loss: 0.04742:  81%|████████  | 163/201 [02:08<00:30,  1.25it/s]Loss: 0.04742:  82%|████████▏ | 164/201 [02:09<00:28,  1.28it/s]Loss: 0.04655:  82%|████████▏ | 164/201 [02:09<00:28,  1.28it/s]Loss: 0.04655:  82%|████████▏ | 165/201 [02:10<00:27,  1.30it/s]Loss: 0.04570:  82%|████████▏ | 165/201 [02:10<00:27,  1.30it/s]Loss: 0.04570:  83%|████████▎ | 166/201 [02:11<00:26,  1.31it/s]Loss: 0.04491:  83%|████████▎ | 166/201 [02:11<00:26,  1.31it/s]Loss: 0.04491:  83%|████████▎ | 167/201 [02:11<00:25,  1.32it/s]Loss: 0.04414:  83%|████████▎ | 167/201 [02:11<00:25,  1.32it/s]Loss: 0.04414:  84%|████████▎ | 168/201 [02:12<00:24,  1.33it/s]Loss: 0.04340:  84%|████████▎ | 168/201 [02:12<00:24,  1.33it/s]Loss: 0.04340:  84%|████████▍ | 169/201 [02:13<00:23,  1.33it/s]Loss: 0.04267:  84%|████████▍ | 169/201 [02:13<00:23,  1.33it/s]Loss: 0.04267:  85%|████████▍ | 170/201 [02:14<00:23,  1.34it/s]Loss: 0.04199:  85%|████████▍ | 170/201 [02:14<00:23,  1.34it/s]Loss: 0.04199:  85%|████████▌ | 171/201 [02:14<00:22,  1.34it/s]Loss: 0.04131:  85%|████████▌ | 171/201 [02:14<00:22,  1.34it/s]Loss: 0.04131:  86%|████████▌ | 172/201 [02:15<00:21,  1.34it/s]Loss: 0.04075:  86%|████████▌ | 172/201 [02:15<00:21,  1.34it/s]Loss: 0.04075:  86%|████████▌ | 173/201 [02:16<00:20,  1.34it/s]Loss: 0.04024:  86%|████████▌ | 173/201 [02:16<00:20,  1.34it/s]Loss: 0.04024:  87%|████████▋ | 174/201 [02:17<00:20,  1.34it/s]Loss: 0.03976:  87%|████████▋ | 174/201 [02:17<00:20,  1.34it/s]Loss: 0.03976:  87%|████████▋ | 175/201 [02:17<00:19,  1.34it/s]Loss: 0.03927:  87%|████████▋ | 175/201 [02:17<00:19,  1.34it/s]Loss: 0.03927:  88%|████████▊ | 176/201 [02:18<00:18,  1.34it/s]Loss: 0.03879:  88%|████████▊ | 176/201 [02:18<00:18,  1.34it/s]Loss: 0.03879:  88%|████████▊ | 177/201 [02:19<00:17,  1.34it/s]Loss: 0.03834:  88%|████████▊ | 177/201 [02:19<00:17,  1.34it/s]Loss: 0.03834:  89%|████████▊ | 178/201 [02:20<00:17,  1.35it/s]Loss: 0.03788:  89%|████████▊ | 178/201 [02:20<00:17,  1.35it/s]Loss: 0.03788:  89%|████████▉ | 179/201 [02:20<00:16,  1.35it/s]Loss: 0.03745:  89%|████████▉ | 179/201 [02:20<00:16,  1.35it/s]Loss: 0.03745:  90%|████████▉ | 180/201 [02:21<00:15,  1.35it/s]Loss: 0.03702:  90%|████████▉ | 180/201 [02:21<00:15,  1.35it/s]Loss: 0.03702:  90%|█████████ | 181/201 [02:22<00:16,  1.21it/s]Loss: 0.03659:  90%|█████████ | 181/201 [02:22<00:16,  1.21it/s]Loss: 0.03659:  91%|█████████ | 182/201 [02:23<00:15,  1.25it/s]Loss: 0.03622:  91%|█████████ | 182/201 [02:23<00:15,  1.25it/s]Loss: 0.03622:  91%|█████████ | 183/201 [02:24<00:14,  1.28it/s]Loss: 0.03589:  91%|█████████ | 183/201 [02:24<00:14,  1.28it/s]Loss: 0.03589:  92%|█████████▏| 184/201 [02:24<00:13,  1.30it/s]Loss: 0.03556:  92%|█████████▏| 184/201 [02:24<00:13,  1.30it/s]Loss: 0.03556:  92%|█████████▏| 185/201 [02:25<00:12,  1.32it/s]Loss: 0.03526:  92%|█████████▏| 185/201 [02:25<00:12,  1.32it/s]Loss: 0.03526:  93%|█████████▎| 186/201 [02:26<00:11,  1.33it/s]Loss: 0.03495:  93%|█████████▎| 186/201 [02:26<00:11,  1.33it/s]Loss: 0.03495:  93%|█████████▎| 187/201 [02:27<00:10,  1.33it/s]Loss: 0.03464:  93%|█████████▎| 187/201 [02:27<00:10,  1.33it/s]Loss: 0.03464:  94%|█████████▎| 188/201 [02:27<00:09,  1.34it/s]Loss: 0.03434:  94%|█████████▎| 188/201 [02:27<00:09,  1.34it/s]Loss: 0.03434:  94%|█████████▍| 189/201 [02:28<00:08,  1.34it/s]Loss: 0.03404:  94%|█████████▍| 189/201 [02:28<00:08,  1.34it/s]Loss: 0.03404:  95%|█████████▍| 190/201 [02:29<00:08,  1.34it/s]Loss: 0.03376:  95%|█████████▍| 190/201 [02:29<00:08,  1.34it/s]Loss: 0.03376:  95%|█████████▌| 191/201 [02:29<00:07,  1.34it/s]Loss: 0.03345:  95%|█████████▌| 191/201 [02:29<00:07,  1.34it/s]Loss: 0.03345:  96%|█████████▌| 192/201 [02:30<00:06,  1.35it/s]Loss: 0.03319:  96%|█████████▌| 192/201 [02:30<00:06,  1.35it/s]Loss: 0.03319:  96%|█████████▌| 193/201 [02:31<00:05,  1.35it/s]Loss: 0.03296:  96%|█████████▌| 193/201 [02:31<00:05,  1.35it/s]Loss: 0.03296:  97%|█████████▋| 194/201 [02:32<00:05,  1.35it/s]Loss: 0.03275:  97%|█████████▋| 194/201 [02:32<00:05,  1.35it/s]Loss: 0.03275:  97%|█████████▋| 195/201 [02:32<00:04,  1.35it/s]Loss: 0.03253:  97%|█████████▋| 195/201 [02:32<00:04,  1.35it/s]Loss: 0.03253:  98%|█████████▊| 196/201 [02:33<00:03,  1.35it/s]Loss: 0.03231:  98%|█████████▊| 196/201 [02:33<00:03,  1.35it/s]Loss: 0.03231:  98%|█████████▊| 197/201 [02:34<00:02,  1.35it/s]Loss: 0.03211:  98%|█████████▊| 197/201 [02:34<00:02,  1.35it/s]Loss: 0.03211:  99%|█████████▊| 198/201 [02:35<00:02,  1.35it/s]Loss: 0.03189:  99%|█████████▊| 198/201 [02:35<00:02,  1.35it/s]Loss: 0.03189:  99%|█████████▉| 199/201 [02:35<00:01,  1.35it/s]Loss: 0.03170:  99%|█████████▉| 199/201 [02:35<00:01,  1.35it/s]Loss: 0.03170: 100%|█████████▉| 200/201 [02:36<00:00,  1.35it/s]Loss: 0.03149: 100%|█████████▉| 200/201 [02:36<00:00,  1.35it/s]Loss: 0.03149: 100%|██████████| 201/201 [02:37<00:00,  1.21it/s]Loss: 0.03128: 100%|██████████| 201/201 [02:37<00:00,  1.21it/s]Loss: 0.03128: 100%|██████████| 201/201 [02:37<00:00,  1.27it/s]
max loss: 0.5346814393997192
Densities: min=0.0, max=1.0, mean=0.3872421979904175
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to run03-rebuild/richtmyer_meshkov_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 157.68460941314697 seconds
Traceback (most recent call last):
  File "volnet/train_volnet_lite.py", line 311, in <module>
    main()
  File "volnet/train_volnet_lite.py", line 302, in main
    create_inr_scene(basename, opt['dims'], network)
  File "/home/qadwu/Work/fV-SRN/applications/volnet/train_inr_helper.py", line 115, in create_inr_scene
    mc = compute_macrocell(dims, model)
  File "/home/qadwu/Work/fV-SRN/applications/volnet/train_inr_helper.py", line 91, in compute_macrocell
    mcrange[iz, :, :, 0] = vmin.reshape([mcdims[1], mcdims[0]])
RuntimeError: CUDA error: an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z26ImageEvaluatorSimpleKernel4dim3N6kernel27GenericPackedTensorAccessorIfLm4ENS0_16DefaultPtrTraitsEiLb0EEEijS3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z22EvaluateTFWithPrevious4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_17RestrictPtrTraitsEiLb1EEES3_S3_NS1_IfLm2ENS0_16DefaultPtrTraitsEiLb0EEEfff:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z23CameraGenerateRayKernel4dim3N6kernel27GenericPackedTensorAccessorIfLm4ENS0_16DefaultPtrTraitsEiLb0EEES3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z17EvaluateNoBatches4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_16DefaultPtrTraitsEiLb0EEES3_S3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z37ImportanceSamplingWithProbabilityGridjN6kernel27GenericPackedTensorAccessorIfLm3ENS_17RestrictPtrTraitsEiLb1EEENS0_IfLm2ENS_16DefaultPtrTraitsEiLb0EEES4_S4_ffPjiiff:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z17EvaluateNoBatches4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_16DefaultPtrTraitsEiLb0EEES3_S3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z22EvaluateTFWithPrevious4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_17RestrictPtrTraitsEiLb1EEES3_S3_NS1_IfLm2ENS0_16DefaultPtrTraitsEiLb0EEEfff:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z17EvaluateNoBatches4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_16DefaultPtrTraitsEiLb0EEES3_S3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z26ImageEvaluatorSimpleKernel4dim3N6kernel27GenericPackedTensorAccessorIfLm4ENS0_16DefaultPtrTraitsEiLb0EEEijS3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z17EvaluateNoBatches4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_16DefaultPtrTraitsEiLb0EEES3_S3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z18ImportanceSamplingjN6kernel27GenericPackedTensorAccessorIfLm2ENS_16DefaultPtrTraitsEiLb0EEES2_S2_ffPjiiff:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z26ImageEvaluatorSimpleKernel4dim3N6kernel27GenericPackedTensorAccessorIfLm4ENS0_16DefaultPtrTraitsEiLb0EEEijS3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z22EvaluateTFWithPrevious4dim3N6kernel27GenericPackedTensorAccessorIfLm2ENS0_17RestrictPtrTraitsEiLb1EEES3_S3_NS1_IfLm2ENS0_16DefaultPtrTraitsEiLb0EEEfff:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z26ImageEvaluatorSimpleKernel4dim3N6kernel27GenericPackedTensorAccessorIfLm4ENS0_16DefaultPtrTraitsEiLb0EEEijS3_:an illegal memory access was encountered
Cuda error CUDA_ERROR_ILLEGAL_ADDRESS when unloading module for kernel _Z26ImageEvaluatorSimpleKernel4dim3N6kernel27GenericPackedTensorAccessorIfLm4ENS0_16DefaultPtrTraitsEiLb0EEEijS3_:an illegal memory access was encountered
[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume_interpolation_grid.cpp:78 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume_interpolation_grid.cpp:79 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume_interpolation_grid.cpp:80 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume.cpp:172 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume.cpp:176 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume.cpp:181 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume.cpp:185 : an illegal memory access was encountered

Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:129 cudaFree(rawptr) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:702 cudaEventDestroy(m_training_splitk_events[i]) failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:703 cudaStreamDestroy(m_training_splitk_streams[i]) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:702 cudaEventDestroy(m_training_splitk_events[i]) failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:703 cudaStreamDestroy(m_training_splitk_streams[i]) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:702 cudaEventDestroy(m_training_splitk_events[i]) failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:703 cudaStreamDestroy(m_training_splitk_streams[i]) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:702 cudaEventDestroy(m_training_splitk_events[i]) failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:703 cudaStreamDestroy(m_training_splitk_streams[i]) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:702 cudaEventDestroy(m_training_splitk_events[i]) failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:703 cudaStreamDestroy(m_training_splitk_streams[i]) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:702 cudaEventDestroy(m_training_splitk_events[i]) failed with error an illegal memory access was encountered
/home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/src/fully_fused_mlp.cu:703 cudaStreamDestroy(m_training_splitk_streams[i]) failed with error an illegal memory access was encountered
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:454 cudaDeviceSynchronize() failed with error an illegal memory access was encountered
[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/ray_evaluation_stepping.cpp:163 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/ray_evaluation_stepping.cpp:164 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/ray_evaluation_stepping.cpp:165 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/ray_evaluation_stepping.cpp:166 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:67 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:68 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:70 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:71 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:72 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:74 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:75 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/transfer_function_texture.cpp:76 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume_interpolation_grid.cpp:78 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume_interpolation_grid.cpp:79 : an illegal memory access was encountered

[SEVERE]  cudaSafeCall() failed at /home/qadwu/Work/fV-SRN/renderer/volume_interpolation_grid.cpp:80 : an illegal memory access was encountered

16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/pig_heart_2048x2048x2612_float32_raw_2048x2048x2612_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/pigheart.json
Initialize network
Latent space memory: 13.2MiB
# of network parameters: 3469505
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  1.28it/s]1it [00:00,  1.28it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.08040472865104675, max=0.41714343428611755, mean=0.10840058326721191
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:25, 25.77s/it]Render: : 1it [00:25, 25.77s/it]
Load TF 0, timestep 0, ensemble 0
Model directory: run03-rebuild/pigheart_hybrid/srn/model
Log directory: run03-rebuild/pigheart_hybrid/srn/log
HDF5 directory: run03-rebuild/pigheart_hybrid/srn/hdf5
Current run: 00001
{'settings': '/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/pigheart.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.01, 'epochs': 200, 'lr_gamma': 0.5, 'lr_step': 120, 'optim_params': '{}', 'outputmode': 'density:direct', 'layers': '64:64:64', 'activation': 'SnakeAlt:1', 'fouriercount': 30, 'fourierstd': -1.0, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 16, 'volumetric_features_resolution': 60, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': 'run03-rebuild/pigheart_hybrid/srn/log', 'modeldir': 'run03-rebuild/pigheart_hybrid/srn/model', 'hdf5dir': 'run03-rebuild/pigheart_hybrid/srn/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [2048, 2048, 1920], 'inr': None, 'dryrun': False, 'CUDA_Device': 'Quadro RTX 8000'}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:01<06:06,  1.83s/it]Loss: 0.02277:   0%|          | 1/201 [00:01<06:06,  1.83s/it]Loss: 0.02277:   1%|          | 2/201 [00:03<04:52,  1.47s/it]Loss: 0.00415:   1%|          | 2/201 [00:03<04:52,  1.47s/it]Loss: 0.00415:   1%|▏         | 3/201 [00:04<04:29,  1.36s/it]Loss: 0.00230:   1%|▏         | 3/201 [00:04<04:29,  1.36s/it]Loss: 0.00230:   2%|▏         | 4/201 [00:05<04:17,  1.31s/it]Loss: 0.00209:   2%|▏         | 4/201 [00:05<04:17,  1.31s/it]Loss: 0.00209:   2%|▏         | 5/201 [00:06<04:10,  1.28s/it]Loss: 0.00214:   2%|▏         | 5/201 [00:06<04:10,  1.28s/it]Loss: 0.00214:   3%|▎         | 6/201 [00:07<04:05,  1.26s/it]Loss: 0.00290:   3%|▎         | 6/201 [00:07<04:05,  1.26s/it]Loss: 0.00290:   3%|▎         | 7/201 [00:09<04:02,  1.25s/it]Loss: 0.00264:   3%|▎         | 7/201 [00:09<04:02,  1.25s/it]Loss: 0.00264:   4%|▍         | 8/201 [00:10<03:59,  1.24s/it]Loss: 0.00252:   4%|▍         | 8/201 [00:10<03:59,  1.24s/it]Loss: 0.00252:   4%|▍         | 9/201 [00:11<03:57,  1.24s/it]Loss: 0.00233:   4%|▍         | 9/201 [00:11<03:57,  1.24s/it]Loss: 0.00233:   5%|▍         | 10/201 [00:12<03:55,  1.23s/it]Loss: 0.00218:   5%|▍         | 10/201 [00:12<03:55,  1.23s/it]Loss: 0.00218:   5%|▌         | 11/201 [00:14<03:54,  1.23s/it]Loss: 0.00213:   5%|▌         | 11/201 [00:14<03:54,  1.23s/it]Loss: 0.00213:   6%|▌         | 12/201 [00:15<03:52,  1.23s/it]Loss: 0.00206:   6%|▌         | 12/201 [00:15<03:52,  1.23s/it]Loss: 0.00206:   6%|▋         | 13/201 [00:16<03:51,  1.23s/it]Loss: 0.00194:   6%|▋         | 13/201 [00:16<03:51,  1.23s/it]Loss: 0.00194:   7%|▋         | 14/201 [00:17<03:49,  1.23s/it]Loss: 0.00186:   7%|▋         | 14/201 [00:17<03:49,  1.23s/it]Loss: 0.00186:   7%|▋         | 15/201 [00:19<03:48,  1.23s/it]Loss: 0.00210:   7%|▋         | 15/201 [00:19<03:48,  1.23s/it]Loss: 0.00210:   8%|▊         | 16/201 [00:20<03:47,  1.23s/it]Loss: 0.00200:   8%|▊         | 16/201 [00:20<03:47,  1.23s/it]Loss: 0.00200:   8%|▊         | 17/201 [00:21<03:45,  1.23s/it]Loss: 0.00196:   8%|▊         | 17/201 [00:21<03:45,  1.23s/it]Loss: 0.00196:   9%|▉         | 18/201 [00:22<03:44,  1.23s/it]Loss: 0.00192:   9%|▉         | 18/201 [00:22<03:44,  1.23s/it]Loss: 0.00192:   9%|▉         | 19/201 [00:23<03:43,  1.23s/it]Loss: 0.00189:   9%|▉         | 19/201 [00:23<03:43,  1.23s/it]Loss: 0.00189:  10%|▉         | 20/201 [00:25<03:42,  1.23s/it]Loss: 0.00186:  10%|▉         | 20/201 [00:25<03:42,  1.23s/it]Loss: 0.00186:  10%|█         | 21/201 [00:26<03:42,  1.24s/it]Loss: 0.00184:  10%|█         | 21/201 [00:26<03:42,  1.24s/it]Loss: 0.00184:  11%|█         | 22/201 [00:27<03:40,  1.23s/it]Loss: 0.00186:  11%|█         | 22/201 [00:27<03:40,  1.23s/it]Loss: 0.00186:  11%|█▏        | 23/201 [00:28<03:39,  1.23s/it]Loss: 0.00173:  11%|█▏        | 23/201 [00:28<03:39,  1.23s/it]Loss: 0.00173:  12%|█▏        | 24/201 [00:30<03:37,  1.23s/it]Loss: 0.00185:  12%|█▏        | 24/201 [00:30<03:37,  1.23s/it]Loss: 0.00185:  12%|█▏        | 25/201 [00:31<03:36,  1.23s/it]Loss: 0.00181:  12%|█▏        | 25/201 [00:31<03:36,  1.23s/it]Loss: 0.00181:  13%|█▎        | 26/201 [00:32<03:35,  1.23s/it]Loss: 0.00181:  13%|█▎        | 26/201 [00:32<03:35,  1.23s/it]Loss: 0.00181:  13%|█▎        | 27/201 [00:33<03:33,  1.23s/it]Loss: 0.00178:  13%|█▎        | 27/201 [00:33<03:33,  1.23s/it]Loss: 0.00178:  14%|█▍        | 28/201 [00:34<03:32,  1.23s/it]Loss: 0.00180:  14%|█▍        | 28/201 [00:34<03:32,  1.23s/it]Loss: 0.00180:  14%|█▍        | 29/201 [00:36<03:31,  1.23s/it]Loss: 0.00170:  14%|█▍        | 29/201 [00:36<03:31,  1.23s/it]Loss: 0.00170:  15%|█▍        | 30/201 [00:37<03:30,  1.23s/it]Loss: 0.00182:  15%|█▍        | 30/201 [00:37<03:30,  1.23s/it]Loss: 0.00182:  15%|█▌        | 31/201 [00:38<03:28,  1.23s/it]Loss: 0.00174:  15%|█▌        | 31/201 [00:38<03:28,  1.23s/it]Loss: 0.00174:  16%|█▌        | 32/201 [00:39<03:27,  1.23s/it]Loss: 0.00173:  16%|█▌        | 32/201 [00:39<03:27,  1.23s/it]Loss: 0.00173:  16%|█▋        | 33/201 [00:41<03:26,  1.23s/it]Loss: 0.00169:  16%|█▋        | 33/201 [00:41<03:26,  1.23s/it]Loss: 0.00169:  17%|█▋        | 34/201 [00:42<03:25,  1.23s/it]Loss: 0.00175:  17%|█▋        | 34/201 [00:42<03:25,  1.23s/it]Loss: 0.00175:  17%|█▋        | 35/201 [00:43<03:24,  1.23s/it]Loss: 0.00165:  17%|█▋        | 35/201 [00:43<03:24,  1.23s/it]Loss: 0.00165:  18%|█▊        | 36/201 [00:44<03:23,  1.23s/it]Loss: 0.00180:  18%|█▊        | 36/201 [00:44<03:23,  1.23s/it]Loss: 0.00180:  18%|█▊        | 37/201 [00:46<03:22,  1.23s/it]Loss: 0.00174:  18%|█▊        | 37/201 [00:46<03:22,  1.23s/it]Loss: 0.00174:  19%|█▉        | 38/201 [00:47<03:20,  1.23s/it]Loss: 0.00166:  19%|█▉        | 38/201 [00:47<03:20,  1.23s/it]Loss: 0.00166:  19%|█▉        | 39/201 [00:48<03:19,  1.23s/it]Loss: 0.00170:  19%|█▉        | 39/201 [00:48<03:19,  1.23s/it]Loss: 0.00170:  20%|█▉        | 40/201 [00:49<03:18,  1.23s/it]Loss: 0.00161:  20%|█▉        | 40/201 [00:49<03:18,  1.23s/it]Loss: 0.00161:  20%|██        | 41/201 [00:51<03:18,  1.24s/it]Loss: 0.00175:  20%|██        | 41/201 [00:51<03:18,  1.24s/it]Loss: 0.00175:  21%|██        | 42/201 [00:52<03:16,  1.24s/it]Loss: 0.00168:  21%|██        | 42/201 [00:52<03:16,  1.24s/it]Loss: 0.00168:  21%|██▏       | 43/201 [00:53<03:15,  1.24s/it]Loss: 0.00163:  21%|██▏       | 43/201 [00:53<03:15,  1.24s/it]Loss: 0.00163:  22%|██▏       | 44/201 [00:54<03:13,  1.23s/it]Loss: 0.00168:  22%|██▏       | 44/201 [00:54<03:13,  1.23s/it]Loss: 0.00168:  22%|██▏       | 45/201 [00:55<03:12,  1.23s/it]Loss: 0.00161:  22%|██▏       | 45/201 [00:55<03:12,  1.23s/it]Loss: 0.00161:  23%|██▎       | 46/201 [00:57<03:11,  1.23s/it]Loss: 0.00162:  23%|██▎       | 46/201 [00:57<03:11,  1.23s/it]Loss: 0.00162:  23%|██▎       | 47/201 [00:58<03:09,  1.23s/it]Loss: 0.00169:  23%|██▎       | 47/201 [00:58<03:09,  1.23s/it]Loss: 0.00169:  24%|██▍       | 48/201 [00:59<03:08,  1.23s/it]Loss: 0.00167:  24%|██▍       | 48/201 [00:59<03:08,  1.23s/it]Loss: 0.00167:  24%|██▍       | 49/201 [01:00<03:07,  1.23s/it]Loss: 0.00172:  24%|██▍       | 49/201 [01:00<03:07,  1.23s/it]Loss: 0.00172:  25%|██▍       | 50/201 [01:02<03:06,  1.23s/it]Loss: 0.00164:  25%|██▍       | 50/201 [01:02<03:06,  1.23s/it]Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_0.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_20.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.83s/it][A1it [00:01,  1.83s/it]
Loss: 0.00164:  25%|██▌       | 51/201 [01:05<04:27,  1.78s/it]Loss: 0.00206:  25%|██▌       | 51/201 [01:05<04:27,  1.78s/it]Loss: 0.00206:  26%|██▌       | 52/201 [01:06<04:00,  1.62s/it]Loss: 0.00200:  26%|██▌       | 52/201 [01:06<04:00,  1.62s/it]Loss: 0.00200:  26%|██▋       | 53/201 [01:07<03:41,  1.50s/it]Loss: 0.00200:  26%|██▋       | 53/201 [01:07<03:41,  1.50s/it]Loss: 0.00200:  27%|██▋       | 54/201 [01:08<03:28,  1.42s/it]Loss: 0.00193:  27%|██▋       | 54/201 [01:08<03:28,  1.42s/it]Loss: 0.00193:  27%|██▋       | 55/201 [01:10<03:18,  1.36s/it]Loss: 0.00199:  27%|██▋       | 55/201 [01:10<03:18,  1.36s/it]Loss: 0.00199:  28%|██▊       | 56/201 [01:11<03:11,  1.32s/it]Loss: 0.00190:  28%|██▊       | 56/201 [01:11<03:11,  1.32s/it]Loss: 0.00190:  28%|██▊       | 57/201 [01:12<03:05,  1.29s/it]Loss: 0.00196:  28%|██▊       | 57/201 [01:12<03:05,  1.29s/it]Loss: 0.00196:  29%|██▉       | 58/201 [01:13<03:01,  1.27s/it]Loss: 0.00189:  29%|██▉       | 58/201 [01:13<03:01,  1.27s/it]Loss: 0.00189:  29%|██▉       | 59/201 [01:14<02:58,  1.26s/it]Loss: 0.00190:  29%|██▉       | 59/201 [01:14<02:58,  1.26s/it]Loss: 0.00190:  30%|██▉       | 60/201 [01:16<02:56,  1.25s/it]Loss: 0.00197:  30%|██▉       | 60/201 [01:16<02:56,  1.25s/it]Loss: 0.00197:  30%|███       | 61/201 [01:17<02:55,  1.25s/it]Loss: 0.00193:  30%|███       | 61/201 [01:17<02:55,  1.25s/it]Loss: 0.00193:  31%|███       | 62/201 [01:18<02:52,  1.24s/it]Loss: 0.00189:  31%|███       | 62/201 [01:18<02:52,  1.24s/it]Loss: 0.00189:  31%|███▏      | 63/201 [01:19<02:50,  1.24s/it]Loss: 0.00191:  31%|███▏      | 63/201 [01:19<02:50,  1.24s/it]Loss: 0.00191:  32%|███▏      | 64/201 [01:21<02:48,  1.23s/it]Loss: 0.00189:  32%|███▏      | 64/201 [01:21<02:48,  1.23s/it]Loss: 0.00189:  32%|███▏      | 65/201 [01:22<02:47,  1.23s/it]Loss: 0.00194:  32%|███▏      | 65/201 [01:22<02:47,  1.23s/it]Loss: 0.00194:  33%|███▎      | 66/201 [01:23<02:45,  1.23s/it]Loss: 0.00189:  33%|███▎      | 66/201 [01:23<02:45,  1.23s/it]Loss: 0.00189:  33%|███▎      | 67/201 [01:24<02:44,  1.23s/it]Loss: 0.00188:  33%|███▎      | 67/201 [01:24<02:44,  1.23s/it]Loss: 0.00188:  34%|███▍      | 68/201 [01:26<02:43,  1.23s/it]Loss: 0.00187:  34%|███▍      | 68/201 [01:26<02:43,  1.23s/it]Loss: 0.00187:  34%|███▍      | 69/201 [01:27<02:41,  1.23s/it]Loss: 0.00194:  34%|███▍      | 69/201 [01:27<02:41,  1.23s/it]Loss: 0.00194:  35%|███▍      | 70/201 [01:28<02:40,  1.22s/it]Loss: 0.00185:  35%|███▍      | 70/201 [01:28<02:40,  1.22s/it]Loss: 0.00185:  35%|███▌      | 71/201 [01:29<02:39,  1.22s/it]Loss: 0.00187:  35%|███▌      | 71/201 [01:29<02:39,  1.22s/it]Loss: 0.00187:  36%|███▌      | 72/201 [01:30<02:37,  1.22s/it]Loss: 0.00190:  36%|███▌      | 72/201 [01:30<02:37,  1.22s/it]Loss: 0.00190:  36%|███▋      | 73/201 [01:32<02:36,  1.22s/it]Loss: 0.00185:  36%|███▋      | 73/201 [01:32<02:36,  1.22s/it]Loss: 0.00185:  37%|███▋      | 74/201 [01:33<02:35,  1.22s/it]Loss: 0.00183:  37%|███▋      | 74/201 [01:33<02:35,  1.22s/it]Loss: 0.00183:  37%|███▋      | 75/201 [01:34<02:34,  1.22s/it]Loss: 0.00176:  37%|███▋      | 75/201 [01:34<02:34,  1.22s/it]Loss: 0.00176:  38%|███▊      | 76/201 [01:35<02:33,  1.22s/it]Loss: 0.00187:  38%|███▊      | 76/201 [01:35<02:33,  1.22s/it]Loss: 0.00187:  38%|███▊      | 77/201 [01:37<02:31,  1.22s/it]Loss: 0.00216:  38%|███▊      | 77/201 [01:37<02:31,  1.22s/it]Loss: 0.00216:  39%|███▉      | 78/201 [01:38<02:30,  1.22s/it]Loss: 0.00199:  39%|███▉      | 78/201 [01:38<02:30,  1.22s/it]Loss: 0.00199:  39%|███▉      | 79/201 [01:39<02:29,  1.22s/it]Loss: 0.00168:  39%|███▉      | 79/201 [01:39<02:29,  1.22s/it]Loss: 0.00168:  40%|███▉      | 80/201 [01:40<02:27,  1.22s/it]Loss: 0.00154:  40%|███▉      | 80/201 [01:40<02:27,  1.22s/it]Loss: 0.00154:  40%|████      | 81/201 [01:41<02:28,  1.24s/it]Loss: 0.00152:  40%|████      | 81/201 [01:41<02:28,  1.24s/it]Loss: 0.00152:  41%|████      | 82/201 [01:43<02:26,  1.23s/it]Loss: 0.00152:  41%|████      | 82/201 [01:43<02:26,  1.23s/it]Loss: 0.00152:  41%|████▏     | 83/201 [01:44<02:24,  1.23s/it]Loss: 0.00151:  41%|████▏     | 83/201 [01:44<02:24,  1.23s/it]Loss: 0.00151:  42%|████▏     | 84/201 [01:45<02:23,  1.23s/it]Loss: 0.00150:  42%|████▏     | 84/201 [01:45<02:23,  1.23s/it]Loss: 0.00150:  42%|████▏     | 85/201 [01:46<02:22,  1.23s/it]Loss: 0.00150:  42%|████▏     | 85/201 [01:46<02:22,  1.23s/it]Loss: 0.00150:  43%|████▎     | 86/201 [01:48<02:20,  1.23s/it]Loss: 0.00150:  43%|████▎     | 86/201 [01:48<02:20,  1.23s/it]Loss: 0.00150:  43%|████▎     | 87/201 [01:49<02:19,  1.23s/it]Loss: 0.00150:  43%|████▎     | 87/201 [01:49<02:19,  1.23s/it]Loss: 0.00150:  44%|████▍     | 88/201 [01:50<02:18,  1.22s/it]Loss: 0.00149:  44%|████▍     | 88/201 [01:50<02:18,  1.22s/it]Loss: 0.00149:  44%|████▍     | 89/201 [01:51<02:17,  1.22s/it]Loss: 0.00149:  44%|████▍     | 89/201 [01:51<02:17,  1.22s/it]Loss: 0.00149:  45%|████▍     | 90/201 [01:52<02:15,  1.22s/it]Loss: 0.00149:  45%|████▍     | 90/201 [01:52<02:15,  1.22s/it]Loss: 0.00149:  45%|████▌     | 91/201 [01:54<02:14,  1.22s/it]Loss: 0.00149:  45%|████▌     | 91/201 [01:54<02:14,  1.22s/it]Loss: 0.00149:  46%|████▌     | 92/201 [01:55<02:13,  1.22s/it]Loss: 0.00149:  46%|████▌     | 92/201 [01:55<02:13,  1.22s/it]Loss: 0.00149:  46%|████▋     | 93/201 [01:56<02:12,  1.22s/it]Loss: 0.00149:  46%|████▋     | 93/201 [01:56<02:12,  1.22s/it]Loss: 0.00149:  47%|████▋     | 94/201 [01:57<02:10,  1.22s/it]Loss: 0.00148:  47%|████▋     | 94/201 [01:57<02:10,  1.22s/it]Loss: 0.00148:  47%|████▋     | 95/201 [01:59<02:09,  1.22s/it]Loss: 0.00148:  47%|████▋     | 95/201 [01:59<02:09,  1.22s/it]Loss: 0.00148:  48%|████▊     | 96/201 [02:00<02:08,  1.22s/it]Loss: 0.00148:  48%|████▊     | 96/201 [02:00<02:08,  1.22s/it]Loss: 0.00148:  48%|████▊     | 97/201 [02:01<02:07,  1.22s/it]Loss: 0.00148:  48%|████▊     | 97/201 [02:01<02:07,  1.22s/it]Loss: 0.00148:  49%|████▉     | 98/201 [02:02<02:06,  1.23s/it]Loss: 0.00148:  49%|████▉     | 98/201 [02:02<02:06,  1.23s/it]Loss: 0.00148:  49%|████▉     | 99/201 [02:04<02:04,  1.22s/it]Loss: 0.00147:  49%|████▉     | 99/201 [02:04<02:04,  1.22s/it]Loss: 0.00147:  50%|████▉     | 100/201 [02:05<02:03,  1.22s/it]Loss: 0.00148:  50%|████▉     | 100/201 [02:05<02:03,  1.22s/it]Loss: 0.00148:  50%|█████     | 101/201 [02:06<02:03,  1.24s/it]Loss: 0.00147:  50%|█████     | 101/201 [02:06<02:03,  1.24s/it]max loss: 0.049275729805231094
Densities: min=0.0666515901684761, max=0.5107340216636658, mean=0.11039575934410095
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_60.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_80.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.82s/it][A1it [00:01,  1.82s/it]
Loss: 0.00147:  51%|█████     | 102/201 [02:09<02:56,  1.78s/it]Loss: 0.00171:  51%|█████     | 102/201 [02:09<02:56,  1.78s/it]Loss: 0.00171:  51%|█████     | 103/201 [02:10<02:37,  1.61s/it]Loss: 0.00165:  51%|█████     | 103/201 [02:10<02:37,  1.61s/it]Loss: 0.00165:  52%|█████▏    | 104/201 [02:11<02:24,  1.49s/it]Loss: 0.00163:  52%|█████▏    | 104/201 [02:11<02:24,  1.49s/it]Loss: 0.00163:  52%|█████▏    | 105/201 [02:13<02:15,  1.41s/it]Loss: 0.00162:  52%|█████▏    | 105/201 [02:13<02:15,  1.41s/it]Loss: 0.00162:  53%|█████▎    | 106/201 [02:14<02:08,  1.35s/it]Loss: 0.00162:  53%|█████▎    | 106/201 [02:14<02:08,  1.35s/it]Loss: 0.00162:  53%|█████▎    | 107/201 [02:15<02:03,  1.31s/it]Loss: 0.00161:  53%|█████▎    | 107/201 [02:15<02:03,  1.31s/it]Loss: 0.00161:  54%|█████▎    | 108/201 [02:16<01:59,  1.28s/it]Loss: 0.00160:  54%|█████▎    | 108/201 [02:16<01:59,  1.28s/it]Loss: 0.00160:  54%|█████▍    | 109/201 [02:18<01:56,  1.26s/it]Loss: 0.00160:  54%|█████▍    | 109/201 [02:18<01:56,  1.26s/it]Loss: 0.00160:  55%|█████▍    | 110/201 [02:19<01:53,  1.25s/it]Loss: 0.00159:  55%|█████▍    | 110/201 [02:19<01:53,  1.25s/it]Loss: 0.00159:  55%|█████▌    | 111/201 [02:20<01:51,  1.24s/it]Loss: 0.00160:  55%|█████▌    | 111/201 [02:20<01:51,  1.24s/it]Loss: 0.00160:  56%|█████▌    | 112/201 [02:21<01:49,  1.23s/it]Loss: 0.00158:  56%|█████▌    | 112/201 [02:21<01:49,  1.23s/it]Loss: 0.00158:  56%|█████▌    | 113/201 [02:22<01:48,  1.23s/it]Loss: 0.00158:  56%|█████▌    | 113/201 [02:22<01:48,  1.23s/it]Loss: 0.00158:  57%|█████▋    | 114/201 [02:24<01:46,  1.22s/it]Loss: 0.00159:  57%|█████▋    | 114/201 [02:24<01:46,  1.22s/it]Loss: 0.00159:  57%|█████▋    | 115/201 [02:25<01:45,  1.22s/it]Loss: 0.00158:  57%|█████▋    | 115/201 [02:25<01:45,  1.22s/it]Loss: 0.00158:  58%|█████▊    | 116/201 [02:26<01:43,  1.22s/it]Loss: 0.00158:  58%|█████▊    | 116/201 [02:26<01:43,  1.22s/it]Loss: 0.00158:  58%|█████▊    | 117/201 [02:27<01:42,  1.22s/it]Loss: 0.00157:  58%|█████▊    | 117/201 [02:27<01:42,  1.22s/it]Loss: 0.00157:  59%|█████▊    | 118/201 [02:29<01:41,  1.22s/it]Loss: 0.00157:  59%|█████▊    | 118/201 [02:29<01:41,  1.22s/it]Loss: 0.00157:  59%|█████▉    | 119/201 [02:30<01:39,  1.22s/it]Loss: 0.00157:  59%|█████▉    | 119/201 [02:30<01:39,  1.22s/it]Loss: 0.00157:  60%|█████▉    | 120/201 [02:31<01:38,  1.22s/it]Loss: 0.00157:  60%|█████▉    | 120/201 [02:31<01:38,  1.22s/it]Loss: 0.00157:  60%|██████    | 121/201 [02:32<01:38,  1.23s/it]Loss: 0.00152:  60%|██████    | 121/201 [02:32<01:38,  1.23s/it]Loss: 0.00152:  61%|██████    | 122/201 [02:33<01:36,  1.22s/it]Loss: 0.00150:  61%|██████    | 122/201 [02:33<01:36,  1.22s/it]Loss: 0.00150:  61%|██████    | 123/201 [02:35<01:35,  1.22s/it]Loss: 0.00151:  61%|██████    | 123/201 [02:35<01:35,  1.22s/it]Loss: 0.00151:  62%|██████▏   | 124/201 [02:36<01:33,  1.22s/it]Loss: 0.00151:  62%|██████▏   | 124/201 [02:36<01:33,  1.22s/it]Loss: 0.00151:  62%|██████▏   | 125/201 [02:37<01:32,  1.22s/it]Loss: 0.00148:  62%|██████▏   | 125/201 [02:37<01:32,  1.22s/it]Loss: 0.00148:  63%|██████▎   | 126/201 [02:38<01:31,  1.22s/it]Loss: 0.00147:  63%|██████▎   | 126/201 [02:38<01:31,  1.22s/it]Loss: 0.00147:  63%|██████▎   | 127/201 [02:39<01:29,  1.21s/it]Loss: 0.00147:  63%|██████▎   | 127/201 [02:39<01:29,  1.21s/it]Loss: 0.00147:  64%|██████▎   | 128/201 [02:41<01:28,  1.21s/it]Loss: 0.00148:  64%|██████▎   | 128/201 [02:41<01:28,  1.21s/it]Loss: 0.00148:  64%|██████▍   | 129/201 [02:42<01:27,  1.21s/it]Loss: 0.00149:  64%|██████▍   | 129/201 [02:42<01:27,  1.21s/it]Loss: 0.00149:  65%|██████▍   | 130/201 [02:43<01:26,  1.21s/it]Loss: 0.00149:  65%|██████▍   | 130/201 [02:43<01:26,  1.21s/it]Loss: 0.00149:  65%|██████▌   | 131/201 [02:44<01:24,  1.21s/it]Loss: 0.00148:  65%|██████▌   | 131/201 [02:44<01:24,  1.21s/it]Loss: 0.00148:  66%|██████▌   | 132/201 [02:46<01:23,  1.21s/it]Loss: 0.00147:  66%|██████▌   | 132/201 [02:46<01:23,  1.21s/it]Loss: 0.00147:  66%|██████▌   | 133/201 [02:47<01:22,  1.21s/it]Loss: 0.00146:  66%|██████▌   | 133/201 [02:47<01:22,  1.21s/it]Loss: 0.00146:  67%|██████▋   | 134/201 [02:48<01:21,  1.21s/it]Loss: 0.00144:  67%|██████▋   | 134/201 [02:48<01:21,  1.21s/it]Loss: 0.00144:  67%|██████▋   | 135/201 [02:49<01:20,  1.21s/it]Loss: 0.00144:  67%|██████▋   | 135/201 [02:49<01:20,  1.21s/it]Loss: 0.00144:  68%|██████▊   | 136/201 [02:50<01:18,  1.21s/it]Loss: 0.00144:  68%|██████▊   | 136/201 [02:50<01:18,  1.21s/it]Loss: 0.00144:  68%|██████▊   | 137/201 [02:52<01:17,  1.21s/it]Loss: 0.00144:  68%|██████▊   | 137/201 [02:52<01:17,  1.21s/it]Loss: 0.00144:  69%|██████▊   | 138/201 [02:53<01:16,  1.21s/it]Loss: 0.00143:  69%|██████▊   | 138/201 [02:53<01:16,  1.21s/it]Loss: 0.00143:  69%|██████▉   | 139/201 [02:54<01:15,  1.21s/it]Loss: 0.00143:  69%|██████▉   | 139/201 [02:54<01:15,  1.21s/it]Loss: 0.00143:  70%|██████▉   | 140/201 [02:55<01:13,  1.21s/it]Loss: 0.00143:  70%|██████▉   | 140/201 [02:55<01:13,  1.21s/it]Loss: 0.00143:  70%|███████   | 141/201 [02:56<01:13,  1.22s/it]Loss: 0.00143:  70%|███████   | 141/201 [02:56<01:13,  1.22s/it]Loss: 0.00143:  71%|███████   | 142/201 [02:58<01:11,  1.22s/it]Loss: 0.00143:  71%|███████   | 142/201 [02:58<01:11,  1.22s/it]Loss: 0.00143:  71%|███████   | 143/201 [02:59<01:10,  1.22s/it]Loss: 0.00143:  71%|███████   | 143/201 [02:59<01:10,  1.22s/it]Loss: 0.00143:  72%|███████▏  | 144/201 [03:00<01:09,  1.22s/it]Loss: 0.00143:  72%|███████▏  | 144/201 [03:00<01:09,  1.22s/it]Loss: 0.00143:  72%|███████▏  | 145/201 [03:01<01:08,  1.21s/it]Loss: 0.00143:  72%|███████▏  | 145/201 [03:01<01:08,  1.21s/it]Loss: 0.00143:  73%|███████▎  | 146/201 [03:03<01:06,  1.21s/it]Loss: 0.00143:  73%|███████▎  | 146/201 [03:03<01:06,  1.21s/it]Loss: 0.00143:  73%|███████▎  | 147/201 [03:04<01:05,  1.21s/it]Loss: 0.00143:  73%|███████▎  | 147/201 [03:04<01:05,  1.21s/it]Loss: 0.00143:  74%|███████▎  | 148/201 [03:05<01:04,  1.21s/it]Loss: 0.00143:  74%|███████▎  | 148/201 [03:05<01:04,  1.21s/it]Loss: 0.00143:  74%|███████▍  | 149/201 [03:06<01:03,  1.21s/it]Loss: 0.00143:  74%|███████▍  | 149/201 [03:06<01:03,  1.21s/it]Loss: 0.00143:  75%|███████▍  | 150/201 [03:07<01:01,  1.21s/it]Loss: 0.00143:  75%|███████▍  | 150/201 [03:07<01:01,  1.21s/it]Loss: 0.00143:  75%|███████▌  | 151/201 [03:09<01:00,  1.21s/it]Loss: 0.00143:  75%|███████▌  | 151/201 [03:09<01:00,  1.21s/it]Loss: 0.00143:  76%|███████▌  | 152/201 [03:10<00:59,  1.21s/it]Loss: 0.00142:  76%|███████▌  | 152/201 [03:10<00:59,  1.21s/it]max loss: 0.033285073935985565
Densities: min=0.07981826364994049, max=0.9374369382858276, mean=0.11116993427276611
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_120.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.84s/it][A1it [00:01,  1.84s/it]
Loss: 0.00142:  76%|███████▌  | 153/201 [03:13<01:24,  1.77s/it]Loss: 0.00162:  76%|███████▌  | 153/201 [03:13<01:24,  1.77s/it]Loss: 0.00162:  77%|███████▋  | 154/201 [03:14<01:15,  1.60s/it]Loss: 0.00156:  77%|███████▋  | 154/201 [03:14<01:15,  1.60s/it]Loss: 0.00156:  77%|███████▋  | 155/201 [03:15<01:08,  1.48s/it]Loss: 0.00154:  77%|███████▋  | 155/201 [03:15<01:08,  1.48s/it]Loss: 0.00154:  78%|███████▊  | 156/201 [03:17<01:03,  1.40s/it]Loss: 0.00153:  78%|███████▊  | 156/201 [03:17<01:03,  1.40s/it]Loss: 0.00153:  78%|███████▊  | 157/201 [03:18<00:59,  1.34s/it]Loss: 0.00152:  78%|███████▊  | 157/201 [03:18<00:59,  1.34s/it]Loss: 0.00152:  79%|███████▊  | 158/201 [03:19<00:56,  1.30s/it]Loss: 0.00151:  79%|███████▊  | 158/201 [03:19<00:56,  1.30s/it]Loss: 0.00151:  79%|███████▉  | 159/201 [03:20<00:53,  1.28s/it]Loss: 0.00151:  79%|███████▉  | 159/201 [03:20<00:53,  1.28s/it]Loss: 0.00151:  80%|███████▉  | 160/201 [03:21<00:51,  1.26s/it]Loss: 0.00150:  80%|███████▉  | 160/201 [03:21<00:51,  1.26s/it]Loss: 0.00150:  80%|████████  | 161/201 [03:23<00:50,  1.25s/it]Loss: 0.00150:  80%|████████  | 161/201 [03:23<00:50,  1.25s/it]Loss: 0.00150:  81%|████████  | 162/201 [03:24<00:48,  1.24s/it]Loss: 0.00150:  81%|████████  | 162/201 [03:24<00:48,  1.24s/it]Loss: 0.00150:  81%|████████  | 163/201 [03:25<00:46,  1.23s/it]Loss: 0.00149:  81%|████████  | 163/201 [03:25<00:46,  1.23s/it]Loss: 0.00149:  82%|████████▏ | 164/201 [03:26<00:45,  1.23s/it]Loss: 0.00149:  82%|████████▏ | 164/201 [03:26<00:45,  1.23s/it]Loss: 0.00149:  82%|████████▏ | 165/201 [03:27<00:43,  1.22s/it]Loss: 0.00149:  82%|████████▏ | 165/201 [03:27<00:43,  1.22s/it]Loss: 0.00149:  83%|████████▎ | 166/201 [03:29<00:42,  1.22s/it]Loss: 0.00148:  83%|████████▎ | 166/201 [03:29<00:42,  1.22s/it]Loss: 0.00148:  83%|████████▎ | 167/201 [03:30<00:41,  1.22s/it]Loss: 0.00148:  83%|████████▎ | 167/201 [03:30<00:41,  1.22s/it]Loss: 0.00148:  84%|████████▎ | 168/201 [03:31<00:40,  1.22s/it]Loss: 0.00148:  84%|████████▎ | 168/201 [03:31<00:40,  1.22s/it]Loss: 0.00148:  84%|████████▍ | 169/201 [03:32<00:38,  1.21s/it]Loss: 0.00147:  84%|████████▍ | 169/201 [03:32<00:38,  1.21s/it]Loss: 0.00147:  85%|████████▍ | 170/201 [03:34<00:37,  1.21s/it]Loss: 0.00147:  85%|████████▍ | 170/201 [03:34<00:37,  1.21s/it]Loss: 0.00147:  85%|████████▌ | 171/201 [03:35<00:36,  1.21s/it]Loss: 0.00147:  85%|████████▌ | 171/201 [03:35<00:36,  1.21s/it]Loss: 0.00147:  86%|████████▌ | 172/201 [03:36<00:35,  1.21s/it]Loss: 0.00147:  86%|████████▌ | 172/201 [03:36<00:35,  1.21s/it]Loss: 0.00147:  86%|████████▌ | 173/201 [03:37<00:33,  1.21s/it]Loss: 0.00147:  86%|████████▌ | 173/201 [03:37<00:33,  1.21s/it]Loss: 0.00147:  87%|████████▋ | 174/201 [03:38<00:32,  1.21s/it]Loss: 0.00146:  87%|████████▋ | 174/201 [03:38<00:32,  1.21s/it]Loss: 0.00146:  87%|████████▋ | 175/201 [03:40<00:31,  1.21s/it]Loss: 0.00146:  87%|████████▋ | 175/201 [03:40<00:31,  1.21s/it]Loss: 0.00146:  88%|████████▊ | 176/201 [03:41<00:30,  1.21s/it]Loss: 0.00146:  88%|████████▊ | 176/201 [03:41<00:30,  1.21s/it]Loss: 0.00146:  88%|████████▊ | 177/201 [03:42<00:29,  1.21s/it]Loss: 0.00146:  88%|████████▊ | 177/201 [03:42<00:29,  1.21s/it]Loss: 0.00146:  89%|████████▊ | 178/201 [03:43<00:27,  1.21s/it]Loss: 0.00146:  89%|████████▊ | 178/201 [03:43<00:27,  1.21s/it]Loss: 0.00146:  89%|████████▉ | 179/201 [03:44<00:26,  1.21s/it]Loss: 0.00145:  89%|████████▉ | 179/201 [03:44<00:26,  1.21s/it]Loss: 0.00145:  90%|████████▉ | 180/201 [03:46<00:25,  1.21s/it]Loss: 0.00145:  90%|████████▉ | 180/201 [03:46<00:25,  1.21s/it]Loss: 0.00145:  90%|█████████ | 181/201 [03:47<00:24,  1.22s/it]Loss: 0.00145:  90%|█████████ | 181/201 [03:47<00:24,  1.22s/it]Loss: 0.00145:  91%|█████████ | 182/201 [03:48<00:23,  1.22s/it]Loss: 0.00145:  91%|█████████ | 182/201 [03:48<00:23,  1.22s/it]Loss: 0.00145:  91%|█████████ | 183/201 [03:49<00:21,  1.21s/it]Loss: 0.00144:  91%|█████████ | 183/201 [03:49<00:21,  1.21s/it]Loss: 0.00144:  92%|█████████▏| 184/201 [03:51<00:20,  1.21s/it]Loss: 0.00145:  92%|█████████▏| 184/201 [03:51<00:20,  1.21s/it]Loss: 0.00145:  92%|█████████▏| 185/201 [03:52<00:19,  1.21s/it]Loss: 0.00145:  92%|█████████▏| 185/201 [03:52<00:19,  1.21s/it]Loss: 0.00145:  93%|█████████▎| 186/201 [03:53<00:18,  1.21s/it]Loss: 0.00144:  93%|█████████▎| 186/201 [03:53<00:18,  1.21s/it]Loss: 0.00144:  93%|█████████▎| 187/201 [03:54<00:16,  1.21s/it]Loss: 0.00145:  93%|█████████▎| 187/201 [03:54<00:16,  1.21s/it]Loss: 0.00145:  94%|█████████▎| 188/201 [03:55<00:15,  1.21s/it]Loss: 0.00144:  94%|█████████▎| 188/201 [03:55<00:15,  1.21s/it]Loss: 0.00144:  94%|█████████▍| 189/201 [03:57<00:14,  1.21s/it]Loss: 0.00145:  94%|█████████▍| 189/201 [03:57<00:14,  1.21s/it]Loss: 0.00145:  95%|█████████▍| 190/201 [03:58<00:13,  1.21s/it]Loss: 0.00144:  95%|█████████▍| 190/201 [03:58<00:13,  1.21s/it]Loss: 0.00144:  95%|█████████▌| 191/201 [03:59<00:12,  1.21s/it]Loss: 0.00144:  95%|█████████▌| 191/201 [03:59<00:12,  1.21s/it]Loss: 0.00144:  96%|█████████▌| 192/201 [04:00<00:10,  1.21s/it]Loss: 0.00143:  96%|█████████▌| 192/201 [04:00<00:10,  1.21s/it]Loss: 0.00143:  96%|█████████▌| 193/201 [04:01<00:09,  1.21s/it]Loss: 0.00143:  96%|█████████▌| 193/201 [04:01<00:09,  1.21s/it]Loss: 0.00143:  97%|█████████▋| 194/201 [04:03<00:08,  1.21s/it]Loss: 0.00144:  97%|█████████▋| 194/201 [04:03<00:08,  1.21s/it]Loss: 0.00144:  97%|█████████▋| 195/201 [04:04<00:07,  1.21s/it]Loss: 0.00144:  97%|█████████▋| 195/201 [04:04<00:07,  1.21s/it]Loss: 0.00144:  98%|█████████▊| 196/201 [04:05<00:06,  1.21s/it]Loss: 0.00143:  98%|█████████▊| 196/201 [04:05<00:06,  1.21s/it]Loss: 0.00143:  98%|█████████▊| 197/201 [04:06<00:04,  1.21s/it]Loss: 0.00143:  98%|█████████▊| 197/201 [04:06<00:04,  1.21s/it]Loss: 0.00143:  99%|█████████▊| 198/201 [04:07<00:03,  1.21s/it]Loss: 0.00143:  99%|█████████▊| 198/201 [04:07<00:03,  1.21s/it]Loss: 0.00143:  99%|█████████▉| 199/201 [04:09<00:02,  1.21s/it]Loss: 0.00143:  99%|█████████▉| 199/201 [04:09<00:02,  1.21s/it]Loss: 0.00143: 100%|█████████▉| 200/201 [04:10<00:01,  1.21s/it]Loss: 0.00142: 100%|█████████▉| 200/201 [04:10<00:01,  1.21s/it]Loss: 0.00142: 100%|██████████| 201/201 [04:11<00:00,  1.22s/it]Loss: 0.00142: 100%|██████████| 201/201 [04:11<00:00,  1.22s/it]Loss: 0.00142: 100%|██████████| 201/201 [04:11<00:00,  1.25s/it]Load volume "/media/storage0/qadwu/floats/pig_heart_2048x2048x2612_float32_raw_2048x2048x2612_float.cvol"
Loaded

max loss: 0.035794489085674286
Densities: min=0.06809178739786148, max=0.7754085659980774, mean=0.11140331625938416
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_160.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_180.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_200.pth
Done in 251.64918684959412 seconds
Load settings from /home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/pigheart.json
Latent space memory: 13.2MiB
Latent space memory: 13.2MiB
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Warps shared: 5 , warps mixed: 5
Loaded, output mode: density:direct
Convert model run03-rebuild/pigheart_hybrid/srn/model/run00001/model_epoch_200.pth
16 implicit functions loaded
Load volume "/media/storage0/qadwu/floats/pig_heart_2048x2048x2612_float32_raw_2048x2048x2612_float.cvol"
Load feature 0
Loaded
Search pyrenderer in '/home/qadwu/Work/fV-SRN/bin'
pyrenderer native library loaded
Load settings, collect volumes and TFs
Load settings from /home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/pigheart.json
Initialize network
NetworkWithInputEncoding(n_input_dims=3, n_output_dims=1, seed=1337, dtype=torch.float16, hyperparams={'encoding': {'base_resolution': 4, 'interpolation': 'Linear', 'log2_hashmap_size': 16, 'n_features_per_level': 8, 'n_levels': 10, 'otype': 'Grid', 'per_level_scale': 2.0, 'type': 'Hash'}, 'network': {'activation': 'ReLU', 'feedback_alignment': False, 'n_hidden_layers': 3, 'n_neurons': 64, 'otype': 'FullyFusedMLP', 'output_activation': 'ReLU'}, 'otype': 'NetworkWithInputEncoding'})
# of network parameters: 3459584
Create the dataloader
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 16777216 points.
This gives rise to 16777216 samples, split over 32 batches with a batch size of 524288.
In total, this requires 256.0MiB for the DataLoader
0it [00:00, ?it/s]Read from cache "kernel_cache/992a58811d75cd8abe61adc62a5325b79f4dfc24.kernel"
15 kernels loaded from cache
1it [00:00,  1.28it/s]1it [00:00,  1.28it/s]
Load TF 0, timestep 0, ensemble 0
Densities: min=0.08040472865104675, max=0.41714343428611755, mean=0.10840089619159698
Generate world-space dataset for 1 TFs, 1 timesteps, 1 ensembles, and 1 views of resolution 1024^2.
This gives rise to 1048576 samples, split over 1048576 batches with a batch size of 1.
In total, this requires 40.0MiB for the DataLoader
0it [00:00, ?it/s]Render: : 0it [00:00, ?it/s]Render: : 1it [00:25, 25.81s/it]Render: : 1it [00:25, 25.81s/it]
Load TF 0, timestep 0, ensemble 0
Model directory: run03-rebuild/pigheart_hybrid/inr/model
Log directory: run03-rebuild/pigheart_hybrid/inr/log
HDF5 directory: run03-rebuild/pigheart_hybrid/inr/hdf5
Current run: 00001
{'settings': '/home/qadwu/Work/fV-SRN/applications/config-files/instant-vnr/pigheart.json', 'tf_directory': None, 'volume_filenames': None, 'ensembles': '0:1', 'time_keyframes': '0:1', 'time_train': '0:1', 'time_val': '0:1', 'train:mode': 'world', 'train:views': 8, 'train:resolution': 256, 'train:stepsize': 0.01, 'train:num_refine': 0, 'train:samples': 16777216, 'train:sampler': 'random', 'train:sampler_importance': 0.01, 'train:batchsize': 524288, 'train:disable_inversion_trick': False, 'val:copy_and_split': 0.2, 'val:mode': None, 'val:views': 8, 'val:resolution': 256, 'val:stepsize': 0.01, 'val:num_refine': 0, 'val:samples': 1024, 'val:sampler': 'random', 'val:sampler_importance': None, 'val:batchsize': None, 'vis:resolution': 1024, 'vis:stepsize': 0.005, 'vis:num_refine': None, 'sampler_cache': 'cache/', 'cache_images': False, 'rebuild_dataset': 51, 'rebuild_gridsize': 128, 'rebuild_samples_per_voxel': 8, 'rebuild_importance': None, 'rebuild_force_color': False, 'lossmode': 'density', 'l1': 1.0, 'l2': 0, 'dssim': 0, 'lpips': 0, 'absorption_weighting': 0.1, 'multiply_alpha': False, 'optimizer': 'Adam', 'lr': 0.005, 'epochs': 200, 'lr_gamma': 0.8, 'lr_step': 10, 'optim_params': '{}', 'outputmode': 'density', 'layers': '32:32:32', 'activation': 'ReLU', 'fouriercount': 0, 'fourierstd': 1, 'time_features': 0, 'ensemble_features': 0, 'volumetric_features_channels': 0, 'volumetric_features_resolution': 0, 'volumetric_features_std': 0.01, 'volumetric_features_time_dependent': False, 'use_direction': False, 'disable_direction_in_fourier_features': False, 'fourier_position_direction_split': -1, 'use_time_direct': False, 'num_time_fourier': 0, 'meta_network': None, 'meta_activation': 'ReLU', 'meta_pretrain': None, 'logdir': 'run03-rebuild/pigheart_hybrid/inr/log', 'modeldir': 'run03-rebuild/pigheart_hybrid/inr/model', 'hdf5dir': 'run03-rebuild/pigheart_hybrid/inr/hdf5', 'name': None, 'save_frequency': 20, 'profile': False, 'seed': 124, 'dims': [2048, 2048, 1920], 'inr': '/home/qadwu/Work/instant-vnr-cuda/data/threshold-compress/compress-200000/pigheart-20220916185946-network.json', 'dryrun': False, 'CUDA_Device': 'Quadro RTX 8000', 'inr_config': {'optimizer': {'otype': 'ExponentialDecay', 'decay_start': 2000, 'decay_interval': 1000, 'decay_base': 0.99, 'nested': {'otype': 'Adam', 'learning_rate': 0.005, 'beta1': 0.9, 'beta2': 0.999, 'epsilon': 1e-15, 'l2_reg': 1e-06}}, 'loss': {'otype': 'L1'}, 'encoding': {'otype': 'HashGrid', 'n_levels': 10, 'n_features_per_level': 8, 'log2_hashmap_size': 16, 'base_resolution': 4}, 'network': {'otype': 'FullyFusedMLP', 'activation': 'ReLU', 'output_activation': 'ReLU', 'n_neurons': 64, 'n_hidden_layers': 3}}}
  0%|          | 0/201 [00:00<?, ?it/s]  0%|          | 1/201 [00:00<01:28,  2.25it/s]Loss: 0.02750:   0%|          | 1/201 [00:00<01:28,  2.25it/s]Loss: 0.02750:   1%|          | 2/201 [00:00<01:23,  2.39it/s]Loss: 0.00483:   1%|          | 2/201 [00:00<01:23,  2.39it/s]Loss: 0.00483:   1%|▏         | 3/201 [00:01<01:21,  2.44it/s]Loss: 0.00309:   1%|▏         | 3/201 [00:01<01:21,  2.44it/s]Loss: 0.00309:   2%|▏         | 4/201 [00:01<01:20,  2.46it/s]Loss: 0.00289:   2%|▏         | 4/201 [00:01<01:20,  2.46it/s]Loss: 0.00289:   2%|▏         | 5/201 [00:02<01:18,  2.48it/s]Loss: 0.00281:   2%|▏         | 5/201 [00:02<01:18,  2.48it/s]Loss: 0.00281:   3%|▎         | 6/201 [00:02<01:18,  2.50it/s]Loss: 0.00272:   3%|▎         | 6/201 [00:02<01:18,  2.50it/s]Loss: 0.00272:   3%|▎         | 7/201 [00:02<01:17,  2.51it/s]Loss: 0.00260:   3%|▎         | 7/201 [00:02<01:17,  2.51it/s]Loss: 0.00260:   4%|▍         | 8/201 [00:03<01:16,  2.51it/s]Loss: 0.00254:   4%|▍         | 8/201 [00:03<01:16,  2.51it/s]Loss: 0.00254:   4%|▍         | 9/201 [00:03<01:16,  2.52it/s]Loss: 0.00247:   4%|▍         | 9/201 [00:03<01:16,  2.52it/s]Loss: 0.00247:   5%|▍         | 10/201 [00:04<01:15,  2.52it/s]Loss: 0.00242:   5%|▍         | 10/201 [00:04<01:15,  2.52it/s]Loss: 0.00242:   5%|▌         | 11/201 [00:04<01:15,  2.52it/s]Loss: 0.00197:   5%|▌         | 11/201 [00:04<01:15,  2.52it/s]Loss: 0.00197:   6%|▌         | 12/201 [00:04<01:14,  2.52it/s]Loss: 0.00201:   6%|▌         | 12/201 [00:04<01:14,  2.52it/s]Loss: 0.00201:   6%|▋         | 13/201 [00:05<01:14,  2.52it/s]Loss: 0.00196:   6%|▋         | 13/201 [00:05<01:14,  2.52it/s]Loss: 0.00196:   7%|▋         | 14/201 [00:05<01:14,  2.52it/s]Loss: 0.00196:   7%|▋         | 14/201 [00:05<01:14,  2.52it/s]Loss: 0.00196:   7%|▋         | 15/201 [00:06<01:13,  2.52it/s]Loss: 0.00190:   7%|▋         | 15/201 [00:06<01:13,  2.52it/s]Loss: 0.00190:   8%|▊         | 16/201 [00:06<01:13,  2.52it/s]Loss: 0.00194:   8%|▊         | 16/201 [00:06<01:13,  2.52it/s]Loss: 0.00194:   8%|▊         | 17/201 [00:06<01:12,  2.52it/s]Loss: 0.00190:   8%|▊         | 17/201 [00:06<01:12,  2.52it/s]Loss: 0.00190:   9%|▉         | 18/201 [00:07<01:12,  2.52it/s]Loss: 0.00185:   9%|▉         | 18/201 [00:07<01:12,  2.52it/s]Loss: 0.00185:   9%|▉         | 19/201 [00:07<01:12,  2.52it/s]Loss: 0.00188:   9%|▉         | 19/201 [00:07<01:12,  2.52it/s]Loss: 0.00188:  10%|▉         | 20/201 [00:07<01:11,  2.52it/s]Loss: 0.00182:  10%|▉         | 20/201 [00:07<01:11,  2.52it/s]Loss: 0.00182:  10%|█         | 21/201 [00:08<01:12,  2.47it/s]Loss: 0.00157:  10%|█         | 21/201 [00:08<01:12,  2.47it/s]Loss: 0.00157:  11%|█         | 22/201 [00:08<01:11,  2.49it/s]Loss: 0.00156:  11%|█         | 22/201 [00:08<01:11,  2.49it/s]Loss: 0.00156:  11%|█▏        | 23/201 [00:09<01:11,  2.50it/s]Loss: 0.00153:  11%|█▏        | 23/201 [00:09<01:11,  2.50it/s]Loss: 0.00153:  12%|█▏        | 24/201 [00:09<01:10,  2.51it/s]Loss: 0.00152:  12%|█▏        | 24/201 [00:09<01:10,  2.51it/s]Loss: 0.00152:  12%|█▏        | 25/201 [00:09<01:10,  2.51it/s]Loss: 0.00154:  12%|█▏        | 25/201 [00:09<01:10,  2.51it/s]Loss: 0.00154:  13%|█▎        | 26/201 [00:10<01:09,  2.52it/s]Loss: 0.00154:  13%|█▎        | 26/201 [00:10<01:09,  2.52it/s]Loss: 0.00154:  13%|█▎        | 27/201 [00:10<01:09,  2.52it/s]Loss: 0.00154:  13%|█▎        | 27/201 [00:10<01:09,  2.52it/s]Loss: 0.00154:  14%|█▍        | 28/201 [00:11<01:08,  2.52it/s]Loss: 0.00155:  14%|█▍        | 28/201 [00:11<01:08,  2.52it/s]Loss: 0.00155:  14%|█▍        | 29/201 [00:11<01:08,  2.52it/s]Loss: 0.00156:  14%|█▍        | 29/201 [00:11<01:08,  2.52it/s]Loss: 0.00156:  15%|█▍        | 30/201 [00:11<01:07,  2.52it/s]Loss: 0.00156:  15%|█▍        | 30/201 [00:11<01:07,  2.52it/s]Loss: 0.00156:  15%|█▌        | 31/201 [00:12<01:07,  2.52it/s]Loss: 0.00137:  15%|█▌        | 31/201 [00:12<01:07,  2.52it/s]Loss: 0.00137:  16%|█▌        | 32/201 [00:12<01:07,  2.52it/s]Loss: 0.00135:  16%|█▌        | 32/201 [00:12<01:07,  2.52it/s]Loss: 0.00135:  16%|█▋        | 33/201 [00:13<01:06,  2.52it/s]Loss: 0.00136:  16%|█▋        | 33/201 [00:13<01:06,  2.52it/s]Loss: 0.00136:  17%|█▋        | 34/201 [00:13<01:06,  2.52it/s]Loss: 0.00136:  17%|█▋        | 34/201 [00:13<01:06,  2.52it/s]Loss: 0.00136:  17%|█▋        | 35/201 [00:13<01:05,  2.52it/s]Loss: 0.00136:  17%|█▋        | 35/201 [00:13<01:05,  2.52it/s]Loss: 0.00136:  18%|█▊        | 36/201 [00:14<01:05,  2.52it/s]Loss: 0.00134:  18%|█▊        | 36/201 [00:14<01:05,  2.52it/s]Loss: 0.00134:  18%|█▊        | 37/201 [00:14<01:05,  2.52it/s]Loss: 0.00138:  18%|█▊        | 37/201 [00:14<01:05,  2.52it/s]Loss: 0.00138:  19%|█▉        | 38/201 [00:15<01:04,  2.52it/s]Loss: 0.00137:  19%|█▉        | 38/201 [00:15<01:04,  2.52it/s]Loss: 0.00137:  19%|█▉        | 39/201 [00:15<01:04,  2.52it/s]Loss: 0.00136:  19%|█▉        | 39/201 [00:15<01:04,  2.52it/s]Loss: 0.00136:  20%|█▉        | 40/201 [00:15<01:03,  2.52it/s]Loss: 0.00136:  20%|█▉        | 40/201 [00:15<01:03,  2.52it/s]Loss: 0.00136:  20%|██        | 41/201 [00:16<01:05,  2.46it/s]Loss: 0.00123:  20%|██        | 41/201 [00:16<01:05,  2.46it/s]Loss: 0.00123:  21%|██        | 42/201 [00:16<01:04,  2.48it/s]Loss: 0.00122:  21%|██        | 42/201 [00:16<01:04,  2.48it/s]Loss: 0.00122:  21%|██▏       | 43/201 [00:17<01:03,  2.49it/s]Loss: 0.00122:  21%|██▏       | 43/201 [00:17<01:03,  2.49it/s]Loss: 0.00122:  22%|██▏       | 44/201 [00:17<01:02,  2.50it/s]Loss: 0.00122:  22%|██▏       | 44/201 [00:17<01:02,  2.50it/s]Loss: 0.00122:  22%|██▏       | 45/201 [00:17<01:02,  2.50it/s]Loss: 0.00123:  22%|██▏       | 45/201 [00:17<01:02,  2.50it/s]Loss: 0.00123:  23%|██▎       | 46/201 [00:18<01:01,  2.51it/s]Loss: 0.00122:  23%|██▎       | 46/201 [00:18<01:01,  2.51it/s]Loss: 0.00122:  23%|██▎       | 47/201 [00:18<01:01,  2.51it/s]Loss: 0.00122:  23%|██▎       | 47/201 [00:18<01:01,  2.51it/s]Loss: 0.00122:  24%|██▍       | 48/201 [00:19<01:01,  2.50it/s]Loss: 0.00123:  24%|██▍       | 48/201 [00:19<01:01,  2.50it/s]Loss: 0.00123:  24%|██▍       | 49/201 [00:19<01:00,  2.50it/s]Loss: 0.00123:  24%|██▍       | 49/201 [00:19<01:00,  2.50it/s]Loss: 0.00123:  25%|██▍       | 50/201 [00:19<01:00,  2.50it/s]Loss: 0.00123:  25%|██▍       | 50/201 [00:19<01:00,  2.50it/s]Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_0.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_20.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_40.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.54s/it][A1it [00:01,  1.54s/it]
Loss: 0.00123:  25%|██▌       | 51/201 [00:21<02:09,  1.15it/s]Loss: 0.00250:  25%|██▌       | 51/201 [00:21<02:09,  1.15it/s]Loss: 0.00250:  26%|██▌       | 52/201 [00:22<01:48,  1.38it/s]Loss: 0.00222:  26%|██▌       | 52/201 [00:22<01:48,  1.38it/s]Loss: 0.00222:  26%|██▋       | 53/201 [00:22<01:33,  1.59it/s]Loss: 0.00208:  26%|██▋       | 53/201 [00:22<01:33,  1.59it/s]Loss: 0.00208:  27%|██▋       | 54/201 [00:23<01:22,  1.79it/s]Loss: 0.00200:  27%|██▋       | 54/201 [00:23<01:22,  1.79it/s]Loss: 0.00200:  27%|██▋       | 55/201 [00:23<01:14,  1.96it/s]Loss: 0.00194:  27%|██▋       | 55/201 [00:23<01:14,  1.96it/s]Loss: 0.00194:  28%|██▊       | 56/201 [00:23<01:09,  2.09it/s]Loss: 0.00189:  28%|██▊       | 56/201 [00:23<01:09,  2.09it/s]Loss: 0.00189:  28%|██▊       | 57/201 [00:24<01:05,  2.21it/s]Loss: 0.00186:  28%|██▊       | 57/201 [00:24<01:05,  2.21it/s]Loss: 0.00186:  29%|██▉       | 58/201 [00:24<01:02,  2.29it/s]Loss: 0.00182:  29%|██▉       | 58/201 [00:24<01:02,  2.29it/s]Loss: 0.00182:  29%|██▉       | 59/201 [00:25<01:00,  2.35it/s]Loss: 0.00180:  29%|██▉       | 59/201 [00:25<01:00,  2.35it/s]Loss: 0.00180:  30%|██▉       | 60/201 [00:25<00:58,  2.39it/s]Loss: 0.00177:  30%|██▉       | 60/201 [00:25<00:58,  2.39it/s]Loss: 0.00177:  30%|███       | 61/201 [00:25<00:58,  2.38it/s]Loss: 0.00173:  30%|███       | 61/201 [00:25<00:58,  2.38it/s]Loss: 0.00173:  31%|███       | 62/201 [00:26<00:57,  2.43it/s]Loss: 0.00171:  31%|███       | 62/201 [00:26<00:57,  2.43it/s]Loss: 0.00171:  31%|███▏      | 63/201 [00:26<00:56,  2.45it/s]Loss: 0.00169:  31%|███▏      | 63/201 [00:26<00:56,  2.45it/s]Loss: 0.00169:  32%|███▏      | 64/201 [00:27<00:55,  2.47it/s]Loss: 0.00168:  32%|███▏      | 64/201 [00:27<00:55,  2.47it/s]Loss: 0.00168:  32%|███▏      | 65/201 [00:27<00:54,  2.49it/s]Loss: 0.00166:  32%|███▏      | 65/201 [00:27<00:54,  2.49it/s]Loss: 0.00166:  33%|███▎      | 66/201 [00:27<00:54,  2.50it/s]Loss: 0.00165:  33%|███▎      | 66/201 [00:27<00:54,  2.50it/s]Loss: 0.00165:  33%|███▎      | 67/201 [00:28<00:53,  2.51it/s]Loss: 0.00164:  33%|███▎      | 67/201 [00:28<00:53,  2.51it/s]Loss: 0.00164:  34%|███▍      | 68/201 [00:28<00:52,  2.51it/s]Loss: 0.00163:  34%|███▍      | 68/201 [00:28<00:52,  2.51it/s]Loss: 0.00163:  34%|███▍      | 69/201 [00:29<00:52,  2.51it/s]Loss: 0.00163:  34%|███▍      | 69/201 [00:29<00:52,  2.51it/s]Loss: 0.00163:  35%|███▍      | 70/201 [00:29<00:52,  2.52it/s]Loss: 0.00161:  35%|███▍      | 70/201 [00:29<00:52,  2.52it/s]Loss: 0.00161:  35%|███▌      | 71/201 [00:29<00:51,  2.52it/s]Loss: 0.00159:  35%|███▌      | 71/201 [00:29<00:51,  2.52it/s]Loss: 0.00159:  36%|███▌      | 72/201 [00:30<00:51,  2.52it/s]Loss: 0.00157:  36%|███▌      | 72/201 [00:30<00:51,  2.52it/s]Loss: 0.00157:  36%|███▋      | 73/201 [00:30<00:50,  2.52it/s]Loss: 0.00157:  36%|███▋      | 73/201 [00:30<00:50,  2.52it/s]Loss: 0.00157:  37%|███▋      | 74/201 [00:31<00:50,  2.52it/s]Loss: 0.00156:  37%|███▋      | 74/201 [00:31<00:50,  2.52it/s]Loss: 0.00156:  37%|███▋      | 75/201 [00:31<00:50,  2.52it/s]Loss: 0.00155:  37%|███▋      | 75/201 [00:31<00:50,  2.52it/s]Loss: 0.00155:  38%|███▊      | 76/201 [00:31<00:49,  2.52it/s]Loss: 0.00155:  38%|███▊      | 76/201 [00:31<00:49,  2.52it/s]Loss: 0.00155:  38%|███▊      | 77/201 [00:32<00:49,  2.52it/s]Loss: 0.00154:  38%|███▊      | 77/201 [00:32<00:49,  2.52it/s]Loss: 0.00154:  39%|███▉      | 78/201 [00:32<00:48,  2.52it/s]Loss: 0.00154:  39%|███▉      | 78/201 [00:32<00:48,  2.52it/s]Loss: 0.00154:  39%|███▉      | 79/201 [00:33<00:48,  2.52it/s]Loss: 0.00153:  39%|███▉      | 79/201 [00:33<00:48,  2.52it/s]Loss: 0.00153:  40%|███▉      | 80/201 [00:33<00:47,  2.52it/s]Loss: 0.00153:  40%|███▉      | 80/201 [00:33<00:47,  2.52it/s]Loss: 0.00153:  40%|████      | 81/201 [00:33<00:48,  2.47it/s]Loss: 0.00151:  40%|████      | 81/201 [00:33<00:48,  2.47it/s]Loss: 0.00151:  41%|████      | 82/201 [00:34<00:47,  2.49it/s]Loss: 0.00149:  41%|████      | 82/201 [00:34<00:47,  2.49it/s]Loss: 0.00149:  41%|████▏     | 83/201 [00:34<00:47,  2.50it/s]Loss: 0.00149:  41%|████▏     | 83/201 [00:34<00:47,  2.50it/s]Loss: 0.00149:  42%|████▏     | 84/201 [00:35<00:46,  2.51it/s]Loss: 0.00149:  42%|████▏     | 84/201 [00:35<00:46,  2.51it/s]Loss: 0.00149:  42%|████▏     | 85/201 [00:35<00:46,  2.51it/s]Loss: 0.00148:  42%|████▏     | 85/201 [00:35<00:46,  2.51it/s]Loss: 0.00148:  43%|████▎     | 86/201 [00:35<00:45,  2.52it/s]Loss: 0.00148:  43%|████▎     | 86/201 [00:35<00:45,  2.52it/s]Loss: 0.00148:  43%|████▎     | 87/201 [00:36<00:45,  2.52it/s]Loss: 0.00148:  43%|████▎     | 87/201 [00:36<00:45,  2.52it/s]Loss: 0.00148:  44%|████▍     | 88/201 [00:36<00:44,  2.52it/s]Loss: 0.00147:  44%|████▍     | 88/201 [00:36<00:44,  2.52it/s]Loss: 0.00147:  44%|████▍     | 89/201 [00:37<00:44,  2.52it/s]Loss: 0.00147:  44%|████▍     | 89/201 [00:37<00:44,  2.52it/s]Loss: 0.00147:  45%|████▍     | 90/201 [00:37<00:44,  2.52it/s]Loss: 0.00148:  45%|████▍     | 90/201 [00:37<00:44,  2.52it/s]Loss: 0.00148:  45%|████▌     | 91/201 [00:37<00:43,  2.52it/s]Loss: 0.00146:  45%|████▌     | 91/201 [00:37<00:43,  2.52it/s]Loss: 0.00146:  46%|████▌     | 92/201 [00:38<00:43,  2.52it/s]Loss: 0.00145:  46%|████▌     | 92/201 [00:38<00:43,  2.52it/s]Loss: 0.00145:  46%|████▋     | 93/201 [00:38<00:42,  2.52it/s]Loss: 0.00144:  46%|████▋     | 93/201 [00:38<00:42,  2.52it/s]Loss: 0.00144:  47%|████▋     | 94/201 [00:39<00:42,  2.52it/s]Loss: 0.00144:  47%|████▋     | 94/201 [00:39<00:42,  2.52it/s]Loss: 0.00144:  47%|████▋     | 95/201 [00:39<00:42,  2.52it/s]Loss: 0.00143:  47%|████▋     | 95/201 [00:39<00:42,  2.52it/s]Loss: 0.00143:  48%|████▊     | 96/201 [00:39<00:41,  2.52it/s]Loss: 0.00143:  48%|████▊     | 96/201 [00:39<00:41,  2.52it/s]Loss: 0.00143:  48%|████▊     | 97/201 [00:40<00:41,  2.52it/s]Loss: 0.00143:  48%|████▊     | 97/201 [00:40<00:41,  2.52it/s]Loss: 0.00143:  49%|████▉     | 98/201 [00:40<00:40,  2.52it/s]Loss: 0.00143:  49%|████▉     | 98/201 [00:40<00:40,  2.52it/s]Loss: 0.00143:  49%|████▉     | 99/201 [00:41<00:40,  2.52it/s]Loss: 0.00143:  49%|████▉     | 99/201 [00:41<00:40,  2.52it/s]Loss: 0.00143:  50%|████▉     | 100/201 [00:41<00:40,  2.52it/s]Loss: 0.00143:  50%|████▉     | 100/201 [00:41<00:40,  2.52it/s]Loss: 0.00143:  50%|█████     | 101/201 [00:41<00:40,  2.47it/s]Loss: 0.00141:  50%|█████     | 101/201 [00:41<00:40,  2.47it/s]max loss: 0.0439511314034462
Densities: min=0.04933301359415054, max=0.5539122223854065, mean=0.1117500513792038
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_60.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_80.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_100.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.57s/it][A1it [00:01,  1.57s/it]
Loss: 0.00141:  51%|█████     | 102/201 [00:43<01:27,  1.14it/s]Loss: 0.00195:  51%|█████     | 102/201 [00:43<01:27,  1.14it/s]Loss: 0.00195:  51%|█████     | 103/201 [00:44<01:12,  1.36it/s]Loss: 0.00184:  51%|█████     | 103/201 [00:44<01:12,  1.36it/s]Loss: 0.00184:  52%|█████▏    | 104/201 [00:44<01:01,  1.58it/s]Loss: 0.00178:  52%|█████▏    | 104/201 [00:44<01:01,  1.58it/s]Loss: 0.00178:  52%|█████▏    | 105/201 [00:45<00:54,  1.78it/s]Loss: 0.00174:  52%|█████▏    | 105/201 [00:45<00:54,  1.78it/s]Loss: 0.00174:  53%|█████▎    | 106/201 [00:45<00:48,  1.94it/s]Loss: 0.00171:  53%|█████▎    | 106/201 [00:45<00:48,  1.94it/s]Loss: 0.00171:  53%|█████▎    | 107/201 [00:45<00:45,  2.08it/s]Loss: 0.00168:  53%|█████▎    | 107/201 [00:45<00:45,  2.08it/s]Loss: 0.00168:  54%|█████▎    | 108/201 [00:46<00:42,  2.20it/s]Loss: 0.00166:  54%|█████▎    | 108/201 [00:46<00:42,  2.20it/s]Loss: 0.00166:  54%|█████▍    | 109/201 [00:46<00:40,  2.28it/s]Loss: 0.00164:  54%|█████▍    | 109/201 [00:46<00:40,  2.28it/s]Loss: 0.00164:  55%|█████▍    | 110/201 [00:47<00:38,  2.34it/s]Loss: 0.00163:  55%|█████▍    | 110/201 [00:47<00:38,  2.34it/s]Loss: 0.00163:  55%|█████▌    | 111/201 [00:47<00:37,  2.39it/s]Loss: 0.00161:  55%|█████▌    | 111/201 [00:47<00:37,  2.39it/s]Loss: 0.00161:  56%|█████▌    | 112/201 [00:47<00:36,  2.43it/s]Loss: 0.00159:  56%|█████▌    | 112/201 [00:47<00:36,  2.43it/s]Loss: 0.00159:  56%|█████▌    | 113/201 [00:48<00:35,  2.46it/s]Loss: 0.00158:  56%|█████▌    | 113/201 [00:48<00:35,  2.46it/s]Loss: 0.00158:  57%|█████▋    | 114/201 [00:48<00:35,  2.48it/s]Loss: 0.00157:  57%|█████▋    | 114/201 [00:48<00:35,  2.48it/s]Loss: 0.00157:  57%|█████▋    | 115/201 [00:48<00:34,  2.49it/s]Loss: 0.00156:  57%|█████▋    | 115/201 [00:48<00:34,  2.49it/s]Loss: 0.00156:  58%|█████▊    | 116/201 [00:49<00:34,  2.50it/s]Loss: 0.00155:  58%|█████▊    | 116/201 [00:49<00:34,  2.50it/s]Loss: 0.00155:  58%|█████▊    | 117/201 [00:49<00:33,  2.50it/s]Loss: 0.00155:  58%|█████▊    | 117/201 [00:49<00:33,  2.50it/s]Loss: 0.00155:  59%|█████▊    | 118/201 [00:50<00:33,  2.51it/s]Loss: 0.00154:  59%|█████▊    | 118/201 [00:50<00:33,  2.51it/s]Loss: 0.00154:  59%|█████▉    | 119/201 [00:50<00:32,  2.51it/s]Loss: 0.00153:  59%|█████▉    | 119/201 [00:50<00:32,  2.51it/s]Loss: 0.00153:  60%|█████▉    | 120/201 [00:50<00:32,  2.51it/s]Loss: 0.00152:  60%|█████▉    | 120/201 [00:50<00:32,  2.51it/s]Loss: 0.00152:  60%|██████    | 121/201 [00:51<00:32,  2.47it/s]Loss: 0.00151:  60%|██████    | 121/201 [00:51<00:32,  2.47it/s]Loss: 0.00151:  61%|██████    | 122/201 [00:51<00:31,  2.49it/s]Loss: 0.00150:  61%|██████    | 122/201 [00:51<00:31,  2.49it/s]Loss: 0.00150:  61%|██████    | 123/201 [00:52<00:31,  2.50it/s]Loss: 0.00150:  61%|██████    | 123/201 [00:52<00:31,  2.50it/s]Loss: 0.00150:  62%|██████▏   | 124/201 [00:52<00:30,  2.50it/s]Loss: 0.00149:  62%|██████▏   | 124/201 [00:52<00:30,  2.50it/s]Loss: 0.00149:  62%|██████▏   | 125/201 [00:52<00:30,  2.50it/s]Loss: 0.00149:  62%|██████▏   | 125/201 [00:52<00:30,  2.50it/s]Loss: 0.00149:  63%|██████▎   | 126/201 [00:53<00:29,  2.51it/s]Loss: 0.00148:  63%|██████▎   | 126/201 [00:53<00:29,  2.51it/s]Loss: 0.00148:  63%|██████▎   | 127/201 [00:53<00:29,  2.51it/s]Loss: 0.00148:  63%|██████▎   | 127/201 [00:53<00:29,  2.51it/s]Loss: 0.00148:  64%|██████▎   | 128/201 [00:54<00:29,  2.51it/s]Loss: 0.00147:  64%|██████▎   | 128/201 [00:54<00:29,  2.51it/s]Loss: 0.00147:  64%|██████▍   | 129/201 [00:54<00:28,  2.51it/s]Loss: 0.00147:  64%|██████▍   | 129/201 [00:54<00:28,  2.51it/s]Loss: 0.00147:  65%|██████▍   | 130/201 [00:54<00:28,  2.51it/s]Loss: 0.00147:  65%|██████▍   | 130/201 [00:54<00:28,  2.51it/s]Loss: 0.00147:  65%|██████▌   | 131/201 [00:55<00:27,  2.51it/s]Loss: 0.00146:  65%|██████▌   | 131/201 [00:55<00:27,  2.51it/s]Loss: 0.00146:  66%|██████▌   | 132/201 [00:55<00:27,  2.51it/s]Loss: 0.00145:  66%|██████▌   | 132/201 [00:55<00:27,  2.51it/s]Loss: 0.00145:  66%|██████▌   | 133/201 [00:56<00:27,  2.51it/s]Loss: 0.00145:  66%|██████▌   | 133/201 [00:56<00:27,  2.51it/s]Loss: 0.00145:  67%|██████▋   | 134/201 [00:56<00:26,  2.51it/s]Loss: 0.00145:  67%|██████▋   | 134/201 [00:56<00:26,  2.51it/s]Loss: 0.00145:  67%|██████▋   | 135/201 [00:56<00:26,  2.51it/s]Loss: 0.00144:  67%|██████▋   | 135/201 [00:56<00:26,  2.51it/s]Loss: 0.00144:  68%|██████▊   | 136/201 [00:57<00:25,  2.51it/s]Loss: 0.00144:  68%|██████▊   | 136/201 [00:57<00:25,  2.51it/s]Loss: 0.00144:  68%|██████▊   | 137/201 [00:57<00:25,  2.51it/s]Loss: 0.00144:  68%|██████▊   | 137/201 [00:57<00:25,  2.51it/s]Loss: 0.00144:  69%|██████▊   | 138/201 [00:58<00:25,  2.51it/s]Loss: 0.00143:  69%|██████▊   | 138/201 [00:58<00:25,  2.51it/s]Loss: 0.00143:  69%|██████▉   | 139/201 [00:58<00:24,  2.51it/s]Loss: 0.00143:  69%|██████▉   | 139/201 [00:58<00:24,  2.51it/s]Loss: 0.00143:  70%|██████▉   | 140/201 [00:58<00:24,  2.51it/s]Loss: 0.00143:  70%|██████▉   | 140/201 [00:58<00:24,  2.51it/s]Loss: 0.00143:  70%|███████   | 141/201 [00:59<00:24,  2.46it/s]Loss: 0.00142:  70%|███████   | 141/201 [00:59<00:24,  2.46it/s]Loss: 0.00142:  71%|███████   | 142/201 [00:59<00:23,  2.48it/s]Loss: 0.00142:  71%|███████   | 142/201 [00:59<00:23,  2.48it/s]Loss: 0.00142:  71%|███████   | 143/201 [01:00<00:23,  2.49it/s]Loss: 0.00142:  71%|███████   | 143/201 [01:00<00:23,  2.49it/s]Loss: 0.00142:  72%|███████▏  | 144/201 [01:00<00:22,  2.50it/s]Loss: 0.00141:  72%|███████▏  | 144/201 [01:00<00:22,  2.50it/s]Loss: 0.00141:  72%|███████▏  | 145/201 [01:00<00:22,  2.50it/s]Loss: 0.00141:  72%|███████▏  | 145/201 [01:00<00:22,  2.50it/s]Loss: 0.00141:  73%|███████▎  | 146/201 [01:01<00:21,  2.51it/s]Loss: 0.00141:  73%|███████▎  | 146/201 [01:01<00:21,  2.51it/s]Loss: 0.00141:  73%|███████▎  | 147/201 [01:01<00:21,  2.51it/s]Loss: 0.00141:  73%|███████▎  | 147/201 [01:01<00:21,  2.51it/s]Loss: 0.00141:  74%|███████▎  | 148/201 [01:02<00:21,  2.51it/s]Loss: 0.00141:  74%|███████▎  | 148/201 [01:02<00:21,  2.51it/s]Loss: 0.00141:  74%|███████▍  | 149/201 [01:02<00:20,  2.51it/s]Loss: 0.00140:  74%|███████▍  | 149/201 [01:02<00:20,  2.51it/s]Loss: 0.00140:  75%|███████▍  | 150/201 [01:02<00:20,  2.51it/s]Loss: 0.00140:  75%|███████▍  | 150/201 [01:02<00:20,  2.51it/s]Loss: 0.00140:  75%|███████▌  | 151/201 [01:03<00:19,  2.51it/s]Loss: 0.00140:  75%|███████▌  | 151/201 [01:03<00:19,  2.51it/s]Loss: 0.00140:  76%|███████▌  | 152/201 [01:03<00:19,  2.51it/s]Loss: 0.00139:  76%|███████▌  | 152/201 [01:03<00:19,  2.51it/s]max loss: 0.046688273549079895
Densities: min=0.05919133871793747, max=0.9374369382858276, mean=0.11148867011070251
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_120.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_140.pth
Rebuild training data based on the loss distribution

0it [00:00, ?it/s][A
1it [00:01,  1.71s/it][A1it [00:01,  1.71s/it]
Loss: 0.00139:  76%|███████▌  | 153/201 [01:05<00:43,  1.09it/s]Loss: 0.00178:  76%|███████▌  | 153/201 [01:05<00:43,  1.09it/s]Loss: 0.00178:  77%|███████▋  | 154/201 [01:06<00:35,  1.32it/s]Loss: 0.00172:  77%|███████▋  | 154/201 [01:06<00:35,  1.32it/s]Loss: 0.00172:  77%|███████▋  | 155/201 [01:06<00:29,  1.54it/s]Loss: 0.00169:  77%|███████▋  | 155/201 [01:06<00:29,  1.54it/s]Loss: 0.00169:  78%|███████▊  | 156/201 [01:07<00:25,  1.74it/s]Loss: 0.00166:  78%|███████▊  | 156/201 [01:07<00:25,  1.74it/s]Loss: 0.00166:  78%|███████▊  | 157/201 [01:07<00:22,  1.92it/s]Loss: 0.00164:  78%|███████▊  | 157/201 [01:07<00:22,  1.92it/s]Loss: 0.00164:  79%|███████▊  | 158/201 [01:07<00:20,  2.06it/s]Loss: 0.00163:  79%|███████▊  | 158/201 [01:07<00:20,  2.06it/s]Loss: 0.00163:  79%|███████▉  | 159/201 [01:08<00:19,  2.18it/s]Loss: 0.00161:  79%|███████▉  | 159/201 [01:08<00:19,  2.18it/s]Loss: 0.00161:  80%|███████▉  | 160/201 [01:08<00:18,  2.27it/s]Loss: 0.00160:  80%|███████▉  | 160/201 [01:08<00:18,  2.27it/s]Loss: 0.00160:  80%|████████  | 161/201 [01:09<00:17,  2.29it/s]Loss: 0.00158:  80%|████████  | 161/201 [01:09<00:17,  2.29it/s]Loss: 0.00158:  81%|████████  | 162/201 [01:09<00:16,  2.35it/s]Loss: 0.00157:  81%|████████  | 162/201 [01:09<00:16,  2.35it/s]Loss: 0.00157:  81%|████████  | 163/201 [01:09<00:15,  2.40it/s]Loss: 0.00157:  81%|████████  | 163/201 [01:09<00:15,  2.40it/s]Loss: 0.00157:  82%|████████▏ | 164/201 [01:10<00:15,  2.43it/s]Loss: 0.00156:  82%|████████▏ | 164/201 [01:10<00:15,  2.43it/s]Loss: 0.00156:  82%|████████▏ | 165/201 [01:10<00:14,  2.46it/s]Loss: 0.00155:  82%|████████▏ | 165/201 [01:10<00:14,  2.46it/s]Loss: 0.00155:  83%|████████▎ | 166/201 [01:11<00:14,  2.48it/s]Loss: 0.00154:  83%|████████▎ | 166/201 [01:11<00:14,  2.48it/s]Loss: 0.00154:  83%|████████▎ | 167/201 [01:11<00:13,  2.49it/s]Loss: 0.00154:  83%|████████▎ | 167/201 [01:11<00:13,  2.49it/s]Loss: 0.00154:  84%|████████▎ | 168/201 [01:11<00:13,  2.50it/s]Loss: 0.00153:  84%|████████▎ | 168/201 [01:11<00:13,  2.50it/s]Loss: 0.00153:  84%|████████▍ | 169/201 [01:12<00:12,  2.51it/s]Loss: 0.00152:  84%|████████▍ | 169/201 [01:12<00:12,  2.51it/s]Loss: 0.00152:  85%|████████▍ | 170/201 [01:12<00:12,  2.51it/s]Loss: 0.00152:  85%|████████▍ | 170/201 [01:12<00:12,  2.51it/s]Loss: 0.00152:  85%|████████▌ | 171/201 [01:13<00:11,  2.51it/s]Loss: 0.00151:  85%|████████▌ | 171/201 [01:13<00:11,  2.51it/s]Loss: 0.00151:  86%|████████▌ | 172/201 [01:13<00:11,  2.52it/s]Loss: 0.00151:  86%|████████▌ | 172/201 [01:13<00:11,  2.52it/s]Loss: 0.00151:  86%|████████▌ | 173/201 [01:13<00:11,  2.52it/s]Loss: 0.00150:  86%|████████▌ | 173/201 [01:13<00:11,  2.52it/s]Loss: 0.00150:  87%|████████▋ | 174/201 [01:14<00:10,  2.52it/s]Loss: 0.00150:  87%|████████▋ | 174/201 [01:14<00:10,  2.52it/s]Loss: 0.00150:  87%|████████▋ | 175/201 [01:14<00:10,  2.52it/s]Loss: 0.00149:  87%|████████▋ | 175/201 [01:14<00:10,  2.52it/s]Loss: 0.00149:  88%|████████▊ | 176/201 [01:15<00:09,  2.52it/s]Loss: 0.00149:  88%|████████▊ | 176/201 [01:15<00:09,  2.52it/s]Loss: 0.00149:  88%|████████▊ | 177/201 [01:15<00:09,  2.52it/s]Loss: 0.00149:  88%|████████▊ | 177/201 [01:15<00:09,  2.52it/s]Loss: 0.00149:  89%|████████▊ | 178/201 [01:15<00:09,  2.52it/s]Loss: 0.00148:  89%|████████▊ | 178/201 [01:15<00:09,  2.52it/s]Loss: 0.00148:  89%|████████▉ | 179/201 [01:16<00:08,  2.52it/s]Loss: 0.00148:  89%|████████▉ | 179/201 [01:16<00:08,  2.52it/s]Loss: 0.00148:  90%|████████▉ | 180/201 [01:16<00:08,  2.52it/s]Loss: 0.00148:  90%|████████▉ | 180/201 [01:16<00:08,  2.52it/s]Loss: 0.00148:  90%|█████████ | 181/201 [01:17<00:08,  2.49it/s]Loss: 0.00147:  90%|█████████ | 181/201 [01:17<00:08,  2.49it/s]Loss: 0.00147:  91%|█████████ | 182/201 [01:17<00:07,  2.52it/s]Loss: 0.00147:  91%|█████████ | 182/201 [01:17<00:07,  2.52it/s]Loss: 0.00147:  91%|█████████ | 183/201 [01:17<00:07,  2.53it/s]Loss: 0.00146:  91%|█████████ | 183/201 [01:17<00:07,  2.53it/s]Loss: 0.00146:  92%|█████████▏| 184/201 [01:18<00:06,  2.54it/s]Loss: 0.00146:  92%|█████████▏| 184/201 [01:18<00:06,  2.54it/s]Loss: 0.00146:  92%|█████████▏| 185/201 [01:18<00:06,  2.55it/s]Loss: 0.00146:  92%|█████████▏| 185/201 [01:18<00:06,  2.55it/s]Loss: 0.00146:  93%|█████████▎| 186/201 [01:18<00:05,  2.56it/s]Loss: 0.00146:  93%|█████████▎| 186/201 [01:18<00:05,  2.56it/s]Loss: 0.00146:  93%|█████████▎| 187/201 [01:19<00:05,  2.56it/s]Loss: 0.00145:  93%|█████████▎| 187/201 [01:19<00:05,  2.56it/s]Loss: 0.00145:  94%|█████████▎| 188/201 [01:19<00:05,  2.56it/s]Loss: 0.00145:  94%|█████████▎| 188/201 [01:19<00:05,  2.56it/s]Loss: 0.00145:  94%|█████████▍| 189/201 [01:20<00:04,  2.56it/s]Loss: 0.00145:  94%|█████████▍| 189/201 [01:20<00:04,  2.56it/s]Loss: 0.00145:  95%|█████████▍| 190/201 [01:20<00:04,  2.56it/s]Loss: 0.00145:  95%|█████████▍| 190/201 [01:20<00:04,  2.56it/s]Loss: 0.00145:  95%|█████████▌| 191/201 [01:20<00:03,  2.56it/s]Loss: 0.00144:  95%|█████████▌| 191/201 [01:20<00:03,  2.56it/s]Loss: 0.00144:  96%|█████████▌| 192/201 [01:21<00:03,  2.57it/s]Loss: 0.00144:  96%|█████████▌| 192/201 [01:21<00:03,  2.57it/s]Loss: 0.00144:  96%|█████████▌| 193/201 [01:21<00:03,  2.57it/s]Loss: 0.00144:  96%|█████████▌| 193/201 [01:21<00:03,  2.57it/s]Loss: 0.00144:  97%|█████████▋| 194/201 [01:22<00:02,  2.57it/s]Loss: 0.00144:  97%|█████████▋| 194/201 [01:22<00:02,  2.57it/s]Loss: 0.00144:  97%|█████████▋| 195/201 [01:22<00:02,  2.57it/s]Loss: 0.00144:  97%|█████████▋| 195/201 [01:22<00:02,  2.57it/s]Loss: 0.00144:  98%|█████████▊| 196/201 [01:22<00:01,  2.57it/s]Loss: 0.00143:  98%|█████████▊| 196/201 [01:22<00:01,  2.57it/s]Loss: 0.00143:  98%|█████████▊| 197/201 [01:23<00:01,  2.57it/s]Loss: 0.00143:  98%|█████████▊| 197/201 [01:23<00:01,  2.57it/s]Loss: 0.00143:  99%|█████████▊| 198/201 [01:23<00:01,  2.57it/s]Loss: 0.00143:  99%|█████████▊| 198/201 [01:23<00:01,  2.57it/s]Loss: 0.00143:  99%|█████████▉| 199/201 [01:24<00:00,  2.57it/s]Loss: 0.00143:  99%|█████████▉| 199/201 [01:24<00:00,  2.57it/s]Loss: 0.00143: 100%|█████████▉| 200/201 [01:24<00:00,  2.57it/s]Loss: 0.00143: 100%|█████████▉| 200/201 [01:24<00:00,  2.57it/s]Loss: 0.00143: 100%|██████████| 201/201 [01:24<00:00,  2.52it/s]Loss: 0.00142: 100%|██████████| 201/201 [01:24<00:00,  2.52it/s]Loss: 0.00142: 100%|██████████| 201/201 [01:24<00:00,  2.37it/s]
max loss: 0.06019357591867447
Densities: min=0.06809178739786148, max=0.7754085659980774, mean=0.11078202724456787
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_160.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_180.pth
Checkpoint saved to run03-rebuild/pigheart_hybrid/inr/model/run00001/model_epoch_200.pth
Done in 84.85533118247986 seconds
Traceback (most recent call last):
  File "volnet/train_volnet_lite.py", line 311, in <module>
    main()
  File "volnet/train_volnet_lite.py", line 302, in main
    create_inr_scene(basename, opt['dims'], network)
  File "/home/qadwu/Work/fV-SRN/applications/volnet/train_inr_helper.py", line 115, in create_inr_scene
    mc = compute_macrocell(dims, model)
  File "/home/qadwu/Work/fV-SRN/applications/volnet/train_inr_helper.py", line 87, in compute_macrocell
    y = model((x * vscale).clamp(min=0, max=1)).reshape([m, n])
  File "/home/qadwu/Software/miniconda3/envs/proj-fvsrn/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/qadwu/Work/fV-SRN/applications/volnet/train_inr_helper.py", line 26, in forward
    return self.model(x).float()
  File "/home/qadwu/Software/miniconda3/envs/proj-fvsrn/lib/python3.8/site-packages/torch/nn/modules/module.py", line 889, in _call_impl
    result = self.forward(*input, **kwargs)
  File "/home/qadwu/Software/miniconda3/envs/proj-fvsrn/lib/python3.8/site-packages/tinycudann-1.5-py3.8-linux-x86_64.egg/tinycudann/modules.py", line 123, in forward
    output = _module_function.apply(
  File "/home/qadwu/Software/miniconda3/envs/proj-fvsrn/lib/python3.8/site-packages/tinycudann-1.5-py3.8-linux-x86_64.egg/tinycudann/modules.py", line 32, in forward
    native_ctx, output = native_tcnn_module.fwd(input, params)
RuntimeError: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:556 cuMemCreate(&m_handles.back(), n_bytes_to_allocate, &prop, 0) failed with error CUDA_ERROR_OUT_OF_MEMORY
Could not free memory: /home/qadwu/Work/ascent-superbuild/tiny-cuda-nn/include/tiny-cuda-nn/gpu_memory.h:462 cuMemRelease(handle) failed with error CUDA_ERROR_INVALID_VALUE
